(() => {
  var t = {
      479: (t) => {
        !(function i(n) {
          var r;
          (r = function () {
            function t(t, i) {
              var n = Object.keys(t);
              if (Object.getOwnPropertySymbols) {
                var r = Object.getOwnPropertySymbols(t);
                i &&
                  (r = r.filter(function (i) {
                    return Object.getOwnPropertyDescriptor(t, i).enumerable;
                  })),
                  n.push.apply(n, r);
              }
              return n;
            }
            function r(i) {
              for (var n = 1; n < arguments.length; n++) {
                var r = null != arguments[n] ? arguments[n] : {};
                n % 2
                  ? t(Object(r), !0).forEach(function (t) {
                      a(i, t, r[t]);
                    })
                  : Object.getOwnPropertyDescriptors
                  ? Object.defineProperties(
                      i,
                      Object.getOwnPropertyDescriptors(r)
                    )
                  : t(Object(r)).forEach(function (t) {
                      Object.defineProperty(
                        i,
                        t,
                        Object.getOwnPropertyDescriptor(r, t)
                      );
                    });
              }
              return i;
            }
            function e(t, i) {
              for (var n = 0; n < i.length; n++) {
                var r = i[n];
                (r.enumerable = r.enumerable || !1),
                  (r.configurable = !0),
                  "value" in r && (r.writable = !0),
                  Object.defineProperty(t, p(r.key), r);
              }
            }
            function s(t, i, n) {
              return (
                i && e(t.prototype, i),
                n && e(t, n),
                Object.defineProperty(t, "prototype", { writable: !1 }),
                t
              );
            }
            function a(t, i, n) {
              return (
                (i = p(i)) in t
                  ? Object.defineProperty(t, i, {
                      value: n,
                      enumerable: !0,
                      configurable: !0,
                      writable: !0,
                    })
                  : (t[i] = n),
                t
              );
            }
            function o() {
              return (
                (o = Object.assign
                  ? Object.assign.bind()
                  : function (t) {
                      for (var i = 1; i < arguments.length; i++) {
                        var n = arguments[i];
                        for (var r in n)
                          Object.prototype.hasOwnProperty.call(n, r) &&
                            (t[r] = n[r]);
                      }
                      return t;
                    }),
                o.apply(this, arguments)
              );
            }
            function h(t, i) {
              (t.prototype = Object.create(i.prototype)),
                (t.prototype.constructor = t),
                f(t, i);
            }
            function u(t) {
              return (
                (u = Object.setPrototypeOf
                  ? Object.getPrototypeOf.bind()
                  : function (t) {
                      return t.__proto__ || Object.getPrototypeOf(t);
                    }),
                u(t)
              );
            }
            function f(t, i) {
              return (
                (f = Object.setPrototypeOf
                  ? Object.setPrototypeOf.bind()
                  : function (t, i) {
                      return (t.__proto__ = i), t;
                    }),
                f(t, i)
              );
            }
            function l(t, i, n) {
              return (
                (l = (function () {
                  if ("undefined" == typeof Reflect || !Reflect.construct)
                    return !1;
                  if (Reflect.construct.sham) return !1;
                  if ("function" == typeof Proxy) return !0;
                  try {
                    return (
                      Boolean.prototype.valueOf.call(
                        Reflect.construct(Boolean, [], function () {})
                      ),
                      !0
                    );
                  } catch (t) {
                    return !1;
                  }
                })()
                  ? Reflect.construct.bind()
                  : function (t, i, n) {
                      var r = [null];
                      r.push.apply(r, i);
                      var e = new (Function.bind.apply(t, r))();
                      return n && f(e, n.prototype), e;
                    }),
                l.apply(null, arguments)
              );
            }
            function c(t) {
              var i = "function" == typeof Map ? new Map() : void 0;
              return (
                (c = function (t) {
                  if (
                    null === t ||
                    ((n = t),
                    -1 === Function.toString.call(n).indexOf("[native code]"))
                  )
                    return t;
                  var n;
                  if ("function" != typeof t)
                    throw new TypeError(
                      "Super expression must either be null or a function"
                    );
                  if (void 0 !== i) {
                    if (i.has(t)) return i.get(t);
                    i.set(t, r);
                  }
                  function r() {
                    return l(t, arguments, u(this).constructor);
                  }
                  return (
                    (r.prototype = Object.create(t.prototype, {
                      constructor: {
                        value: r,
                        enumerable: !1,
                        writable: !0,
                        configurable: !0,
                      },
                    })),
                    f(r, t)
                  );
                }),
                c(t)
              );
            }
            function v(t, i) {
              (null == i || i > t.length) && (i = t.length);
              for (var n = 0, r = new Array(i); n < i; n++) r[n] = t[n];
              return r;
            }
            function d(t, i) {
              var n =
                ("undefined" != typeof Symbol && t[Symbol.iterator]) ||
                t["@@iterator"];
              if (n) return (n = n.call(t)).next.bind(n);
              if (
                Array.isArray(t) ||
                (n = (function (t, i) {
                  if (t) {
                    if ("string" == typeof t) return v(t, i);
                    var n = Object.prototype.toString.call(t).slice(8, -1);
                    return (
                      "Object" === n &&
                        t.constructor &&
                        (n = t.constructor.name),
                      "Map" === n || "Set" === n
                        ? Array.from(t)
                        : "Arguments" === n ||
                          /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)
                        ? v(t, i)
                        : void 0
                    );
                  }
                })(t)) ||
                (i && t && "number" == typeof t.length)
              ) {
                n && (t = n);
                var r = 0;
                return function () {
                  return r >= t.length
                    ? { done: !0 }
                    : { done: !1, value: t[r++] };
                };
              }
              throw new TypeError(
                "Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."
              );
            }
            function p(t) {
              var i = (function (t, i) {
                if ("object" != typeof t || null === t) return t;
                var n = t[Symbol.toPrimitive];
                if (void 0 !== n) {
                  var r = n.call(t, "string");
                  if ("object" != typeof r) return r;
                  throw new TypeError(
                    "@@toPrimitive must return a primitive value."
                  );
                }
                return String(t);
              })(t);
              return "symbol" == typeof i ? i : String(i);
            }
            var m = { exports: {} };
            !(function (t, i) {
              var n, r, e, s, a;
              (n =
                /^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/),
                (r = /^(?=([^\/?#]*))\1([^]*)$/),
                (e = /(?:\/|^)\.(?=\/)/g),
                (s = /(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g),
                (a = {
                  buildAbsoluteURL: function (t, i, n) {
                    if (((n = n || {}), (t = t.trim()), !(i = i.trim()))) {
                      if (!n.alwaysNormalize) return t;
                      var e = a.parseURL(t);
                      if (!e)
                        throw new Error("Error trying to parse base URL.");
                      return (
                        (e.path = a.normalizePath(e.path)),
                        a.buildURLFromParts(e)
                      );
                    }
                    var s = a.parseURL(i);
                    if (!s)
                      throw new Error("Error trying to parse relative URL.");
                    if (s.scheme)
                      return n.alwaysNormalize
                        ? ((s.path = a.normalizePath(s.path)),
                          a.buildURLFromParts(s))
                        : i;
                    var o = a.parseURL(t);
                    if (!o) throw new Error("Error trying to parse base URL.");
                    if (!o.netLoc && o.path && "/" !== o.path[0]) {
                      var h = r.exec(o.path);
                      (o.netLoc = h[1]), (o.path = h[2]);
                    }
                    o.netLoc && !o.path && (o.path = "/");
                    var u = {
                      scheme: o.scheme,
                      netLoc: s.netLoc,
                      path: null,
                      params: s.params,
                      query: s.query,
                      fragment: s.fragment,
                    };
                    if (!s.netLoc && ((u.netLoc = o.netLoc), "/" !== s.path[0]))
                      if (s.path) {
                        var f = o.path,
                          l = f.substring(0, f.lastIndexOf("/") + 1) + s.path;
                        u.path = a.normalizePath(l);
                      } else
                        (u.path = o.path),
                          s.params ||
                            ((u.params = o.params),
                            s.query || (u.query = o.query));
                    return (
                      null === u.path &&
                        (u.path = n.alwaysNormalize
                          ? a.normalizePath(s.path)
                          : s.path),
                      a.buildURLFromParts(u)
                    );
                  },
                  parseURL: function (t) {
                    var i = n.exec(t);
                    return i
                      ? {
                          scheme: i[1] || "",
                          netLoc: i[2] || "",
                          path: i[3] || "",
                          params: i[4] || "",
                          query: i[5] || "",
                          fragment: i[6] || "",
                        }
                      : null;
                  },
                  normalizePath: function (t) {
                    for (
                      t = t.split("").reverse().join("").replace(e, "");
                      t.length !== (t = t.replace(s, "")).length;

                    );
                    return t.split("").reverse().join("");
                  },
                  buildURLFromParts: function (t) {
                    return (
                      t.scheme +
                      t.netLoc +
                      t.path +
                      t.params +
                      t.query +
                      t.fragment
                    );
                  },
                }),
                (t.exports = a);
            })(m);
            var y = m.exports,
              g =
                Number.isFinite ||
                function (t) {
                  return "number" == typeof t && isFinite(t);
                },
              w = (function (t) {
                return (
                  (t.MEDIA_ATTACHING = "hlsMediaAttaching"),
                  (t.MEDIA_ATTACHED = "hlsMediaAttached"),
                  (t.MEDIA_DETACHING = "hlsMediaDetaching"),
                  (t.MEDIA_DETACHED = "hlsMediaDetached"),
                  (t.BUFFER_RESET = "hlsBufferReset"),
                  (t.BUFFER_CODECS = "hlsBufferCodecs"),
                  (t.BUFFER_CREATED = "hlsBufferCreated"),
                  (t.BUFFER_APPENDING = "hlsBufferAppending"),
                  (t.BUFFER_APPENDED = "hlsBufferAppended"),
                  (t.BUFFER_EOS = "hlsBufferEos"),
                  (t.BUFFER_FLUSHING = "hlsBufferFlushing"),
                  (t.BUFFER_FLUSHED = "hlsBufferFlushed"),
                  (t.MANIFEST_LOADING = "hlsManifestLoading"),
                  (t.MANIFEST_LOADED = "hlsManifestLoaded"),
                  (t.MANIFEST_PARSED = "hlsManifestParsed"),
                  (t.LEVEL_SWITCHING = "hlsLevelSwitching"),
                  (t.LEVEL_SWITCHED = "hlsLevelSwitched"),
                  (t.LEVEL_LOADING = "hlsLevelLoading"),
                  (t.LEVEL_LOADED = "hlsLevelLoaded"),
                  (t.LEVEL_UPDATED = "hlsLevelUpdated"),
                  (t.LEVEL_PTS_UPDATED = "hlsLevelPtsUpdated"),
                  (t.LEVELS_UPDATED = "hlsLevelsUpdated"),
                  (t.AUDIO_TRACKS_UPDATED = "hlsAudioTracksUpdated"),
                  (t.AUDIO_TRACK_SWITCHING = "hlsAudioTrackSwitching"),
                  (t.AUDIO_TRACK_SWITCHED = "hlsAudioTrackSwitched"),
                  (t.AUDIO_TRACK_LOADING = "hlsAudioTrackLoading"),
                  (t.AUDIO_TRACK_LOADED = "hlsAudioTrackLoaded"),
                  (t.SUBTITLE_TRACKS_UPDATED = "hlsSubtitleTracksUpdated"),
                  (t.SUBTITLE_TRACKS_CLEARED = "hlsSubtitleTracksCleared"),
                  (t.SUBTITLE_TRACK_SWITCH = "hlsSubtitleTrackSwitch"),
                  (t.SUBTITLE_TRACK_LOADING = "hlsSubtitleTrackLoading"),
                  (t.SUBTITLE_TRACK_LOADED = "hlsSubtitleTrackLoaded"),
                  (t.SUBTITLE_FRAG_PROCESSED = "hlsSubtitleFragProcessed"),
                  (t.CUES_PARSED = "hlsCuesParsed"),
                  (t.NON_NATIVE_TEXT_TRACKS_FOUND =
                    "hlsNonNativeTextTracksFound"),
                  (t.INIT_PTS_FOUND = "hlsInitPtsFound"),
                  (t.FRAG_LOADING = "hlsFragLoading"),
                  (t.FRAG_LOAD_EMERGENCY_ABORTED =
                    "hlsFragLoadEmergencyAborted"),
                  (t.FRAG_LOADED = "hlsFragLoaded"),
                  (t.FRAG_DECRYPTED = "hlsFragDecrypted"),
                  (t.FRAG_PARSING_INIT_SEGMENT = "hlsFragParsingInitSegment"),
                  (t.FRAG_PARSING_USERDATA = "hlsFragParsingUserdata"),
                  (t.FRAG_PARSING_METADATA = "hlsFragParsingMetadata"),
                  (t.FRAG_PARSED = "hlsFragParsed"),
                  (t.FRAG_BUFFERED = "hlsFragBuffered"),
                  (t.FRAG_CHANGED = "hlsFragChanged"),
                  (t.FPS_DROP = "hlsFpsDrop"),
                  (t.FPS_DROP_LEVEL_CAPPING = "hlsFpsDropLevelCapping"),
                  (t.ERROR = "hlsError"),
                  (t.DESTROYING = "hlsDestroying"),
                  (t.KEY_LOADING = "hlsKeyLoading"),
                  (t.KEY_LOADED = "hlsKeyLoaded"),
                  (t.LIVE_BACK_BUFFER_REACHED = "hlsLiveBackBufferReached"),
                  (t.BACK_BUFFER_REACHED = "hlsBackBufferReached"),
                  t
                );
              })({}),
              b = (function (t) {
                return (
                  (t.NETWORK_ERROR = "networkError"),
                  (t.MEDIA_ERROR = "mediaError"),
                  (t.KEY_SYSTEM_ERROR = "keySystemError"),
                  (t.MUX_ERROR = "muxError"),
                  (t.OTHER_ERROR = "otherError"),
                  t
                );
              })({}),
              k = (function (t) {
                return (
                  (t.KEY_SYSTEM_NO_KEYS = "keySystemNoKeys"),
                  (t.KEY_SYSTEM_NO_ACCESS = "keySystemNoAccess"),
                  (t.KEY_SYSTEM_NO_SESSION = "keySystemNoSession"),
                  (t.KEY_SYSTEM_NO_CONFIGURED_LICENSE =
                    "keySystemNoConfiguredLicense"),
                  (t.KEY_SYSTEM_LICENSE_REQUEST_FAILED =
                    "keySystemLicenseRequestFailed"),
                  (t.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED =
                    "keySystemServerCertificateRequestFailed"),
                  (t.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED =
                    "keySystemServerCertificateUpdateFailed"),
                  (t.KEY_SYSTEM_SESSION_UPDATE_FAILED =
                    "keySystemSessionUpdateFailed"),
                  (t.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED =
                    "keySystemStatusOutputRestricted"),
                  (t.KEY_SYSTEM_STATUS_INTERNAL_ERROR =
                    "keySystemStatusInternalError"),
                  (t.MANIFEST_LOAD_ERROR = "manifestLoadError"),
                  (t.MANIFEST_LOAD_TIMEOUT = "manifestLoadTimeOut"),
                  (t.MANIFEST_PARSING_ERROR = "manifestParsingError"),
                  (t.MANIFEST_INCOMPATIBLE_CODECS_ERROR =
                    "manifestIncompatibleCodecsError"),
                  (t.LEVEL_EMPTY_ERROR = "levelEmptyError"),
                  (t.LEVEL_LOAD_ERROR = "levelLoadError"),
                  (t.LEVEL_LOAD_TIMEOUT = "levelLoadTimeOut"),
                  (t.LEVEL_PARSING_ERROR = "levelParsingError"),
                  (t.LEVEL_SWITCH_ERROR = "levelSwitchError"),
                  (t.AUDIO_TRACK_LOAD_ERROR = "audioTrackLoadError"),
                  (t.AUDIO_TRACK_LOAD_TIMEOUT = "audioTrackLoadTimeOut"),
                  (t.SUBTITLE_LOAD_ERROR = "subtitleTrackLoadError"),
                  (t.SUBTITLE_TRACK_LOAD_TIMEOUT = "subtitleTrackLoadTimeOut"),
                  (t.FRAG_LOAD_ERROR = "fragLoadError"),
                  (t.FRAG_LOAD_TIMEOUT = "fragLoadTimeOut"),
                  (t.FRAG_DECRYPT_ERROR = "fragDecryptError"),
                  (t.FRAG_PARSING_ERROR = "fragParsingError"),
                  (t.FRAG_GAP = "fragGap"),
                  (t.REMUX_ALLOC_ERROR = "remuxAllocError"),
                  (t.KEY_LOAD_ERROR = "keyLoadError"),
                  (t.KEY_LOAD_TIMEOUT = "keyLoadTimeOut"),
                  (t.BUFFER_ADD_CODEC_ERROR = "bufferAddCodecError"),
                  (t.BUFFER_INCOMPATIBLE_CODECS_ERROR =
                    "bufferIncompatibleCodecsError"),
                  (t.BUFFER_APPEND_ERROR = "bufferAppendError"),
                  (t.BUFFER_APPENDING_ERROR = "bufferAppendingError"),
                  (t.BUFFER_STALLED_ERROR = "bufferStalledError"),
                  (t.BUFFER_FULL_ERROR = "bufferFullError"),
                  (t.BUFFER_SEEK_OVER_HOLE = "bufferSeekOverHole"),
                  (t.BUFFER_NUDGE_ON_STALL = "bufferNudgeOnStall"),
                  (t.INTERNAL_EXCEPTION = "internalException"),
                  (t.INTERNAL_ABORTED = "aborted"),
                  (t.UNKNOWN = "unknown"),
                  t
                );
              })({}),
              E = function () {},
              T = { trace: E, debug: E, log: E, warn: E, info: E, error: E },
              x = T;
            function S(t, i) {
              if ((self.console && !0 === t) || "object" == typeof t) {
                !(function (t) {
                  for (
                    var i = arguments.length,
                      n = new Array(i > 1 ? i - 1 : 0),
                      r = 1;
                    r < i;
                    r++
                  )
                    n[r - 1] = arguments[r];
                  n.forEach(function (i) {
                    x[i] = t[i]
                      ? t[i].bind(t)
                      : (function (t) {
                          var i = self.console[t];
                          return i ? i.bind(self.console, "[" + t + "] >") : E;
                        })(i);
                  });
                })(t, "debug", "log", "info", "warn", "error");
                try {
                  x.log(
                    'Debug logs enabled for "' + i + '" in hls.js version 1.4.5'
                  );
                } catch (t) {
                  x = T;
                }
              } else x = T;
            }
            var A = x,
              M = /^(\d+)x(\d+)$/,
              D = /(.+?)=(".*?"|.*?)(?:,|$)/g,
              _ = (function () {
                function t(i) {
                  for (var n in ("string" == typeof i &&
                    (i = t.parseAttrList(i)),
                  i))
                    i.hasOwnProperty(n) &&
                      ("X-" === n.substring(0, 2) &&
                        ((this.clientAttrs = this.clientAttrs || []),
                        this.clientAttrs.push(n)),
                      (this[n] = i[n]));
                }
                var i = t.prototype;
                return (
                  (i.decimalInteger = function (t) {
                    var i = parseInt(this[t], 10);
                    return i > Number.MAX_SAFE_INTEGER ? 1 / 0 : i;
                  }),
                  (i.hexadecimalInteger = function (t) {
                    if (this[t]) {
                      var i = (this[t] || "0x").slice(2);
                      i = (1 & i.length ? "0" : "") + i;
                      for (
                        var n = new Uint8Array(i.length / 2), r = 0;
                        r < i.length / 2;
                        r++
                      )
                        n[r] = parseInt(i.slice(2 * r, 2 * r + 2), 16);
                      return n;
                    }
                    return null;
                  }),
                  (i.hexadecimalIntegerAsNumber = function (t) {
                    var i = parseInt(this[t], 16);
                    return i > Number.MAX_SAFE_INTEGER ? 1 / 0 : i;
                  }),
                  (i.decimalFloatingPoint = function (t) {
                    return parseFloat(this[t]);
                  }),
                  (i.optionalFloat = function (t, i) {
                    var n = this[t];
                    return n ? parseFloat(n) : i;
                  }),
                  (i.enumeratedString = function (t) {
                    return this[t];
                  }),
                  (i.bool = function (t) {
                    return "YES" === this[t];
                  }),
                  (i.decimalResolution = function (t) {
                    var i = M.exec(this[t]);
                    if (null !== i)
                      return {
                        width: parseInt(i[1], 10),
                        height: parseInt(i[2], 10),
                      };
                  }),
                  (t.parseAttrList = function (t) {
                    var i,
                      n = {};
                    for (D.lastIndex = 0; null !== (i = D.exec(t)); ) {
                      var r = i[2];
                      0 === r.indexOf('"') &&
                        r.lastIndexOf('"') === r.length - 1 &&
                        (r = r.slice(1, -1)),
                        (n[i[1].trim()] = r);
                    }
                    return n;
                  }),
                  t
                );
              })();
            function O(t) {
              return "SCTE35-OUT" === t || "SCTE35-IN" === t;
            }
            var R = (function () {
                function t(t, i) {
                  if (
                    ((this.attr = void 0),
                    (this.t = void 0),
                    (this.i = void 0),
                    (this.h = void 0),
                    i)
                  ) {
                    var n = i.attr;
                    for (var r in n)
                      if (
                        Object.prototype.hasOwnProperty.call(t, r) &&
                        t[r] !== n[r]
                      ) {
                        A.warn(
                          'DATERANGE tag attribute: "' +
                            r +
                            '" does not match for tags with ID: "' +
                            t.ID +
                            '"'
                        ),
                          (this.h = r);
                        break;
                      }
                    t = o(new _({}), n, t);
                  }
                  if (
                    ((this.attr = t),
                    (this.t = new Date(t["START-DATE"])),
                    "END-DATE" in this.attr)
                  ) {
                    var e = new Date(this.attr["END-DATE"]);
                    g(e.getTime()) && (this.i = e);
                  }
                }
                return (
                  s(t, [
                    {
                      key: "id",
                      get: function () {
                        return this.attr.ID;
                      },
                    },
                    {
                      key: "class",
                      get: function () {
                        return this.attr.CLASS;
                      },
                    },
                    {
                      key: "startDate",
                      get: function () {
                        return this.t;
                      },
                    },
                    {
                      key: "endDate",
                      get: function () {
                        if (this.i) return this.i;
                        var t = this.duration;
                        return null !== t
                          ? new Date(this.t.getTime() + 1e3 * t)
                          : null;
                      },
                    },
                    {
                      key: "duration",
                      get: function () {
                        if ("DURATION" in this.attr) {
                          var t = this.attr.decimalFloatingPoint("DURATION");
                          if (g(t)) return t;
                        } else if (this.i)
                          return (this.i.getTime() - this.t.getTime()) / 1e3;
                        return null;
                      },
                    },
                    {
                      key: "plannedDuration",
                      get: function () {
                        return "PLANNED-DURATION" in this.attr
                          ? this.attr.decimalFloatingPoint("PLANNED-DURATION")
                          : null;
                      },
                    },
                    {
                      key: "endOnNext",
                      get: function () {
                        return this.attr.bool("END-ON-NEXT");
                      },
                    },
                    {
                      key: "isValid",
                      get: function () {
                        return (
                          !!this.id &&
                          !this.h &&
                          g(this.startDate.getTime()) &&
                          (null === this.duration || this.duration >= 0) &&
                          (!this.endOnNext || !!this.class)
                        );
                      },
                    },
                  ]),
                  t
                );
              })(),
              L = function () {
                (this.aborted = !1),
                  (this.loaded = 0),
                  (this.retry = 0),
                  (this.total = 0),
                  (this.chunkCount = 0),
                  (this.bwEstimate = 0),
                  (this.loading = { start: 0, first: 0, end: 0 }),
                  (this.parsing = { start: 0, end: 0 }),
                  (this.buffering = { start: 0, first: 0, end: 0 });
              },
              I = "audio",
              P = "video",
              C = "audiovideo",
              N = (function () {
                function t(t) {
                  var i;
                  (this.u = null),
                    (this.l = null),
                    (this.baseurl = void 0),
                    (this.relurl = void 0),
                    (this.elementaryStreams =
                      (((i = {})[I] = null), (i[P] = null), (i[C] = null), i)),
                    (this.baseurl = t);
                }
                return (
                  (t.prototype.setByteRange = function (t, i) {
                    var n = t.split("@", 2),
                      r = [];
                    1 === n.length
                      ? (r[0] = i ? i.byteRangeEndOffset : 0)
                      : (r[0] = parseInt(n[1])),
                      (r[1] = parseInt(n[0]) + r[0]),
                      (this.u = r);
                  }),
                  s(t, [
                    {
                      key: "byteRange",
                      get: function () {
                        return this.u ? this.u : [];
                      },
                    },
                    {
                      key: "byteRangeStartOffset",
                      get: function () {
                        return this.byteRange[0];
                      },
                    },
                    {
                      key: "byteRangeEndOffset",
                      get: function () {
                        return this.byteRange[1];
                      },
                    },
                    {
                      key: "url",
                      get: function () {
                        return (
                          !this.l &&
                            this.baseurl &&
                            this.relurl &&
                            (this.l = y.buildAbsoluteURL(
                              this.baseurl,
                              this.relurl,
                              { alwaysNormalize: !0 }
                            )),
                          this.l || ""
                        );
                      },
                      set: function (t) {
                        this.l = t;
                      },
                    },
                  ]),
                  t
                );
              })(),
              U = (function (t) {
                function i(i, n) {
                  var r;
                  return (
                    ((r = t.call(this, n) || this).p = null),
                    (r.rawProgramDateTime = null),
                    (r.programDateTime = null),
                    (r.tagList = []),
                    (r.duration = 0),
                    (r.sn = 0),
                    (r.levelkeys = void 0),
                    (r.type = void 0),
                    (r.loader = null),
                    (r.keyLoader = null),
                    (r.level = -1),
                    (r.cc = 0),
                    (r.startPTS = void 0),
                    (r.endPTS = void 0),
                    (r.startDTS = void 0),
                    (r.endDTS = void 0),
                    (r.start = 0),
                    (r.deltaPTS = void 0),
                    (r.maxStartPTS = void 0),
                    (r.minEndPTS = void 0),
                    (r.stats = new L()),
                    (r.urlId = 0),
                    (r.data = void 0),
                    (r.bitrateTest = !1),
                    (r.title = null),
                    (r.initSegment = null),
                    (r.endList = void 0),
                    (r.gap = void 0),
                    (r.type = i),
                    r
                  );
                }
                h(i, t);
                var n = i.prototype;
                return (
                  (n.setKeyFormat = function (t) {
                    if (this.levelkeys) {
                      var i = this.levelkeys[t];
                      i && !this.p && (this.p = i.getDecryptData(this.sn));
                    }
                  }),
                  (n.abortRequests = function () {
                    var t, i;
                    null == (t = this.loader) || t.abort(),
                      null == (i = this.keyLoader) || i.abort();
                  }),
                  (n.setElementaryStreamInfo = function (t, i, n, r, e, s) {
                    void 0 === s && (s = !1);
                    var a = this.elementaryStreams,
                      o = a[t];
                    o
                      ? ((o.startPTS = Math.min(o.startPTS, i)),
                        (o.endPTS = Math.max(o.endPTS, n)),
                        (o.startDTS = Math.min(o.startDTS, r)),
                        (o.endDTS = Math.max(o.endDTS, e)))
                      : (a[t] = {
                          startPTS: i,
                          endPTS: n,
                          startDTS: r,
                          endDTS: e,
                          partial: s,
                        });
                  }),
                  (n.clearElementaryStreamInfo = function () {
                    var t = this.elementaryStreams;
                    (t[I] = null), (t[P] = null), (t[C] = null);
                  }),
                  s(i, [
                    {
                      key: "decryptdata",
                      get: function () {
                        if (!this.levelkeys && !this.p) return null;
                        if (!this.p && this.levelkeys && !this.levelkeys.NONE) {
                          var t = this.levelkeys.identity;
                          if (t) this.p = t.getDecryptData(this.sn);
                          else {
                            var i = Object.keys(this.levelkeys);
                            if (1 === i.length)
                              return (this.p = this.levelkeys[
                                i[0]
                              ].getDecryptData(this.sn));
                          }
                        }
                        return this.p;
                      },
                    },
                    {
                      key: "end",
                      get: function () {
                        return this.start + this.duration;
                      },
                    },
                    {
                      key: "endProgramDateTime",
                      get: function () {
                        if (null === this.programDateTime) return null;
                        if (!g(this.programDateTime)) return null;
                        var t = g(this.duration) ? this.duration : 0;
                        return this.programDateTime + 1e3 * t;
                      },
                    },
                    {
                      key: "encrypted",
                      get: function () {
                        var t;
                        if (null != (t = this.p) && t.encrypted) return !0;
                        if (this.levelkeys) {
                          var i = Object.keys(this.levelkeys),
                            n = i.length;
                          if (
                            n > 1 ||
                            (1 === n && this.levelkeys[i[0]].encrypted)
                          )
                            return !0;
                        }
                        return !1;
                      },
                    },
                  ]),
                  i
                );
              })(N),
              F = (function (t) {
                function i(i, n, r, e, s) {
                  var a;
                  ((a = t.call(this, r) || this).fragOffset = 0),
                    (a.duration = 0),
                    (a.gap = !1),
                    (a.independent = !1),
                    (a.relurl = void 0),
                    (a.fragment = void 0),
                    (a.index = void 0),
                    (a.stats = new L()),
                    (a.duration = i.decimalFloatingPoint("DURATION")),
                    (a.gap = i.bool("GAP")),
                    (a.independent = i.bool("INDEPENDENT")),
                    (a.relurl = i.enumeratedString("URI")),
                    (a.fragment = n),
                    (a.index = e);
                  var o = i.enumeratedString("BYTERANGE");
                  return (
                    o && a.setByteRange(o, s),
                    s && (a.fragOffset = s.fragOffset + s.duration),
                    a
                  );
                }
                return (
                  h(i, t),
                  s(i, [
                    {
                      key: "start",
                      get: function () {
                        return this.fragment.start + this.fragOffset;
                      },
                    },
                    {
                      key: "end",
                      get: function () {
                        return this.start + this.duration;
                      },
                    },
                    {
                      key: "loaded",
                      get: function () {
                        var t = this.elementaryStreams;
                        return !!(t.audio || t.video || t.audiovideo);
                      },
                    },
                  ]),
                  i
                );
              })(N),
              j = (function () {
                function t(t) {
                  (this.PTSKnown = !1),
                    (this.alignedSliding = !1),
                    (this.averagetargetduration = void 0),
                    (this.endCC = 0),
                    (this.endSN = 0),
                    (this.fragments = void 0),
                    (this.fragmentHint = void 0),
                    (this.partList = null),
                    (this.dateRanges = void 0),
                    (this.live = !0),
                    (this.ageHeader = 0),
                    (this.advancedDateTime = void 0),
                    (this.updated = !0),
                    (this.advanced = !0),
                    (this.availabilityDelay = void 0),
                    (this.misses = 0),
                    (this.startCC = 0),
                    (this.startSN = 0),
                    (this.startTimeOffset = null),
                    (this.targetduration = 0),
                    (this.totalduration = 0),
                    (this.type = null),
                    (this.url = void 0),
                    (this.m3u8 = ""),
                    (this.version = null),
                    (this.canBlockReload = !1),
                    (this.canSkipUntil = 0),
                    (this.canSkipDateRanges = !1),
                    (this.skippedSegments = 0),
                    (this.recentlyRemovedDateranges = void 0),
                    (this.partHoldBack = 0),
                    (this.holdBack = 0),
                    (this.partTarget = 0),
                    (this.preloadHint = void 0),
                    (this.renditionReports = void 0),
                    (this.tuneInGoal = 0),
                    (this.deltaUpdateFailed = void 0),
                    (this.driftStartTime = 0),
                    (this.driftEndTime = 0),
                    (this.driftStart = 0),
                    (this.driftEnd = 0),
                    (this.encryptedFragments = void 0),
                    (this.playlistParsingError = null),
                    (this.variableList = null),
                    (this.hasVariableRefs = !1),
                    (this.fragments = []),
                    (this.encryptedFragments = []),
                    (this.dateRanges = {}),
                    (this.url = t);
                }
                return (
                  (t.prototype.reloaded = function (t) {
                    if (!t)
                      return (this.advanced = !0), void (this.updated = !0);
                    var i = this.lastPartSn - t.lastPartSn,
                      n = this.lastPartIndex - t.lastPartIndex;
                    (this.updated = this.endSN !== t.endSN || !!n || !!i),
                      (this.advanced =
                        this.endSN > t.endSN || i > 0 || (0 === i && n > 0)),
                      this.updated || this.advanced
                        ? (this.misses = Math.floor(0.6 * t.misses))
                        : (this.misses = t.misses + 1),
                      (this.availabilityDelay = t.availabilityDelay);
                  }),
                  s(t, [
                    {
                      key: "hasProgramDateTime",
                      get: function () {
                        return (
                          !!this.fragments.length &&
                          g(
                            this.fragments[this.fragments.length - 1]
                              .programDateTime
                          )
                        );
                      },
                    },
                    {
                      key: "levelTargetDuration",
                      get: function () {
                        return (
                          this.averagetargetduration ||
                          this.targetduration ||
                          10
                        );
                      },
                    },
                    {
                      key: "drift",
                      get: function () {
                        var t = this.driftEndTime - this.driftStartTime;
                        return t > 0
                          ? (1e3 * (this.driftEnd - this.driftStart)) / t
                          : 1;
                      },
                    },
                    {
                      key: "edge",
                      get: function () {
                        return this.partEnd || this.fragmentEnd;
                      },
                    },
                    {
                      key: "partEnd",
                      get: function () {
                        var t;
                        return null != (t = this.partList) && t.length
                          ? this.partList[this.partList.length - 1].end
                          : this.fragmentEnd;
                      },
                    },
                    {
                      key: "fragmentEnd",
                      get: function () {
                        var t;
                        return null != (t = this.fragments) && t.length
                          ? this.fragments[this.fragments.length - 1].end
                          : 0;
                      },
                    },
                    {
                      key: "age",
                      get: function () {
                        return this.advancedDateTime
                          ? Math.max(Date.now() - this.advancedDateTime, 0) /
                              1e3
                          : 0;
                      },
                    },
                    {
                      key: "lastPartIndex",
                      get: function () {
                        var t;
                        return null != (t = this.partList) && t.length
                          ? this.partList[this.partList.length - 1].index
                          : -1;
                      },
                    },
                    {
                      key: "lastPartSn",
                      get: function () {
                        var t;
                        return null != (t = this.partList) && t.length
                          ? this.partList[this.partList.length - 1].fragment.sn
                          : this.endSN;
                      },
                    },
                  ]),
                  t
                );
              })();
            function B(t) {
              return Uint8Array.from(atob(t), function (t) {
                return t.charCodeAt(0);
              });
            }
            function X(t) {
              return Uint8Array.from(
                unescape(encodeURIComponent(t)),
                function (t) {
                  return t.charCodeAt(0);
                }
              );
            }
            var Y = {
                CLEARKEY: "org.w3.clearkey",
                FAIRPLAY: "com.apple.fps",
                PLAYREADY: "com.microsoft.playready",
                WIDEVINE: "com.widevine.alpha",
              },
              $ = "org.w3.clearkey",
              H = "com.apple.streamingkeydelivery",
              V = "com.microsoft.playready",
              G = "urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";
            function W(t) {
              switch (t) {
                case H:
                  return Y.FAIRPLAY;
                case V:
                  return Y.PLAYREADY;
                case G:
                  return Y.WIDEVINE;
                case $:
                  return Y.CLEARKEY;
              }
            }
            var K = "edef8ba979d64acea3c827dcd51d21ed";
            function z(t) {
              switch (t) {
                case Y.FAIRPLAY:
                  return H;
                case Y.PLAYREADY:
                  return V;
                case Y.WIDEVINE:
                  return G;
                case Y.CLEARKEY:
                  return $;
              }
            }
            function q(t) {
              var i = t.drmSystems,
                n = t.widevineLicenseUrl,
                r = i
                  ? [Y.FAIRPLAY, Y.WIDEVINE, Y.PLAYREADY, Y.CLEARKEY].filter(
                      function (t) {
                        return !!i[t];
                      }
                    )
                  : [];
              return !r[Y.WIDEVINE] && n && r.push(Y.WIDEVINE), r;
            }
            var J =
              "undefined" != typeof self &&
              self.navigator &&
              self.navigator.requestMediaKeySystemAccess
                ? self.navigator.requestMediaKeySystemAccess.bind(
                    self.navigator
                  )
                : null;
            function Q(t, i, n) {
              return Uint8Array.prototype.slice
                ? t.slice(i, n)
                : new Uint8Array(Array.prototype.slice.call(t, i, n));
            }
            var Z,
              tt = function (t, i) {
                return (
                  i + 10 <= t.length &&
                  73 === t[i] &&
                  68 === t[i + 1] &&
                  51 === t[i + 2] &&
                  t[i + 3] < 255 &&
                  t[i + 4] < 255 &&
                  t[i + 6] < 128 &&
                  t[i + 7] < 128 &&
                  t[i + 8] < 128 &&
                  t[i + 9] < 128
                );
              },
              it = function (t, i) {
                return (
                  i + 10 <= t.length &&
                  51 === t[i] &&
                  68 === t[i + 1] &&
                  73 === t[i + 2] &&
                  t[i + 3] < 255 &&
                  t[i + 4] < 255 &&
                  t[i + 6] < 128 &&
                  t[i + 7] < 128 &&
                  t[i + 8] < 128 &&
                  t[i + 9] < 128
                );
              },
              nt = function (t, i) {
                for (var n = i, r = 0; tt(t, i); )
                  (r += 10),
                    (r += rt(t, i + 6)),
                    it(t, i + 10) && (r += 10),
                    (i += r);
                if (r > 0) return t.subarray(n, n + r);
              },
              rt = function (t, i) {
                var n = 0;
                return (
                  (n = (127 & t[i]) << 21),
                  (n |= (127 & t[i + 1]) << 14),
                  (n |= (127 & t[i + 2]) << 7) | (127 & t[i + 3])
                );
              },
              et = function (t, i) {
                return tt(t, i) && rt(t, i + 6) + 10 <= t.length - i;
              },
              st = function (t) {
                return (
                  t &&
                  "PRIV" === t.key &&
                  "com.apple.streaming.transportStreamTimestamp" === t.info
                );
              },
              at = function (t) {
                var i = String.fromCharCode(t[0], t[1], t[2], t[3]),
                  n = rt(t, 4);
                return { type: i, size: n, data: t.subarray(10, 10 + n) };
              },
              ot = function (t) {
                for (var i = 0, n = []; tt(t, i); ) {
                  for (var r = rt(t, i + 6), e = (i += 10) + r; i + 8 < e; ) {
                    var s = at(t.subarray(i)),
                      a = ht(s);
                    a && n.push(a), (i += s.size + 10);
                  }
                  it(t, i) && (i += 10);
                }
                return n;
              },
              ht = function (t) {
                return "PRIV" === t.type
                  ? ut(t)
                  : "W" === t.type[0]
                  ? lt(t)
                  : ft(t);
              },
              ut = function (t) {
                if (!(t.size < 2)) {
                  var i = vt(t.data, !0),
                    n = new Uint8Array(t.data.subarray(i.length + 1));
                  return { key: t.type, info: i, data: n.buffer };
                }
              },
              ft = function (t) {
                if (!(t.size < 2)) {
                  if ("TXXX" === t.type) {
                    var i = 1,
                      n = vt(t.data.subarray(i), !0);
                    i += n.length + 1;
                    var r = vt(t.data.subarray(i));
                    return { key: t.type, info: n, data: r };
                  }
                  var e = vt(t.data.subarray(1));
                  return { key: t.type, data: e };
                }
              },
              lt = function (t) {
                if ("WXXX" === t.type) {
                  if (t.size < 2) return;
                  var i = 1,
                    n = vt(t.data.subarray(i), !0);
                  i += n.length + 1;
                  var r = vt(t.data.subarray(i));
                  return { key: t.type, info: n, data: r };
                }
                var e = vt(t.data);
                return { key: t.type, data: e };
              },
              ct = function (t) {
                if (8 === t.data.byteLength) {
                  var i = new Uint8Array(t.data),
                    n = 1 & i[3],
                    r = (i[4] << 23) + (i[5] << 15) + (i[6] << 7) + i[7];
                  return (r /= 45), n && (r += 47721858.84), Math.round(r);
                }
              },
              vt = function (t, i) {
                void 0 === i && (i = !1);
                var n =
                  (Z ||
                    void 0 === self.TextDecoder ||
                    (Z = new self.TextDecoder("utf-8")),
                  Z);
                if (n) {
                  var r = n.decode(t);
                  if (i) {
                    var e = r.indexOf("\0");
                    return -1 !== e ? r.substring(0, e) : r;
                  }
                  return r.replace(/\0/g, "");
                }
                for (var s, a, o, h = t.length, u = "", f = 0; f < h; ) {
                  if (0 === (s = t[f++]) && i) return u;
                  if (0 !== s && 3 !== s)
                    switch (s >> 4) {
                      case 0:
                      case 1:
                      case 2:
                      case 3:
                      case 4:
                      case 5:
                      case 6:
                      case 7:
                        u += String.fromCharCode(s);
                        break;
                      case 12:
                      case 13:
                        (a = t[f++]),
                          (u += String.fromCharCode(
                            ((31 & s) << 6) | (63 & a)
                          ));
                        break;
                      case 14:
                        (a = t[f++]),
                          (o = t[f++]),
                          (u += String.fromCharCode(
                            ((15 & s) << 12) | ((63 & a) << 6) | ((63 & o) << 0)
                          ));
                    }
                }
                return u;
              };
            var dt = function (t) {
                for (var i = "", n = 0; n < t.length; n++) {
                  var r = t[n].toString(16);
                  r.length < 2 && (r = "0" + r), (i += r);
                }
                return i;
              },
              pt = Math.pow(2, 32) - 1,
              mt = [].push,
              yt = { video: 1, audio: 2, id3: 3, text: 4 };
            function gt(t) {
              return String.fromCharCode.apply(null, t);
            }
            function wt(t, i) {
              var n = (t[i] << 8) | t[i + 1];
              return n < 0 ? 65536 + n : n;
            }
            function bt(t, i) {
              var n = kt(t, i);
              return n < 0 ? 4294967296 + n : n;
            }
            function kt(t, i) {
              return (
                (t[i] << 24) | (t[i + 1] << 16) | (t[i + 2] << 8) | t[i + 3]
              );
            }
            function Et(t, i, n) {
              (t[i] = n >> 24),
                (t[i + 1] = (n >> 16) & 255),
                (t[i + 2] = (n >> 8) & 255),
                (t[i + 3] = 255 & n);
            }
            function Tt(t, i) {
              var n = [];
              if (!i.length) return n;
              for (var r = t.byteLength, e = 0; e < r; ) {
                var s = bt(t, e),
                  a = s > 1 ? e + s : r;
                if (gt(t.subarray(e + 4, e + 8)) === i[0])
                  if (1 === i.length) n.push(t.subarray(e + 8, a));
                  else {
                    var o = Tt(t.subarray(e + 8, a), i.slice(1));
                    o.length && mt.apply(n, o);
                  }
                e = a;
              }
              return n;
            }
            function xt(t) {
              var i = [],
                n = t[0],
                r = 8,
                e = bt(t, r);
              (r += 4), (r += 0 === n ? 8 : 16), (r += 2);
              var s = t.length + 0,
                a = wt(t, r);
              r += 2;
              for (var o = 0; o < a; o++) {
                var h = r,
                  u = bt(t, h);
                h += 4;
                var f = 2147483647 & u;
                if (1 == (2147483648 & u) >>> 31)
                  return (
                    A.warn("SIDX has hierarchical references (not supported)"),
                    null
                  );
                var l = bt(t, h);
                (h += 4),
                  i.push({
                    referenceSize: f,
                    subsegmentDuration: l,
                    info: { duration: l / e, start: s, end: s + f - 1 },
                  }),
                  (s += f),
                  (r = h += 4);
              }
              return {
                earliestPresentationTime: 0,
                timescale: e,
                version: n,
                referencesCount: a,
                references: i,
              };
            }
            function St(t) {
              for (
                var i = [], n = Tt(t, ["moov", "trak"]), r = 0;
                r < n.length;
                r++
              ) {
                var e = n[r],
                  s = Tt(e, ["tkhd"])[0];
                if (s) {
                  var a = s[0],
                    o = 0 === a ? 12 : 20,
                    h = bt(s, o),
                    u = Tt(e, ["mdia", "mdhd"])[0];
                  if (u) {
                    var f = bt(u, (o = 0 === (a = u[0]) ? 12 : 20)),
                      l = Tt(e, ["mdia", "hdlr"])[0];
                    if (l) {
                      var c = gt(l.subarray(8, 12)),
                        v = { soun: I, vide: P }[c];
                      if (v) {
                        var d = Tt(e, ["mdia", "minf", "stbl", "stsd"])[0],
                          p = void 0;
                        d && (p = gt(d.subarray(12, 16))),
                          (i[h] = { timescale: f, type: v }),
                          (i[v] = { timescale: f, id: h, codec: p });
                      }
                    }
                  }
                }
              }
              return (
                Tt(t, ["moov", "mvex", "trex"]).forEach(function (t) {
                  var n = bt(t, 4),
                    r = i[n];
                  r && (r.default = { duration: bt(t, 12), flags: bt(t, 20) });
                }),
                i
              );
            }
            function At(t) {
              var i = Tt(t, ["schm"])[0];
              if (i) {
                var n = gt(i.subarray(4, 8));
                if ("cbcs" === n || "cenc" === n)
                  return Tt(t, ["schi", "tenc"])[0];
              }
              return A.error("[eme] missing 'schm' box"), null;
            }
            function Mt(t) {
              var i = bt(t, 0),
                n = 8;
              1 & i && (n += 4), 4 & i && (n += 4);
              for (var r = 0, e = bt(t, 4), s = 0; s < e; s++)
                256 & i && ((r += bt(t, n)), (n += 4)),
                  512 & i && (n += 4),
                  1024 & i && (n += 4),
                  2048 & i && (n += 4);
              return r;
            }
            function Dt(t, i) {
              var n = new Uint8Array(t.length + i.length);
              return n.set(t), n.set(i, t.length), n;
            }
            function _t(t, i) {
              var n = [],
                r = i.samples,
                e = i.timescale,
                s = i.id,
                a = !1;
              return (
                Tt(r, ["moof"]).map(function (o) {
                  var h = o.byteOffset - 8;
                  Tt(o, ["traf"]).map(function (o) {
                    var u = Tt(o, ["tfdt"]).map(function (t) {
                      var i = t[0],
                        n = bt(t, 4);
                      return (
                        1 === i && ((n *= Math.pow(2, 32)), (n += bt(t, 8))),
                        n / e
                      );
                    })[0];
                    return (
                      void 0 !== u && (t = u),
                      Tt(o, ["tfhd"]).map(function (u) {
                        var f = bt(u, 4),
                          l = 16777215 & bt(u, 0),
                          c = 0,
                          v = 0 != (16 & l),
                          d = 0,
                          p = 0 != (32 & l),
                          m = 8;
                        f === s &&
                          (0 != (1 & l) && (m += 8),
                          0 != (2 & l) && (m += 4),
                          0 != (8 & l) && ((c = bt(u, m)), (m += 4)),
                          v && ((d = bt(u, m)), (m += 4)),
                          p && (m += 4),
                          "video" === i.type &&
                            (a = (function (t) {
                              if (!t) return !1;
                              var i = t.indexOf("."),
                                n = i < 0 ? t : t.substring(0, i);
                              return (
                                "hvc1" === n ||
                                "hev1" === n ||
                                "dvh1" === n ||
                                "dvhe" === n
                              );
                            })(i.codec)),
                          Tt(o, ["trun"]).map(function (s) {
                            var o = s[0],
                              u = 16777215 & bt(s, 0),
                              f = 0 != (1 & u),
                              l = 0,
                              v = 0 != (4 & u),
                              p = 0 != (256 & u),
                              m = 0,
                              y = 0 != (512 & u),
                              g = 0,
                              w = 0 != (1024 & u),
                              b = 0 != (2048 & u),
                              k = 0,
                              E = bt(s, 4),
                              T = 8;
                            f && ((l = bt(s, T)), (T += 4)), v && (T += 4);
                            for (var x = l + h, S = 0; S < E; S++) {
                              if (
                                (p ? ((m = bt(s, T)), (T += 4)) : (m = c),
                                y ? ((g = bt(s, T)), (T += 4)) : (g = d),
                                w && (T += 4),
                                b &&
                                  ((k = 0 === o ? bt(s, T) : kt(s, T)),
                                  (T += 4)),
                                i.type === P)
                              )
                                for (var A = 0; A < g; ) {
                                  var M = bt(r, x);
                                  Ot(a, r[(x += 4)]) &&
                                    Rt(
                                      r.subarray(x, x + M),
                                      a ? 2 : 1,
                                      t + k / e,
                                      n
                                    ),
                                    (x += M),
                                    (A += M + 4);
                                }
                              t += m / e;
                            }
                          }));
                      })
                    );
                  });
                }),
                n
              );
            }
            function Ot(t, i) {
              if (t) {
                var n = (i >> 1) & 63;
                return 39 === n || 40 === n;
              }
              return 6 == (31 & i);
            }
            function Rt(t, i, n, r) {
              var e = Lt(t),
                s = 0;
              s += i;
              for (var a = 0, o = 0, h = !1, u = 0; s < e.length; ) {
                a = 0;
                do {
                  if (s >= e.length) break;
                  a += u = e[s++];
                } while (255 === u);
                o = 0;
                do {
                  if (s >= e.length) break;
                  o += u = e[s++];
                } while (255 === u);
                var f = e.length - s;
                if (!h && 4 === a && s < e.length) {
                  if (((h = !0), 181 === e[s++])) {
                    var l = wt(e, s);
                    if (((s += 2), 49 === l)) {
                      var c = bt(e, s);
                      if (((s += 4), 1195456820 === c)) {
                        var v = e[s++];
                        if (3 === v) {
                          var d = e[s++],
                            p = 64 & d,
                            m = p ? 2 + 3 * (31 & d) : 0,
                            y = new Uint8Array(m);
                          if (p) {
                            y[0] = d;
                            for (var g = 1; g < m; g++) y[g] = e[s++];
                          }
                          r.push({ type: v, payloadType: a, pts: n, bytes: y });
                        }
                      }
                    }
                  }
                } else if (5 === a && o < f) {
                  if (((h = !0), o > 16)) {
                    for (var w = [], b = 0; b < 16; b++) {
                      var k = e[s++].toString(16);
                      w.push(1 == k.length ? "0" + k : k),
                        (3 !== b && 5 !== b && 7 !== b && 9 !== b) ||
                          w.push("-");
                    }
                    for (
                      var E = o - 16, T = new Uint8Array(E), x = 0;
                      x < E;
                      x++
                    )
                      T[x] = e[s++];
                    r.push({
                      payloadType: a,
                      pts: n,
                      uuid: w.join(""),
                      userData: vt(T),
                      userDataBytes: T,
                    });
                  }
                } else if (o < f) s += o;
                else if (o > f) break;
              }
            }
            function Lt(t) {
              for (var i = t.byteLength, n = [], r = 1; r < i - 2; )
                0 === t[r] && 0 === t[r + 1] && 3 === t[r + 2]
                  ? (n.push(r + 2), (r += 2))
                  : r++;
              if (0 === n.length) return t;
              var e = i - n.length,
                s = new Uint8Array(e),
                a = 0;
              for (r = 0; r < e; a++, r++)
                a === n[0] && (a++, n.shift()), (s[r] = t[a]);
              return s;
            }
            var It = {},
              Pt = (function () {
                function t(t, i, n, r, e) {
                  void 0 === r && (r = [1]),
                    void 0 === e && (e = null),
                    (this.uri = void 0),
                    (this.method = void 0),
                    (this.keyFormat = void 0),
                    (this.keyFormatVersions = void 0),
                    (this.encrypted = void 0),
                    (this.isCommonEncryption = void 0),
                    (this.iv = null),
                    (this.key = null),
                    (this.keyId = null),
                    (this.pssh = null),
                    (this.method = t),
                    (this.uri = i),
                    (this.keyFormat = n),
                    (this.keyFormatVersions = r),
                    (this.iv = e),
                    (this.encrypted = !!t && "NONE" !== t),
                    (this.isCommonEncryption =
                      this.encrypted && "AES-128" !== t);
                }
                t.clearKeyUriToKeyIdMap = function () {
                  It = {};
                };
                var i = t.prototype;
                return (
                  (i.isSupported = function () {
                    if (this.method) {
                      if ("AES-128" === this.method || "NONE" === this.method)
                        return !0;
                      if ("identity" === this.keyFormat)
                        return "SAMPLE-AES" === this.method;
                      switch (this.keyFormat) {
                        case H:
                        case G:
                        case V:
                        case $:
                          return (
                            -1 !==
                            [
                              "ISO-23001-7",
                              "SAMPLE-AES",
                              "SAMPLE-AES-CENC",
                              "SAMPLE-AES-CTR",
                            ].indexOf(this.method)
                          );
                      }
                    }
                    return !1;
                  }),
                  (i.getDecryptData = function (i) {
                    if (!this.encrypted || !this.uri) return null;
                    if ("AES-128" === this.method && this.uri && !this.iv) {
                      "number" != typeof i &&
                        ("AES-128" !== this.method ||
                          this.iv ||
                          A.warn(
                            'missing IV for initialization segment with method="' +
                              this.method +
                              '" - compliance issue'
                          ),
                        (i = 0));
                      var n = (function (t) {
                        for (var i = new Uint8Array(16), n = 12; n < 16; n++)
                          i[n] = (t >> (8 * (15 - n))) & 255;
                        return i;
                      })(i);
                      return new t(
                        this.method,
                        this.uri,
                        "identity",
                        this.keyFormatVersions,
                        n
                      );
                    }
                    var r = (function (t) {
                      var i,
                        n,
                        r = t.split(":"),
                        e = null;
                      if ("data" === r[0] && 2 === r.length) {
                        var s = r[1].split(";"),
                          a = s[s.length - 1].split(",");
                        if (2 === a.length) {
                          var o = "base64" === a[0],
                            h = a[1];
                          o
                            ? (s.splice(-1, 1), (e = B(h)))
                            : ((i = X(h).subarray(0, 16)),
                              (n = new Uint8Array(16)).set(i, 16 - i.length),
                              (e = n));
                        }
                      }
                      return e;
                    })(this.uri);
                    if (r)
                      switch (this.keyFormat) {
                        case G:
                          (this.pssh = r),
                            r.length >= 22 &&
                              (this.keyId = r.subarray(
                                r.length - 22,
                                r.length - 6
                              ));
                          break;
                        case V:
                          var e = new Uint8Array([
                            154, 4, 240, 121, 152, 64, 66, 134, 171, 146, 230,
                            91, 224, 136, 95, 149,
                          ]);
                          this.pssh = (function (t, i, n) {
                            if (16 !== t.byteLength)
                              throw new RangeError("Invalid system id");
                            var r, e, s;
                            if (i) {
                              (r = 1), (e = new Uint8Array(16 * i.length));
                              for (var a = 0; a < i.length; a++) {
                                var o = i[a];
                                if (16 !== o.byteLength)
                                  throw new RangeError("Invalid key");
                                e.set(o, 16 * a);
                              }
                            } else (r = 0), (e = new Uint8Array());
                            r > 0
                              ? ((s = new Uint8Array(4)),
                                i.length > 0 &&
                                  new DataView(s.buffer).setUint32(
                                    0,
                                    i.length,
                                    !1
                                  ))
                              : (s = new Uint8Array());
                            var h = new Uint8Array(4);
                            return (
                              n &&
                                n.byteLength > 0 &&
                                new DataView(h.buffer).setUint32(
                                  0,
                                  n.byteLength,
                                  !1
                                ),
                              (function (t) {
                                for (
                                  var i = arguments.length,
                                    n = new Array(i > 1 ? i - 1 : 0),
                                    r = 1;
                                  r < i;
                                  r++
                                )
                                  n[r - 1] = arguments[r];
                                for (var e = n.length, s = 8, a = e; a--; )
                                  s += n[a].byteLength;
                                var o = new Uint8Array(s);
                                for (
                                  o[0] = (s >> 24) & 255,
                                    o[1] = (s >> 16) & 255,
                                    o[2] = (s >> 8) & 255,
                                    o[3] = 255 & s,
                                    o.set(t, 4),
                                    a = 0,
                                    s = 8;
                                  a < e;
                                  a++
                                )
                                  o.set(n[a], s), (s += n[a].byteLength);
                                return o;
                              })(
                                [112, 115, 115, 104],
                                new Uint8Array([r, 0, 0, 0]),
                                t,
                                s,
                                e,
                                h,
                                n || new Uint8Array()
                              )
                            );
                          })(e, null, r);
                          var s = new Uint16Array(
                              r.buffer,
                              r.byteOffset,
                              r.byteLength / 2
                            ),
                            a = String.fromCharCode.apply(null, Array.from(s)),
                            o = a.substring(a.indexOf("<"), a.length),
                            h = new DOMParser()
                              .parseFromString(o, "text/xml")
                              .getElementsByTagName("KID")[0];
                          if (h) {
                            var u = h.childNodes[0]
                              ? h.childNodes[0].nodeValue
                              : h.getAttribute("VALUE");
                            if (u) {
                              var f = B(u).subarray(0, 16);
                              !(function (t) {
                                var i = function (t, i, n) {
                                  var r = t[i];
                                  (t[i] = t[n]), (t[n] = r);
                                };
                                i(t, 0, 3), i(t, 1, 2), i(t, 4, 5), i(t, 6, 7);
                              })(f),
                                (this.keyId = f);
                            }
                          }
                          break;
                        default:
                          var l = r.subarray(0, 16);
                          if (16 !== l.length) {
                            var c = new Uint8Array(16);
                            c.set(l, 16 - l.length), (l = c);
                          }
                          this.keyId = l;
                      }
                    if (!this.keyId || 16 !== this.keyId.byteLength) {
                      var v = It[this.uri];
                      if (!v) {
                        var d =
                          Object.keys(It).length % Number.MAX_SAFE_INTEGER;
                        (v = new Uint8Array(16)),
                          new DataView(v.buffer, 12, 4).setUint32(0, d),
                          (It[this.uri] = v);
                      }
                      this.keyId = v;
                    }
                    return this;
                  }),
                  t
                );
              })(),
              Ct = /\{\$([a-zA-Z0-9-_]+)\}/g;
            function Nt(t) {
              return Ct.test(t);
            }
            function Ut(t, i, n) {
              if (null !== t.variableList || t.hasVariableRefs)
                for (var r = n.length; r--; ) {
                  var e = n[r],
                    s = i[e];
                  s && (i[e] = Ft(t, s));
                }
            }
            function Ft(t, i) {
              if (null !== t.variableList || t.hasVariableRefs) {
                var n = t.variableList;
                return i.replace(Ct, function (i) {
                  var r = i.substring(2, i.length - 1),
                    e = null == n ? void 0 : n[r];
                  return void 0 === e
                    ? (t.playlistParsingError ||
                        (t.playlistParsingError = new Error(
                          'Missing preceding EXT-X-DEFINE tag for Variable Reference: "' +
                            r +
                            '"'
                        )),
                      i)
                    : e;
                });
              }
              return i;
            }
            function jt(t, i, n) {
              var r,
                e,
                s = t.variableList;
              if ((s || (t.variableList = s = {}), "QUERYPARAM" in i)) {
                r = i.QUERYPARAM;
                try {
                  var a = new self.URL(n).searchParams;
                  if (!a.has(r))
                    throw new Error(
                      '"' +
                        r +
                        '" does not match any query parameter in URI: "' +
                        n +
                        '"'
                    );
                  e = a.get(r);
                } catch (i) {
                  t.playlistParsingError ||
                    (t.playlistParsingError = new Error(
                      "EXT-X-DEFINE QUERYPARAM: " + i.message
                    ));
                }
              } else (r = i.NAME), (e = i.VALUE);
              r in s
                ? t.playlistParsingError ||
                  (t.playlistParsingError = new Error(
                    'EXT-X-DEFINE duplicate Variable Name declarations: "' +
                      r +
                      '"'
                  ))
                : (s[r] = e || "");
            }
            function Bt(t, i, n) {
              var r = i.IMPORT;
              if (n && r in n) {
                var e = t.variableList;
                e || (t.variableList = e = {}), (e[r] = n[r]);
              } else
                t.playlistParsingError ||
                  (t.playlistParsingError = new Error(
                    'EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "' +
                      r +
                      '"'
                  ));
            }
            function Xt() {
              if ("undefined" != typeof self)
                return self.MediaSource || self.WebKitMediaSource;
            }
            var Yt = {
                audio: {
                  a3ds: !0,
                  "ac-3": !0,
                  "ac-4": !0,
                  alac: !0,
                  alaw: !0,
                  dra1: !0,
                  "dts+": !0,
                  "dts-": !0,
                  dtsc: !0,
                  dtse: !0,
                  dtsh: !0,
                  "ec-3": !0,
                  enca: !0,
                  g719: !0,
                  g726: !0,
                  m4ae: !0,
                  mha1: !0,
                  mha2: !0,
                  mhm1: !0,
                  mhm2: !0,
                  mlpa: !0,
                  mp4a: !0,
                  "raw ": !0,
                  Opus: !0,
                  opus: !0,
                  samr: !0,
                  sawb: !0,
                  sawp: !0,
                  sevc: !0,
                  sqcp: !0,
                  ssmv: !0,
                  twos: !0,
                  ulaw: !0,
                },
                video: {
                  avc1: !0,
                  avc2: !0,
                  avc3: !0,
                  avc4: !0,
                  avcp: !0,
                  av01: !0,
                  drac: !0,
                  dva1: !0,
                  dvav: !0,
                  dvh1: !0,
                  dvhe: !0,
                  encv: !0,
                  hev1: !0,
                  hvc1: !0,
                  mjp2: !0,
                  mp4v: !0,
                  mvc1: !0,
                  mvc2: !0,
                  mvc3: !0,
                  mvc4: !0,
                  resv: !0,
                  rv60: !0,
                  s263: !0,
                  svc1: !0,
                  svc2: !0,
                  "vc-1": !0,
                  vp08: !0,
                  vp09: !0,
                },
                text: { stpp: !0, wvtt: !0 },
              },
              $t = Xt();
            function Ht(t, i) {
              var n;
              return (
                null !=
                  (n =
                    null == $t
                      ? void 0
                      : $t.isTypeSupported(
                          (i || "video") + '/mp4;codecs="' + t + '"'
                        )) && n
              );
            }
            var Vt =
                /#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,
              Gt = /#EXT-X-MEDIA:(.*)/g,
              Wt = /^#EXT(?:INF|-X-TARGETDURATION):/m,
              Kt = new RegExp(
                [
                  /#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,
                  /(?!#) *(\S[\S ]*)/.source,
                  /#EXT-X-BYTERANGE:*(.+)/.source,
                  /#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,
                  /#.*/.source,
                ].join("|"),
                "g"
              ),
              zt = new RegExp(
                [
                  /#(EXTM3U)/.source,
                  /#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/
                    .source,
                  /#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/
                    .source,
                  /#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,
                  /(#)([^:]*):(.*)/.source,
                  /(#)(.*)(?:.*)\r?\n?/.source,
                ].join("|")
              ),
              qt = (function () {
                function t() {}
                return (
                  (t.findGroup = function (t, i) {
                    for (var n = 0; n < t.length; n++) {
                      var r = t[n];
                      if (r.id === i) return r;
                    }
                  }),
                  (t.convertAVC1ToAVCOTI = function (t) {
                    var i = t.split(".");
                    if (i.length > 2) {
                      var n = i.shift() + ".";
                      return (
                        (n += parseInt(i.shift()).toString(16)) +
                        ("000" + parseInt(i.shift()).toString(16)).slice(-4)
                      );
                    }
                    return t;
                  }),
                  (t.resolve = function (t, i) {
                    return y.buildAbsoluteURL(i, t, { alwaysNormalize: !0 });
                  }),
                  (t.isMediaPlaylist = function (t) {
                    return Wt.test(t);
                  }),
                  (t.parseMasterPlaylist = function (i, n) {
                    var r,
                      e = {
                        contentSteering: null,
                        levels: [],
                        playlistParsingError: null,
                        sessionData: null,
                        sessionKeys: null,
                        startTimeOffset: null,
                        variableList: null,
                        hasVariableRefs: Nt(i),
                      },
                      s = [];
                    for (Vt.lastIndex = 0; null != (r = Vt.exec(i)); )
                      if (r[1]) {
                        var a,
                          o = new _(r[1]);
                        Ut(e, o, [
                          "CODECS",
                          "SUPPLEMENTAL-CODECS",
                          "ALLOWED-CPC",
                          "PATHWAY-ID",
                          "STABLE-VARIANT-ID",
                          "AUDIO",
                          "VIDEO",
                          "SUBTITLES",
                          "CLOSED-CAPTIONS",
                          "NAME",
                        ]);
                        var h = Ft(e, r[2]),
                          u = {
                            attrs: o,
                            bitrate:
                              o.decimalInteger("AVERAGE-BANDWIDTH") ||
                              o.decimalInteger("BANDWIDTH"),
                            name: o.NAME,
                            url: t.resolve(h, n),
                          },
                          f = o.decimalResolution("RESOLUTION");
                        f && ((u.width = f.width), (u.height = f.height)),
                          Zt(
                            (o.CODECS || "")
                              .split(/[ ,]+/)
                              .filter(function (t) {
                                return t;
                              }),
                            u
                          ),
                          u.videoCodec &&
                            -1 !== u.videoCodec.indexOf("avc1") &&
                            (u.videoCodec = t.convertAVC1ToAVCOTI(
                              u.videoCodec
                            )),
                          (null != (a = u.unknownCodecs) && a.length) ||
                            s.push(u),
                          e.levels.push(u);
                      } else if (r[3]) {
                        var l = r[3],
                          c = r[4];
                        switch (l) {
                          case "SESSION-DATA":
                            var v = new _(c);
                            Ut(e, v, ["DATA-ID", "LANGUAGE", "VALUE", "URI"]);
                            var d = v["DATA-ID"];
                            d &&
                              (null === e.sessionData && (e.sessionData = {}),
                              (e.sessionData[d] = v));
                            break;
                          case "SESSION-KEY":
                            var p = Jt(c, n, e);
                            p.encrypted && p.isSupported()
                              ? (null === e.sessionKeys && (e.sessionKeys = []),
                                e.sessionKeys.push(p))
                              : A.warn(
                                  '[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "' +
                                    c +
                                    '"'
                                );
                            break;
                          case "DEFINE":
                            var m = new _(c);
                            Ut(e, m, ["NAME", "VALUE", "QUERYPARAM"]),
                              jt(e, m, n);
                            break;
                          case "CONTENT-STEERING":
                            var y = new _(c);
                            Ut(e, y, ["SERVER-URI", "PATHWAY-ID"]),
                              (e.contentSteering = {
                                uri: t.resolve(y["SERVER-URI"], n),
                                pathwayId: y["PATHWAY-ID"] || ".",
                              });
                            break;
                          case "START":
                            e.startTimeOffset = Qt(c);
                        }
                      }
                    var g = s.length > 0 && s.length < e.levels.length;
                    return (
                      (e.levels = g ? s : e.levels),
                      0 === e.levels.length &&
                        (e.playlistParsingError = new Error(
                          "no levels found in manifest"
                        )),
                      e
                    );
                  }),
                  (t.parseMasterPlaylistMedia = function (i, n, r) {
                    var e,
                      s = {},
                      a = r.levels,
                      o = {
                        AUDIO: a.map(function (t) {
                          return {
                            id: t.attrs.AUDIO,
                            audioCodec: t.audioCodec,
                          };
                        }),
                        SUBTITLES: a.map(function (t) {
                          return {
                            id: t.attrs.SUBTITLES,
                            textCodec: t.textCodec,
                          };
                        }),
                        "CLOSED-CAPTIONS": [],
                      },
                      h = 0;
                    for (Gt.lastIndex = 0; null !== (e = Gt.exec(i)); ) {
                      var u = new _(e[1]),
                        f = u.TYPE;
                      if (f) {
                        var l = o[f],
                          c = s[f] || [];
                        (s[f] = c),
                          Ut(r, u, [
                            "URI",
                            "GROUP-ID",
                            "LANGUAGE",
                            "ASSOC-LANGUAGE",
                            "STABLE-RENDITION-ID",
                            "NAME",
                            "INSTREAM-ID",
                            "CHARACTERISTICS",
                            "CHANNELS",
                          ]);
                        var v = {
                          attrs: u,
                          bitrate: 0,
                          id: h++,
                          groupId: u["GROUP-ID"] || "",
                          instreamId: u["INSTREAM-ID"],
                          name: u.NAME || u.LANGUAGE || "",
                          type: f,
                          default: u.bool("DEFAULT"),
                          autoselect: u.bool("AUTOSELECT"),
                          forced: u.bool("FORCED"),
                          lang: u.LANGUAGE,
                          url: u.URI ? t.resolve(u.URI, n) : "",
                        };
                        if (null != l && l.length) {
                          var d = t.findGroup(l, v.groupId) || l[0];
                          ti(v, d, "audioCodec"), ti(v, d, "textCodec");
                        }
                        c.push(v);
                      }
                    }
                    return s;
                  }),
                  (t.parseLevelPlaylist = function (t, i, n, r, e, s) {
                    var a,
                      h,
                      u,
                      f = new j(i),
                      l = f.fragments,
                      c = null,
                      v = 0,
                      d = 0,
                      p = 0,
                      m = 0,
                      y = null,
                      w = new U(r, i),
                      b = -1,
                      k = !1;
                    for (
                      Kt.lastIndex = 0, f.m3u8 = t, f.hasVariableRefs = Nt(t);
                      null !== (a = Kt.exec(t));

                    ) {
                      k &&
                        ((k = !1),
                        ((w = new U(r, i)).start = p),
                        (w.sn = v),
                        (w.cc = m),
                        (w.level = n),
                        c &&
                          ((w.initSegment = c),
                          (w.rawProgramDateTime = c.rawProgramDateTime),
                          (c.rawProgramDateTime = null)));
                      var E = a[1];
                      if (E) {
                        w.duration = parseFloat(E);
                        var T = (" " + a[2]).slice(1);
                        (w.title = T || null),
                          w.tagList.push(T ? ["INF", E, T] : ["INF", E]);
                      } else if (a[3]) {
                        if (g(w.duration)) {
                          (w.start = p),
                            u && ri(w, u, f),
                            (w.sn = v),
                            (w.level = n),
                            (w.cc = m),
                            (w.urlId = e),
                            l.push(w);
                          var x = (" " + a[3]).slice(1);
                          (w.relurl = Ft(f, x)),
                            ii(w, y),
                            (y = w),
                            (p += w.duration),
                            v++,
                            (d = 0),
                            (k = !0);
                        }
                      } else if (a[4]) {
                        var S = (" " + a[4]).slice(1);
                        y ? w.setByteRange(S, y) : w.setByteRange(S);
                      } else if (a[5])
                        (w.rawProgramDateTime = (" " + a[5]).slice(1)),
                          w.tagList.push([
                            "PROGRAM-DATE-TIME",
                            w.rawProgramDateTime,
                          ]),
                          -1 === b && (b = l.length);
                      else {
                        if (!(a = a[0].match(zt))) {
                          A.warn(
                            "No matches on slow regex match for level playlist!"
                          );
                          continue;
                        }
                        for (h = 1; h < a.length && void 0 === a[h]; h++);
                        var M = (" " + a[h]).slice(1),
                          D = (" " + a[h + 1]).slice(1),
                          O = a[h + 2] ? (" " + a[h + 2]).slice(1) : "";
                        switch (M) {
                          case "PLAYLIST-TYPE":
                            f.type = D.toUpperCase();
                            break;
                          case "MEDIA-SEQUENCE":
                            v = f.startSN = parseInt(D);
                            break;
                          case "SKIP":
                            var L = new _(D);
                            Ut(f, L, ["RECENTLY-REMOVED-DATERANGES"]);
                            var I = L.decimalInteger("SKIPPED-SEGMENTS");
                            if (g(I)) {
                              f.skippedSegments = I;
                              for (var P = I; P--; ) l.unshift(null);
                              v += I;
                            }
                            var C = L.enumeratedString(
                              "RECENTLY-REMOVED-DATERANGES"
                            );
                            C && (f.recentlyRemovedDateranges = C.split("\t"));
                            break;
                          case "TARGETDURATION":
                            f.targetduration = Math.max(parseInt(D), 1);
                            break;
                          case "VERSION":
                            f.version = parseInt(D);
                            break;
                          case "EXTM3U":
                            break;
                          case "ENDLIST":
                            f.live = !1;
                            break;
                          case "#":
                            (D || O) && w.tagList.push(O ? [D, O] : [D]);
                            break;
                          case "DISCONTINUITY":
                            m++, w.tagList.push(["DIS"]);
                            break;
                          case "GAP":
                            (w.gap = !0), w.tagList.push([M]);
                            break;
                          case "BITRATE":
                            w.tagList.push([M, D]);
                            break;
                          case "DATERANGE":
                            var N = new _(D);
                            Ut(f, N, [
                              "ID",
                              "CLASS",
                              "START-DATE",
                              "END-DATE",
                              "SCTE35-CMD",
                              "SCTE35-OUT",
                              "SCTE35-IN",
                            ]),
                              Ut(f, N, N.clientAttrs);
                            var B = new R(N, f.dateRanges[N.ID]);
                            B.isValid || f.skippedSegments
                              ? (f.dateRanges[B.id] = B)
                              : A.warn(
                                  'Ignoring invalid DATERANGE tag: "' + D + '"'
                                ),
                              w.tagList.push(["EXT-X-DATERANGE", D]);
                            break;
                          case "DEFINE":
                            var X = new _(D);
                            Ut(f, X, ["NAME", "VALUE", "IMPORT", "QUERYPARAM"]),
                              "IMPORT" in X ? Bt(f, X, s) : jt(f, X, i);
                            break;
                          case "DISCONTINUITY-SEQUENCE":
                            m = parseInt(D);
                            break;
                          case "KEY":
                            var Y = Jt(D, i, f);
                            if (Y.isSupported()) {
                              if ("NONE" === Y.method) {
                                u = void 0;
                                break;
                              }
                              u || (u = {}),
                                u[Y.keyFormat] && (u = o({}, u)),
                                (u[Y.keyFormat] = Y);
                            } else
                              A.warn(
                                '[Keys] Ignoring invalid EXT-X-KEY tag: "' +
                                  D +
                                  '"'
                              );
                            break;
                          case "START":
                            f.startTimeOffset = Qt(D);
                            break;
                          case "MAP":
                            var $ = new _(D);
                            if ((Ut(f, $, ["BYTERANGE", "URI"]), w.duration)) {
                              var H = new U(r, i);
                              ni(H, $, n, u),
                                (c = H),
                                (w.initSegment = c),
                                c.rawProgramDateTime &&
                                  !w.rawProgramDateTime &&
                                  (w.rawProgramDateTime = c.rawProgramDateTime);
                            } else ni(w, $, n, u), (c = w), (k = !0);
                            break;
                          case "SERVER-CONTROL":
                            var V = new _(D);
                            (f.canBlockReload = V.bool("CAN-BLOCK-RELOAD")),
                              (f.canSkipUntil = V.optionalFloat(
                                "CAN-SKIP-UNTIL",
                                0
                              )),
                              (f.canSkipDateRanges =
                                f.canSkipUntil > 0 &&
                                V.bool("CAN-SKIP-DATERANGES")),
                              (f.partHoldBack = V.optionalFloat(
                                "PART-HOLD-BACK",
                                0
                              )),
                              (f.holdBack = V.optionalFloat("HOLD-BACK", 0));
                            break;
                          case "PART-INF":
                            var G = new _(D);
                            f.partTarget =
                              G.decimalFloatingPoint("PART-TARGET");
                            break;
                          case "PART":
                            var W = f.partList;
                            W || (W = f.partList = []);
                            var K = d > 0 ? W[W.length - 1] : void 0,
                              z = d++,
                              q = new _(D);
                            Ut(f, q, ["BYTERANGE", "URI"]);
                            var J = new F(q, w, i, z, K);
                            W.push(J), (w.duration += J.duration);
                            break;
                          case "PRELOAD-HINT":
                            var Q = new _(D);
                            Ut(f, Q, ["URI"]), (f.preloadHint = Q);
                            break;
                          case "RENDITION-REPORT":
                            var Z = new _(D);
                            Ut(f, Z, ["URI"]),
                              (f.renditionReports = f.renditionReports || []),
                              f.renditionReports.push(Z);
                            break;
                          default:
                            A.warn("line parsed but not handled: " + a);
                        }
                      }
                    }
                    y && !y.relurl
                      ? (l.pop(),
                        (p -= y.duration),
                        f.partList && (f.fragmentHint = y))
                      : f.partList &&
                        (ii(w, y),
                        (w.cc = m),
                        (f.fragmentHint = w),
                        u && ri(w, u, f));
                    var tt = l.length,
                      it = l[0],
                      nt = l[tt - 1];
                    if (
                      (p += f.skippedSegments * f.targetduration) > 0 &&
                      tt &&
                      nt
                    ) {
                      f.averagetargetduration = p / tt;
                      var rt = nt.sn;
                      (f.endSN = "initSegment" !== rt ? rt : 0),
                        f.live || (nt.endList = !0),
                        it && (f.startCC = it.cc);
                    } else (f.endSN = 0), (f.startCC = 0);
                    return (
                      f.fragmentHint && (p += f.fragmentHint.duration),
                      (f.totalduration = p),
                      (f.endCC = m),
                      b > 0 &&
                        (function (t, i) {
                          for (var n = t[i], r = i; r--; ) {
                            var e = t[r];
                            if (!e) return;
                            (e.programDateTime =
                              n.programDateTime - 1e3 * e.duration),
                              (n = e);
                          }
                        })(l, b),
                      f
                    );
                  }),
                  t
                );
              })();
            function Jt(t, i, n) {
              var r,
                e,
                s = new _(t);
              Ut(n, s, ["KEYFORMAT", "KEYFORMATVERSIONS", "URI", "IV", "URI"]);
              var a = null != (r = s.METHOD) ? r : "",
                o = s.URI,
                h = s.hexadecimalInteger("IV"),
                u = s.KEYFORMATVERSIONS,
                f = null != (e = s.KEYFORMAT) ? e : "identity";
              o && s.IV && !h && A.error("Invalid IV: " + s.IV);
              var l = o ? qt.resolve(o, i) : "",
                c = (u || "1").split("/").map(Number).filter(Number.isFinite);
              return new Pt(a, l, f, c, h);
            }
            function Qt(t) {
              var i = new _(t).decimalFloatingPoint("TIME-OFFSET");
              return g(i) ? i : null;
            }
            function Zt(t, i) {
              ["video", "audio", "text"].forEach(function (n) {
                var r = t.filter(function (t) {
                  return (function (t, i) {
                    var n = Yt[i];
                    return !!n && !0 === n[t.slice(0, 4)];
                  })(t, n);
                });
                if (r.length) {
                  var e = r.filter(function (t) {
                    return (
                      0 === t.lastIndexOf("avc1", 0) ||
                      0 === t.lastIndexOf("mp4a", 0)
                    );
                  });
                  (i[n + "Codec"] = e.length > 0 ? e[0] : r[0]),
                    (t = t.filter(function (t) {
                      return -1 === r.indexOf(t);
                    }));
                }
              }),
                (i.unknownCodecs = t);
            }
            function ti(t, i, n) {
              var r = i[n];
              r && (t[n] = r);
            }
            function ii(t, i) {
              t.rawProgramDateTime
                ? (t.programDateTime = Date.parse(t.rawProgramDateTime))
                : null != i &&
                  i.programDateTime &&
                  (t.programDateTime = i.endProgramDateTime),
                g(t.programDateTime) ||
                  ((t.programDateTime = null), (t.rawProgramDateTime = null));
            }
            function ni(t, i, n, r) {
              (t.relurl = i.URI),
                i.BYTERANGE && t.setByteRange(i.BYTERANGE),
                (t.level = n),
                (t.sn = "initSegment"),
                r && (t.levelkeys = r),
                (t.initSegment = null);
            }
            function ri(t, i, n) {
              t.levelkeys = i;
              var r = n.encryptedFragments;
              (r.length && r[r.length - 1].levelkeys === i) ||
                !Object.keys(i).some(function (t) {
                  return i[t].isCommonEncryption;
                }) ||
                r.push(t);
            }
            var ei = "manifest",
              si = "level",
              ai = "audioTrack",
              oi = "subtitleTrack",
              hi = "main",
              ui = "audio",
              fi = "subtitle";
            function li(t) {
              switch (t.type) {
                case ai:
                  return ui;
                case oi:
                  return fi;
                default:
                  return hi;
              }
            }
            function ci(t, i) {
              var n = t.url;
              return (
                (void 0 !== n && 0 !== n.indexOf("data:")) || (n = i.url), n
              );
            }
            var vi = (function () {
              function t(t) {
                (this.hls = void 0),
                  (this.loaders = Object.create(null)),
                  (this.variableList = null),
                  (this.hls = t),
                  this.registerListeners();
              }
              var i = t.prototype;
              return (
                (i.startLoad = function (t) {}),
                (i.stopLoad = function () {
                  this.destroyInternalLoaders();
                }),
                (i.registerListeners = function () {
                  var t = this.hls;
                  t.on(w.MANIFEST_LOADING, this.onManifestLoading, this),
                    t.on(w.LEVEL_LOADING, this.onLevelLoading, this),
                    t.on(w.AUDIO_TRACK_LOADING, this.onAudioTrackLoading, this),
                    t.on(
                      w.SUBTITLE_TRACK_LOADING,
                      this.onSubtitleTrackLoading,
                      this
                    );
                }),
                (i.unregisterListeners = function () {
                  var t = this.hls;
                  t.off(w.MANIFEST_LOADING, this.onManifestLoading, this),
                    t.off(w.LEVEL_LOADING, this.onLevelLoading, this),
                    t.off(
                      w.AUDIO_TRACK_LOADING,
                      this.onAudioTrackLoading,
                      this
                    ),
                    t.off(
                      w.SUBTITLE_TRACK_LOADING,
                      this.onSubtitleTrackLoading,
                      this
                    );
                }),
                (i.createInternalLoader = function (t) {
                  var i = this.hls.config,
                    n = i.pLoader,
                    r = i.loader,
                    e = new (n || r)(i);
                  return (this.loaders[t.type] = e), e;
                }),
                (i.getInternalLoader = function (t) {
                  return this.loaders[t.type];
                }),
                (i.resetInternalLoader = function (t) {
                  this.loaders[t] && delete this.loaders[t];
                }),
                (i.destroyInternalLoaders = function () {
                  for (var t in this.loaders) {
                    var i = this.loaders[t];
                    i && i.destroy(), this.resetInternalLoader(t);
                  }
                }),
                (i.destroy = function () {
                  (this.variableList = null),
                    this.unregisterListeners(),
                    this.destroyInternalLoaders();
                }),
                (i.onManifestLoading = function (t, i) {
                  var n = i.url;
                  (this.variableList = null),
                    this.load({
                      id: null,
                      level: 0,
                      responseType: "text",
                      type: ei,
                      url: n,
                      deliveryDirectives: null,
                    });
                }),
                (i.onLevelLoading = function (t, i) {
                  var n = i.id,
                    r = i.level,
                    e = i.url,
                    s = i.deliveryDirectives;
                  this.load({
                    id: n,
                    level: r,
                    responseType: "text",
                    type: si,
                    url: e,
                    deliveryDirectives: s,
                  });
                }),
                (i.onAudioTrackLoading = function (t, i) {
                  var n = i.id,
                    r = i.groupId,
                    e = i.url,
                    s = i.deliveryDirectives;
                  this.load({
                    id: n,
                    groupId: r,
                    level: null,
                    responseType: "text",
                    type: ai,
                    url: e,
                    deliveryDirectives: s,
                  });
                }),
                (i.onSubtitleTrackLoading = function (t, i) {
                  var n = i.id,
                    r = i.groupId,
                    e = i.url,
                    s = i.deliveryDirectives;
                  this.load({
                    id: n,
                    groupId: r,
                    level: null,
                    responseType: "text",
                    type: oi,
                    url: e,
                    deliveryDirectives: s,
                  });
                }),
                (i.load = function (t) {
                  var i,
                    n,
                    r,
                    e = this,
                    s = this.hls.config,
                    a = this.getInternalLoader(t);
                  if (a) {
                    var h = a.context;
                    if (h && h.url === t.url)
                      return void A.trace(
                        "[playlist-loader]: playlist request ongoing"
                      );
                    A.log(
                      "[playlist-loader]: aborting previous loader for type: " +
                        t.type
                    ),
                      a.abort();
                  }
                  if (
                    ((n =
                      t.type === ei
                        ? s.manifestLoadPolicy.default
                        : o({}, s.playlistLoadPolicy.default, {
                            timeoutRetry: null,
                            errorRetry: null,
                          })),
                    (a = this.createInternalLoader(t)),
                    null != (i = t.deliveryDirectives) &&
                      i.part &&
                      (t.type === si && null !== t.level
                        ? (r = this.hls.levels[t.level].details)
                        : t.type === ai && null !== t.id
                        ? (r = this.hls.audioTracks[t.id].details)
                        : t.type === oi &&
                          null !== t.id &&
                          (r = this.hls.subtitleTracks[t.id].details),
                      r))
                  ) {
                    var u = r.partTarget,
                      f = r.targetduration;
                    if (u && f) {
                      var l = 1e3 * Math.max(3 * u, 0.8 * f);
                      n = o({}, n, {
                        maxTimeToFirstByteMs: Math.min(
                          l,
                          n.maxTimeToFirstByteMs
                        ),
                        maxLoadTimeMs: Math.min(l, n.maxTimeToFirstByteMs),
                      });
                    }
                  }
                  var c = n.errorRetry || n.timeoutRetry || {},
                    v = {
                      loadPolicy: n,
                      timeout: n.maxLoadTimeMs,
                      maxRetry: c.maxNumRetry || 0,
                      retryDelay: c.retryDelayMs || 0,
                      maxRetryDelay: c.maxRetryDelayMs || 0,
                    },
                    d = {
                      onSuccess: function (t, i, n, r) {
                        var s = e.getInternalLoader(n);
                        e.resetInternalLoader(n.type);
                        var a = t.data;
                        0 === a.indexOf("#EXTM3U")
                          ? ((i.parsing.start = performance.now()),
                            qt.isMediaPlaylist(a)
                              ? e.handleTrackOrLevelPlaylist(
                                  t,
                                  i,
                                  n,
                                  r || null,
                                  s
                                )
                              : e.handleMasterPlaylist(t, i, n, r))
                          : e.handleManifestParsingError(
                              t,
                              n,
                              new Error("no EXTM3U delimiter"),
                              r || null,
                              i
                            );
                      },
                      onError: function (t, i, n, r) {
                        e.handleNetworkError(i, n, !1, t, r);
                      },
                      onTimeout: function (t, i, n) {
                        e.handleNetworkError(i, n, !0, void 0, t);
                      },
                    };
                  a.load(t, v, d);
                }),
                (i.handleMasterPlaylist = function (t, i, n, r) {
                  var e = this.hls,
                    s = t.data,
                    a = ci(t, n),
                    o = qt.parseMasterPlaylist(s, a);
                  if (o.playlistParsingError)
                    this.handleManifestParsingError(
                      t,
                      n,
                      o.playlistParsingError,
                      r,
                      i
                    );
                  else {
                    var h = o.contentSteering,
                      u = o.levels,
                      f = o.sessionData,
                      l = o.sessionKeys,
                      c = o.startTimeOffset,
                      v = o.variableList;
                    this.variableList = v;
                    var d = qt.parseMasterPlaylistMedia(s, a, o),
                      p = d.AUDIO,
                      m = void 0 === p ? [] : p,
                      y = d.SUBTITLES,
                      g = d["CLOSED-CAPTIONS"];
                    m.length &&
                      (m.some(function (t) {
                        return !t.url;
                      }) ||
                        !u[0].audioCodec ||
                        u[0].attrs.AUDIO ||
                        (A.log(
                          "[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"
                        ),
                        m.unshift({
                          type: "main",
                          name: "main",
                          groupId: "main",
                          default: !1,
                          autoselect: !1,
                          forced: !1,
                          id: -1,
                          attrs: new _({}),
                          bitrate: 0,
                          url: "",
                        }))),
                      e.trigger(w.MANIFEST_LOADED, {
                        levels: u,
                        audioTracks: m,
                        subtitles: y,
                        captions: g,
                        contentSteering: h,
                        url: a,
                        stats: i,
                        networkDetails: r,
                        sessionData: f,
                        sessionKeys: l,
                        startTimeOffset: c,
                        variableList: v,
                      });
                  }
                }),
                (i.handleTrackOrLevelPlaylist = function (t, i, n, r, e) {
                  var s = this.hls,
                    a = n.id,
                    o = n.level,
                    h = n.type,
                    u = ci(t, n),
                    f = g(a) ? a : 0,
                    l = g(o) ? o : f,
                    c = li(n),
                    v = qt.parseLevelPlaylist(
                      t.data,
                      u,
                      l,
                      c,
                      f,
                      this.variableList
                    );
                  if (h === ei) {
                    var d = {
                      attrs: new _({}),
                      bitrate: 0,
                      details: v,
                      name: "",
                      url: u,
                    };
                    s.trigger(w.MANIFEST_LOADED, {
                      levels: [d],
                      audioTracks: [],
                      url: u,
                      stats: i,
                      networkDetails: r,
                      sessionData: null,
                      sessionKeys: null,
                      contentSteering: null,
                      startTimeOffset: null,
                      variableList: null,
                    });
                  }
                  (i.parsing.end = performance.now()),
                    (n.levelDetails = v),
                    this.handlePlaylistLoaded(v, t, i, n, r, e);
                }),
                (i.handleManifestParsingError = function (t, i, n, r, e) {
                  this.hls.trigger(w.ERROR, {
                    type: b.NETWORK_ERROR,
                    details: k.MANIFEST_PARSING_ERROR,
                    fatal: i.type === ei,
                    url: t.url,
                    err: n,
                    error: n,
                    reason: n.message,
                    response: t,
                    context: i,
                    networkDetails: r,
                    stats: e,
                  });
                }),
                (i.handleNetworkError = function (t, i, n, e, s) {
                  void 0 === n && (n = !1);
                  var a =
                    "A network " +
                    (n
                      ? "timeout"
                      : "error" + (e ? " (status " + e.code + ")" : "")) +
                    " occurred while loading " +
                    t.type;
                  t.type === si
                    ? (a += ": " + t.level + " id: " + t.id)
                    : (t.type !== ai && t.type !== oi) ||
                      (a += " id: " + t.id + ' group-id: "' + t.groupId + '"');
                  var o = new Error(a);
                  A.warn("[playlist-loader]: " + a);
                  var h = k.UNKNOWN,
                    u = !1,
                    f = this.getInternalLoader(t);
                  switch (t.type) {
                    case ei:
                      (h = n ? k.MANIFEST_LOAD_TIMEOUT : k.MANIFEST_LOAD_ERROR),
                        (u = !0);
                      break;
                    case si:
                      (h = n ? k.LEVEL_LOAD_TIMEOUT : k.LEVEL_LOAD_ERROR),
                        (u = !1);
                      break;
                    case ai:
                      (h = n
                        ? k.AUDIO_TRACK_LOAD_TIMEOUT
                        : k.AUDIO_TRACK_LOAD_ERROR),
                        (u = !1);
                      break;
                    case oi:
                      (h = n
                        ? k.SUBTITLE_TRACK_LOAD_TIMEOUT
                        : k.SUBTITLE_LOAD_ERROR),
                        (u = !1);
                  }
                  f && this.resetInternalLoader(t.type);
                  var l = {
                    type: b.NETWORK_ERROR,
                    details: h,
                    fatal: u,
                    url: t.url,
                    loader: f,
                    context: t,
                    error: o,
                    networkDetails: i,
                    stats: s,
                  };
                  if (e) {
                    var c = (null == i ? void 0 : i.url) || t.url;
                    l.response = r({ url: c, data: void 0 }, e);
                  }
                  this.hls.trigger(w.ERROR, l);
                }),
                (i.handlePlaylistLoaded = function (t, i, n, r, e, s) {
                  var a = this.hls,
                    o = r.type,
                    h = r.level,
                    u = r.id,
                    f = r.groupId,
                    l = r.deliveryDirectives,
                    c = ci(i, r),
                    v = li(r),
                    d = "number" == typeof r.level && v === hi ? h : void 0;
                  if (t.fragments.length) {
                    t.targetduration ||
                      (t.playlistParsingError = new Error(
                        "Missing Target Duration"
                      ));
                    var p = t.playlistParsingError;
                    if (p)
                      a.trigger(w.ERROR, {
                        type: b.NETWORK_ERROR,
                        details: k.LEVEL_PARSING_ERROR,
                        fatal: !1,
                        url: c,
                        error: p,
                        reason: p.message,
                        response: i,
                        context: r,
                        level: d,
                        parent: v,
                        networkDetails: e,
                        stats: n,
                      });
                    else
                      switch (
                        (t.live &&
                          s &&
                          (s.getCacheAge &&
                            (t.ageHeader = s.getCacheAge() || 0),
                          (s.getCacheAge && !isNaN(t.ageHeader)) ||
                            (t.ageHeader = 0)),
                        o)
                      ) {
                        case ei:
                        case si:
                          a.trigger(w.LEVEL_LOADED, {
                            details: t,
                            level: d || 0,
                            id: u || 0,
                            stats: n,
                            networkDetails: e,
                            deliveryDirectives: l,
                          });
                          break;
                        case ai:
                          a.trigger(w.AUDIO_TRACK_LOADED, {
                            details: t,
                            id: u || 0,
                            groupId: f || "",
                            stats: n,
                            networkDetails: e,
                            deliveryDirectives: l,
                          });
                          break;
                        case oi:
                          a.trigger(w.SUBTITLE_TRACK_LOADED, {
                            details: t,
                            id: u || 0,
                            groupId: f || "",
                            stats: n,
                            networkDetails: e,
                            deliveryDirectives: l,
                          });
                      }
                  } else {
                    var m = new Error("No Segments found in Playlist");
                    a.trigger(w.ERROR, {
                      type: b.NETWORK_ERROR,
                      details: k.LEVEL_EMPTY_ERROR,
                      fatal: !1,
                      url: c,
                      error: m,
                      reason: m.message,
                      response: i,
                      context: r,
                      level: d,
                      parent: v,
                      networkDetails: e,
                      stats: n,
                    });
                  }
                }),
                t
              );
            })();
            function di(t, i) {
              var n;
              try {
                n = new Event("addtrack");
              } catch (t) {
                (n = document.createEvent("Event")).initEvent(
                  "addtrack",
                  !1,
                  !1
                );
              }
              (n.track = t), i.dispatchEvent(n);
            }
            function pi(t, i) {
              var n = t.mode;
              if (
                ("disabled" === n && (t.mode = "hidden"),
                t.cues && !t.cues.getCueById(i.id))
              )
                try {
                  if ((t.addCue(i), !t.cues.getCueById(i.id)))
                    throw new Error("addCue is failed for: " + i);
                } catch (n) {
                  A.debug("[texttrack-utils]: " + n);
                  var r = new self.TextTrackCue(i.startTime, i.endTime, i.text);
                  (r.id = i.id), t.addCue(r);
                }
              "disabled" === n && (t.mode = n);
            }
            function mi(t) {
              var i = t.mode;
              if (("disabled" === i && (t.mode = "hidden"), t.cues))
                for (var n = t.cues.length; n--; ) t.removeCue(t.cues[n]);
              "disabled" === i && (t.mode = i);
            }
            function yi(t, i, n, r) {
              var e = t.mode;
              if (
                ("disabled" === e && (t.mode = "hidden"),
                t.cues && t.cues.length > 0)
              )
                for (
                  var s = (function (t, i, n) {
                      var r = [],
                        e = (function (t, i) {
                          if (i < t[0].startTime) return 0;
                          var n = t.length - 1;
                          if (i > t[n].endTime) return -1;
                          for (var r = 0, e = n; r <= e; ) {
                            var s = Math.floor((e + r) / 2);
                            if (i < t[s].startTime) e = s - 1;
                            else {
                              if (!(i > t[s].startTime && r < n)) return s;
                              r = s + 1;
                            }
                          }
                          return t[r].startTime - i < i - t[e].startTime
                            ? r
                            : e;
                        })(t, i);
                      if (e > -1)
                        for (var s = e, a = t.length; s < a; s++) {
                          var o = t[s];
                          if (o.startTime >= i && o.endTime <= n) r.push(o);
                          else if (o.startTime > n) return r;
                        }
                      return r;
                    })(t.cues, i, n),
                    a = 0;
                  a < s.length;
                  a++
                )
                  (r && !r(s[a])) || t.removeCue(s[a]);
              "disabled" === e && (t.mode = e);
            }
            var gi = "org.id3",
              wi = "https://aomedia.org/emsg/ID3";
            function bi() {
              if ("undefined" != typeof self)
                return self.WebKitDataCue || self.VTTCue || self.TextTrackCue;
            }
            var ki = (function () {
              var t = bi();
              try {
                new t(0, Number.POSITIVE_INFINITY, "");
              } catch (t) {
                return Number.MAX_VALUE;
              }
              return Number.POSITIVE_INFINITY;
            })();
            function Ei(t, i) {
              return t.getTime() / 1e3 - i;
            }
            var Ti = (function () {
                function t(t) {
                  (this.hls = void 0),
                    (this.id3Track = null),
                    (this.media = null),
                    (this.dateRangeCuesAppended = {}),
                    (this.hls = t),
                    this.m();
                }
                var i = t.prototype;
                return (
                  (i.destroy = function () {
                    this.k(),
                      (this.id3Track = null),
                      (this.media = null),
                      (this.dateRangeCuesAppended = {}),
                      (this.hls = null);
                  }),
                  (i.m = function () {
                    var t = this.hls;
                    t.on(w.MEDIA_ATTACHED, this.onMediaAttached, this),
                      t.on(w.MEDIA_DETACHING, this.onMediaDetaching, this),
                      t.on(w.MANIFEST_LOADING, this.onManifestLoading, this),
                      t.on(
                        w.FRAG_PARSING_METADATA,
                        this.onFragParsingMetadata,
                        this
                      ),
                      t.on(w.BUFFER_FLUSHING, this.onBufferFlushing, this),
                      t.on(w.LEVEL_UPDATED, this.onLevelUpdated, this);
                  }),
                  (i.k = function () {
                    var t = this.hls;
                    t.off(w.MEDIA_ATTACHED, this.onMediaAttached, this),
                      t.off(w.MEDIA_DETACHING, this.onMediaDetaching, this),
                      t.off(w.MANIFEST_LOADING, this.onManifestLoading, this),
                      t.off(
                        w.FRAG_PARSING_METADATA,
                        this.onFragParsingMetadata,
                        this
                      ),
                      t.off(w.BUFFER_FLUSHING, this.onBufferFlushing, this),
                      t.off(w.LEVEL_UPDATED, this.onLevelUpdated, this);
                  }),
                  (i.onMediaAttached = function (t, i) {
                    this.media = i.media;
                  }),
                  (i.onMediaDetaching = function () {
                    this.id3Track &&
                      (mi(this.id3Track),
                      (this.id3Track = null),
                      (this.media = null),
                      (this.dateRangeCuesAppended = {}));
                  }),
                  (i.onManifestLoading = function () {
                    this.dateRangeCuesAppended = {};
                  }),
                  (i.createTrack = function (t) {
                    var i = this.getID3Track(t.textTracks);
                    return (i.mode = "hidden"), i;
                  }),
                  (i.getID3Track = function (t) {
                    if (this.media) {
                      for (var i = 0; i < t.length; i++) {
                        var n = t[i];
                        if ("metadata" === n.kind && "id3" === n.label)
                          return di(n, this.media), n;
                      }
                      return this.media.addTextTrack("metadata", "id3");
                    }
                  }),
                  (i.onFragParsingMetadata = function (t, i) {
                    if (this.media) {
                      var n = this.hls.config,
                        r = n.enableEmsgMetadataCues,
                        e = n.enableID3MetadataCues;
                      if (r || e) {
                        var s = i.samples;
                        this.id3Track ||
                          (this.id3Track = this.createTrack(this.media));
                        for (var a = bi(), o = 0; o < s.length; o++) {
                          var h = s[o].type;
                          if ((h !== wi || r) && e) {
                            var u = ot(s[o].data);
                            if (u) {
                              var f = s[o].pts,
                                l = f + s[o].duration;
                              l > ki && (l = ki), l - f <= 0 && (l = f + 0.25);
                              for (var c = 0; c < u.length; c++) {
                                var v = u[c];
                                if (!st(v)) {
                                  this.updateId3CueEnds(f, h);
                                  var d = new a(f, l, "");
                                  (d.value = v),
                                    h && (d.type = h),
                                    this.id3Track.addCue(d);
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }),
                  (i.updateId3CueEnds = function (t, i) {
                    var n,
                      r = null == (n = this.id3Track) ? void 0 : n.cues;
                    if (r)
                      for (var e = r.length; e--; ) {
                        var s = r[e];
                        s.type === i &&
                          s.startTime < t &&
                          s.endTime === ki &&
                          (s.endTime = t);
                      }
                  }),
                  (i.onBufferFlushing = function (t, i) {
                    var n = i.startOffset,
                      r = i.endOffset,
                      e = i.type,
                      s = this.id3Track,
                      a = this.hls;
                    if (a) {
                      var o = a.config,
                        h = o.enableEmsgMetadataCues,
                        u = o.enableID3MetadataCues;
                      s &&
                        (h || u) &&
                        yi(
                          s,
                          n,
                          r,
                          "audio" === e
                            ? function (t) {
                                return t.type === gi && u;
                              }
                            : "video" === e
                            ? function (t) {
                                return t.type === wi && h;
                              }
                            : function (t) {
                                return (
                                  (t.type === gi && u) || (t.type === wi && h)
                                );
                              }
                        );
                    }
                  }),
                  (i.onLevelUpdated = function (t, i) {
                    var n = this,
                      r = i.details;
                    if (
                      this.media &&
                      r.hasProgramDateTime &&
                      this.hls.config.enableDateRangeMetadataCues
                    ) {
                      var e = this.dateRangeCuesAppended,
                        s = this.id3Track,
                        a = r.dateRanges,
                        o = Object.keys(a);
                      if (s)
                        for (
                          var h = Object.keys(e).filter(function (t) {
                              return !o.includes(t);
                            }),
                            u = function () {
                              var t = h[f];
                              Object.keys(e[t].cues).forEach(function (i) {
                                s.removeCue(e[t].cues[i]);
                              }),
                                delete e[t];
                            },
                            f = h.length;
                          f--;

                        )
                          u();
                      var l = r.fragments[r.fragments.length - 1];
                      if (
                        0 !== o.length &&
                        g(null == l ? void 0 : l.programDateTime)
                      ) {
                        this.id3Track ||
                          (this.id3Track = this.createTrack(this.media));
                        for (
                          var c = l.programDateTime / 1e3 - l.start,
                            v = bi(),
                            d = function () {
                              var t = o[p],
                                i = a[t],
                                r = e[t],
                                s = (null == r ? void 0 : r.cues) || {},
                                h =
                                  (null == r ? void 0 : r.durationKnown) || !1,
                                u = Ei(i.startDate, c),
                                f = ki,
                                l = i.endDate;
                              if (l) (f = Ei(l, c)), (h = !0);
                              else if (i.endOnNext && !h) {
                                var d = o
                                  .reduce(function (t, n) {
                                    var r = a[n];
                                    return (
                                      r.class === i.class &&
                                        r.id !== n &&
                                        r.startDate > i.startDate &&
                                        t.push(r),
                                      t
                                    );
                                  }, [])
                                  .sort(function (t, i) {
                                    return (
                                      t.startDate.getTime() -
                                      i.startDate.getTime()
                                    );
                                  })[0];
                                d && ((f = Ei(d.startDate, c)), (h = !0));
                              }
                              for (
                                var m, y, g = Object.keys(i.attr), w = 0;
                                w < g.length;
                                w++
                              ) {
                                var b = g[w];
                                if (
                                  "ID" !== (y = b) &&
                                  "CLASS" !== y &&
                                  "START-DATE" !== y &&
                                  "DURATION" !== y &&
                                  "END-DATE" !== y &&
                                  "END-ON-NEXT" !== y
                                ) {
                                  var k = s[b];
                                  if (k)
                                    h && !r.durationKnown && (k.endTime = f);
                                  else {
                                    var E = i.attr[b];
                                    (k = new v(u, f, "")),
                                      O(b) &&
                                        ((m = E),
                                        (E = Uint8Array.from(
                                          m
                                            .replace(/^0x/, "")
                                            .replace(
                                              /([\da-fA-F]{2}) ?/g,
                                              "0x$1 "
                                            )
                                            .replace(/ +$/, "")
                                            .split(" ")
                                        ).buffer)),
                                      (k.value = { key: b, data: E }),
                                      (k.type = "com.apple.quicktime.HLS"),
                                      (k.id = t),
                                      n.id3Track.addCue(k),
                                      (s[b] = k);
                                  }
                                }
                              }
                              e[t] = {
                                cues: s,
                                dateRange: i,
                                durationKnown: h,
                              };
                            },
                            p = 0;
                          p < o.length;
                          p++
                        )
                          d();
                      }
                    }
                  }),
                  t
                );
              })(),
              xi = (function () {
                function t(t) {
                  var i = this;
                  (this.hls = void 0),
                    (this.config = void 0),
                    (this.media = null),
                    (this.levelDetails = null),
                    (this.currentTime = 0),
                    (this.stallCount = 0),
                    (this.T = null),
                    (this.timeupdateHandler = function () {
                      return i.timeupdate();
                    }),
                    (this.hls = t),
                    (this.config = t.config),
                    this.registerListeners();
                }
                var i = t.prototype;
                return (
                  (i.destroy = function () {
                    this.unregisterListeners(),
                      this.onMediaDetaching(),
                      (this.levelDetails = null),
                      (this.hls = this.timeupdateHandler = null);
                  }),
                  (i.registerListeners = function () {
                    this.hls.on(w.MEDIA_ATTACHED, this.onMediaAttached, this),
                      this.hls.on(
                        w.MEDIA_DETACHING,
                        this.onMediaDetaching,
                        this
                      ),
                      this.hls.on(
                        w.MANIFEST_LOADING,
                        this.onManifestLoading,
                        this
                      ),
                      this.hls.on(w.LEVEL_UPDATED, this.onLevelUpdated, this),
                      this.hls.on(w.ERROR, this.onError, this);
                  }),
                  (i.unregisterListeners = function () {
                    this.hls.off(w.MEDIA_ATTACHED, this.onMediaAttached, this),
                      this.hls.off(
                        w.MEDIA_DETACHING,
                        this.onMediaDetaching,
                        this
                      ),
                      this.hls.off(
                        w.MANIFEST_LOADING,
                        this.onManifestLoading,
                        this
                      ),
                      this.hls.off(w.LEVEL_UPDATED, this.onLevelUpdated, this),
                      this.hls.off(w.ERROR, this.onError, this);
                  }),
                  (i.onMediaAttached = function (t, i) {
                    (this.media = i.media),
                      this.media.addEventListener(
                        "timeupdate",
                        this.timeupdateHandler
                      );
                  }),
                  (i.onMediaDetaching = function () {
                    this.media &&
                      (this.media.removeEventListener(
                        "timeupdate",
                        this.timeupdateHandler
                      ),
                      (this.media = null));
                  }),
                  (i.onManifestLoading = function () {
                    (this.levelDetails = null),
                      (this.T = null),
                      (this.stallCount = 0);
                  }),
                  (i.onLevelUpdated = function (t, i) {
                    var n = i.details;
                    (this.levelDetails = n),
                      n.advanced && this.timeupdate(),
                      !n.live &&
                        this.media &&
                        this.media.removeEventListener(
                          "timeupdate",
                          this.timeupdateHandler
                        );
                  }),
                  (i.onError = function (t, i) {
                    var n;
                    i.details === k.BUFFER_STALLED_ERROR &&
                      (this.stallCount++,
                      null != (n = this.levelDetails) &&
                        n.live &&
                        A.warn(
                          "[playback-rate-controller]: Stall detected, adjusting target latency"
                        ));
                  }),
                  (i.timeupdate = function () {
                    var t = this.media,
                      i = this.levelDetails;
                    if (t && i) {
                      this.currentTime = t.currentTime;
                      var n = this.computeLatency();
                      if (null !== n) {
                        this.T = n;
                        var r = this.config,
                          e = r.lowLatencyMode,
                          s = r.maxLiveSyncPlaybackRate;
                        if (e && 1 !== s) {
                          var a = this.targetLatency;
                          if (null !== a) {
                            var o = n - a,
                              h =
                                o <
                                Math.min(this.maxLatency, a + i.targetduration);
                            if (
                              i.live &&
                              h &&
                              o > 0.05 &&
                              this.forwardBufferLength > 1
                            ) {
                              var u = Math.min(2, Math.max(1, s)),
                                f =
                                  Math.round(
                                    (2 /
                                      (1 +
                                        Math.exp(
                                          -0.75 * o - this.edgeStalled
                                        ))) *
                                      20
                                  ) / 20;
                              t.playbackRate = Math.min(u, Math.max(1, f));
                            } else
                              1 !== t.playbackRate &&
                                0 !== t.playbackRate &&
                                (t.playbackRate = 1);
                          }
                        }
                      }
                    }
                  }),
                  (i.estimateLiveEdge = function () {
                    var t = this.levelDetails;
                    return null === t ? null : t.edge + t.age;
                  }),
                  (i.computeLatency = function () {
                    var t = this.estimateLiveEdge();
                    return null === t ? null : t - this.currentTime;
                  }),
                  s(t, [
                    {
                      key: "latency",
                      get: function () {
                        return this.T || 0;
                      },
                    },
                    {
                      key: "maxLatency",
                      get: function () {
                        var t = this.config,
                          i = this.levelDetails;
                        return void 0 !== t.liveMaxLatencyDuration
                          ? t.liveMaxLatencyDuration
                          : i
                          ? t.liveMaxLatencyDurationCount * i.targetduration
                          : 0;
                      },
                    },
                    {
                      key: "targetLatency",
                      get: function () {
                        var t = this.levelDetails;
                        if (null === t) return null;
                        var i = t.holdBack,
                          n = t.partHoldBack,
                          r = t.targetduration,
                          e = this.config,
                          s = e.liveSyncDuration,
                          a = e.liveSyncDurationCount,
                          o = e.lowLatencyMode,
                          h = this.hls.userConfig,
                          u = (o && n) || i;
                        (h.liveSyncDuration ||
                          h.liveSyncDurationCount ||
                          0 === u) &&
                          (u = void 0 !== s ? s : a * r);
                        var f = r;
                        return u + Math.min(1 * this.stallCount, f);
                      },
                    },
                    {
                      key: "liveSyncPosition",
                      get: function () {
                        var t = this.estimateLiveEdge(),
                          i = this.targetLatency,
                          n = this.levelDetails;
                        if (null === t || null === i || null === n) return null;
                        var r = n.edge,
                          e = t - i - this.edgeStalled,
                          s = r - n.totalduration,
                          a =
                            r -
                            ((this.config.lowLatencyMode && n.partTarget) ||
                              n.targetduration);
                        return Math.min(Math.max(s, e), a);
                      },
                    },
                    {
                      key: "drift",
                      get: function () {
                        var t = this.levelDetails;
                        return null === t ? 1 : t.drift;
                      },
                    },
                    {
                      key: "edgeStalled",
                      get: function () {
                        var t = this.levelDetails;
                        if (null === t) return 0;
                        var i =
                          3 *
                          ((this.config.lowLatencyMode && t.partTarget) ||
                            t.targetduration);
                        return Math.max(t.age - i, 0);
                      },
                    },
                    {
                      key: "forwardBufferLength",
                      get: function () {
                        var t = this.media,
                          i = this.levelDetails;
                        if (!t || !i) return 0;
                        var n = t.buffered.length;
                        return (
                          (n ? t.buffered.end(n - 1) : i.edge) -
                          this.currentTime
                        );
                      },
                    },
                  ]),
                  t
                );
              })(),
              Si = ["NONE", "TYPE-0", "TYPE-1", null],
              Ai = (function () {
                function t(t, i, n) {
                  (this.msn = void 0),
                    (this.part = void 0),
                    (this.skip = void 0),
                    (this.msn = t),
                    (this.part = i),
                    (this.skip = n);
                }
                return (
                  (t.prototype.addDirectives = function (t) {
                    var i = new self.URL(t);
                    return (
                      void 0 !== this.msn &&
                        i.searchParams.set("_HLS_msn", this.msn.toString()),
                      void 0 !== this.part &&
                        i.searchParams.set("_HLS_part", this.part.toString()),
                      this.skip && i.searchParams.set("_HLS_skip", this.skip),
                      i.href
                    );
                  }),
                  t
                );
              })(),
              Mi = (function () {
                function t(t) {
                  (this.S = void 0),
                    (this.audioCodec = void 0),
                    (this.bitrate = void 0),
                    (this.codecSet = void 0),
                    (this.height = void 0),
                    (this.id = void 0),
                    (this.name = void 0),
                    (this.videoCodec = void 0),
                    (this.width = void 0),
                    (this.unknownCodecs = void 0),
                    (this.audioGroupIds = void 0),
                    (this.details = void 0),
                    (this.fragmentError = 0),
                    (this.loadError = 0),
                    (this.loaded = void 0),
                    (this.realBitrate = 0),
                    (this.textGroupIds = void 0),
                    (this.url = void 0),
                    (this.A = 0),
                    (this.url = [t.url]),
                    (this.S = [t.attrs]),
                    (this.bitrate = t.bitrate),
                    t.details && (this.details = t.details),
                    (this.id = t.id || 0),
                    (this.name = t.name),
                    (this.width = t.width || 0),
                    (this.height = t.height || 0),
                    (this.audioCodec = t.audioCodec),
                    (this.videoCodec = t.videoCodec),
                    (this.unknownCodecs = t.unknownCodecs),
                    (this.codecSet = [t.videoCodec, t.audioCodec]
                      .filter(function (t) {
                        return t;
                      })
                      .join(",")
                      .replace(/\.[^.,]+/g, ""));
                }
                return (
                  (t.prototype.addFallback = function (t) {
                    this.url.push(t.url), this.S.push(t.attrs);
                  }),
                  s(t, [
                    {
                      key: "maxBitrate",
                      get: function () {
                        return Math.max(this.realBitrate, this.bitrate);
                      },
                    },
                    {
                      key: "attrs",
                      get: function () {
                        return this.S[this.A];
                      },
                    },
                    {
                      key: "pathwayId",
                      get: function () {
                        return this.attrs["PATHWAY-ID"] || ".";
                      },
                    },
                    {
                      key: "uri",
                      get: function () {
                        return this.url[this.A] || "";
                      },
                    },
                    {
                      key: "urlId",
                      get: function () {
                        return this.A;
                      },
                      set: function (t) {
                        var i = t % this.url.length;
                        this.A !== i &&
                          ((this.fragmentError = 0),
                          (this.loadError = 0),
                          (this.details = void 0),
                          (this.A = i));
                      },
                    },
                    {
                      key: "audioGroupId",
                      get: function () {
                        var t;
                        return null == (t = this.audioGroupIds)
                          ? void 0
                          : t[this.urlId];
                      },
                    },
                    {
                      key: "textGroupId",
                      get: function () {
                        var t;
                        return null == (t = this.textGroupIds)
                          ? void 0
                          : t[this.urlId];
                      },
                    },
                  ]),
                  t
                );
              })();
            function Di(t, i) {
              var n = i.startPTS;
              if (g(n)) {
                var r,
                  e = 0;
                i.sn > t.sn
                  ? ((e = n - t.start), (r = t))
                  : ((e = t.start - n), (r = i)),
                  r.duration !== e && (r.duration = e);
              } else
                i.sn > t.sn
                  ? t.cc === i.cc && t.minEndPTS
                    ? (i.start = t.start + (t.minEndPTS - t.start))
                    : (i.start = t.start + t.duration)
                  : (i.start = Math.max(t.start - i.duration, 0));
            }
            function _i(t, i, n, r, e, s) {
              r - n <= 0 &&
                (A.warn("Fragment should have a positive duration", i),
                (r = n + i.duration),
                (s = e + i.duration));
              var a = n,
                o = r,
                h = i.startPTS,
                u = i.endPTS;
              if (g(h)) {
                var f = Math.abs(h - n);
                g(i.deltaPTS)
                  ? (i.deltaPTS = Math.max(f, i.deltaPTS))
                  : (i.deltaPTS = f),
                  (a = Math.max(n, h)),
                  (n = Math.min(n, h)),
                  (e = Math.min(e, i.startDTS)),
                  (o = Math.min(r, u)),
                  (r = Math.max(r, u)),
                  (s = Math.max(s, i.endDTS));
              }
              var l = n - i.start;
              0 !== i.start && (i.start = n),
                (i.duration = r - i.start),
                (i.startPTS = n),
                (i.maxStartPTS = a),
                (i.startDTS = e),
                (i.endPTS = r),
                (i.minEndPTS = o),
                (i.endDTS = s);
              var c,
                v = i.sn;
              if (!t || v < t.startSN || v > t.endSN) return 0;
              var d = v - t.startSN,
                p = t.fragments;
              for (p[d] = i, c = d; c > 0; c--) Di(p[c], p[c - 1]);
              for (c = d; c < p.length - 1; c++) Di(p[c], p[c + 1]);
              return (
                t.fragmentHint && Di(p[p.length - 1], t.fragmentHint),
                (t.PTSKnown = t.alignedSliding = !0),
                l
              );
            }
            function Oi(t, i) {
              for (
                var n = null, r = t.fragments, e = r.length - 1;
                e >= 0;
                e--
              ) {
                var s = r[e].initSegment;
                if (s) {
                  n = s;
                  break;
                }
              }
              t.fragmentHint && delete t.fragmentHint.endPTS;
              var a,
                h,
                u,
                f,
                l,
                c = 0;
              if (
                ((function (t, i, n) {
                  for (
                    var r = i.skippedSegments,
                      e = Math.max(t.startSN, i.startSN) - i.startSN,
                      s =
                        (t.fragmentHint ? 1 : 0) +
                        (r ? i.endSN : Math.min(t.endSN, i.endSN)) -
                        i.startSN,
                      a = i.startSN - t.startSN,
                      o = i.fragmentHint
                        ? i.fragments.concat(i.fragmentHint)
                        : i.fragments,
                      h = t.fragmentHint
                        ? t.fragments.concat(t.fragmentHint)
                        : t.fragments,
                      u = e;
                    u <= s;
                    u++
                  ) {
                    var f = h[a + u],
                      l = o[u];
                    r && !l && u < r && (l = i.fragments[u] = f),
                      f && l && n(f, l);
                  }
                })(t, i, function (t, r) {
                  t.relurl && (c = t.cc - r.cc),
                    g(t.startPTS) &&
                      g(t.endPTS) &&
                      ((r.start = r.startPTS = t.startPTS),
                      (r.startDTS = t.startDTS),
                      (r.maxStartPTS = t.maxStartPTS),
                      (r.endPTS = t.endPTS),
                      (r.endDTS = t.endDTS),
                      (r.minEndPTS = t.minEndPTS),
                      (r.duration = t.endPTS - t.startPTS),
                      r.duration && (a = r),
                      (i.PTSKnown = i.alignedSliding = !0)),
                    (r.elementaryStreams = t.elementaryStreams),
                    (r.loader = t.loader),
                    (r.stats = t.stats),
                    (r.urlId = t.urlId),
                    t.initSegment &&
                      ((r.initSegment = t.initSegment), (n = t.initSegment));
                }),
                n &&
                  (i.fragmentHint
                    ? i.fragments.concat(i.fragmentHint)
                    : i.fragments
                  ).forEach(function (t) {
                    var i;
                    (t.initSegment &&
                      t.initSegment.relurl !==
                        (null == (i = n) ? void 0 : i.relurl)) ||
                      (t.initSegment = n);
                  }),
                i.skippedSegments)
              )
                if (
                  ((i.deltaUpdateFailed = i.fragments.some(function (t) {
                    return !t;
                  })),
                  i.deltaUpdateFailed)
                ) {
                  A.warn(
                    "[level-helper] Previous playlist missing segments skipped in delta playlist"
                  );
                  for (var v = i.skippedSegments; v--; ) i.fragments.shift();
                  (i.startSN = i.fragments[0].sn),
                    (i.startCC = i.fragments[0].cc);
                } else
                  i.canSkipDateRanges &&
                    (i.dateRanges =
                      ((h = t.dateRanges),
                      (u = i.dateRanges),
                      (f = i.recentlyRemovedDateranges),
                      (l = o({}, h)),
                      f &&
                        f.forEach(function (t) {
                          delete l[t];
                        }),
                      Object.keys(u).forEach(function (t) {
                        var i = new R(u[t].attr, l[t]);
                        i.isValid
                          ? (l[t] = i)
                          : A.warn(
                              'Ignoring invalid Playlist Delta Update DATERANGE tag: "' +
                                JSON.stringify(u[t].attr) +
                                '"'
                            );
                      }),
                      l));
              var d = i.fragments;
              if (c) {
                A.warn(
                  "discontinuity sliding from playlist, take drift into account"
                );
                for (var p = 0; p < d.length; p++) d[p].cc += c;
              }
              i.skippedSegments && (i.startCC = i.fragments[0].cc),
                (function (t, i, n) {
                  if (t && i)
                    for (var r = 0, e = 0, s = t.length; e <= s; e++) {
                      var a = t[e],
                        o = i[e + r];
                      a &&
                      o &&
                      a.index === o.index &&
                      a.fragment.sn === o.fragment.sn
                        ? n(a, o)
                        : r--;
                    }
                })(t.partList, i.partList, function (t, i) {
                  (i.elementaryStreams = t.elementaryStreams),
                    (i.stats = t.stats);
                }),
                a
                  ? _i(i, a, a.startPTS, a.endPTS, a.startDTS, a.endDTS)
                  : Ri(t, i),
                d.length && (i.totalduration = i.edge - d[0].start),
                (i.driftStartTime = t.driftStartTime),
                (i.driftStart = t.driftStart);
              var m = i.advancedDateTime;
              if (i.advanced && m) {
                var y = i.edge;
                i.driftStart || ((i.driftStartTime = m), (i.driftStart = y)),
                  (i.driftEndTime = m),
                  (i.driftEnd = y);
              } else
                (i.driftEndTime = t.driftEndTime),
                  (i.driftEnd = t.driftEnd),
                  (i.advancedDateTime = t.advancedDateTime);
            }
            function Ri(t, i) {
              var n = i.startSN + i.skippedSegments - t.startSN,
                r = t.fragments;
              n < 0 || n >= r.length || Li(i, r[n].start);
            }
            function Li(t, i) {
              if (i) {
                for (
                  var n = t.fragments, r = t.skippedSegments;
                  r < n.length;
                  r++
                )
                  n[r].start += i;
                t.fragmentHint && (t.fragmentHint.start += i);
              }
            }
            function Ii(t, i, n) {
              var r;
              return null != t && t.details
                ? Pi(null == (r = t.details) ? void 0 : r.partList, i, n)
                : null;
            }
            function Pi(t, i, n) {
              if (t)
                for (var r = t.length; r--; ) {
                  var e = t[r];
                  if (e.index === n && e.fragment.sn === i) return e;
                }
              return null;
            }
            function Ci(t) {
              switch (t.details) {
                case k.FRAG_LOAD_TIMEOUT:
                case k.KEY_LOAD_TIMEOUT:
                case k.LEVEL_LOAD_TIMEOUT:
                case k.MANIFEST_LOAD_TIMEOUT:
                  return !0;
              }
              return !1;
            }
            function Ni(t, i) {
              var n = Ci(i);
              return t.default[(n ? "timeout" : "error") + "Retry"];
            }
            function Ui(t, i) {
              var n = "linear" === t.backoff ? 1 : Math.pow(2, i);
              return Math.min(n * t.retryDelayMs, t.maxRetryDelayMs);
            }
            function Fi(t) {
              return r(r({}, t), { errorRetry: null, timeoutRetry: null });
            }
            function ji(t, i, n, r) {
              return (
                !!t &&
                i < t.maxNumRetry &&
                ((function (t) {
                  return (
                    (0 === t && !1 === navigator.onLine) ||
                    (!!t && (t < 400 || t > 499))
                  );
                })(r) ||
                  !!n)
              );
            }
            var Bi = function (t, i) {
              for (var n = 0, r = t.length - 1, e = null, s = null; n <= r; ) {
                var a = i((s = t[(e = ((n + r) / 2) | 0)]));
                if (a > 0) n = e + 1;
                else {
                  if (!(a < 0)) return s;
                  r = e - 1;
                }
              }
              return null;
            };
            function Xi(t, i, n, r) {
              void 0 === n && (n = 0), void 0 === r && (r = 0);
              var e = null;
              if (
                (t
                  ? (e = i[t.sn - i[0].sn + 1] || null)
                  : 0 === n && 0 === i[0].start && (e = i[0]),
                e && 0 === Yi(n, r, e))
              )
                return e;
              var s = Bi(i, Yi.bind(null, n, r));
              return !s || (s === t && e) ? e : s;
            }
            function Yi(t, i, n) {
              if (
                (void 0 === t && (t = 0),
                void 0 === i && (i = 0),
                n.start <= t && n.start + n.duration > t)
              )
                return 0;
              var r = Math.min(i, n.duration + (n.deltaPTS ? n.deltaPTS : 0));
              return n.start + n.duration - r <= t
                ? 1
                : n.start - r > t && n.start
                ? -1
                : 0;
            }
            function $i(t, i, n) {
              var r =
                1e3 * Math.min(i, n.duration + (n.deltaPTS ? n.deltaPTS : 0));
              return (n.endProgramDateTime || 0) - r > t;
            }
            var Hi,
              Vi = (function () {
                function t(t) {
                  (this.hls = void 0),
                    (this.playlistError = 0),
                    (this.penalizedRenditions = {}),
                    (this.log = void 0),
                    (this.warn = void 0),
                    (this.error = void 0),
                    (this.hls = t),
                    (this.log = A.log.bind(A, "[info]:")),
                    (this.warn = A.warn.bind(A, "[warning]:")),
                    (this.error = A.error.bind(A, "[error]:")),
                    this.registerListeners();
                }
                var i = t.prototype;
                return (
                  (i.registerListeners = function () {
                    var t = this.hls;
                    t.on(w.ERROR, this.onError, this),
                      t.on(w.MANIFEST_LOADING, this.onManifestLoading, this),
                      t.on(w.LEVEL_UPDATED, this.onLevelUpdated, this);
                  }),
                  (i.unregisterListeners = function () {
                    var t = this.hls;
                    t &&
                      (t.off(w.ERROR, this.onError, this),
                      t.off(w.ERROR, this.onErrorOut, this),
                      t.off(w.MANIFEST_LOADING, this.onManifestLoading, this),
                      t.off(w.LEVEL_UPDATED, this.onLevelUpdated, this));
                  }),
                  (i.destroy = function () {
                    this.unregisterListeners(),
                      (this.hls = null),
                      (this.penalizedRenditions = {});
                  }),
                  (i.startLoad = function (t) {
                    this.playlistError = 0;
                  }),
                  (i.stopLoad = function () {}),
                  (i.getVariantLevelIndex = function (t) {
                    return (null == t ? void 0 : t.type) === hi
                      ? t.level
                      : this.hls.loadLevel;
                  }),
                  (i.onManifestLoading = function () {
                    (this.playlistError = 0), (this.penalizedRenditions = {});
                  }),
                  (i.onLevelUpdated = function () {
                    this.playlistError = 0;
                  }),
                  (i.onError = function (t, i) {
                    var n;
                    if (!i.fatal) {
                      var r = this.hls,
                        e = i.context;
                      switch (i.details) {
                        case k.FRAG_LOAD_ERROR:
                        case k.FRAG_LOAD_TIMEOUT:
                        case k.KEY_LOAD_ERROR:
                        case k.KEY_LOAD_TIMEOUT:
                          return void (i.errorAction =
                            this.getFragRetryOrSwitchAction(i));
                        case k.FRAG_GAP:
                        case k.FRAG_PARSING_ERROR:
                        case k.FRAG_DECRYPT_ERROR:
                          return (
                            (i.errorAction =
                              this.getFragRetryOrSwitchAction(i)),
                            void (i.errorAction.action = 2)
                          );
                        case k.LEVEL_EMPTY_ERROR:
                        case k.LEVEL_PARSING_ERROR:
                          var s,
                            a,
                            o = i.parent === hi ? i.level : r.loadLevel;
                          return void (i.details === k.LEVEL_EMPTY_ERROR &&
                          null != (s = i.context) &&
                          null != (a = s.levelDetails) &&
                          a.live
                            ? (i.errorAction =
                                this.getPlaylistRetryOrSwitchAction(i, o))
                            : ((i.levelRetry = !1),
                              (i.errorAction = this.getLevelSwitchAction(
                                i,
                                o
                              ))));
                        case k.LEVEL_LOAD_ERROR:
                        case k.LEVEL_LOAD_TIMEOUT:
                          return void (
                            "number" == typeof (null == e ? void 0 : e.level) &&
                            (i.errorAction =
                              this.getPlaylistRetryOrSwitchAction(i, e.level))
                          );
                        case k.AUDIO_TRACK_LOAD_ERROR:
                        case k.AUDIO_TRACK_LOAD_TIMEOUT:
                        case k.SUBTITLE_LOAD_ERROR:
                        case k.SUBTITLE_TRACK_LOAD_TIMEOUT:
                          if (e) {
                            var h = r.levels[r.loadLevel];
                            if (
                              h &&
                              ((e.type === ai &&
                                e.groupId === h.audioGroupId) ||
                                (e.type === oi && e.groupId === h.textGroupId))
                            )
                              return (
                                (i.errorAction =
                                  this.getPlaylistRetryOrSwitchAction(
                                    i,
                                    r.loadLevel
                                  )),
                                (i.errorAction.action = 2),
                                void (i.errorAction.flags = 1)
                              );
                          }
                          return;
                        case k.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:
                          var u = r.levels[r.loadLevel],
                            f = null == u ? void 0 : u.attrs["HDCP-LEVEL"];
                          return void (
                            f &&
                            (i.errorAction = {
                              action: 2,
                              flags: 2,
                              hdcpLevel: f,
                            })
                          );
                        case k.BUFFER_ADD_CODEC_ERROR:
                        case k.REMUX_ALLOC_ERROR:
                          return void (i.errorAction =
                            this.getLevelSwitchAction(
                              i,
                              null != (n = i.level) ? n : r.loadLevel
                            ));
                        case k.INTERNAL_EXCEPTION:
                        case k.BUFFER_APPENDING_ERROR:
                        case k.BUFFER_APPEND_ERROR:
                        case k.BUFFER_FULL_ERROR:
                        case k.LEVEL_SWITCH_ERROR:
                        case k.BUFFER_STALLED_ERROR:
                        case k.BUFFER_SEEK_OVER_HOLE:
                        case k.BUFFER_NUDGE_ON_STALL:
                          return void (i.errorAction = { action: 0, flags: 0 });
                      }
                      if (i.type === b.KEY_SYSTEM_ERROR) {
                        var l = this.getVariantLevelIndex(i.frag);
                        return (
                          (i.levelRetry = !1),
                          void (i.errorAction = this.getLevelSwitchAction(i, l))
                        );
                      }
                    }
                  }),
                  (i.getPlaylistRetryOrSwitchAction = function (t, i) {
                    var n,
                      r = Ni(this.hls.config.playlistLoadPolicy, t),
                      e = this.playlistError++,
                      s = null == (n = t.response) ? void 0 : n.code;
                    if (ji(r, e, Ci(t), s))
                      return {
                        action: 5,
                        flags: 0,
                        retryConfig: r,
                        retryCount: e,
                      };
                    var a = this.getLevelSwitchAction(t, i);
                    return r && ((a.retryConfig = r), (a.retryCount = e)), a;
                  }),
                  (i.getFragRetryOrSwitchAction = function (t) {
                    var i = this.hls,
                      n = this.getVariantLevelIndex(t.frag),
                      r = i.levels[n],
                      e = i.config,
                      s = e.fragLoadPolicy,
                      a = e.keyLoadPolicy,
                      o = Ni(t.details.startsWith("key") ? a : s, t),
                      h = i.levels.reduce(function (t, i) {
                        return t + i.fragmentError;
                      }, 0);
                    if (r) {
                      var u;
                      t.details !== k.FRAG_GAP && r.fragmentError++;
                      var f = null == (u = t.response) ? void 0 : u.code;
                      if (ji(o, h, Ci(t), f))
                        return {
                          action: 5,
                          flags: 0,
                          retryConfig: o,
                          retryCount: h,
                        };
                    }
                    var l = this.getLevelSwitchAction(t, n);
                    return o && ((l.retryConfig = o), (l.retryCount = h)), l;
                  }),
                  (i.getLevelSwitchAction = function (t, i) {
                    var n = this.hls;
                    null == i && (i = n.loadLevel);
                    var r = this.hls.levels[i];
                    if (r && (r.loadError++, n.autoLevelEnabled)) {
                      for (
                        var e,
                          s,
                          a = -1,
                          o = n.levels,
                          h = null == (e = t.frag) ? void 0 : e.type,
                          u = null != (s = t.context) ? s : {},
                          f = u.type,
                          l = u.groupId,
                          c = o.length;
                        c--;

                      ) {
                        var v = (c + n.loadLevel) % o.length;
                        if (v !== n.loadLevel && 0 === o[v].loadError) {
                          var d = o[v];
                          if (t.details === k.FRAG_GAP && t.frag) {
                            var p = o[v].details;
                            if (p) {
                              var m = Xi(t.frag, p.fragments, t.frag.start);
                              if (null != m && m.gap) continue;
                            }
                          } else {
                            if (
                              (f === ai && l === d.audioGroupId) ||
                              (f === oi && l === d.textGroupId)
                            )
                              continue;
                            if (
                              (h === ui && r.audioGroupId === d.audioGroupId) ||
                              (h === fi && r.textGroupId === d.textGroupId)
                            )
                              continue;
                          }
                          a = v;
                          break;
                        }
                      }
                      if (a > -1 && n.loadLevel !== a)
                        return (
                          (t.levelRetry = !0),
                          (this.playlistError = 0),
                          { action: 2, flags: 0, nextAutoLevel: a }
                        );
                    }
                    return { action: 2, flags: 1 };
                  }),
                  (i.onErrorOut = function (t, i) {
                    var n;
                    switch (null == (n = i.errorAction) ? void 0 : n.action) {
                      case 0:
                        break;
                      case 2:
                        this.sendAlternateToPenaltyBox(i),
                          i.errorAction.resolved ||
                            i.details === k.FRAG_GAP ||
                            (i.fatal = !0);
                    }
                    i.fatal && this.hls.stopLoad();
                  }),
                  (i.sendAlternateToPenaltyBox = function (t) {
                    var i = this.hls,
                      n = t.errorAction;
                    if (n) {
                      var r = n.flags,
                        e = n.hdcpLevel,
                        s = n.nextAutoLevel;
                      switch (r) {
                        case 0:
                          this.switchLevel(t, s);
                          break;
                        case 1:
                          n.resolved ||
                            (n.resolved = this.redundantFailover(t));
                          break;
                        case 2:
                          e &&
                            ((i.maxHdcpLevel = Si[Si.indexOf(e) - 1]),
                            (n.resolved = !0)),
                            this.warn(
                              'Restricting playback to HDCP-LEVEL of "' +
                                i.maxHdcpLevel +
                                '" or lower'
                            );
                      }
                      n.resolved || this.switchLevel(t, s);
                    }
                  }),
                  (i.switchLevel = function (t, i) {
                    void 0 !== i &&
                      t.errorAction &&
                      (this.warn(
                        "switching to level " + i + " after " + t.details
                      ),
                      (this.hls.nextAutoLevel = i),
                      (t.errorAction.resolved = !0),
                      (this.hls.nextLoadLevel = this.hls.nextAutoLevel));
                  }),
                  (i.redundantFailover = function (t) {
                    var i = this,
                      n = this.hls,
                      r = this.penalizedRenditions,
                      e = t.parent === hi ? t.level : n.loadLevel,
                      s = n.levels[e],
                      a = s.url.length,
                      o = t.frag ? t.frag.urlId : s.urlId;
                    s.urlId !== o ||
                      (t.frag && !s.details) ||
                      this.penalizeRendition(s, t);
                    for (
                      var h = function () {
                          var h = (o + u) % a,
                            f = r[h];
                          if (
                            !f ||
                            (function (t, i, n) {
                              if (performance.now() - t.lastErrorPerfMs > 3e5)
                                return !0;
                              var r = t.details;
                              if (i.details === k.FRAG_GAP && r && i.frag) {
                                var e = i.frag.start,
                                  s = Xi(null, r.fragments, e);
                                if (s && !s.gap) return !0;
                              }
                              if (n && t.errors.length < n.errors.length) {
                                var a = t.errors[t.errors.length - 1];
                                if (
                                  r &&
                                  a.frag &&
                                  i.frag &&
                                  Math.abs(a.frag.start - i.frag.start) >
                                    3 * r.targetduration
                                )
                                  return !0;
                              }
                              return !1;
                            })(f, t, r[o])
                          )
                            return (
                              i.warn(
                                "Switching to Redundant Stream " +
                                  (h + 1) +
                                  "/" +
                                  a +
                                  ': "' +
                                  s.url[h] +
                                  '" after ' +
                                  t.details
                              ),
                              (i.playlistError = 0),
                              n.levels.forEach(function (t) {
                                t.urlId = h;
                              }),
                              (n.nextLoadLevel = e),
                              { v: !0 }
                            );
                        },
                        u = 1;
                      u < a;
                      u++
                    ) {
                      var f = h();
                      if ("object" == typeof f) return f.v;
                    }
                    return !1;
                  }),
                  (i.penalizeRendition = function (t, i) {
                    var n = this.penalizedRenditions,
                      r = n[t.urlId] || {
                        lastErrorPerfMs: 0,
                        errors: [],
                        details: void 0,
                      };
                    (r.lastErrorPerfMs = performance.now()),
                      r.errors.push(i),
                      (r.details = t.details),
                      (n[t.urlId] = r);
                  }),
                  t
                );
              })(),
              Gi = (function () {
                function t(t, i) {
                  (this.hls = void 0),
                    (this.timer = -1),
                    (this.requestScheduled = -1),
                    (this.canLoad = !1),
                    (this.log = void 0),
                    (this.warn = void 0),
                    (this.log = A.log.bind(A, i + ":")),
                    (this.warn = A.warn.bind(A, i + ":")),
                    (this.hls = t);
                }
                var i = t.prototype;
                return (
                  (i.destroy = function () {
                    this.clearTimer(), (this.hls = this.log = this.warn = null);
                  }),
                  (i.clearTimer = function () {
                    clearTimeout(this.timer), (this.timer = -1);
                  }),
                  (i.startLoad = function () {
                    (this.canLoad = !0),
                      (this.requestScheduled = -1),
                      this.loadPlaylist();
                  }),
                  (i.stopLoad = function () {
                    (this.canLoad = !1), this.clearTimer();
                  }),
                  (i.switchParams = function (t, i) {
                    var n = null == i ? void 0 : i.renditionReports;
                    if (n) {
                      for (var r = -1, e = 0; e < n.length; e++) {
                        var s = n[e],
                          a = void 0;
                        try {
                          a = new self.URL(s.URI, i.url).href;
                        } catch (t) {
                          A.warn(
                            "Could not construct new URL for Rendition Report: " +
                              t
                          ),
                            (a = s.URI || "");
                        }
                        if (a === t) {
                          r = e;
                          break;
                        }
                        a === t.substring(0, a.length) && (r = e);
                      }
                      if (-1 !== r) {
                        var o = n[r],
                          h =
                            parseInt(o["LAST-MSN"]) ||
                            (null == i ? void 0 : i.lastPartSn),
                          u =
                            parseInt(o["LAST-PART"]) ||
                            (null == i ? void 0 : i.lastPartIndex);
                        if (this.hls.config.lowLatencyMode) {
                          var f = Math.min(
                            i.age - i.partTarget,
                            i.targetduration
                          );
                          u >= 0 && f > i.partTarget && (u += 1);
                        }
                        return new Ai(h, u >= 0 ? u : void 0, "");
                      }
                    }
                  }),
                  (i.loadPlaylist = function (t) {
                    -1 === this.requestScheduled &&
                      (this.requestScheduled = self.performance.now());
                  }),
                  (i.shouldLoadPlaylist = function (t) {
                    return (
                      this.canLoad &&
                      !!t &&
                      !!t.url &&
                      (!t.details || t.details.live)
                    );
                  }),
                  (i.shouldReloadPlaylist = function (t) {
                    return (
                      -1 === this.timer &&
                      -1 === this.requestScheduled &&
                      this.shouldLoadPlaylist(t)
                    );
                  }),
                  (i.playlistLoaded = function (t, i, n) {
                    var r = this,
                      e = i.details,
                      s = i.stats,
                      a = self.performance.now(),
                      o = s.loading.first
                        ? Math.max(0, a - s.loading.first)
                        : 0;
                    if (
                      ((e.advancedDateTime = Date.now() - o),
                      e.live || (null != n && n.live))
                    ) {
                      if (
                        (e.reloaded(n),
                        n &&
                          this.log(
                            "live playlist " +
                              t +
                              " " +
                              (e.advanced
                                ? "REFRESHED " +
                                  e.lastPartSn +
                                  "-" +
                                  e.lastPartIndex
                                : "MISSED")
                          ),
                        n && e.fragments.length > 0 && Oi(n, e),
                        !this.canLoad || !e.live)
                      )
                        return;
                      var h,
                        u = void 0,
                        f = void 0;
                      if (e.canBlockReload && e.endSN && e.advanced) {
                        var l = this.hls.config.lowLatencyMode,
                          c = e.lastPartSn,
                          v = e.endSN,
                          d = e.lastPartIndex,
                          p = c === v;
                        -1 !== d
                          ? ((u = p ? v + 1 : c), (f = p ? (l ? 0 : d) : d + 1))
                          : (u = v + 1);
                        var m = e.age,
                          y = m + e.ageHeader,
                          g = Math.min(
                            y - e.partTarget,
                            1.5 * e.targetduration
                          );
                        if (g > 0) {
                          if (n && g > n.tuneInGoal)
                            this.warn(
                              "CDN Tune-in goal increased from: " +
                                n.tuneInGoal +
                                " to: " +
                                g +
                                " with playlist age: " +
                                e.age
                            ),
                              (g = 0);
                          else {
                            var w = Math.floor(g / e.targetduration);
                            (u += w),
                              void 0 !== f &&
                                (f += Math.round(
                                  (g % e.targetduration) / e.partTarget
                                )),
                              this.log(
                                "CDN Tune-in age: " +
                                  e.ageHeader +
                                  "s last advanced " +
                                  m.toFixed(2) +
                                  "s goal: " +
                                  g +
                                  " skip sn " +
                                  w +
                                  " to part " +
                                  f
                              );
                          }
                          e.tuneInGoal = g;
                        }
                        if (
                          ((h = this.getDeliveryDirectives(
                            e,
                            i.deliveryDirectives,
                            u,
                            f
                          )),
                          l || !p)
                        )
                          return void this.loadPlaylist(h);
                      } else
                        e.canBlockReload &&
                          (h = this.getDeliveryDirectives(
                            e,
                            i.deliveryDirectives,
                            u,
                            f
                          ));
                      var b = this.hls.mainForwardBufferInfo,
                        k = b ? b.end - b.len : 0,
                        E = (function (t, i) {
                          void 0 === i && (i = 1 / 0);
                          var n = 1e3 * t.targetduration;
                          if (t.updated) {
                            var r = t.fragments;
                            if (r.length && 4 * n > i) {
                              var e = 1e3 * r[r.length - 1].duration;
                              e < n && (n = e);
                            }
                          } else n /= 2;
                          return Math.round(n);
                        })(e, 1e3 * (e.edge - k));
                      e.updated &&
                        a > this.requestScheduled + E &&
                        (this.requestScheduled = s.loading.start),
                        void 0 !== u && e.canBlockReload
                          ? (this.requestScheduled =
                              s.loading.first + E - (1e3 * e.partTarget || 1e3))
                          : -1 === this.requestScheduled ||
                            this.requestScheduled + E < a
                          ? (this.requestScheduled = a)
                          : this.requestScheduled - a <= 0 &&
                            (this.requestScheduled += E);
                      var T = this.requestScheduled - a;
                      (T = Math.max(0, T)),
                        this.log(
                          "reload live playlist " +
                            t +
                            " in " +
                            Math.round(T) +
                            " ms"
                        ),
                        (this.timer = self.setTimeout(function () {
                          return r.loadPlaylist(h);
                        }, T));
                    } else this.clearTimer();
                  }),
                  (i.getDeliveryDirectives = function (t, i, n, r) {
                    var e = (function (t, i) {
                      var n = t.canSkipUntil,
                        r = t.canSkipDateRanges,
                        e = t.endSN;
                      return n && (void 0 !== i ? i - e : 0) < n
                        ? r
                          ? "v2"
                          : "YES"
                        : "";
                    })(t, n);
                    return (
                      null != i &&
                        i.skip &&
                        t.deltaUpdateFailed &&
                        ((n = i.msn), (r = i.part), (e = "")),
                      new Ai(n, r, e)
                    );
                  }),
                  (i.checkRetry = function (t) {
                    var i = this,
                      n = t.details,
                      r = Ci(t),
                      e = t.errorAction,
                      s = e || {},
                      a = s.action,
                      o = s.retryCount,
                      h = void 0 === o ? 0 : o,
                      u = s.retryConfig,
                      f = !!e && !!u && (5 === a || (!e.resolved && 2 === a));
                    if (f) {
                      var l;
                      if (((this.requestScheduled = -1), h >= u.maxNumRetry))
                        return !1;
                      if (r && null != (l = t.context) && l.deliveryDirectives)
                        this.warn(
                          "Retrying playlist loading " +
                            (h + 1) +
                            "/" +
                            u.maxNumRetry +
                            ' after "' +
                            n +
                            '" without delivery-directives'
                        ),
                          this.loadPlaylist();
                      else {
                        var c = Ui(u, h);
                        (this.timer = self.setTimeout(function () {
                          return i.loadPlaylist();
                        }, c)),
                          this.warn(
                            "Retrying playlist loading " +
                              (h + 1) +
                              "/" +
                              u.maxNumRetry +
                              ' after "' +
                              n +
                              '" in ' +
                              c +
                              "ms"
                          );
                      }
                      (t.levelRetry = !0), (e.resolved = !0);
                    }
                    return f;
                  }),
                  t
                );
              })(),
              Wi = (function (t) {
                function i(i, n) {
                  var r;
                  return (
                    ((r = t.call(this, i, "[level-controller]") || this).M =
                      []),
                    (r.D = -1),
                    (r._ = void 0),
                    (r.currentLevel = null),
                    (r.currentLevelIndex = -1),
                    (r.manualLevelIndex = -1),
                    (r.steering = void 0),
                    (r.onParsedComplete = void 0),
                    (r.steering = n),
                    r.m(),
                    r
                  );
                }
                h(i, t);
                var n = i.prototype;
                return (
                  (n.m = function () {
                    var t = this.hls;
                    t.on(w.MANIFEST_LOADING, this.onManifestLoading, this),
                      t.on(w.MANIFEST_LOADED, this.onManifestLoaded, this),
                      t.on(w.LEVEL_LOADED, this.onLevelLoaded, this),
                      t.on(w.LEVELS_UPDATED, this.onLevelsUpdated, this),
                      t.on(
                        w.AUDIO_TRACK_SWITCHED,
                        this.onAudioTrackSwitched,
                        this
                      ),
                      t.on(w.FRAG_LOADED, this.onFragLoaded, this),
                      t.on(w.ERROR, this.onError, this);
                  }),
                  (n.k = function () {
                    var t = this.hls;
                    t.off(w.MANIFEST_LOADING, this.onManifestLoading, this),
                      t.off(w.MANIFEST_LOADED, this.onManifestLoaded, this),
                      t.off(w.LEVEL_LOADED, this.onLevelLoaded, this),
                      t.off(w.LEVELS_UPDATED, this.onLevelsUpdated, this),
                      t.off(
                        w.AUDIO_TRACK_SWITCHED,
                        this.onAudioTrackSwitched,
                        this
                      ),
                      t.off(w.FRAG_LOADED, this.onFragLoaded, this),
                      t.off(w.ERROR, this.onError, this);
                  }),
                  (n.destroy = function () {
                    this.k(),
                      (this.steering = null),
                      this.resetLevels(),
                      t.prototype.destroy.call(this);
                  }),
                  (n.startLoad = function () {
                    this.M.forEach(function (t) {
                      (t.loadError = 0), (t.fragmentError = 0);
                    }),
                      t.prototype.startLoad.call(this);
                  }),
                  (n.resetLevels = function () {
                    (this._ = void 0),
                      (this.manualLevelIndex = -1),
                      (this.currentLevelIndex = -1),
                      (this.currentLevel = null),
                      (this.M = []);
                  }),
                  (n.onManifestLoading = function (t, i) {
                    this.resetLevels();
                  }),
                  (n.onManifestLoaded = function (t, i) {
                    var n,
                      r = [],
                      e = {};
                    i.levels.forEach(function (t) {
                      var i,
                        s = t.attrs;
                      -1 !==
                        (null == (i = t.audioCodec)
                          ? void 0
                          : i.indexOf("mp4a.40.34")) &&
                        (Hi ||
                          (Hi = /chrome|firefox/i.test(navigator.userAgent)),
                        Hi && (t.audioCodec = void 0));
                      var a = s.AUDIO,
                        o = s.CODECS,
                        h = s["FRAME-RATE"],
                        u = s["PATHWAY-ID"],
                        f = s.RESOLUTION,
                        l = s.SUBTITLES,
                        c =
                          (u || ".") +
                          "-" +
                          t.bitrate +
                          "-" +
                          f +
                          "-" +
                          h +
                          "-" +
                          o;
                      (n = e[c])
                        ? n.addFallback(t)
                        : ((n = new Mi(t)), (e[c] = n), r.push(n)),
                        Ki(n, "audio", a),
                        Ki(n, "text", l);
                    }),
                      this.filterAndSortMediaOptions(r, i);
                  }),
                  (n.filterAndSortMediaOptions = function (t, i) {
                    var n = this,
                      r = [],
                      e = [],
                      s = !1,
                      a = !1,
                      o = !1,
                      h = t.filter(function (t) {
                        var i = t.audioCodec,
                          n = t.videoCodec,
                          r = t.width,
                          e = t.height,
                          h = t.unknownCodecs;
                        return (
                          s || (s = !(!r || !e)),
                          a || (a = !!n),
                          o || (o = !!i),
                          !(null != h && h.length) &&
                            (!i || Ht(i, "audio")) &&
                            (!n || Ht(n, "video"))
                        );
                      });
                    if (
                      ((s || a) &&
                        o &&
                        (h = h.filter(function (t) {
                          var i = t.videoCodec,
                            n = t.width,
                            r = t.height;
                          return !!i || !(!n || !r);
                        })),
                      0 !== h.length)
                    ) {
                      i.audioTracks &&
                        zi(
                          (r = i.audioTracks.filter(function (t) {
                            return !t.audioCodec || Ht(t.audioCodec, "audio");
                          }))
                        ),
                        i.subtitles && zi((e = i.subtitles));
                      var u = h.slice(0);
                      h.sort(function (t, i) {
                        return t.attrs["HDCP-LEVEL"] !== i.attrs["HDCP-LEVEL"]
                          ? (t.attrs["HDCP-LEVEL"] || "") >
                            (i.attrs["HDCP-LEVEL"] || "")
                            ? 1
                            : -1
                          : t.bitrate !== i.bitrate
                          ? t.bitrate - i.bitrate
                          : t.attrs["FRAME-RATE"] !== i.attrs["FRAME-RATE"]
                          ? t.attrs.decimalFloatingPoint("FRAME-RATE") -
                            i.attrs.decimalFloatingPoint("FRAME-RATE")
                          : t.attrs.SCORE !== i.attrs.SCORE
                          ? t.attrs.decimalFloatingPoint("SCORE") -
                            i.attrs.decimalFloatingPoint("SCORE")
                          : s && t.height !== i.height
                          ? t.height - i.height
                          : 0;
                      });
                      var f = u[0];
                      if (
                        this.steering &&
                        (h = this.steering.filterParsedLevels(h)).length !==
                          u.length
                      )
                        for (var l = 0; l < u.length; l++)
                          if (u[l].pathwayId === h[0].pathwayId) {
                            f = u[l];
                            break;
                          }
                      this.M = h;
                      for (var c = 0; c < h.length; c++)
                        if (h[c] === f) {
                          (this.D = c),
                            this.log(
                              "manifest loaded, " +
                                h.length +
                                " level(s) found, first bitrate: " +
                                f.bitrate
                            );
                          break;
                        }
                      var v = o && !a,
                        d = {
                          levels: h,
                          audioTracks: r,
                          subtitleTracks: e,
                          sessionData: i.sessionData,
                          sessionKeys: i.sessionKeys,
                          firstLevel: this.D,
                          stats: i.stats,
                          audio: o,
                          video: a,
                          altAudio:
                            !v &&
                            r.some(function (t) {
                              return !!t.url;
                            }),
                        };
                      this.hls.trigger(w.MANIFEST_PARSED, d),
                        (this.hls.config.autoStartLoad ||
                          this.hls.forceStartLoad) &&
                          this.hls.startLoad(this.hls.config.startPosition);
                    } else
                      Promise.resolve().then(function () {
                        if (n.hls) {
                          var t = new Error(
                            "no level with compatible codecs found in manifest"
                          );
                          n.hls.trigger(w.ERROR, {
                            type: b.MEDIA_ERROR,
                            details: k.MANIFEST_INCOMPATIBLE_CODECS_ERROR,
                            fatal: !0,
                            url: i.url,
                            error: t,
                            reason: t.message,
                          });
                        }
                      });
                  }),
                  (n.onError = function (t, i) {
                    !i.fatal &&
                      i.context &&
                      i.context.type === si &&
                      i.context.level === this.level &&
                      this.checkRetry(i);
                  }),
                  (n.onFragLoaded = function (t, i) {
                    var n = i.frag;
                    if (void 0 !== n && n.type === hi) {
                      var r = this.M[n.level];
                      void 0 !== r && (r.loadError = 0);
                    }
                  }),
                  (n.onLevelLoaded = function (t, i) {
                    var n,
                      r,
                      e = i.level,
                      s = i.details,
                      a = this.M[e];
                    if (!a)
                      return (
                        this.warn("Invalid level index " + e),
                        void (
                          null != (r = i.deliveryDirectives) &&
                          r.skip &&
                          (s.deltaUpdateFailed = !0)
                        )
                      );
                    e === this.currentLevelIndex
                      ? (0 === a.fragmentError && (a.loadError = 0),
                        this.playlistLoaded(e, i, a.details))
                      : null != (n = i.deliveryDirectives) &&
                        n.skip &&
                        (s.deltaUpdateFailed = !0);
                  }),
                  (n.onAudioTrackSwitched = function (t, i) {
                    var n = this.currentLevel;
                    if (n) {
                      var r = this.hls.audioTracks[i.id].groupId;
                      if (n.audioGroupIds && n.audioGroupId !== r) {
                        for (var e = -1, s = 0; s < n.audioGroupIds.length; s++)
                          if (n.audioGroupIds[s] === r) {
                            e = s;
                            break;
                          }
                        -1 !== e &&
                          e !== n.urlId &&
                          ((n.urlId = e), this.canLoad && this.startLoad());
                      }
                    }
                  }),
                  (n.loadPlaylist = function (i) {
                    t.prototype.loadPlaylist.call(this);
                    var n = this.currentLevelIndex,
                      r = this.currentLevel;
                    if (r && this.shouldLoadPlaylist(r)) {
                      var e = r.urlId,
                        s = r.uri;
                      if (i)
                        try {
                          s = i.addDirectives(s);
                        } catch (t) {
                          this.warn(
                            "Could not construct new URL with HLS Delivery Directives: " +
                              t
                          );
                        }
                      var a = r.attrs["PATHWAY-ID"];
                      this.log(
                        "Loading level index " +
                          n +
                          (void 0 !== (null == i ? void 0 : i.msn)
                            ? " at sn " + i.msn + " part " + i.part
                            : "") +
                          " with" +
                          (a ? " Pathway " + a : "") +
                          " URI " +
                          (e + 1) +
                          "/" +
                          r.url.length +
                          " " +
                          s
                      ),
                        this.clearTimer(),
                        this.hls.trigger(w.LEVEL_LOADING, {
                          url: s,
                          level: n,
                          id: e,
                          deliveryDirectives: i || null,
                        });
                    }
                  }),
                  (n.removeLevel = function (t, i) {
                    var n = this,
                      r = function (t, n) {
                        return n !== i;
                      },
                      e = this.M.filter(function (e, s) {
                        return (
                          s !== t ||
                          (e.url.length > 1 && void 0 !== i
                            ? ((e.url = e.url.filter(r)),
                              e.audioGroupIds &&
                                (e.audioGroupIds = e.audioGroupIds.filter(r)),
                              e.textGroupIds &&
                                (e.textGroupIds = e.textGroupIds.filter(r)),
                              (e.urlId = 0),
                              !0)
                            : (n.steering && n.steering.removeLevel(e), !1))
                        );
                      });
                    this.hls.trigger(w.LEVELS_UPDATED, { levels: e });
                  }),
                  (n.onLevelsUpdated = function (t, i) {
                    var n = i.levels;
                    n.forEach(function (t, i) {
                      var n = t.details;
                      null != n &&
                        n.fragments &&
                        n.fragments.forEach(function (t) {
                          t.level = i;
                        });
                    }),
                      (this.M = n);
                  }),
                  s(i, [
                    {
                      key: "levels",
                      get: function () {
                        return 0 === this.M.length ? null : this.M;
                      },
                    },
                    {
                      key: "level",
                      get: function () {
                        return this.currentLevelIndex;
                      },
                      set: function (t) {
                        var i = this.M;
                        if (0 !== i.length) {
                          if (t < 0 || t >= i.length) {
                            var n = new Error("invalid level idx"),
                              r = t < 0;
                            if (
                              (this.hls.trigger(w.ERROR, {
                                type: b.OTHER_ERROR,
                                details: k.LEVEL_SWITCH_ERROR,
                                level: t,
                                fatal: r,
                                error: n,
                                reason: n.message,
                              }),
                              r)
                            )
                              return;
                            t = Math.min(t, i.length - 1);
                          }
                          var e = this.currentLevelIndex,
                            s = this.currentLevel,
                            a = s ? s.attrs["PATHWAY-ID"] : void 0,
                            h = i[t],
                            u = h.attrs["PATHWAY-ID"];
                          if (
                            ((this.currentLevelIndex = t),
                            (this.currentLevel = h),
                            e !== t || !h.details || !s || a !== u)
                          ) {
                            this.log(
                              "Switching to level " +
                                t +
                                (u ? " with Pathway " + u : "") +
                                " from level " +
                                e +
                                (a ? " with Pathway " + a : "")
                            );
                            var f = o({}, h, {
                              level: t,
                              maxBitrate: h.maxBitrate,
                              attrs: h.attrs,
                              uri: h.uri,
                              urlId: h.urlId,
                            });
                            delete f.S,
                              delete f.A,
                              this.hls.trigger(w.LEVEL_SWITCHING, f);
                            var l = h.details;
                            if (!l || l.live) {
                              var c = this.switchParams(
                                h.uri,
                                null == s ? void 0 : s.details
                              );
                              this.loadPlaylist(c);
                            }
                          }
                        }
                      },
                    },
                    {
                      key: "manualLevel",
                      get: function () {
                        return this.manualLevelIndex;
                      },
                      set: function (t) {
                        (this.manualLevelIndex = t),
                          void 0 === this._ && (this._ = t),
                          -1 !== t && (this.level = t);
                      },
                    },
                    {
                      key: "firstLevel",
                      get: function () {
                        return this.D;
                      },
                      set: function (t) {
                        this.D = t;
                      },
                    },
                    {
                      key: "startLevel",
                      get: function () {
                        if (void 0 === this._) {
                          var t = this.hls.config.startLevel;
                          return void 0 !== t ? t : this.D;
                        }
                        return this._;
                      },
                      set: function (t) {
                        this._ = t;
                      },
                    },
                    {
                      key: "nextLoadLevel",
                      get: function () {
                        return -1 !== this.manualLevelIndex
                          ? this.manualLevelIndex
                          : this.hls.nextAutoLevel;
                      },
                      set: function (t) {
                        (this.level = t),
                          -1 === this.manualLevelIndex &&
                            (this.hls.nextAutoLevel = t);
                      },
                    },
                  ]),
                  i
                );
              })(Gi);
            function Ki(t, i, n) {
              n &&
                ("audio" === i
                  ? (t.audioGroupIds || (t.audioGroupIds = []),
                    (t.audioGroupIds[t.url.length - 1] = n))
                  : "text" === i &&
                    (t.textGroupIds || (t.textGroupIds = []),
                    (t.textGroupIds[t.url.length - 1] = n)));
            }
            function zi(t) {
              var i = {};
              t.forEach(function (t) {
                var n = t.groupId || "";
                (t.id = i[n] = i[n] || 0), i[n]++;
              });
            }
            var qi = "NOT_LOADED",
              Ji = "APPENDING",
              Qi = "PARTIAL",
              Zi = "OK",
              tn = (function () {
                function t(t) {
                  (this.activePartLists = Object.create(null)),
                    (this.endListFragments = Object.create(null)),
                    (this.fragments = Object.create(null)),
                    (this.timeRanges = Object.create(null)),
                    (this.bufferPadding = 0.2),
                    (this.hls = void 0),
                    (this.hasGaps = !1),
                    (this.hls = t),
                    this.m();
                }
                var i = t.prototype;
                return (
                  (i.m = function () {
                    var t = this.hls;
                    t.on(w.BUFFER_APPENDED, this.onBufferAppended, this),
                      t.on(w.FRAG_BUFFERED, this.onFragBuffered, this),
                      t.on(w.FRAG_LOADED, this.onFragLoaded, this);
                  }),
                  (i.k = function () {
                    var t = this.hls;
                    t.off(w.BUFFER_APPENDED, this.onBufferAppended, this),
                      t.off(w.FRAG_BUFFERED, this.onFragBuffered, this),
                      t.off(w.FRAG_LOADED, this.onFragLoaded, this);
                  }),
                  (i.destroy = function () {
                    this.k(),
                      (this.fragments =
                        this.activePartLists =
                        this.endListFragments =
                        this.timeRanges =
                          null);
                  }),
                  (i.getAppendedFrag = function (t, i) {
                    var n = this.activePartLists[i];
                    if (n)
                      for (var r = n.length; r--; ) {
                        var e = n[r];
                        if (!e) break;
                        var s = e.end;
                        if (e.start <= t && null !== s && t <= s) return e;
                      }
                    return this.getBufferedFrag(t, i);
                  }),
                  (i.getBufferedFrag = function (t, i) {
                    for (
                      var n = this.fragments, r = Object.keys(n), e = r.length;
                      e--;

                    ) {
                      var s = n[r[e]];
                      if (
                        (null == s ? void 0 : s.body.type) === i &&
                        s.buffered
                      ) {
                        var a = s.body;
                        if (a.start <= t && t <= a.end) return a;
                      }
                    }
                    return null;
                  }),
                  (i.detectEvictedFragments = function (t, i, n, r) {
                    var e = this;
                    this.timeRanges && (this.timeRanges[t] = i);
                    var s = (null == r ? void 0 : r.fragment.sn) || -1;
                    Object.keys(this.fragments).forEach(function (r) {
                      var a = e.fragments[r];
                      if (a && !(s >= a.body.sn))
                        if (a.buffered || a.loaded) {
                          var o = a.range[t];
                          o &&
                            o.time.some(function (t) {
                              var n = !e.isTimeBuffered(
                                t.startPTS,
                                t.endPTS,
                                i
                              );
                              return n && e.removeFragment(a.body), n;
                            });
                        } else a.body.type === n && e.removeFragment(a.body);
                    });
                  }),
                  (i.detectPartialFragments = function (t) {
                    var i = this,
                      n = this.timeRanges,
                      r = t.frag,
                      e = t.part;
                    if (n && "initSegment" !== r.sn) {
                      var s = rn(r),
                        a = this.fragments[s];
                      if (a) {
                        var o = !r.relurl;
                        Object.keys(n).forEach(function (t) {
                          var s = r.elementaryStreams[t];
                          if (s) {
                            var h = n[t],
                              u = o || !0 === s.partial;
                            a.range[t] = i.getBufferedTimes(r, e, u, h);
                          }
                        }),
                          (a.loaded = null),
                          Object.keys(a.range).length
                            ? ((a.buffered = !0),
                              a.body.endList &&
                                (this.endListFragments[a.body.type] = a),
                              nn(a) || this.removeParts(r.sn - 1, r.type))
                            : this.removeFragment(a.body);
                      }
                    }
                  }),
                  (i.removeParts = function (t, i) {
                    var n = this.activePartLists[i];
                    n &&
                      (this.activePartLists[i] = n.filter(function (i) {
                        return i.fragment.sn >= t;
                      }));
                  }),
                  (i.fragBuffered = function (t, i) {
                    var n = rn(t),
                      r = this.fragments[n];
                    !r &&
                      i &&
                      ((r = this.fragments[n] =
                        {
                          body: t,
                          appendedPTS: null,
                          loaded: null,
                          buffered: !1,
                          range: Object.create(null),
                        }),
                      t.gap && (this.hasGaps = !0)),
                      r && ((r.loaded = null), (r.buffered = !0));
                  }),
                  (i.getBufferedTimes = function (t, i, n, r) {
                    for (
                      var e = { time: [], partial: n },
                        s = t.start,
                        a = t.end,
                        o = t.minEndPTS || a,
                        h = t.maxStartPTS || s,
                        u = 0;
                      u < r.length;
                      u++
                    ) {
                      var f = r.start(u) - this.bufferPadding,
                        l = r.end(u) + this.bufferPadding;
                      if (h >= f && o <= l) {
                        e.time.push({
                          startPTS: Math.max(s, r.start(u)),
                          endPTS: Math.min(a, r.end(u)),
                        });
                        break;
                      }
                      if (s < l && a > f)
                        (e.partial = !0),
                          e.time.push({
                            startPTS: Math.max(s, r.start(u)),
                            endPTS: Math.min(a, r.end(u)),
                          });
                      else if (a <= f) break;
                    }
                    return e;
                  }),
                  (i.getPartialFragment = function (t) {
                    var i,
                      n,
                      r,
                      e = null,
                      s = 0,
                      a = this.bufferPadding,
                      o = this.fragments;
                    return (
                      Object.keys(o).forEach(function (h) {
                        var u = o[h];
                        u &&
                          nn(u) &&
                          ((n = u.body.start - a),
                          (r = u.body.end + a),
                          t >= n &&
                            t <= r &&
                            ((i = Math.min(t - n, r - t)),
                            s <= i && ((e = u.body), (s = i))));
                      }),
                      e
                    );
                  }),
                  (i.isEndListAppended = function (t) {
                    var i = this.endListFragments[t];
                    return void 0 !== i && (i.buffered || nn(i));
                  }),
                  (i.getState = function (t) {
                    var i = rn(t),
                      n = this.fragments[i];
                    return n ? (n.buffered ? (nn(n) ? Qi : Zi) : Ji) : qi;
                  }),
                  (i.isTimeBuffered = function (t, i, n) {
                    for (var r, e, s = 0; s < n.length; s++) {
                      if (
                        ((r = n.start(s) - this.bufferPadding),
                        (e = n.end(s) + this.bufferPadding),
                        t >= r && i <= e)
                      )
                        return !0;
                      if (i <= r) return !1;
                    }
                    return !1;
                  }),
                  (i.onFragLoaded = function (t, i) {
                    var n = i.frag,
                      r = i.part;
                    if ("initSegment" !== n.sn && !n.bitrateTest) {
                      var e = r ? null : i,
                        s = rn(n);
                      this.fragments[s] = {
                        body: n,
                        appendedPTS: null,
                        loaded: e,
                        buffered: !1,
                        range: Object.create(null),
                      };
                    }
                  }),
                  (i.onBufferAppended = function (t, i) {
                    var n = this,
                      r = i.frag,
                      e = i.part,
                      s = i.timeRanges;
                    if ("initSegment" !== r.sn) {
                      var a = r.type;
                      if (e) {
                        var o = this.activePartLists[a];
                        o || (this.activePartLists[a] = o = []), o.push(e);
                      }
                      (this.timeRanges = s),
                        Object.keys(s).forEach(function (t) {
                          var i = s[t];
                          n.detectEvictedFragments(t, i, a, e);
                        });
                    }
                  }),
                  (i.onFragBuffered = function (t, i) {
                    this.detectPartialFragments(i);
                  }),
                  (i.hasFragment = function (t) {
                    var i = rn(t);
                    return !!this.fragments[i];
                  }),
                  (i.hasParts = function (t) {
                    var i;
                    return !(
                      null == (i = this.activePartLists[t]) || !i.length
                    );
                  }),
                  (i.removeFragmentsInRange = function (t, i, n, r, e) {
                    var s = this;
                    (r && !this.hasGaps) ||
                      Object.keys(this.fragments).forEach(function (a) {
                        var o = s.fragments[a];
                        if (o) {
                          var h = o.body;
                          h.type !== n ||
                            (r && !h.gap) ||
                            (h.start < i &&
                              h.end > t &&
                              (o.buffered || e) &&
                              s.removeFragment(h));
                        }
                      });
                  }),
                  (i.removeFragment = function (t) {
                    var i = rn(t);
                    (t.stats.loaded = 0), t.clearElementaryStreamInfo();
                    var n = this.activePartLists[t.type];
                    if (n) {
                      var r = t.sn;
                      this.activePartLists[t.type] = n.filter(function (t) {
                        return t.fragment.sn !== r;
                      });
                    }
                    delete this.fragments[i],
                      t.endList && delete this.endListFragments[t.type];
                  }),
                  (i.removeAllFragments = function () {
                    (this.fragments = Object.create(null)),
                      (this.endListFragments = Object.create(null)),
                      (this.activePartLists = Object.create(null)),
                      (this.hasGaps = !1);
                  }),
                  t
                );
              })();
            function nn(t) {
              var i, n, r;
              return (
                t.buffered &&
                (t.body.gap ||
                  (null == (i = t.range.video) ? void 0 : i.partial) ||
                  (null == (n = t.range.audio) ? void 0 : n.partial) ||
                  (null == (r = t.range.audiovideo) ? void 0 : r.partial))
              );
            }
            function rn(t) {
              return t.type + "_" + t.level + "_" + t.urlId + "_" + t.sn;
            }
            var en = Math.pow(2, 17),
              sn = (function () {
                function t(t) {
                  (this.config = void 0),
                    (this.loader = null),
                    (this.partLoadTimeout = -1),
                    (this.config = t);
                }
                var i = t.prototype;
                return (
                  (i.destroy = function () {
                    this.loader &&
                      (this.loader.destroy(), (this.loader = null));
                  }),
                  (i.abort = function () {
                    this.loader && this.loader.abort();
                  }),
                  (i.load = function (t, i) {
                    var n = this,
                      e = t.url;
                    if (!e)
                      return Promise.reject(
                        new hn({
                          type: b.NETWORK_ERROR,
                          details: k.FRAG_LOAD_ERROR,
                          fatal: !1,
                          frag: t,
                          error: new Error(
                            "Fragment does not have a " +
                              (e ? "part list" : "url")
                          ),
                          networkDetails: null,
                        })
                      );
                    this.abort();
                    var s = this.config,
                      a = s.fLoader,
                      o = s.loader;
                    return new Promise(function (h, u) {
                      if ((n.loader && n.loader.destroy(), t.gap)) u(on(t));
                      else {
                        var f = (n.loader = t.loader = a ? new a(s) : new o(s)),
                          l = an(t),
                          c = Fi(s.fragLoadPolicy.default),
                          v = {
                            loadPolicy: c,
                            timeout: c.maxLoadTimeMs,
                            maxRetry: 0,
                            retryDelay: 0,
                            maxRetryDelay: 0,
                            highWaterMark: "initSegment" === t.sn ? 1 / 0 : en,
                          };
                        (t.stats = f.stats),
                          f.load(l, v, {
                            onSuccess: function (i, r, e, s) {
                              n.resetLoader(t, f);
                              var a = i.data;
                              e.resetIV &&
                                t.decryptdata &&
                                ((t.decryptdata.iv = new Uint8Array(
                                  a.slice(0, 16)
                                )),
                                (a = a.slice(16))),
                                h({
                                  frag: t,
                                  part: null,
                                  payload: a,
                                  networkDetails: s,
                                });
                            },
                            onError: function (i, s, a, o) {
                              n.resetLoader(t, f),
                                u(
                                  new hn({
                                    type: b.NETWORK_ERROR,
                                    details: k.FRAG_LOAD_ERROR,
                                    fatal: !1,
                                    frag: t,
                                    response: r({ url: e, data: void 0 }, i),
                                    error: new Error(
                                      "HTTP Error " + i.code + " " + i.text
                                    ),
                                    networkDetails: a,
                                    stats: o,
                                  })
                                );
                            },
                            onAbort: function (i, r, e) {
                              n.resetLoader(t, f),
                                u(
                                  new hn({
                                    type: b.NETWORK_ERROR,
                                    details: k.INTERNAL_ABORTED,
                                    fatal: !1,
                                    frag: t,
                                    error: new Error("Aborted"),
                                    networkDetails: e,
                                    stats: i,
                                  })
                                );
                            },
                            onTimeout: function (i, r, e) {
                              n.resetLoader(t, f),
                                u(
                                  new hn({
                                    type: b.NETWORK_ERROR,
                                    details: k.FRAG_LOAD_TIMEOUT,
                                    fatal: !1,
                                    frag: t,
                                    error: new Error(
                                      "Timeout after " + v.timeout + "ms"
                                    ),
                                    networkDetails: e,
                                    stats: i,
                                  })
                                );
                            },
                            onProgress: function (n, r, e, s) {
                              i &&
                                i({
                                  frag: t,
                                  part: null,
                                  payload: e,
                                  networkDetails: s,
                                });
                            },
                          });
                      }
                    });
                  }),
                  (i.loadPart = function (t, i, n) {
                    var e = this;
                    this.abort();
                    var s = this.config,
                      a = s.fLoader,
                      o = s.loader;
                    return new Promise(function (h, u) {
                      if ((e.loader && e.loader.destroy(), t.gap || i.gap))
                        u(on(t, i));
                      else {
                        var f = (e.loader = t.loader = a ? new a(s) : new o(s)),
                          l = an(t, i),
                          c = Fi(s.fragLoadPolicy.default),
                          v = {
                            loadPolicy: c,
                            timeout: c.maxLoadTimeMs,
                            maxRetry: 0,
                            retryDelay: 0,
                            maxRetryDelay: 0,
                            highWaterMark: en,
                          };
                        (i.stats = f.stats),
                          f.load(l, v, {
                            onSuccess: function (r, s, a, o) {
                              e.resetLoader(t, f), e.updateStatsFromPart(t, i);
                              var u = {
                                frag: t,
                                part: i,
                                payload: r.data,
                                networkDetails: o,
                              };
                              n(u), h(u);
                            },
                            onError: function (n, s, a, o) {
                              e.resetLoader(t, f),
                                u(
                                  new hn({
                                    type: b.NETWORK_ERROR,
                                    details: k.FRAG_LOAD_ERROR,
                                    fatal: !1,
                                    frag: t,
                                    part: i,
                                    response: r(
                                      { url: l.url, data: void 0 },
                                      n
                                    ),
                                    error: new Error(
                                      "HTTP Error " + n.code + " " + n.text
                                    ),
                                    networkDetails: a,
                                    stats: o,
                                  })
                                );
                            },
                            onAbort: function (n, r, s) {
                              (t.stats.aborted = i.stats.aborted),
                                e.resetLoader(t, f),
                                u(
                                  new hn({
                                    type: b.NETWORK_ERROR,
                                    details: k.INTERNAL_ABORTED,
                                    fatal: !1,
                                    frag: t,
                                    part: i,
                                    error: new Error("Aborted"),
                                    networkDetails: s,
                                    stats: n,
                                  })
                                );
                            },
                            onTimeout: function (n, r, s) {
                              e.resetLoader(t, f),
                                u(
                                  new hn({
                                    type: b.NETWORK_ERROR,
                                    details: k.FRAG_LOAD_TIMEOUT,
                                    fatal: !1,
                                    frag: t,
                                    part: i,
                                    error: new Error(
                                      "Timeout after " + v.timeout + "ms"
                                    ),
                                    networkDetails: s,
                                    stats: n,
                                  })
                                );
                            },
                          });
                      }
                    });
                  }),
                  (i.updateStatsFromPart = function (t, i) {
                    var n = t.stats,
                      r = i.stats,
                      e = r.total;
                    if (((n.loaded += r.loaded), e)) {
                      var s = Math.round(t.duration / i.duration),
                        a = Math.min(Math.round(n.loaded / e), s),
                        o = (s - a) * Math.round(n.loaded / a);
                      n.total = n.loaded + o;
                    } else n.total = Math.max(n.loaded, n.total);
                    var h = n.loading,
                      u = r.loading;
                    h.start
                      ? (h.first += u.first - u.start)
                      : ((h.start = u.start), (h.first = u.first)),
                      (h.end = u.end);
                  }),
                  (i.resetLoader = function (t, i) {
                    (t.loader = null),
                      this.loader === i &&
                        (self.clearTimeout(this.partLoadTimeout),
                        (this.loader = null)),
                      i.destroy();
                  }),
                  t
                );
              })();
            function an(t, i) {
              void 0 === i && (i = null);
              var n = i || t,
                r = {
                  frag: t,
                  part: i,
                  responseType: "arraybuffer",
                  url: n.url,
                  headers: {},
                  rangeStart: 0,
                  rangeEnd: 0,
                },
                e = n.byteRangeStartOffset,
                s = n.byteRangeEndOffset;
              if (g(e) && g(s)) {
                var a,
                  o = e,
                  h = s;
                if (
                  "initSegment" === t.sn &&
                  "AES-128" ===
                    (null == (a = t.decryptdata) ? void 0 : a.method)
                ) {
                  var u = s - e;
                  u % 16 && (h = s + (16 - (u % 16))),
                    0 !== e && ((r.resetIV = !0), (o = e - 16));
                }
                (r.rangeStart = o), (r.rangeEnd = h);
              }
              return r;
            }
            function on(t, i) {
              var n = new Error(
                  "GAP " + (t.gap ? "tag" : "attribute") + " found"
                ),
                r = {
                  type: b.MEDIA_ERROR,
                  details: k.FRAG_GAP,
                  fatal: !1,
                  frag: t,
                  error: n,
                  networkDetails: null,
                };
              return (
                i && (r.part = i), ((i || t).stats.aborted = !0), new hn(r)
              );
            }
            var hn = (function (t) {
                function i(i) {
                  var n;
                  return (
                    ((n = t.call(this, i.error.message) || this).data = void 0),
                    (n.data = i),
                    n
                  );
                }
                return h(i, t), i;
              })(c(Error)),
              un = (function () {
                function t(t) {
                  (this.config = void 0),
                    (this.keyUriToKeyInfo = {}),
                    (this.emeController = null),
                    (this.config = t);
                }
                var i = t.prototype;
                return (
                  (i.abort = function (t) {
                    for (var i in this.keyUriToKeyInfo) {
                      var n = this.keyUriToKeyInfo[i].loader;
                      if (n) {
                        if (t && t !== n.context.frag.type) return;
                        n.abort();
                      }
                    }
                  }),
                  (i.detach = function () {
                    for (var t in this.keyUriToKeyInfo) {
                      var i = this.keyUriToKeyInfo[t];
                      (i.mediaKeySessionContext ||
                        i.decryptdata.isCommonEncryption) &&
                        delete this.keyUriToKeyInfo[t];
                    }
                  }),
                  (i.destroy = function () {
                    for (var t in (this.detach(), this.keyUriToKeyInfo)) {
                      var i = this.keyUriToKeyInfo[t].loader;
                      i && i.destroy();
                    }
                    this.keyUriToKeyInfo = {};
                  }),
                  (i.createKeyLoadError = function (t, i, n, r, e) {
                    return (
                      void 0 === i && (i = k.KEY_LOAD_ERROR),
                      new hn({
                        type: b.NETWORK_ERROR,
                        details: i,
                        fatal: !1,
                        frag: t,
                        response: e,
                        error: n,
                        networkDetails: r,
                      })
                    );
                  }),
                  (i.loadClear = function (t, i) {
                    var n = this;
                    if (this.emeController && this.config.emeEnabled)
                      for (
                        var r = t.sn,
                          e = t.cc,
                          s = function () {
                            var t = i[a];
                            if (
                              e <= t.cc &&
                              ("initSegment" === r ||
                                "initSegment" === t.sn ||
                                r < t.sn)
                            )
                              return (
                                n.emeController
                                  .selectKeySystemFormat(t)
                                  .then(function (i) {
                                    t.setKeyFormat(i);
                                  }),
                                "break"
                              );
                          },
                          a = 0;
                        a < i.length && "break" !== s();
                        a++
                      );
                  }),
                  (i.load = function (t) {
                    var i = this;
                    return !t.decryptdata && t.encrypted && this.emeController
                      ? this.emeController
                          .selectKeySystemFormat(t)
                          .then(function (n) {
                            return i.loadInternal(t, n);
                          })
                      : this.loadInternal(t);
                  }),
                  (i.loadInternal = function (t, i) {
                    var n, r;
                    i && t.setKeyFormat(i);
                    var e = t.decryptdata;
                    if (!e) {
                      var s = new Error(
                        i
                          ? "Expected frag.decryptdata to be defined after setting format " +
                            i
                          : "Missing decryption data on fragment in onKeyLoading"
                      );
                      return Promise.reject(
                        this.createKeyLoadError(t, k.KEY_LOAD_ERROR, s)
                      );
                    }
                    var a = e.uri;
                    if (!a)
                      return Promise.reject(
                        this.createKeyLoadError(
                          t,
                          k.KEY_LOAD_ERROR,
                          new Error('Invalid key URI: "' + a + '"')
                        )
                      );
                    var o,
                      h = this.keyUriToKeyInfo[a];
                    if (null != (n = h) && n.decryptdata.key)
                      return (
                        (e.key = h.decryptdata.key),
                        Promise.resolve({ frag: t, keyInfo: h })
                      );
                    if (null != (r = h) && r.keyLoadPromise)
                      switch (
                        null == (o = h.mediaKeySessionContext)
                          ? void 0
                          : o.keyStatus
                      ) {
                        case void 0:
                        case "status-pending":
                        case "usable":
                        case "usable-in-future":
                          return h.keyLoadPromise.then(function (i) {
                            return (
                              (e.key = i.keyInfo.decryptdata.key),
                              { frag: t, keyInfo: h }
                            );
                          });
                      }
                    switch (
                      ((h = this.keyUriToKeyInfo[a] =
                        {
                          decryptdata: e,
                          keyLoadPromise: null,
                          loader: null,
                          mediaKeySessionContext: null,
                        }),
                      e.method)
                    ) {
                      case "ISO-23001-7":
                      case "SAMPLE-AES":
                      case "SAMPLE-AES-CENC":
                      case "SAMPLE-AES-CTR":
                        return "identity" === e.keyFormat
                          ? this.loadKeyHTTP(h, t)
                          : this.loadKeyEME(h, t);
                      case "AES-128":
                        return this.loadKeyHTTP(h, t);
                      default:
                        return Promise.reject(
                          this.createKeyLoadError(
                            t,
                            k.KEY_LOAD_ERROR,
                            new Error(
                              'Key supplied with unsupported METHOD: "' +
                                e.method +
                                '"'
                            )
                          )
                        );
                    }
                  }),
                  (i.loadKeyEME = function (t, i) {
                    var n = { frag: i, keyInfo: t };
                    if (this.emeController && this.config.emeEnabled) {
                      var r = this.emeController.loadKey(n);
                      if (r)
                        return (t.keyLoadPromise = r.then(function (i) {
                          return (t.mediaKeySessionContext = i), n;
                        })).catch(function (i) {
                          throw ((t.keyLoadPromise = null), i);
                        });
                    }
                    return Promise.resolve(n);
                  }),
                  (i.loadKeyHTTP = function (t, i) {
                    var n = this,
                      e = this.config,
                      s = new (0, e.loader)(e);
                    return (
                      (i.keyLoader = t.loader = s),
                      (t.keyLoadPromise = new Promise(function (a, o) {
                        var h = {
                            keyInfo: t,
                            frag: i,
                            responseType: "arraybuffer",
                            url: t.decryptdata.uri,
                          },
                          u = e.keyLoadPolicy.default,
                          f = {
                            loadPolicy: u,
                            timeout: u.maxLoadTimeMs,
                            maxRetry: 0,
                            retryDelay: 0,
                            maxRetryDelay: 0,
                          },
                          l = {
                            onSuccess: function (t, i, r, e) {
                              var s = r.frag,
                                h = r.keyInfo,
                                u = r.url;
                              if (!s.decryptdata || h !== n.keyUriToKeyInfo[u])
                                return o(
                                  n.createKeyLoadError(
                                    s,
                                    k.KEY_LOAD_ERROR,
                                    new Error(
                                      "after key load, decryptdata unset or changed"
                                    ),
                                    e
                                  )
                                );
                              (h.decryptdata.key = s.decryptdata.key =
                                new Uint8Array(t.data)),
                                (s.keyLoader = null),
                                (h.loader = null),
                                a({ frag: s, keyInfo: h });
                            },
                            onError: function (t, e, s, a) {
                              n.resetLoader(e),
                                o(
                                  n.createKeyLoadError(
                                    i,
                                    k.KEY_LOAD_ERROR,
                                    new Error(
                                      "HTTP Error " +
                                        t.code +
                                        " loading key " +
                                        t.text
                                    ),
                                    s,
                                    r({ url: h.url, data: void 0 }, t)
                                  )
                                );
                            },
                            onTimeout: function (t, r, e) {
                              n.resetLoader(r),
                                o(
                                  n.createKeyLoadError(
                                    i,
                                    k.KEY_LOAD_TIMEOUT,
                                    new Error("key loading timed out"),
                                    e
                                  )
                                );
                            },
                            onAbort: function (t, r, e) {
                              n.resetLoader(r),
                                o(
                                  n.createKeyLoadError(
                                    i,
                                    k.INTERNAL_ABORTED,
                                    new Error("key loading aborted"),
                                    e
                                  )
                                );
                            },
                          };
                        s.load(h, f, l);
                      }))
                    );
                  }),
                  (i.resetLoader = function (t) {
                    var i = t.frag,
                      n = t.keyInfo,
                      r = t.url,
                      e = n.loader;
                    i.keyLoader === e &&
                      ((i.keyLoader = null), (n.loader = null)),
                      delete this.keyUriToKeyInfo[r],
                      e && e.destroy();
                  }),
                  t
                );
              })(),
              fn = (function () {
                function t() {
                  (this.O = void 0),
                    (this.R = null),
                    (this.L = null),
                    (this.I = 0),
                    (this.O = this.tick.bind(this));
                }
                var i = t.prototype;
                return (
                  (i.destroy = function () {
                    this.onHandlerDestroying(), this.onHandlerDestroyed();
                  }),
                  (i.onHandlerDestroying = function () {
                    this.clearNextTick(), this.clearInterval();
                  }),
                  (i.onHandlerDestroyed = function () {}),
                  (i.hasInterval = function () {
                    return !!this.L;
                  }),
                  (i.hasNextTick = function () {
                    return !!this.R;
                  }),
                  (i.setInterval = function (t) {
                    return (
                      !this.L &&
                      ((this.I = 0), (this.L = self.setInterval(this.O, t)), !0)
                    );
                  }),
                  (i.clearInterval = function () {
                    return (
                      !!this.L &&
                      (self.clearInterval(this.L), (this.L = null), !0)
                    );
                  }),
                  (i.clearNextTick = function () {
                    return (
                      !!this.R &&
                      (self.clearTimeout(this.R), (this.R = null), !0)
                    );
                  }),
                  (i.tick = function () {
                    this.I++,
                      1 === this.I &&
                        (this.doTick(),
                        this.I > 1 && this.tickImmediate(),
                        (this.I = 0));
                  }),
                  (i.tickImmediate = function () {
                    this.clearNextTick(), (this.R = self.setTimeout(this.O, 0));
                  }),
                  (i.doTick = function () {}),
                  t
                );
              })(),
              ln = {
                length: 0,
                start: function () {
                  return 0;
                },
                end: function () {
                  return 0;
                },
              },
              cn = (function () {
                function t() {}
                return (
                  (t.isBuffered = function (i, n) {
                    try {
                      if (i)
                        for (var r = t.getBuffered(i), e = 0; e < r.length; e++)
                          if (n >= r.start(e) && n <= r.end(e)) return !0;
                    } catch (t) {}
                    return !1;
                  }),
                  (t.bufferInfo = function (i, n, r) {
                    try {
                      if (i) {
                        var e,
                          s = t.getBuffered(i),
                          a = [];
                        for (e = 0; e < s.length; e++)
                          a.push({ start: s.start(e), end: s.end(e) });
                        return this.bufferedInfo(a, n, r);
                      }
                    } catch (t) {}
                    return { len: 0, start: n, end: n, nextStart: void 0 };
                  }),
                  (t.bufferedInfo = function (t, i, n) {
                    (i = Math.max(0, i)),
                      t.sort(function (t, i) {
                        return t.start - i.start || i.end - t.end;
                      });
                    var r = [];
                    if (n)
                      for (var e = 0; e < t.length; e++) {
                        var s = r.length;
                        if (s) {
                          var a = r[s - 1].end;
                          t[e].start - a < n
                            ? t[e].end > a && (r[s - 1].end = t[e].end)
                            : r.push(t[e]);
                        } else r.push(t[e]);
                      }
                    else r = t;
                    for (var o, h = 0, u = i, f = i, l = 0; l < r.length; l++) {
                      var c = r[l].start,
                        v = r[l].end;
                      if (i + n >= c && i < v) (u = c), (h = (f = v) - i);
                      else if (i + n < c) {
                        o = c;
                        break;
                      }
                    }
                    return { len: h, start: u || 0, end: f || 0, nextStart: o };
                  }),
                  (t.getBuffered = function (t) {
                    try {
                      return t.buffered;
                    } catch (t) {
                      return A.log("failed to get media.buffered", t), ln;
                    }
                  }),
                  t
                );
              })(),
              vn = function (t, i, n, r, e, s) {
                void 0 === r && (r = 0),
                  void 0 === e && (e = -1),
                  void 0 === s && (s = !1),
                  (this.level = void 0),
                  (this.sn = void 0),
                  (this.part = void 0),
                  (this.id = void 0),
                  (this.size = void 0),
                  (this.partial = void 0),
                  (this.transmuxing = {
                    start: 0,
                    executeStart: 0,
                    executeEnd: 0,
                    end: 0,
                  }),
                  (this.buffering = {
                    audio: { start: 0, executeStart: 0, executeEnd: 0, end: 0 },
                    video: { start: 0, executeStart: 0, executeEnd: 0, end: 0 },
                    audiovideo: {
                      start: 0,
                      executeStart: 0,
                      executeEnd: 0,
                      end: 0,
                    },
                  }),
                  (this.level = t),
                  (this.sn = i),
                  (this.id = n),
                  (this.size = r),
                  (this.part = e),
                  (this.partial = s);
              };
            function dn(t, i) {
              for (var n = null, r = 0, e = t.length; r < e; r++) {
                var s = t[r];
                if (s && s.cc === i) {
                  n = s;
                  break;
                }
              }
              return n;
            }
            function pn(t, i) {
              if (t) {
                var n = t.start + i;
                (t.start = t.startPTS = n), (t.endPTS = n + t.duration);
              }
            }
            function mn(t, i) {
              for (var n = i.fragments, r = 0, e = n.length; r < e; r++)
                pn(n[r], t);
              i.fragmentHint && pn(i.fragmentHint, t), (i.alignedSliding = !0);
            }
            function yn(t, i) {
              if (t.hasProgramDateTime && i.hasProgramDateTime) {
                var n = t.fragments,
                  r = i.fragments;
                if (n.length && r.length) {
                  var e = r[Math.round(r.length / 2) - 1],
                    s = dn(n, e.cc) || n[Math.round(n.length / 2) - 1],
                    a = e.programDateTime,
                    o = s.programDateTime;
                  null !== a &&
                    null !== o &&
                    mn((o - a) / 1e3 - (s.start - e.start), t);
                }
              }
            }
            var gn = (function () {
                function t(t, i) {
                  (this.subtle = void 0),
                    (this.aesIV = void 0),
                    (this.subtle = t),
                    (this.aesIV = i);
                }
                return (
                  (t.prototype.decrypt = function (t, i) {
                    return this.subtle.decrypt(
                      { name: "AES-CBC", iv: this.aesIV },
                      i,
                      t
                    );
                  }),
                  t
                );
              })(),
              wn = (function () {
                function t(t, i) {
                  (this.subtle = void 0),
                    (this.key = void 0),
                    (this.subtle = t),
                    (this.key = i);
                }
                return (
                  (t.prototype.expandKey = function () {
                    return this.subtle.importKey(
                      "raw",
                      this.key,
                      { name: "AES-CBC" },
                      !1,
                      ["encrypt", "decrypt"]
                    );
                  }),
                  t
                );
              })(),
              bn = (function () {
                function t() {
                  (this.rcon = [0, 1, 2, 4, 8, 16, 32, 64, 128, 27, 54]),
                    (this.subMix = [
                      new Uint32Array(256),
                      new Uint32Array(256),
                      new Uint32Array(256),
                      new Uint32Array(256),
                    ]),
                    (this.invSubMix = [
                      new Uint32Array(256),
                      new Uint32Array(256),
                      new Uint32Array(256),
                      new Uint32Array(256),
                    ]),
                    (this.sBox = new Uint32Array(256)),
                    (this.invSBox = new Uint32Array(256)),
                    (this.key = new Uint32Array(0)),
                    (this.ksRows = 0),
                    (this.keySize = 0),
                    (this.keySchedule = void 0),
                    (this.invKeySchedule = void 0),
                    this.initTable();
                }
                var i = t.prototype;
                return (
                  (i.uint8ArrayToUint32Array_ = function (t) {
                    for (
                      var i = new DataView(t), n = new Uint32Array(4), r = 0;
                      r < 4;
                      r++
                    )
                      n[r] = i.getUint32(4 * r);
                    return n;
                  }),
                  (i.initTable = function () {
                    var t = this.sBox,
                      i = this.invSBox,
                      n = this.subMix,
                      r = n[0],
                      e = n[1],
                      s = n[2],
                      a = n[3],
                      o = this.invSubMix,
                      h = o[0],
                      u = o[1],
                      f = o[2],
                      l = o[3],
                      c = new Uint32Array(256),
                      v = 0,
                      d = 0,
                      p = 0;
                    for (p = 0; p < 256; p++)
                      c[p] = p < 128 ? p << 1 : (p << 1) ^ 283;
                    for (p = 0; p < 256; p++) {
                      var m = d ^ (d << 1) ^ (d << 2) ^ (d << 3) ^ (d << 4);
                      (m = (m >>> 8) ^ (255 & m) ^ 99), (t[v] = m), (i[m] = v);
                      var y = c[v],
                        g = c[y],
                        w = c[g],
                        b = (257 * c[m]) ^ (16843008 * m);
                      (r[v] = (b << 24) | (b >>> 8)),
                        (e[v] = (b << 16) | (b >>> 16)),
                        (s[v] = (b << 8) | (b >>> 24)),
                        (a[v] = b),
                        (b =
                          (16843009 * w) ^
                          (65537 * g) ^
                          (257 * y) ^
                          (16843008 * v)),
                        (h[m] = (b << 24) | (b >>> 8)),
                        (u[m] = (b << 16) | (b >>> 16)),
                        (f[m] = (b << 8) | (b >>> 24)),
                        (l[m] = b),
                        v
                          ? ((v = y ^ c[c[c[w ^ y]]]), (d ^= c[c[d]]))
                          : (v = d = 1);
                    }
                  }),
                  (i.expandKey = function (t) {
                    for (
                      var i = this.uint8ArrayToUint32Array_(t), n = !0, r = 0;
                      r < i.length && n;

                    )
                      (n = i[r] === this.key[r]), r++;
                    if (!n) {
                      this.key = i;
                      var e = (this.keySize = i.length);
                      if (4 !== e && 6 !== e && 8 !== e)
                        throw new Error("Invalid aes key size=" + e);
                      var s,
                        a,
                        o,
                        h,
                        u = (this.ksRows = 4 * (e + 6 + 1)),
                        f = (this.keySchedule = new Uint32Array(u)),
                        l = (this.invKeySchedule = new Uint32Array(u)),
                        c = this.sBox,
                        v = this.rcon,
                        d = this.invSubMix,
                        p = d[0],
                        m = d[1],
                        y = d[2],
                        g = d[3];
                      for (s = 0; s < u; s++)
                        s < e
                          ? (o = f[s] = i[s])
                          : ((h = o),
                            s % e == 0
                              ? ((h =
                                  (c[(h = (h << 8) | (h >>> 24)) >>> 24] <<
                                    24) |
                                  (c[(h >>> 16) & 255] << 16) |
                                  (c[(h >>> 8) & 255] << 8) |
                                  c[255 & h]),
                                (h ^= v[(s / e) | 0] << 24))
                              : e > 6 &&
                                s % e == 4 &&
                                (h =
                                  (c[h >>> 24] << 24) |
                                  (c[(h >>> 16) & 255] << 16) |
                                  (c[(h >>> 8) & 255] << 8) |
                                  c[255 & h]),
                            (f[s] = o = (f[s - e] ^ h) >>> 0));
                      for (a = 0; a < u; a++)
                        (s = u - a),
                          (h = 3 & a ? f[s] : f[s - 4]),
                          (l[a] =
                            a < 4 || s <= 4
                              ? h
                              : p[c[h >>> 24]] ^
                                m[c[(h >>> 16) & 255]] ^
                                y[c[(h >>> 8) & 255]] ^
                                g[c[255 & h]]),
                          (l[a] = l[a] >>> 0);
                    }
                  }),
                  (i.networkToHostOrderSwap = function (t) {
                    return (
                      (t << 24) |
                      ((65280 & t) << 8) |
                      ((16711680 & t) >> 8) |
                      (t >>> 24)
                    );
                  }),
                  (i.decrypt = function (t, i, n) {
                    for (
                      var r,
                        e,
                        s,
                        a,
                        o,
                        h,
                        u,
                        f,
                        l,
                        c,
                        v,
                        d,
                        p,
                        m,
                        y = this.keySize + 6,
                        g = this.invKeySchedule,
                        w = this.invSBox,
                        b = this.invSubMix,
                        k = b[0],
                        E = b[1],
                        T = b[2],
                        x = b[3],
                        S = this.uint8ArrayToUint32Array_(n),
                        A = S[0],
                        M = S[1],
                        D = S[2],
                        _ = S[3],
                        O = new Int32Array(t),
                        R = new Int32Array(O.length),
                        L = this.networkToHostOrderSwap;
                      i < O.length;

                    ) {
                      for (
                        l = L(O[i]),
                          c = L(O[i + 1]),
                          v = L(O[i + 2]),
                          d = L(O[i + 3]),
                          o = l ^ g[0],
                          h = d ^ g[1],
                          u = v ^ g[2],
                          f = c ^ g[3],
                          p = 4,
                          m = 1;
                        m < y;
                        m++
                      )
                        (r =
                          k[o >>> 24] ^
                          E[(h >> 16) & 255] ^
                          T[(u >> 8) & 255] ^
                          x[255 & f] ^
                          g[p]),
                          (e =
                            k[h >>> 24] ^
                            E[(u >> 16) & 255] ^
                            T[(f >> 8) & 255] ^
                            x[255 & o] ^
                            g[p + 1]),
                          (s =
                            k[u >>> 24] ^
                            E[(f >> 16) & 255] ^
                            T[(o >> 8) & 255] ^
                            x[255 & h] ^
                            g[p + 2]),
                          (a =
                            k[f >>> 24] ^
                            E[(o >> 16) & 255] ^
                            T[(h >> 8) & 255] ^
                            x[255 & u] ^
                            g[p + 3]),
                          (o = r),
                          (h = e),
                          (u = s),
                          (f = a),
                          (p += 4);
                      (r =
                        (w[o >>> 24] << 24) ^
                        (w[(h >> 16) & 255] << 16) ^
                        (w[(u >> 8) & 255] << 8) ^
                        w[255 & f] ^
                        g[p]),
                        (e =
                          (w[h >>> 24] << 24) ^
                          (w[(u >> 16) & 255] << 16) ^
                          (w[(f >> 8) & 255] << 8) ^
                          w[255 & o] ^
                          g[p + 1]),
                        (s =
                          (w[u >>> 24] << 24) ^
                          (w[(f >> 16) & 255] << 16) ^
                          (w[(o >> 8) & 255] << 8) ^
                          w[255 & h] ^
                          g[p + 2]),
                        (a =
                          (w[f >>> 24] << 24) ^
                          (w[(o >> 16) & 255] << 16) ^
                          (w[(h >> 8) & 255] << 8) ^
                          w[255 & u] ^
                          g[p + 3]),
                        (R[i] = L(r ^ A)),
                        (R[i + 1] = L(a ^ M)),
                        (R[i + 2] = L(s ^ D)),
                        (R[i + 3] = L(e ^ _)),
                        (A = l),
                        (M = c),
                        (D = v),
                        (_ = d),
                        (i += 4);
                    }
                    return R.buffer;
                  }),
                  t
                );
              })(),
              kn = (function () {
                function t(t, i) {
                  var n = (void 0 === i ? {} : i).removePKCS7Padding,
                    r = void 0 === n || n;
                  if (
                    ((this.logEnabled = !0),
                    (this.removePKCS7Padding = void 0),
                    (this.subtle = null),
                    (this.softwareDecrypter = null),
                    (this.key = null),
                    (this.fastAesKey = null),
                    (this.remainderData = null),
                    (this.currentIV = null),
                    (this.currentResult = null),
                    (this.useSoftware = void 0),
                    (this.useSoftware = t.enableSoftwareAES),
                    (this.removePKCS7Padding = r),
                    r)
                  )
                    try {
                      var e = self.crypto;
                      e && (this.subtle = e.subtle || e.webkitSubtle);
                    } catch (t) {}
                  null === this.subtle && (this.useSoftware = !0);
                }
                var i = t.prototype;
                return (
                  (i.destroy = function () {
                    (this.subtle = null),
                      (this.softwareDecrypter = null),
                      (this.key = null),
                      (this.fastAesKey = null),
                      (this.remainderData = null),
                      (this.currentIV = null),
                      (this.currentResult = null);
                  }),
                  (i.isSync = function () {
                    return this.useSoftware;
                  }),
                  (i.flush = function () {
                    var t = this.currentResult,
                      i = this.remainderData;
                    if (!t || i) return this.reset(), null;
                    var n,
                      r,
                      e,
                      s = new Uint8Array(t);
                    return (
                      this.reset(),
                      this.removePKCS7Padding
                        ? (e =
                            (r = (n = s).byteLength) &&
                            new DataView(n.buffer).getUint8(r - 1))
                          ? Q(n, 0, r - e)
                          : n
                        : s
                    );
                  }),
                  (i.reset = function () {
                    (this.currentResult = null),
                      (this.currentIV = null),
                      (this.remainderData = null),
                      this.softwareDecrypter && (this.softwareDecrypter = null);
                  }),
                  (i.decrypt = function (t, i, n) {
                    var r = this;
                    return this.useSoftware
                      ? new Promise(function (e, s) {
                          r.softwareDecrypt(new Uint8Array(t), i, n);
                          var a = r.flush();
                          a
                            ? e(a.buffer)
                            : s(
                                new Error(
                                  "[softwareDecrypt] Failed to decrypt data"
                                )
                              );
                        })
                      : this.webCryptoDecrypt(new Uint8Array(t), i, n);
                  }),
                  (i.softwareDecrypt = function (t, i, n) {
                    var r = this.currentIV,
                      e = this.currentResult,
                      s = this.remainderData;
                    this.logOnce("JS AES decrypt"),
                      s && ((t = Dt(s, t)), (this.remainderData = null));
                    var a = this.getValidChunk(t);
                    if (!a.length) return null;
                    r && (n = r);
                    var o = this.softwareDecrypter;
                    o || (o = this.softwareDecrypter = new bn()),
                      o.expandKey(i);
                    var h = e;
                    return (
                      (this.currentResult = o.decrypt(a.buffer, 0, n)),
                      (this.currentIV = Q(a, -16).buffer),
                      h || null
                    );
                  }),
                  (i.webCryptoDecrypt = function (t, i, n) {
                    var r = this,
                      e = this.subtle;
                    return (
                      (this.key === i && this.fastAesKey) ||
                        ((this.key = i), (this.fastAesKey = new wn(e, i))),
                      this.fastAesKey
                        .expandKey()
                        .then(function (i) {
                          return e
                            ? (r.logOnce("WebCrypto AES decrypt"),
                              new gn(e, new Uint8Array(n)).decrypt(t.buffer, i))
                            : Promise.reject(
                                new Error("web crypto not initialized")
                              );
                        })
                        .catch(function (e) {
                          return (
                            A.warn(
                              "[decrypter]: WebCrypto Error, disable WebCrypto API, " +
                                e.name +
                                ": " +
                                e.message
                            ),
                            r.onWebCryptoError(t, i, n)
                          );
                        })
                    );
                  }),
                  (i.onWebCryptoError = function (t, i, n) {
                    (this.useSoftware = !0),
                      (this.logEnabled = !0),
                      this.softwareDecrypt(t, i, n);
                    var r = this.flush();
                    if (r) return r.buffer;
                    throw new Error(
                      "WebCrypto and softwareDecrypt: failed to decrypt data"
                    );
                  }),
                  (i.getValidChunk = function (t) {
                    var i = t,
                      n = t.length - (t.length % 16);
                    return (
                      n !== t.length &&
                        ((i = Q(t, 0, n)), (this.remainderData = Q(t, n))),
                      i
                    );
                  }),
                  (i.logOnce = function (t) {
                    this.logEnabled &&
                      (A.log("[decrypter]: " + t), (this.logEnabled = !1));
                  }),
                  t
                );
              })(),
              En = "STOPPED",
              Tn = "IDLE",
              xn = "KEY_LOADING",
              Sn = "FRAG_LOADING",
              An = "FRAG_LOADING_WAITING_RETRY",
              Mn = "WAITING_TRACK",
              Dn = "PARSING",
              _n = "PARSED",
              On = "ENDED",
              Rn = "ERROR",
              Ln = "WAITING_INIT_PTS",
              In = "WAITING_LEVEL",
              Pn = (function (t) {
                function i(i, n, r, e, s) {
                  var a;
                  return (
                    ((a = t.call(this) || this).hls = void 0),
                    (a.fragPrevious = null),
                    (a.fragCurrent = null),
                    (a.fragmentTracker = void 0),
                    (a.transmuxer = null),
                    (a.P = En),
                    (a.playlistType = void 0),
                    (a.media = null),
                    (a.mediaBuffer = null),
                    (a.config = void 0),
                    (a.bitrateTest = !1),
                    (a.lastCurrentTime = 0),
                    (a.nextLoadPosition = 0),
                    (a.startPosition = 0),
                    (a.startTimeOffset = null),
                    (a.loadedmetadata = !1),
                    (a.retryDate = 0),
                    (a.levels = null),
                    (a.fragmentLoader = void 0),
                    (a.keyLoader = void 0),
                    (a.levelLastLoaded = null),
                    (a.startFragRequested = !1),
                    (a.decrypter = void 0),
                    (a.initPTS = []),
                    (a.onvseeking = null),
                    (a.onvended = null),
                    (a.logPrefix = ""),
                    (a.log = void 0),
                    (a.warn = void 0),
                    (a.playlistType = s),
                    (a.logPrefix = e),
                    (a.log = A.log.bind(A, e + ":")),
                    (a.warn = A.warn.bind(A, e + ":")),
                    (a.hls = i),
                    (a.fragmentLoader = new sn(i.config)),
                    (a.keyLoader = r),
                    (a.fragmentTracker = n),
                    (a.config = i.config),
                    (a.decrypter = new kn(i.config)),
                    i.on(
                      w.MANIFEST_LOADED,
                      a.onManifestLoaded,
                      (function (t) {
                        if (void 0 === t)
                          throw new ReferenceError(
                            "this hasn't been initialised - super() hasn't been called"
                          );
                        return t;
                      })(a)
                    ),
                    a
                  );
                }
                h(i, t);
                var n = i.prototype;
                return (
                  (n.doTick = function () {
                    this.onTickEnd();
                  }),
                  (n.onTickEnd = function () {}),
                  (n.startLoad = function (t) {}),
                  (n.stopLoad = function () {
                    this.fragmentLoader.abort(),
                      this.keyLoader.abort(this.playlistType);
                    var t = this.fragCurrent;
                    null != t &&
                      t.loader &&
                      (t.abortRequests(),
                      this.fragmentTracker.removeFragment(t)),
                      this.resetTransmuxer(),
                      (this.fragCurrent = null),
                      (this.fragPrevious = null),
                      this.clearInterval(),
                      this.clearNextTick(),
                      (this.state = En);
                  }),
                  (n.C = function (t, i) {
                    if (i.live || t.nextStart || !t.end || !this.media)
                      return !1;
                    var n = i.partList;
                    if (null != n && n.length) {
                      var r = n[n.length - 1];
                      return cn.isBuffered(
                        this.media,
                        r.start + r.duration / 2
                      );
                    }
                    var e = i.fragments[i.fragments.length - 1].type;
                    return this.fragmentTracker.isEndListAppended(e);
                  }),
                  (n.getLevelDetails = function () {
                    var t;
                    if (this.levels && null !== this.levelLastLoaded)
                      return null == (t = this.levels[this.levelLastLoaded])
                        ? void 0
                        : t.details;
                  }),
                  (n.onMediaAttached = function (t, i) {
                    var n = (this.media = this.mediaBuffer = i.media);
                    (this.onvseeking = this.onMediaSeeking.bind(this)),
                      (this.onvended = this.onMediaEnded.bind(this)),
                      n.addEventListener("seeking", this.onvseeking),
                      n.addEventListener("ended", this.onvended);
                    var r = this.config;
                    this.levels &&
                      r.autoStartLoad &&
                      this.state === En &&
                      this.startLoad(r.startPosition);
                  }),
                  (n.onMediaDetaching = function () {
                    var t = this.media;
                    null != t &&
                      t.ended &&
                      (this.log(
                        "MSE detaching and video ended, reset startPosition"
                      ),
                      (this.startPosition = this.lastCurrentTime = 0)),
                      t &&
                        this.onvseeking &&
                        this.onvended &&
                        (t.removeEventListener("seeking", this.onvseeking),
                        t.removeEventListener("ended", this.onvended),
                        (this.onvseeking = this.onvended = null)),
                      this.keyLoader && this.keyLoader.detach(),
                      (this.media = this.mediaBuffer = null),
                      (this.loadedmetadata = !1),
                      this.fragmentTracker.removeAllFragments(),
                      this.stopLoad();
                  }),
                  (n.onMediaSeeking = function () {
                    var t = this.config,
                      i = this.fragCurrent,
                      n = this.media,
                      r = this.mediaBuffer,
                      e = this.state,
                      s = n ? n.currentTime : 0,
                      a = cn.bufferInfo(r || n, s, t.maxBufferHole);
                    if (
                      (this.log(
                        "media seeking to " +
                          (g(s) ? s.toFixed(3) : s) +
                          ", state: " +
                          e
                      ),
                      this.state === On)
                    )
                      this.resetLoadingState();
                    else if (i) {
                      var o = t.maxFragLookUpTolerance,
                        h = i.start - o,
                        u = i.start + i.duration + o;
                      if (!a.len || u < a.start || h > a.end) {
                        var f = s > u;
                        (s < h || f) &&
                          (f &&
                            i.loader &&
                            (this.log(
                              "seeking outside of buffer while fragment load in progress, cancel fragment load"
                            ),
                            i.abortRequests(),
                            this.resetLoadingState()),
                          (this.fragPrevious = null));
                      }
                    }
                    n &&
                      (this.fragmentTracker.removeFragmentsInRange(
                        s,
                        1 / 0,
                        this.playlistType,
                        !0
                      ),
                      (this.lastCurrentTime = s)),
                      this.loadedmetadata ||
                        a.len ||
                        (this.nextLoadPosition = this.startPosition = s),
                      this.tickImmediate();
                  }),
                  (n.onMediaEnded = function () {
                    this.startPosition = this.lastCurrentTime = 0;
                  }),
                  (n.onManifestLoaded = function (t, i) {
                    (this.startTimeOffset = i.startTimeOffset),
                      (this.initPTS = []);
                  }),
                  (n.onHandlerDestroying = function () {
                    this.stopLoad(), t.prototype.onHandlerDestroying.call(this);
                  }),
                  (n.onHandlerDestroyed = function () {
                    (this.state = En),
                      this.fragmentLoader && this.fragmentLoader.destroy(),
                      this.keyLoader && this.keyLoader.destroy(),
                      this.decrypter && this.decrypter.destroy(),
                      (this.hls =
                        this.log =
                        this.warn =
                        this.decrypter =
                        this.keyLoader =
                        this.fragmentLoader =
                        this.fragmentTracker =
                          null),
                      t.prototype.onHandlerDestroyed.call(this);
                  }),
                  (n.loadFragment = function (t, i, n) {
                    this.N(t, i, n);
                  }),
                  (n.N = function (t, i, n) {
                    var r = this;
                    this.U(t, i, n, function (i) {
                      if (r.fragContextChanged(t))
                        return (
                          r.warn(
                            "Fragment " +
                              t.sn +
                              (i.part ? " p: " + i.part.index : "") +
                              " of level " +
                              t.level +
                              " was dropped during download."
                          ),
                          void r.fragmentTracker.removeFragment(t)
                        );
                      t.stats.chunkCount++, r.F(i);
                    })
                      .then(function (i) {
                        if (i) {
                          var n = r.state;
                          r.fragContextChanged(t)
                            ? (n === Sn || (!r.fragCurrent && n === Dn)) &&
                              (r.fragmentTracker.removeFragment(t),
                              (r.state = Tn))
                            : ("payload" in i &&
                                (r.log(
                                  "Loaded fragment " +
                                    t.sn +
                                    " of level " +
                                    t.level
                                ),
                                r.hls.trigger(w.FRAG_LOADED, i)),
                              r.j(i));
                        }
                      })
                      .catch(function (i) {
                        r.state !== En &&
                          r.state !== Rn &&
                          (r.warn(i), r.resetFragmentLoading(t));
                      });
                  }),
                  (n.clearTrackerIfNeeded = function (t) {
                    var i,
                      n = this.fragmentTracker;
                    if (n.getState(t) === Ji) {
                      var r = t.type,
                        e = this.getFwdBufferInfo(this.mediaBuffer, r),
                        s = Math.max(
                          t.duration,
                          e ? e.len : this.config.maxBufferLength
                        );
                      this.reduceMaxBufferLength(s) && n.removeFragment(t);
                    } else
                      0 ===
                      (null == (i = this.mediaBuffer)
                        ? void 0
                        : i.buffered.length)
                        ? n.removeAllFragments()
                        : n.hasParts(t.type) &&
                          (n.detectPartialFragments({
                            frag: t,
                            part: null,
                            stats: t.stats,
                            id: t.type,
                          }),
                          n.getState(t) === Qi && n.removeFragment(t));
                  }),
                  (n.flushMainBuffer = function (t, i, n) {
                    if ((void 0 === n && (n = null), t - i)) {
                      var r = { startOffset: t, endOffset: i, type: n };
                      this.hls.trigger(w.BUFFER_FLUSHING, r);
                    }
                  }),
                  (n.B = function (t, i) {
                    var n = this;
                    this.U(t, i)
                      .then(function (i) {
                        if (!i || n.fragContextChanged(t) || !n.levels)
                          throw new Error("init load aborted");
                        return i;
                      })
                      .then(function (i) {
                        var r = n.hls,
                          e = i.payload,
                          s = t.decryptdata;
                        if (
                          e &&
                          e.byteLength > 0 &&
                          s &&
                          s.key &&
                          s.iv &&
                          "AES-128" === s.method
                        ) {
                          var a = self.performance.now();
                          return n.decrypter
                            .decrypt(
                              new Uint8Array(e),
                              s.key.buffer,
                              s.iv.buffer
                            )
                            .catch(function (i) {
                              throw (
                                (r.trigger(w.ERROR, {
                                  type: b.MEDIA_ERROR,
                                  details: k.FRAG_DECRYPT_ERROR,
                                  fatal: !1,
                                  error: i,
                                  reason: i.message,
                                  frag: t,
                                }),
                                i)
                              );
                            })
                            .then(function (n) {
                              var e = self.performance.now();
                              return (
                                r.trigger(w.FRAG_DECRYPTED, {
                                  frag: t,
                                  payload: n,
                                  stats: { tstart: a, tdecrypt: e },
                                }),
                                (i.payload = n),
                                i
                              );
                            });
                        }
                        return i;
                      })
                      .then(function (r) {
                        var e = n.fragCurrent,
                          s = n.hls;
                        if (!n.levels)
                          throw new Error("init load aborted, missing levels");
                        var a = t.stats;
                        (n.state = Tn),
                          (i.fragmentError = 0),
                          (t.data = new Uint8Array(r.payload)),
                          (a.parsing.start = a.buffering.start =
                            self.performance.now()),
                          (a.parsing.end = a.buffering.end =
                            self.performance.now()),
                          r.frag === e &&
                            s.trigger(w.FRAG_BUFFERED, {
                              stats: a,
                              frag: e,
                              part: null,
                              id: t.type,
                            }),
                          n.tick();
                      })
                      .catch(function (i) {
                        n.state !== En &&
                          n.state !== Rn &&
                          (n.warn(i), n.resetFragmentLoading(t));
                      });
                  }),
                  (n.fragContextChanged = function (t) {
                    var i = this.fragCurrent;
                    return (
                      !t ||
                      !i ||
                      t.level !== i.level ||
                      t.sn !== i.sn ||
                      t.urlId !== i.urlId
                    );
                  }),
                  (n.fragBufferedComplete = function (t, i) {
                    var n,
                      r,
                      e,
                      s,
                      a = this.mediaBuffer ? this.mediaBuffer : this.media;
                    this.log(
                      "Buffered " +
                        t.type +
                        " sn: " +
                        t.sn +
                        (i ? " part: " + i.index : "") +
                        " of " +
                        (this.playlistType === hi ? "level" : "track") +
                        " " +
                        t.level +
                        " (frag:[" +
                        (null != (n = t.startPTS) ? n : NaN).toFixed(3) +
                        "-" +
                        (null != (r = t.endPTS) ? r : NaN).toFixed(3) +
                        "] > buffer:" +
                        (a
                          ? (function (t) {
                              for (var i = "", n = t.length, r = 0; r < n; r++)
                                i +=
                                  "[" +
                                  t.start(r).toFixed(3) +
                                  "-" +
                                  t.end(r).toFixed(3) +
                                  "]";
                              return i;
                            })(cn.getBuffered(a))
                          : "(detached)") +
                        ")"
                    ),
                      (this.state = Tn),
                      a &&
                        (!this.loadedmetadata &&
                          t.type == hi &&
                          a.buffered.length &&
                          (null == (e = this.fragCurrent) ? void 0 : e.sn) ===
                            (null == (s = this.fragPrevious) ? void 0 : s.sn) &&
                          ((this.loadedmetadata = !0), this.seekToStartPos()),
                        this.tick());
                  }),
                  (n.seekToStartPos = function () {}),
                  (n.j = function (t) {
                    var i = this.transmuxer;
                    if (i) {
                      var n = t.frag,
                        r = t.part,
                        e = t.partsLoaded,
                        s =
                          !e ||
                          0 === e.length ||
                          e.some(function (t) {
                            return !t;
                          }),
                        a = new vn(
                          n.level,
                          n.sn,
                          n.stats.chunkCount + 1,
                          0,
                          r ? r.index : -1,
                          !s
                        );
                      i.flush(a);
                    }
                  }),
                  (n.F = function (t) {}),
                  (n.U = function (t, i, n, r) {
                    var e,
                      s = this;
                    void 0 === n && (n = null);
                    var a = null == i ? void 0 : i.details;
                    if (!this.levels || !a)
                      throw new Error(
                        "frag load aborted, missing level" +
                          (a ? "" : " detail") +
                          "s"
                      );
                    var o = null;
                    if (
                      (!t.encrypted || (null != (e = t.decryptdata) && e.key)
                        ? !t.encrypted &&
                          a.encryptedFragments.length &&
                          this.keyLoader.loadClear(t, a.encryptedFragments)
                        : (this.log(
                            "Loading key for " +
                              t.sn +
                              " of [" +
                              a.startSN +
                              "-" +
                              a.endSN +
                              "], " +
                              ("[stream-controller]" === this.logPrefix
                                ? "level"
                                : "track") +
                              " " +
                              t.level
                          ),
                          (this.state = xn),
                          (this.fragCurrent = t),
                          (o = this.keyLoader.load(t).then(function (t) {
                            if (!s.fragContextChanged(t.frag))
                              return (
                                s.hls.trigger(w.KEY_LOADED, t),
                                s.state === xn && (s.state = Tn),
                                t
                              );
                          })),
                          this.hls.trigger(w.KEY_LOADING, { frag: t }),
                          null === this.fragCurrent &&
                            (o = Promise.reject(
                              new Error(
                                "frag load aborted, context changed in KEY_LOADING"
                              )
                            ))),
                      (n = Math.max(t.start, n || 0)),
                      this.config.lowLatencyMode && "initSegment" !== t.sn)
                    ) {
                      var h = a.partList;
                      if (h && r) {
                        n > t.end && a.fragmentHint && (t = a.fragmentHint);
                        var u = this.getNextPart(h, t, n);
                        if (u > -1) {
                          var f,
                            l = h[u];
                          return (
                            this.log(
                              "Loading part sn: " +
                                t.sn +
                                " p: " +
                                l.index +
                                " cc: " +
                                t.cc +
                                " of playlist [" +
                                a.startSN +
                                "-" +
                                a.endSN +
                                "] parts [0-" +
                                u +
                                "-" +
                                (h.length - 1) +
                                "] " +
                                ("[stream-controller]" === this.logPrefix
                                  ? "level"
                                  : "track") +
                                ": " +
                                t.level +
                                ", target: " +
                                parseFloat(n.toFixed(3))
                            ),
                            (this.nextLoadPosition = l.start + l.duration),
                            (this.state = Sn),
                            (f = o
                              ? o
                                  .then(function (n) {
                                    return !n || s.fragContextChanged(n.frag)
                                      ? null
                                      : s.doFragPartsLoad(t, l, i, r);
                                  })
                                  .catch(function (t) {
                                    return s.handleFragLoadError(t);
                                  })
                              : this.doFragPartsLoad(t, l, i, r).catch(
                                  function (t) {
                                    return s.handleFragLoadError(t);
                                  }
                                )),
                            this.hls.trigger(w.FRAG_LOADING, {
                              frag: t,
                              part: l,
                              targetBufferTime: n,
                            }),
                            null === this.fragCurrent
                              ? Promise.reject(
                                  new Error(
                                    "frag load aborted, context changed in FRAG_LOADING parts"
                                  )
                                )
                              : f
                          );
                        }
                        if (!t.url || this.loadedEndOfParts(h, n))
                          return Promise.resolve(null);
                      }
                    }
                    this.log(
                      "Loading fragment " +
                        t.sn +
                        " cc: " +
                        t.cc +
                        " " +
                        (a ? "of [" + a.startSN + "-" + a.endSN + "] " : "") +
                        ("[stream-controller]" === this.logPrefix
                          ? "level"
                          : "track") +
                        ": " +
                        t.level +
                        ", target: " +
                        parseFloat(n.toFixed(3))
                    ),
                      g(t.sn) &&
                        !this.bitrateTest &&
                        (this.nextLoadPosition = t.start + t.duration),
                      (this.state = Sn);
                    var c,
                      v = this.config.progressive;
                    return (
                      (c =
                        v && o
                          ? o
                              .then(function (i) {
                                return !i ||
                                  s.fragContextChanged(
                                    null == i ? void 0 : i.frag
                                  )
                                  ? null
                                  : s.fragmentLoader.load(t, r);
                              })
                              .catch(function (t) {
                                return s.handleFragLoadError(t);
                              })
                          : Promise.all([
                              this.fragmentLoader.load(t, v ? r : void 0),
                              o,
                            ])
                              .then(function (t) {
                                var i = t[0];
                                return !v && i && r && r(i), i;
                              })
                              .catch(function (t) {
                                return s.handleFragLoadError(t);
                              })),
                      this.hls.trigger(w.FRAG_LOADING, {
                        frag: t,
                        targetBufferTime: n,
                      }),
                      null === this.fragCurrent
                        ? Promise.reject(
                            new Error(
                              "frag load aborted, context changed in FRAG_LOADING"
                            )
                          )
                        : c
                    );
                  }),
                  (n.doFragPartsLoad = function (t, i, n, r) {
                    var e = this;
                    return new Promise(function (s, a) {
                      var o,
                        h = [],
                        u = null == (o = n.details) ? void 0 : o.partList;
                      !(function i(o) {
                        e.fragmentLoader
                          .loadPart(t, o, r)
                          .then(function (r) {
                            h[o.index] = r;
                            var a = r.part;
                            e.hls.trigger(w.FRAG_LOADED, r);
                            var f =
                              Ii(n, t.sn, o.index + 1) ||
                              Pi(u, t.sn, o.index + 1);
                            if (!f)
                              return s({ frag: t, part: a, partsLoaded: h });
                            i(f);
                          })
                          .catch(a);
                      })(i);
                    });
                  }),
                  (n.handleFragLoadError = function (t) {
                    if ("data" in t) {
                      var i = t.data;
                      t.data && i.details === k.INTERNAL_ABORTED
                        ? this.handleFragLoadAborted(i.frag, i.part)
                        : this.hls.trigger(w.ERROR, i);
                    } else
                      this.hls.trigger(w.ERROR, {
                        type: b.OTHER_ERROR,
                        details: k.INTERNAL_EXCEPTION,
                        err: t,
                        error: t,
                        fatal: !0,
                      });
                    return null;
                  }),
                  (n.$ = function (t) {
                    var i = this.getCurrentContext(t);
                    if (i && this.state === Dn) {
                      var n = i.frag,
                        r = i.part,
                        e = i.level,
                        s = self.performance.now();
                      (n.stats.parsing.end = s),
                        r && (r.stats.parsing.end = s),
                        this.updateLevelTiming(n, r, e, t.partial);
                    } else
                      this.fragCurrent ||
                        this.state === En ||
                        this.state === Rn ||
                        (this.state = Tn);
                  }),
                  (n.getCurrentContext = function (t) {
                    var i = this.levels,
                      n = this.fragCurrent,
                      r = t.level,
                      e = t.sn,
                      s = t.part;
                    if (null == i || !i[r])
                      return (
                        this.warn(
                          "Levels object was unset while buffering fragment " +
                            e +
                            " of level " +
                            r +
                            ". The current chunk will not be buffered."
                        ),
                        null
                      );
                    var a = i[r],
                      o = s > -1 ? Ii(a, e, s) : null,
                      h = o
                        ? o.fragment
                        : (function (t, i, n) {
                            if (null == t || !t.details) return null;
                            var r = t.details,
                              e = r.fragments[i - r.startSN];
                            return (
                              e ||
                              ((e = r.fragmentHint) && e.sn === i
                                ? e
                                : i < r.startSN && n && n.sn === i
                                ? n
                                : null)
                            );
                          })(a, e, n);
                    return h
                      ? (n && n !== h && (h.stats = n.stats),
                        { frag: h, part: o, level: a })
                      : null;
                  }),
                  (n.bufferFragmentData = function (t, i, n, r) {
                    var e;
                    if (t && this.state === Dn) {
                      var s = t.data1,
                        a = t.data2,
                        o = s;
                      if (
                        (s && a && (o = Dt(s, a)), null != (e = o) && e.length)
                      ) {
                        var h = {
                          type: t.type,
                          frag: i,
                          part: n,
                          chunkMeta: r,
                          parent: i.type,
                          data: o,
                        };
                        this.hls.trigger(w.BUFFER_APPENDING, h),
                          t.dropped &&
                            t.independent &&
                            !n &&
                            this.flushBufferGap(i);
                      }
                    }
                  }),
                  (n.flushBufferGap = function (t) {
                    var i = this.media;
                    if (i)
                      if (cn.isBuffered(i, i.currentTime)) {
                        var n = i.currentTime,
                          r = cn.bufferInfo(i, n, 0),
                          e = t.duration,
                          s = Math.min(
                            2 * this.config.maxFragLookUpTolerance,
                            0.25 * e
                          ),
                          a = Math.max(Math.min(t.start - s, r.end - s), n + s);
                        t.start - a > s && this.flushMainBuffer(a, t.start);
                      } else this.flushMainBuffer(0, t.start);
                  }),
                  (n.getFwdBufferInfo = function (t, i) {
                    var n = this.getLoadPosition();
                    return g(n) ? this.getFwdBufferInfoAtPos(t, n, i) : null;
                  }),
                  (n.getFwdBufferInfoAtPos = function (t, i, n) {
                    var r = this.config.maxBufferHole,
                      e = cn.bufferInfo(t, i, r);
                    if (0 === e.len && void 0 !== e.nextStart) {
                      var s = this.fragmentTracker.getBufferedFrag(i, n);
                      if (s && e.nextStart < s.end)
                        return cn.bufferInfo(t, i, Math.max(e.nextStart, r));
                    }
                    return e;
                  }),
                  (n.getMaxBufferLength = function (t) {
                    var i,
                      n = this.config;
                    return (
                      (i = t
                        ? Math.max((8 * n.maxBufferSize) / t, n.maxBufferLength)
                        : n.maxBufferLength),
                      Math.min(i, n.maxMaxBufferLength)
                    );
                  }),
                  (n.reduceMaxBufferLength = function (t) {
                    var i = this.config,
                      n = t || i.maxBufferLength;
                    return (
                      i.maxMaxBufferLength >= n &&
                      ((i.maxMaxBufferLength /= 2),
                      this.warn(
                        "Reduce max buffer length to " +
                          i.maxMaxBufferLength +
                          "s"
                      ),
                      !0)
                    );
                  }),
                  (n.getAppendedFrag = function (t, i) {
                    var n = this.fragmentTracker.getAppendedFrag(t, hi);
                    return n && "fragment" in n ? n.fragment : n;
                  }),
                  (n.getNextFragment = function (t, i) {
                    var n = i.fragments,
                      r = n.length;
                    if (!r) return null;
                    var e,
                      s = this.config,
                      a = n[0].start;
                    if (i.live) {
                      var o = s.initialLiveManifestSize;
                      if (r < o)
                        return (
                          this.warn(
                            "Not enough fragments to start playback (have: " +
                              r +
                              ", need: " +
                              o +
                              ")"
                          ),
                          null
                        );
                      i.PTSKnown ||
                        this.startFragRequested ||
                        -1 !== this.startPosition ||
                        ((e = this.getInitialLiveFragment(i, n)),
                        (this.startPosition = e
                          ? this.hls.liveSyncPosition || e.start
                          : t));
                    } else t <= a && (e = n[0]);
                    if (!e) {
                      var h = s.lowLatencyMode ? i.partEnd : i.fragmentEnd;
                      e = this.getFragmentAtPosition(t, h, i);
                    }
                    return this.mapToInitFragWhenRequired(e);
                  }),
                  (n.isLoopLoading = function (t, i) {
                    var n = this.fragmentTracker.getState(t);
                    return (
                      (n === Zi || (n === Qi && !!t.gap)) &&
                      this.nextLoadPosition > i
                    );
                  }),
                  (n.getNextFragmentLoopLoading = function (t, i, n, r, e) {
                    var s = t.gap,
                      a = this.getNextFragment(this.nextLoadPosition, i);
                    if (null === a) return a;
                    if (((t = a), s && t && !t.gap && n.nextStart)) {
                      var o = this.getFwdBufferInfoAtPos(
                        this.mediaBuffer ? this.mediaBuffer : this.media,
                        n.nextStart,
                        r
                      );
                      if (null !== o && n.len + o.len >= e)
                        return (
                          this.log(
                            'buffer full after gaps in "' +
                              r +
                              '" playlist starting at sn: ' +
                              t.sn
                          ),
                          null
                        );
                    }
                    return t;
                  }),
                  (n.mapToInitFragWhenRequired = function (t) {
                    return null == t ||
                      !t.initSegment ||
                      (null != t && t.initSegment.data) ||
                      this.bitrateTest
                      ? t
                      : t.initSegment;
                  }),
                  (n.getNextPart = function (t, i, n) {
                    for (
                      var r = -1, e = !1, s = !0, a = 0, o = t.length;
                      a < o;
                      a++
                    ) {
                      var h = t[a];
                      if (((s = s && !h.independent), r > -1 && n < h.start))
                        break;
                      var u = h.loaded;
                      u
                        ? (r = -1)
                        : (e || h.independent || s) &&
                          h.fragment === i &&
                          (r = a),
                        (e = u);
                    }
                    return r;
                  }),
                  (n.loadedEndOfParts = function (t, i) {
                    var n = t[t.length - 1];
                    return n && i > n.start && n.loaded;
                  }),
                  (n.getInitialLiveFragment = function (t, i) {
                    var n = this.fragPrevious,
                      r = null;
                    if (n) {
                      if (
                        (t.hasProgramDateTime &&
                          (this.log(
                            "Live playlist, switching playlist, load frag with same PDT: " +
                              n.programDateTime
                          ),
                          (r = (function (t, i, n) {
                            if (
                              null === i ||
                              !Array.isArray(t) ||
                              !t.length ||
                              !g(i)
                            )
                              return null;
                            if (i < (t[0].programDateTime || 0)) return null;
                            if (i >= (t[t.length - 1].endProgramDateTime || 0))
                              return null;
                            n = n || 0;
                            for (var r = 0; r < t.length; ++r) {
                              var e = t[r];
                              if ($i(i, n, e)) return e;
                            }
                            return null;
                          })(
                            i,
                            n.endProgramDateTime,
                            this.config.maxFragLookUpTolerance
                          ))),
                        !r)
                      ) {
                        var e = n.sn + 1;
                        if (e >= t.startSN && e <= t.endSN) {
                          var s = i[e - t.startSN];
                          n.cc === s.cc &&
                            ((r = s),
                            this.log(
                              "Live playlist, switching playlist, load frag with next SN: " +
                                r.sn
                            ));
                        }
                        r ||
                          ((r = (function (t, i) {
                            return Bi(t, function (t) {
                              return t.cc < i ? 1 : t.cc > i ? -1 : 0;
                            });
                          })(i, n.cc)),
                          r &&
                            this.log(
                              "Live playlist, switching playlist, load frag with same CC: " +
                                r.sn
                            ));
                      }
                    } else {
                      var a = this.hls.liveSyncPosition;
                      null !== a &&
                        (r = this.getFragmentAtPosition(
                          a,
                          this.bitrateTest ? t.fragmentEnd : t.edge,
                          t
                        ));
                    }
                    return r;
                  }),
                  (n.getFragmentAtPosition = function (t, i, n) {
                    var r,
                      e = this.config,
                      s = this.fragPrevious,
                      a = n.fragments,
                      o = n.endSN,
                      h = n.fragmentHint,
                      u = e.maxFragLookUpTolerance,
                      f = n.partList,
                      l = !!(e.lowLatencyMode && null != f && f.length && h);
                    if (
                      (l &&
                        h &&
                        !this.bitrateTest &&
                        ((a = a.concat(h)), (o = h.sn)),
                      (r =
                        t < i
                          ? Xi(s, a, t, t > i - u ? 0 : u)
                          : a[a.length - 1]))
                    ) {
                      var c = r.sn - n.startSN,
                        v = this.fragmentTracker.getState(r);
                      if (
                        ((v === Zi || (v === Qi && r.gap)) && (s = r),
                        s &&
                          r.sn === s.sn &&
                          (!l || f[0].fragment.sn > r.sn) &&
                          s &&
                          r.level === s.level)
                      ) {
                        var d = a[c + 1];
                        r =
                          r.sn < o && this.fragmentTracker.getState(d) !== Zi
                            ? d
                            : null;
                      }
                    }
                    return r;
                  }),
                  (n.synchronizeToLiveEdge = function (t) {
                    var i = this.config,
                      n = this.media;
                    if (n) {
                      var r = this.hls.liveSyncPosition,
                        e = n.currentTime,
                        s = t.fragments[0].start,
                        a = t.edge,
                        o = e >= s - i.maxFragLookUpTolerance && e <= a;
                      if (null !== r && n.duration > r && (e < r || !o)) {
                        var h =
                          void 0 !== i.liveMaxLatencyDuration
                            ? i.liveMaxLatencyDuration
                            : i.liveMaxLatencyDurationCount * t.targetduration;
                        ((!o && n.readyState < 4) || e < a - h) &&
                          (this.loadedmetadata || (this.nextLoadPosition = r),
                          n.readyState &&
                            (this.warn(
                              "Playback: " +
                                e.toFixed(3) +
                                " is located too far from the end of live sliding playlist: " +
                                a +
                                ", reset currentTime to : " +
                                r.toFixed(3)
                            ),
                            (n.currentTime = r)));
                      }
                    }
                  }),
                  (n.alignPlaylists = function (t, i) {
                    var n = this.levels,
                      r = this.levelLastLoaded,
                      e = this.fragPrevious,
                      s = null !== r ? n[r] : null,
                      a = t.fragments.length;
                    if (!a)
                      return this.warn("No fragments in live playlist"), 0;
                    var o = t.fragments[0].start,
                      h = !i,
                      u = t.alignedSliding && g(o);
                    if (h || (!u && !o)) {
                      !(function (t, i, n) {
                        i &&
                          ((function (t, i, n) {
                            if (
                              (function (t, i, n) {
                                return !(
                                  !i.details ||
                                  !(
                                    n.endCC > n.startCC ||
                                    (t && t.cc < n.startCC)
                                  )
                                );
                              })(t, n, i)
                            ) {
                              var r = (function (t, i, n) {
                                var r = t.fragments,
                                  e = i.fragments;
                                if (e.length && r.length) {
                                  var s = dn(r, e[0].cc);
                                  if (s && (!s || s.startPTS)) return s;
                                  A.log(
                                    "No frag in previous level to align on"
                                  );
                                } else A.log("No fragments to align");
                              })(n.details, i);
                              r &&
                                g(r.start) &&
                                (A.log(
                                  "Adjusting PTS using last level due to CC increase within current level " +
                                    i.url
                                ),
                                mn(r.start, i));
                            }
                          })(t, n, i),
                          !n.alignedSliding &&
                            i.details &&
                            (function (t, i) {
                              if (
                                i.fragments.length &&
                                t.hasProgramDateTime &&
                                i.hasProgramDateTime
                              ) {
                                var n = i.fragments[0].programDateTime,
                                  r = t.fragments[0].programDateTime,
                                  e = (r - n) / 1e3 + i.fragments[0].start;
                                e &&
                                  g(e) &&
                                  (A.log(
                                    "Adjusting PTS using programDateTime delta " +
                                      (r - n) +
                                      "ms, sliding:" +
                                      e.toFixed(3) +
                                      " " +
                                      t.url +
                                      " "
                                  ),
                                  mn(e, t));
                              }
                            })(n, i.details),
                          n.alignedSliding ||
                            !i.details ||
                            n.skippedSegments ||
                            Ri(i.details, n));
                      })(e, s, t);
                      var f = t.fragments[0].start;
                      return (
                        this.log(
                          "Live playlist sliding: " +
                            f.toFixed(2) +
                            " start-sn: " +
                            (i ? i.startSN : "na") +
                            "->" +
                            t.startSN +
                            " prev-sn: " +
                            (e ? e.sn : "na") +
                            " fragments: " +
                            a
                        ),
                        f
                      );
                    }
                    return o;
                  }),
                  (n.waitForCdnTuneIn = function (t) {
                    return (
                      t.live &&
                      t.canBlockReload &&
                      t.partTarget &&
                      t.tuneInGoal > Math.max(t.partHoldBack, 3 * t.partTarget)
                    );
                  }),
                  (n.setStartPosition = function (t, i) {
                    var n = this.startPosition;
                    if (
                      (n < i && (n = -1),
                      -1 === n || -1 === this.lastCurrentTime)
                    ) {
                      var r = null !== this.startTimeOffset,
                        e = r ? this.startTimeOffset : t.startTimeOffset;
                      null !== e && g(e)
                        ? ((n = i + e),
                          e < 0 && (n += t.totalduration),
                          (n = Math.min(Math.max(i, n), i + t.totalduration)),
                          this.log(
                            "Start time offset " +
                              e +
                              " found in " +
                              (r ? "multivariant" : "media") +
                              " playlist, adjust startPosition to " +
                              n
                          ),
                          (this.startPosition = n))
                        : t.live
                        ? (n = this.hls.liveSyncPosition || i)
                        : (this.startPosition = n = 0),
                        (this.lastCurrentTime = n);
                    }
                    this.nextLoadPosition = n;
                  }),
                  (n.getLoadPosition = function () {
                    var t = this.media,
                      i = 0;
                    return (
                      this.loadedmetadata && t
                        ? (i = t.currentTime)
                        : this.nextLoadPosition && (i = this.nextLoadPosition),
                      i
                    );
                  }),
                  (n.handleFragLoadAborted = function (t, i) {
                    this.transmuxer &&
                      "initSegment" !== t.sn &&
                      t.stats.aborted &&
                      (this.warn(
                        "Fragment " +
                          t.sn +
                          (i ? " part " + i.index : "") +
                          " of level " +
                          t.level +
                          " was aborted"
                      ),
                      this.resetFragmentLoading(t));
                  }),
                  (n.resetFragmentLoading = function (t) {
                    (this.fragCurrent &&
                      (this.fragContextChanged(t) || this.state === An)) ||
                      (this.state = Tn);
                  }),
                  (n.onFragmentOrKeyLoadError = function (t, i) {
                    if (i.chunkMeta && !i.frag) {
                      var n = this.getCurrentContext(i.chunkMeta);
                      n && (i.frag = n.frag);
                    }
                    var r = i.frag;
                    if (r && r.type === t && this.levels)
                      if (this.fragContextChanged(r)) {
                        var e;
                        this.warn(
                          "Frag load error must match current frag to retry " +
                            r.url +
                            " > " +
                            (null == (e = this.fragCurrent) ? void 0 : e.url)
                        );
                      } else {
                        var s = i.details === k.FRAG_GAP;
                        s && this.fragmentTracker.fragBuffered(r, !0);
                        var a = i.errorAction,
                          o = a || {},
                          h = o.action,
                          u = o.retryCount,
                          f = void 0 === u ? 0 : u,
                          l = o.retryConfig;
                        if (a && 5 === h && l) {
                          this.loadedmetadata ||
                            ((this.startFragRequested = !1),
                            (this.nextLoadPosition = this.startPosition));
                          var c = Ui(l, f);
                          this.warn(
                            "Fragment " +
                              r.sn +
                              " of " +
                              t +
                              " " +
                              r.level +
                              " errored with " +
                              i.details +
                              ", retrying loading " +
                              (f + 1) +
                              "/" +
                              l.maxNumRetry +
                              " in " +
                              c +
                              "ms"
                          ),
                            (a.resolved = !0),
                            (this.retryDate = self.performance.now() + c),
                            (this.state = An);
                        } else
                          l && a
                            ? (this.resetFragmentErrors(t),
                              f < l.maxNumRetry
                                ? s || (a.resolved = !0)
                                : A.warn(
                                    i.details +
                                      " reached or exceeded max retry (" +
                                      f +
                                      ")"
                                  ))
                            : (this.state = Rn);
                        this.tickImmediate();
                      }
                  }),
                  (n.reduceLengthAndFlushBuffer = function (t) {
                    if (this.state === Dn || this.state === _n) {
                      var i = t.parent,
                        n = this.getFwdBufferInfo(this.mediaBuffer, i),
                        r = n && n.len > 0.5;
                      r && this.reduceMaxBufferLength(n.len);
                      var e = !r;
                      return (
                        e &&
                          this.warn(
                            "Buffer full error while media.currentTime is not buffered, flush " +
                              i +
                              " buffer"
                          ),
                        t.frag &&
                          (this.fragmentTracker.removeFragment(t.frag),
                          (this.nextLoadPosition = t.frag.start)),
                        this.resetLoadingState(),
                        e
                      );
                    }
                    return !1;
                  }),
                  (n.resetFragmentErrors = function (t) {
                    t === ui && (this.fragCurrent = null),
                      this.loadedmetadata || (this.startFragRequested = !1),
                      this.state !== En && (this.state = Tn);
                  }),
                  (n.afterBufferFlushed = function (t, i, n) {
                    if (t) {
                      var r = cn.getBuffered(t);
                      this.fragmentTracker.detectEvictedFragments(i, r, n),
                        this.state === On && this.resetLoadingState();
                    }
                  }),
                  (n.resetLoadingState = function () {
                    this.log("Reset loading state"),
                      (this.fragCurrent = null),
                      (this.fragPrevious = null),
                      (this.state = Tn);
                  }),
                  (n.resetStartWhenNotLoaded = function (t) {
                    if (!this.loadedmetadata) {
                      this.startFragRequested = !1;
                      var i = this.levels ? this.levels[t].details : null;
                      null != i && i.live
                        ? ((this.startPosition = -1),
                          this.setStartPosition(i, 0),
                          this.resetLoadingState())
                        : (this.nextLoadPosition = this.startPosition);
                    }
                  }),
                  (n.resetWhenMissingContext = function (t) {
                    this.warn(
                      "The loading context changed while buffering fragment " +
                        t.sn +
                        " of level " +
                        t.level +
                        ". This chunk will not be buffered."
                    ),
                      this.removeUnbufferedFrags(),
                      this.resetStartWhenNotLoaded(t.level),
                      this.resetLoadingState();
                  }),
                  (n.removeUnbufferedFrags = function (t) {
                    void 0 === t && (t = 0),
                      this.fragmentTracker.removeFragmentsInRange(
                        t,
                        1 / 0,
                        this.playlistType,
                        !1,
                        !0
                      );
                  }),
                  (n.updateLevelTiming = function (t, i, n, r) {
                    var e,
                      s = this,
                      a = n.details;
                    if (a) {
                      if (
                        Object.keys(t.elementaryStreams).reduce(function (
                          i,
                          e
                        ) {
                          var o = t.elementaryStreams[e];
                          if (o) {
                            var h = o.endPTS - o.startPTS;
                            if (h <= 0)
                              return (
                                s.warn(
                                  "Could not parse fragment " +
                                    t.sn +
                                    " " +
                                    e +
                                    " duration reliably (" +
                                    h +
                                    ")"
                                ),
                                i || !1
                              );
                            var u = r
                              ? 0
                              : _i(
                                  a,
                                  t,
                                  o.startPTS,
                                  o.endPTS,
                                  o.startDTS,
                                  o.endDTS
                                );
                            return (
                              s.hls.trigger(w.LEVEL_PTS_UPDATED, {
                                details: a,
                                level: n,
                                drift: u,
                                type: e,
                                frag: t,
                                start: o.startPTS,
                                end: o.endPTS,
                              }),
                              !0
                            );
                          }
                          return i;
                        },
                        !1)
                      )
                        n.fragmentError = 0;
                      else if (
                        null ===
                        (null == (e = this.transmuxer) ? void 0 : e.error)
                      ) {
                        var o = new Error(
                          "Found no media in fragment " +
                            t.sn +
                            " of level " +
                            n.id +
                            " resetting transmuxer to fallback to playlist timing"
                        );
                        if (
                          (this.warn(o.message),
                          this.hls.trigger(w.ERROR, {
                            type: b.MEDIA_ERROR,
                            details: k.FRAG_PARSING_ERROR,
                            fatal: !1,
                            error: o,
                            frag: t,
                            reason:
                              "Found no media in msn " +
                              t.sn +
                              ' of level "' +
                              n.url +
                              '"',
                          }),
                          !this.hls)
                        )
                          return;
                        this.resetTransmuxer();
                      }
                      (this.state = _n),
                        this.hls.trigger(w.FRAG_PARSED, { frag: t, part: i });
                    } else this.warn("level.details undefined");
                  }),
                  (n.resetTransmuxer = function () {
                    this.transmuxer &&
                      (this.transmuxer.destroy(), (this.transmuxer = null));
                  }),
                  (n.recoverWorkerError = function (t) {
                    "demuxerWorker" === t.event &&
                      (this.resetTransmuxer(), this.resetLoadingState());
                  }),
                  s(i, [
                    {
                      key: "state",
                      get: function () {
                        return this.P;
                      },
                      set: function (t) {
                        var i = this.P;
                        i !== t && ((this.P = t), this.log(i + "->" + t));
                      },
                    },
                  ]),
                  i
                );
              })(fn);
            function Cn() {
              return self.SourceBuffer || self.WebKitSourceBuffer;
            }
            function Nn(t, i) {
              return (
                void 0 === t && (t = ""),
                void 0 === i && (i = 9e4),
                {
                  type: t,
                  id: -1,
                  pid: -1,
                  inputTimeScale: i,
                  sequenceNumber: -1,
                  samples: [],
                  dropped: 0,
                }
              );
            }
            var Un = (function () {
                function t() {
                  (this.H = void 0),
                    (this.V = void 0),
                    (this.frameIndex = 0),
                    (this.cachedData = null),
                    (this.basePTS = null),
                    (this.initPTS = null),
                    (this.lastPTS = null);
                }
                var i = t.prototype;
                return (
                  (i.resetInitSegment = function (t, i, n, r) {
                    this.V = {
                      type: "id3",
                      id: 3,
                      pid: -1,
                      inputTimeScale: 9e4,
                      sequenceNumber: 0,
                      samples: [],
                      dropped: 0,
                    };
                  }),
                  (i.resetTimeStamp = function (t) {
                    (this.initPTS = t), this.resetContiguity();
                  }),
                  (i.resetContiguity = function () {
                    (this.basePTS = null),
                      (this.lastPTS = null),
                      (this.frameIndex = 0);
                  }),
                  (i.canParse = function (t, i) {
                    return !1;
                  }),
                  (i.appendFrame = function (t, i, n) {}),
                  (i.demux = function (t, i) {
                    this.cachedData &&
                      ((t = Dt(this.cachedData, t)), (this.cachedData = null));
                    var n,
                      r = nt(t, 0),
                      e = r ? r.length : 0,
                      s = this.H,
                      a = this.V,
                      o = r
                        ? (function (t) {
                            for (var i = ot(t), n = 0; n < i.length; n++) {
                              var r = i[n];
                              if (st(r)) return ct(r);
                            }
                          })(r)
                        : void 0,
                      h = t.length;
                    for (
                      (null === this.basePTS ||
                        (0 === this.frameIndex && g(o))) &&
                        ((this.basePTS = Fn(o, i, this.initPTS)),
                        (this.lastPTS = this.basePTS)),
                        null === this.lastPTS && (this.lastPTS = this.basePTS),
                        r &&
                          r.length > 0 &&
                          a.samples.push({
                            pts: this.lastPTS,
                            dts: this.lastPTS,
                            data: r,
                            type: gi,
                            duration: Number.POSITIVE_INFINITY,
                          });
                      e < h;

                    ) {
                      if (this.canParse(t, e)) {
                        var u = this.appendFrame(s, t, e);
                        u
                          ? (this.frameIndex++,
                            (this.lastPTS = u.sample.pts),
                            (n = e += u.length))
                          : (e = h);
                      } else
                        et(t, e)
                          ? ((r = nt(t, e)),
                            a.samples.push({
                              pts: this.lastPTS,
                              dts: this.lastPTS,
                              data: r,
                              type: gi,
                              duration: Number.POSITIVE_INFINITY,
                            }),
                            (n = e += r.length))
                          : e++;
                      if (e === h && n !== h) {
                        var f = Q(t, n);
                        this.cachedData
                          ? (this.cachedData = Dt(this.cachedData, f))
                          : (this.cachedData = f);
                      }
                    }
                    return {
                      audioTrack: s,
                      videoTrack: Nn(),
                      id3Track: a,
                      textTrack: Nn(),
                    };
                  }),
                  (i.demuxSampleAes = function (t, i, n) {
                    return Promise.reject(
                      new Error(
                        "[" +
                          this +
                          "] This demuxer does not support Sample-AES decryption"
                      )
                    );
                  }),
                  (i.flush = function (t) {
                    var i = this.cachedData;
                    return (
                      i && ((this.cachedData = null), this.demux(i, 0)),
                      {
                        audioTrack: this.H,
                        videoTrack: Nn(),
                        id3Track: this.V,
                        textTrack: Nn(),
                      }
                    );
                  }),
                  (i.destroy = function () {}),
                  t
                );
              })(),
              Fn = function (t, i, n) {
                return g(t)
                  ? 90 * t
                  : 9e4 * i + (n ? (9e4 * n.baseTime) / n.timescale : 0);
              };
            function jn(t, i) {
              return 255 === t[i] && 240 == (246 & t[i + 1]);
            }
            function Bn(t, i) {
              return 1 & t[i + 1] ? 7 : 9;
            }
            function Xn(t, i) {
              return (
                ((3 & t[i + 3]) << 11) |
                (t[i + 4] << 3) |
                ((224 & t[i + 5]) >>> 5)
              );
            }
            function Yn(t, i) {
              return i + 1 < t.length && jn(t, i);
            }
            function $n(t, i) {
              if (Yn(t, i)) {
                var n = Bn(t, i);
                if (i + n >= t.length) return !1;
                var r = Xn(t, i);
                if (r <= n) return !1;
                var e = i + r;
                return e === t.length || Yn(t, e);
              }
              return !1;
            }
            function Hn(t, i, n, r, e) {
              if (!t.samplerate) {
                var s = (function (t, i, n, r) {
                  var e,
                    s,
                    a,
                    o,
                    h = navigator.userAgent.toLowerCase(),
                    u = r,
                    f = [
                      96e3, 88200, 64e3, 48e3, 44100, 32e3, 24e3, 22050, 16e3,
                      12e3, 11025, 8e3, 7350,
                    ];
                  e = 1 + ((192 & i[n + 2]) >>> 6);
                  var l = (60 & i[n + 2]) >>> 2;
                  if (!(l > f.length - 1))
                    return (
                      (a = (1 & i[n + 2]) << 2),
                      (a |= (192 & i[n + 3]) >>> 6),
                      A.log(
                        "manifest codec:" +
                          r +
                          ", ADTS type:" +
                          e +
                          ", samplingIndex:" +
                          l
                      ),
                      /firefox/i.test(h)
                        ? l >= 6
                          ? ((e = 5), (o = new Array(4)), (s = l - 3))
                          : ((e = 2), (o = new Array(2)), (s = l))
                        : -1 !== h.indexOf("android")
                        ? ((e = 2), (o = new Array(2)), (s = l))
                        : ((e = 5),
                          (o = new Array(4)),
                          (r &&
                            (-1 !== r.indexOf("mp4a.40.29") ||
                              -1 !== r.indexOf("mp4a.40.5"))) ||
                          (!r && l >= 6)
                            ? (s = l - 3)
                            : (((r &&
                                -1 !== r.indexOf("mp4a.40.2") &&
                                ((l >= 6 && 1 === a) || /vivaldi/i.test(h))) ||
                                (!r && 1 === a)) &&
                                ((e = 2), (o = new Array(2))),
                              (s = l))),
                      (o[0] = e << 3),
                      (o[0] |= (14 & l) >> 1),
                      (o[1] |= (1 & l) << 7),
                      (o[1] |= a << 3),
                      5 === e &&
                        ((o[1] |= (14 & s) >> 1),
                        (o[2] = (1 & s) << 7),
                        (o[2] |= 8),
                        (o[3] = 0)),
                      {
                        config: o,
                        samplerate: f[l],
                        channelCount: a,
                        codec: "mp4a.40." + e,
                        manifestCodec: u,
                      }
                    );
                  t.trigger(w.ERROR, {
                    type: b.MEDIA_ERROR,
                    details: k.FRAG_PARSING_ERROR,
                    fatal: !0,
                    reason: "invalid ADTS sampling index:" + l,
                  });
                })(i, n, r, e);
                if (!s) return;
                (t.config = s.config),
                  (t.samplerate = s.samplerate),
                  (t.channelCount = s.channelCount),
                  (t.codec = s.codec),
                  (t.manifestCodec = s.manifestCodec),
                  A.log(
                    "parsed codec:" +
                      t.codec +
                      ", rate:" +
                      s.samplerate +
                      ", channels:" +
                      s.channelCount
                  );
              }
            }
            function Vn(t) {
              return 9216e4 / t;
            }
            function Gn(t, i, n, r, e) {
              var s,
                a = r + e * Vn(t.samplerate),
                o = (function (t, i) {
                  var n = Bn(t, i);
                  if (i + n <= t.length) {
                    var r = Xn(t, i) - n;
                    if (r > 0) return { headerLength: n, frameLength: r };
                  }
                })(i, n);
              if (o) {
                var h = o.frameLength,
                  u = o.headerLength,
                  f = u + h,
                  l = Math.max(0, n + f - i.length);
                l
                  ? (s = new Uint8Array(f - u)).set(
                      i.subarray(n + u, i.length),
                      0
                    )
                  : (s = i.subarray(n + u, n + f));
                var c = { unit: s, pts: a };
                return (
                  l || t.samples.push(c), { sample: c, length: f, missing: l }
                );
              }
              var v = i.length - n;
              return (
                (s = new Uint8Array(v)).set(i.subarray(n, i.length), 0),
                { sample: { unit: s, pts: a }, length: v, missing: -1 }
              );
            }
            var Wn = (function (t) {
                function i(i, n) {
                  var r;
                  return (
                    ((r = t.call(this) || this).observer = void 0),
                    (r.config = void 0),
                    (r.observer = i),
                    (r.config = n),
                    r
                  );
                }
                h(i, t);
                var n = i.prototype;
                return (
                  (n.resetInitSegment = function (i, n, r, e) {
                    t.prototype.resetInitSegment.call(this, i, n, r, e),
                      (this.H = {
                        container: "audio/adts",
                        type: "audio",
                        id: 2,
                        pid: -1,
                        sequenceNumber: 0,
                        segmentCodec: "aac",
                        samples: [],
                        manifestCodec: n,
                        duration: e,
                        inputTimeScale: 9e4,
                        dropped: 0,
                      });
                  }),
                  (i.probe = function (t) {
                    if (!t) return !1;
                    for (
                      var i = (nt(t, 0) || []).length, n = t.length;
                      i < n;
                      i++
                    )
                      if ($n(t, i)) return A.log("ADTS sync word found !"), !0;
                    return !1;
                  }),
                  (n.canParse = function (t, i) {
                    return (function (t, i) {
                      return (
                        (function (t, i) {
                          return i + 5 < t.length;
                        })(t, i) &&
                        jn(t, i) &&
                        Xn(t, i) <= t.length - i
                      );
                    })(t, i);
                  }),
                  (n.appendFrame = function (t, i, n) {
                    Hn(t, this.observer, i, n, t.manifestCodec);
                    var r = Gn(t, i, n, this.basePTS, this.frameIndex);
                    if (r && 0 === r.missing) return r;
                  }),
                  i
                );
              })(Un),
              Kn = /\/emsg[-/]ID3/i,
              zn = (function () {
                function t(t, i) {
                  (this.remainderData = null),
                    (this.timeOffset = 0),
                    (this.config = void 0),
                    (this.videoTrack = void 0),
                    (this.audioTrack = void 0),
                    (this.id3Track = void 0),
                    (this.txtTrack = void 0),
                    (this.config = i);
                }
                var i = t.prototype;
                return (
                  (i.resetTimeStamp = function () {}),
                  (i.resetInitSegment = function (t, i, n, r) {
                    var e = (this.videoTrack = Nn("video", 1)),
                      s = (this.audioTrack = Nn("audio", 1)),
                      a = (this.txtTrack = Nn("text", 1));
                    if (
                      ((this.id3Track = Nn("id3", 1)),
                      (this.timeOffset = 0),
                      null != t && t.byteLength)
                    ) {
                      var o = St(t);
                      if (o.video) {
                        var h = o.video,
                          u = h.id,
                          f = h.timescale,
                          l = h.codec;
                        (e.id = u),
                          (e.timescale = a.timescale = f),
                          (e.codec = l);
                      }
                      if (o.audio) {
                        var c = o.audio,
                          v = c.id,
                          d = c.timescale,
                          p = c.codec;
                        (s.id = v), (s.timescale = d), (s.codec = p);
                      }
                      (a.id = yt.text),
                        (e.sampleDuration = 0),
                        (e.duration = s.duration = r);
                    }
                  }),
                  (i.resetContiguity = function () {
                    this.remainderData = null;
                  }),
                  (t.probe = function (t) {
                    return (
                      Tt((t = t.length > 16384 ? t.subarray(0, 16384) : t), [
                        "moof",
                      ]).length > 0
                    );
                  }),
                  (i.demux = function (t, i) {
                    this.timeOffset = i;
                    var n = t,
                      r = this.videoTrack,
                      e = this.txtTrack;
                    if (this.config.progressive) {
                      this.remainderData && (n = Dt(this.remainderData, t));
                      var s = (function (t) {
                        var i = { valid: null, remainder: null },
                          n = Tt(t, ["moof"]);
                        if (!n) return i;
                        if (n.length < 2) return (i.remainder = t), i;
                        var r = n[n.length - 1];
                        return (
                          (i.valid = Q(t, 0, r.byteOffset - 8)),
                          (i.remainder = Q(t, r.byteOffset - 8)),
                          i
                        );
                      })(n);
                      (this.remainderData = s.remainder),
                        (r.samples = s.valid || new Uint8Array());
                    } else r.samples = n;
                    var a = this.extractID3Track(r, i);
                    return (
                      (e.samples = _t(i, r)),
                      {
                        videoTrack: r,
                        audioTrack: this.audioTrack,
                        id3Track: a,
                        textTrack: this.txtTrack,
                      }
                    );
                  }),
                  (i.flush = function () {
                    var t = this.timeOffset,
                      i = this.videoTrack,
                      n = this.txtTrack;
                    (i.samples = this.remainderData || new Uint8Array()),
                      (this.remainderData = null);
                    var r = this.extractID3Track(i, this.timeOffset);
                    return (
                      (n.samples = _t(t, i)),
                      {
                        videoTrack: i,
                        audioTrack: Nn(),
                        id3Track: r,
                        textTrack: Nn(),
                      }
                    );
                  }),
                  (i.extractID3Track = function (t, i) {
                    var n = this.id3Track;
                    if (t.samples.length) {
                      var r = Tt(t.samples, ["emsg"]);
                      r &&
                        r.forEach(function (t) {
                          var r = (function (t) {
                            var i = t[0],
                              n = "",
                              r = "",
                              e = 0,
                              s = 0,
                              a = 0,
                              o = 0,
                              h = 0,
                              u = 0;
                            if (0 === i) {
                              for (; "\0" !== gt(t.subarray(u, u + 1)); )
                                (n += gt(t.subarray(u, u + 1))), (u += 1);
                              for (
                                n += gt(t.subarray(u, u + 1)), u += 1;
                                "\0" !== gt(t.subarray(u, u + 1));

                              )
                                (r += gt(t.subarray(u, u + 1))), (u += 1);
                              (r += gt(t.subarray(u, u + 1))),
                                (u += 1),
                                (e = bt(t, 12)),
                                (s = bt(t, 16)),
                                (o = bt(t, 20)),
                                (h = bt(t, 24)),
                                (u = 28);
                            } else if (1 === i) {
                              e = bt(t, (u += 4));
                              var f = bt(t, (u += 4)),
                                l = bt(t, (u += 4));
                              for (
                                u += 4,
                                  a = Math.pow(2, 32) * f + l,
                                  Number.isSafeInteger(a) ||
                                    ((a = Number.MAX_SAFE_INTEGER),
                                    A.warn(
                                      "Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box"
                                    )),
                                  o = bt(t, u),
                                  h = bt(t, (u += 4)),
                                  u += 4;
                                "\0" !== gt(t.subarray(u, u + 1));

                              )
                                (n += gt(t.subarray(u, u + 1))), (u += 1);
                              for (
                                n += gt(t.subarray(u, u + 1)), u += 1;
                                "\0" !== gt(t.subarray(u, u + 1));

                              )
                                (r += gt(t.subarray(u, u + 1))), (u += 1);
                              (r += gt(t.subarray(u, u + 1))), (u += 1);
                            }
                            return {
                              schemeIdUri: n,
                              value: r,
                              timeScale: e,
                              presentationTime: a,
                              presentationTimeDelta: s,
                              eventDuration: o,
                              id: h,
                              payload: t.subarray(u, t.byteLength),
                            };
                          })(t);
                          if (Kn.test(r.schemeIdUri)) {
                            var e = g(r.presentationTime)
                                ? r.presentationTime / r.timeScale
                                : i + r.presentationTimeDelta / r.timeScale,
                              s =
                                4294967295 === r.eventDuration
                                  ? Number.POSITIVE_INFINITY
                                  : r.eventDuration / r.timeScale;
                            s <= 0.001 && (s = Number.POSITIVE_INFINITY);
                            var a = r.payload;
                            n.samples.push({
                              data: a,
                              len: a.byteLength,
                              dts: e,
                              pts: e,
                              type: wi,
                              duration: s,
                            });
                          }
                        });
                    }
                    return n;
                  }),
                  (i.demuxSampleAes = function (t, i, n) {
                    return Promise.reject(
                      new Error(
                        "The MP4 demuxer does not support SAMPLE-AES decryption"
                      )
                    );
                  }),
                  (i.destroy = function () {}),
                  t
                );
              })(),
              qn = null,
              Jn = [
                32, 64, 96, 128, 160, 192, 224, 256, 288, 320, 352, 384, 416,
                448, 32, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320,
                384, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256,
                320, 32, 48, 56, 64, 80, 96, 112, 128, 144, 160, 176, 192, 224,
                256, 8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160,
              ],
              Qn = [44100, 48e3, 32e3, 22050, 24e3, 16e3, 11025, 12e3, 8e3],
              Zn = [
                [0, 72, 144, 12],
                [0, 0, 0, 0],
                [0, 72, 144, 12],
                [0, 144, 144, 12],
              ],
              tr = [0, 1, 1, 4];
            function ir(t, i, n, r, e) {
              if (!(n + 24 > i.length)) {
                var s = nr(i, n);
                if (s && n + s.frameLength <= i.length) {
                  var a = r + e * ((9e4 * s.samplesPerFrame) / s.sampleRate),
                    o = {
                      unit: i.subarray(n, n + s.frameLength),
                      pts: a,
                      dts: a,
                    };
                  return (
                    (t.config = []),
                    (t.channelCount = s.channelCount),
                    (t.samplerate = s.sampleRate),
                    t.samples.push(o),
                    { sample: o, length: s.frameLength, missing: 0 }
                  );
                }
              }
            }
            function nr(t, i) {
              var n = (t[i + 1] >> 3) & 3,
                r = (t[i + 1] >> 1) & 3,
                e = (t[i + 2] >> 4) & 15,
                s = (t[i + 2] >> 2) & 3;
              if (1 !== n && 0 !== e && 15 !== e && 3 !== s) {
                var a = (t[i + 2] >> 1) & 1,
                  o = t[i + 3] >> 6,
                  h =
                    1e3 * Jn[14 * (3 === n ? 3 - r : 3 === r ? 3 : 4) + e - 1],
                  u = Qn[3 * (3 === n ? 0 : 2 === n ? 1 : 2) + s],
                  f = 3 === o ? 1 : 2,
                  l = Zn[n][r],
                  c = tr[r],
                  v = 8 * l * c,
                  d = Math.floor((l * h) / u + a) * c;
                if (null === qn) {
                  var p = (navigator.userAgent || "").match(/Chrome\/(\d+)/i);
                  qn = p ? parseInt(p[1]) : 0;
                }
                return (
                  !!qn &&
                    qn <= 87 &&
                    2 === r &&
                    h >= 224e3 &&
                    0 === o &&
                    (t[i + 3] = 128 | t[i + 3]),
                  {
                    sampleRate: u,
                    channelCount: f,
                    frameLength: d,
                    samplesPerFrame: v,
                  }
                );
              }
            }
            function rr(t, i) {
              return (
                255 === t[i] && 224 == (224 & t[i + 1]) && 0 != (6 & t[i + 1])
              );
            }
            function er(t, i) {
              return i + 1 < t.length && rr(t, i);
            }
            function sr(t, i) {
              if (i + 1 < t.length && rr(t, i)) {
                var n = nr(t, i),
                  r = 4;
                null != n && n.frameLength && (r = n.frameLength);
                var e = i + r;
                return e === t.length || er(t, e);
              }
              return !1;
            }
            var ar = (function () {
                function t(t) {
                  (this.data = void 0),
                    (this.bytesAvailable = void 0),
                    (this.word = void 0),
                    (this.bitsAvailable = void 0),
                    (this.data = t),
                    (this.bytesAvailable = t.byteLength),
                    (this.word = 0),
                    (this.bitsAvailable = 0);
                }
                var i = t.prototype;
                return (
                  (i.loadWord = function () {
                    var t = this.data,
                      i = this.bytesAvailable,
                      n = t.byteLength - i,
                      r = new Uint8Array(4),
                      e = Math.min(4, i);
                    if (0 === e) throw new Error("no bytes available");
                    r.set(t.subarray(n, n + e)),
                      (this.word = new DataView(r.buffer).getUint32(0)),
                      (this.bitsAvailable = 8 * e),
                      (this.bytesAvailable -= e);
                  }),
                  (i.skipBits = function (t) {
                    var i;
                    (t = Math.min(
                      t,
                      8 * this.bytesAvailable + this.bitsAvailable
                    )),
                      this.bitsAvailable > t
                        ? ((this.word <<= t), (this.bitsAvailable -= t))
                        : ((t -= this.bitsAvailable),
                          (t -= (i = t >> 3) << 3),
                          (this.bytesAvailable -= i),
                          this.loadWord(),
                          (this.word <<= t),
                          (this.bitsAvailable -= t));
                  }),
                  (i.readBits = function (t) {
                    var i = Math.min(this.bitsAvailable, t),
                      n = this.word >>> (32 - i);
                    if (
                      (t > 32 &&
                        A.error("Cannot read more than 32 bits at a time"),
                      (this.bitsAvailable -= i),
                      this.bitsAvailable > 0)
                    )
                      this.word <<= i;
                    else {
                      if (!(this.bytesAvailable > 0))
                        throw new Error("no bits available");
                      this.loadWord();
                    }
                    return (i = t - i) > 0 && this.bitsAvailable
                      ? (n << i) | this.readBits(i)
                      : n;
                  }),
                  (i.skipLZ = function () {
                    var t;
                    for (t = 0; t < this.bitsAvailable; ++t)
                      if (0 != (this.word & (2147483648 >>> t)))
                        return (this.word <<= t), (this.bitsAvailable -= t), t;
                    return this.loadWord(), t + this.skipLZ();
                  }),
                  (i.skipUEG = function () {
                    this.skipBits(1 + this.skipLZ());
                  }),
                  (i.skipEG = function () {
                    this.skipBits(1 + this.skipLZ());
                  }),
                  (i.readUEG = function () {
                    var t = this.skipLZ();
                    return this.readBits(t + 1) - 1;
                  }),
                  (i.readEG = function () {
                    var t = this.readUEG();
                    return 1 & t ? (1 + t) >>> 1 : -1 * (t >>> 1);
                  }),
                  (i.readBoolean = function () {
                    return 1 === this.readBits(1);
                  }),
                  (i.readUByte = function () {
                    return this.readBits(8);
                  }),
                  (i.readUShort = function () {
                    return this.readBits(16);
                  }),
                  (i.readUInt = function () {
                    return this.readBits(32);
                  }),
                  (i.skipScalingList = function (t) {
                    for (var i = 8, n = 8, r = 0; r < t; r++)
                      0 !== n && (n = (i + this.readEG() + 256) % 256),
                        (i = 0 === n ? i : n);
                  }),
                  (i.readSPS = function () {
                    var t,
                      i,
                      n,
                      r = 0,
                      e = 0,
                      s = 0,
                      a = 0,
                      o = this.readUByte.bind(this),
                      h = this.readBits.bind(this),
                      u = this.readUEG.bind(this),
                      f = this.readBoolean.bind(this),
                      l = this.skipBits.bind(this),
                      c = this.skipEG.bind(this),
                      v = this.skipUEG.bind(this),
                      d = this.skipScalingList.bind(this);
                    o();
                    var p = o();
                    if (
                      (h(5),
                      l(3),
                      o(),
                      v(),
                      100 === p ||
                        110 === p ||
                        122 === p ||
                        244 === p ||
                        44 === p ||
                        83 === p ||
                        86 === p ||
                        118 === p ||
                        128 === p)
                    ) {
                      var m = u();
                      if ((3 === m && l(1), v(), v(), l(1), f()))
                        for (i = 3 !== m ? 8 : 12, n = 0; n < i; n++)
                          f() && d(n < 6 ? 16 : 64);
                    }
                    v();
                    var y = u();
                    if (0 === y) u();
                    else if (1 === y)
                      for (l(1), c(), c(), t = u(), n = 0; n < t; n++) c();
                    v(), l(1);
                    var g = u(),
                      w = u(),
                      b = h(1);
                    0 === b && l(1),
                      l(1),
                      f() && ((r = u()), (e = u()), (s = u()), (a = u()));
                    var k = [1, 1];
                    if (f() && f())
                      switch (o()) {
                        case 1:
                          k = [1, 1];
                          break;
                        case 2:
                          k = [12, 11];
                          break;
                        case 3:
                          k = [10, 11];
                          break;
                        case 4:
                          k = [16, 11];
                          break;
                        case 5:
                          k = [40, 33];
                          break;
                        case 6:
                          k = [24, 11];
                          break;
                        case 7:
                          k = [20, 11];
                          break;
                        case 8:
                          k = [32, 11];
                          break;
                        case 9:
                          k = [80, 33];
                          break;
                        case 10:
                          k = [18, 11];
                          break;
                        case 11:
                          k = [15, 11];
                          break;
                        case 12:
                          k = [64, 33];
                          break;
                        case 13:
                          k = [160, 99];
                          break;
                        case 14:
                          k = [4, 3];
                          break;
                        case 15:
                          k = [3, 2];
                          break;
                        case 16:
                          k = [2, 1];
                          break;
                        case 255:
                          k = [(o() << 8) | o(), (o() << 8) | o()];
                      }
                    return {
                      width: Math.ceil(16 * (g + 1) - 2 * r - 2 * e),
                      height: (2 - b) * (w + 1) * 16 - (b ? 2 : 4) * (s + a),
                      pixelRatio: k,
                    };
                  }),
                  (i.readSliceType = function () {
                    return this.readUByte(), this.readUEG(), this.readUEG();
                  }),
                  t
                );
              })(),
              or = (function () {
                function t(t, i, n) {
                  (this.keyData = void 0),
                    (this.decrypter = void 0),
                    (this.keyData = n),
                    (this.decrypter = new kn(i, { removePKCS7Padding: !1 }));
                }
                var i = t.prototype;
                return (
                  (i.decryptBuffer = function (t) {
                    return this.decrypter.decrypt(
                      t,
                      this.keyData.key.buffer,
                      this.keyData.iv.buffer
                    );
                  }),
                  (i.decryptAacSample = function (t, i, n) {
                    var r = this,
                      e = t[i].unit;
                    if (!(e.length <= 16)) {
                      var s = e.subarray(16, e.length - (e.length % 16)),
                        a = s.buffer.slice(
                          s.byteOffset,
                          s.byteOffset + s.length
                        );
                      this.decryptBuffer(a).then(function (s) {
                        var a = new Uint8Array(s);
                        e.set(a, 16),
                          r.decrypter.isSync() ||
                            r.decryptAacSamples(t, i + 1, n);
                      });
                    }
                  }),
                  (i.decryptAacSamples = function (t, i, n) {
                    for (; ; i++) {
                      if (i >= t.length) return void n();
                      if (
                        !(
                          t[i].unit.length < 32 ||
                          (this.decryptAacSample(t, i, n),
                          this.decrypter.isSync())
                        )
                      )
                        return;
                    }
                  }),
                  (i.getAvcEncryptedData = function (t) {
                    for (
                      var i = 16 * Math.floor((t.length - 48) / 160) + 16,
                        n = new Int8Array(i),
                        r = 0,
                        e = 32;
                      e < t.length - 16;
                      e += 160, r += 16
                    )
                      n.set(t.subarray(e, e + 16), r);
                    return n;
                  }),
                  (i.getAvcDecryptedUnit = function (t, i) {
                    for (
                      var n = new Uint8Array(i), r = 0, e = 32;
                      e < t.length - 16;
                      e += 160, r += 16
                    )
                      t.set(n.subarray(r, r + 16), e);
                    return t;
                  }),
                  (i.decryptAvcSample = function (t, i, n, r, e) {
                    var s = this,
                      a = Lt(e.data),
                      o = this.getAvcEncryptedData(a);
                    this.decryptBuffer(o.buffer).then(function (o) {
                      (e.data = s.getAvcDecryptedUnit(a, o)),
                        s.decrypter.isSync() ||
                          s.decryptAvcSamples(t, i, n + 1, r);
                    });
                  }),
                  (i.decryptAvcSamples = function (t, i, n, r) {
                    if (t instanceof Uint8Array)
                      throw new Error(
                        "Cannot decrypt samples of type Uint8Array"
                      );
                    for (; ; i++, n = 0) {
                      if (i >= t.length) return void r();
                      for (var e = t[i].units; !(n >= e.length); n++) {
                        var s = e[n];
                        if (
                          !(
                            s.data.length <= 48 ||
                            (1 !== s.type && 5 !== s.type) ||
                            (this.decryptAvcSample(t, i, n, r, s),
                            this.decrypter.isSync())
                          )
                        )
                          return;
                      }
                    }
                  }),
                  t
                );
              })(),
              hr = 188,
              ur = (function () {
                function t(t, i, n) {
                  (this.observer = void 0),
                    (this.config = void 0),
                    (this.typeSupported = void 0),
                    (this.sampleAes = null),
                    (this.pmtParsed = !1),
                    (this.audioCodec = void 0),
                    (this.videoCodec = void 0),
                    (this.G = 0),
                    (this.W = -1),
                    (this.K = void 0),
                    (this.H = void 0),
                    (this.V = void 0),
                    (this.q = void 0),
                    (this.aacOverFlow = null),
                    (this.avcSample = null),
                    (this.remainderData = null),
                    (this.observer = t),
                    (this.config = i),
                    (this.typeSupported = n);
                }
                (t.probe = function (i) {
                  var n = t.syncOffset(i);
                  return (
                    n > 0 &&
                      A.warn(
                        "MPEG2-TS detected but first sync word found @ offset " +
                          n
                      ),
                    -1 !== n
                  );
                }),
                  (t.syncOffset = function (t) {
                    for (
                      var i = t.length,
                        n = Math.min(940, t.length - hr) + 1,
                        r = 0;
                      r < n;

                    ) {
                      for (var e = !1, s = -1, a = 0, o = r; o < i; o += hr) {
                        if (71 !== t[o]) {
                          if (a) return -1;
                          break;
                        }
                        if (
                          (a++,
                          -1 === s &&
                            0 !== (s = o) &&
                            (n = Math.min(s + 18612, t.length - hr) + 1),
                          e || (e = 0 === lr(t, o)),
                          e && a > 1 && ((0 === s && a > 2) || o + hr > n))
                        )
                          return s;
                      }
                      r++;
                    }
                    return -1;
                  }),
                  (t.createTrack = function (t, i) {
                    return {
                      container:
                        "video" === t || "audio" === t ? "video/mp2t" : void 0,
                      type: t,
                      id: yt[t],
                      pid: -1,
                      inputTimeScale: 9e4,
                      sequenceNumber: 0,
                      samples: [],
                      dropped: 0,
                      duration: "audio" === t ? i : void 0,
                    };
                  });
                var i = t.prototype;
                return (
                  (i.resetInitSegment = function (i, n, r, e) {
                    (this.pmtParsed = !1),
                      (this.W = -1),
                      (this.K = t.createTrack("video")),
                      (this.H = t.createTrack("audio", e)),
                      (this.V = t.createTrack("id3")),
                      (this.q = t.createTrack("text")),
                      (this.H.segmentCodec = "aac"),
                      (this.aacOverFlow = null),
                      (this.avcSample = null),
                      (this.remainderData = null),
                      (this.audioCodec = n),
                      (this.videoCodec = r),
                      (this.G = e);
                  }),
                  (i.resetTimeStamp = function () {}),
                  (i.resetContiguity = function () {
                    var t = this.H,
                      i = this.K,
                      n = this.V;
                    t && (t.pesData = null),
                      i && (i.pesData = null),
                      n && (n.pesData = null),
                      (this.aacOverFlow = null),
                      (this.avcSample = null),
                      (this.remainderData = null);
                  }),
                  (i.demux = function (i, n, r, e) {
                    var s;
                    void 0 === r && (r = !1),
                      void 0 === e && (e = !1),
                      r || (this.sampleAes = null);
                    var a = this.K,
                      o = this.H,
                      h = this.V,
                      u = this.q,
                      f = a.pid,
                      l = a.pesData,
                      c = o.pid,
                      v = h.pid,
                      d = o.pesData,
                      p = h.pesData,
                      m = null,
                      y = this.pmtParsed,
                      g = this.W,
                      E = i.length;
                    if (
                      (this.remainderData &&
                        ((E = (i = Dt(this.remainderData, i)).length),
                        (this.remainderData = null)),
                      E < hr && !e)
                    )
                      return (
                        (this.remainderData = i),
                        {
                          audioTrack: o,
                          videoTrack: a,
                          id3Track: h,
                          textTrack: u,
                        }
                      );
                    var T = Math.max(0, t.syncOffset(i));
                    (E -= (E - T) % hr) < i.byteLength &&
                      !e &&
                      (this.remainderData = new Uint8Array(
                        i.buffer,
                        E,
                        i.buffer.byteLength - E
                      ));
                    for (var x = 0, S = T; S < E; S += hr)
                      if (71 === i[S]) {
                        var M = !!(64 & i[S + 1]),
                          D = lr(i, S),
                          _ = void 0;
                        if ((48 & i[S + 3]) >> 4 > 1) {
                          if ((_ = S + 5 + i[S + 4]) === S + hr) continue;
                        } else _ = S + 4;
                        switch (D) {
                          case f:
                            M &&
                              (l &&
                                (s = dr(l)) &&
                                this.parseAVCPES(a, u, s, !1),
                              (l = { data: [], size: 0 })),
                              l &&
                                (l.data.push(i.subarray(_, S + hr)),
                                (l.size += S + hr - _));
                            break;
                          case c:
                            if (M) {
                              if (d && (s = dr(d)))
                                switch (o.segmentCodec) {
                                  case "aac":
                                    this.parseAACPES(o, s);
                                    break;
                                  case "mp3":
                                    this.parseMPEGPES(o, s);
                                }
                              d = { data: [], size: 0 };
                            }
                            d &&
                              (d.data.push(i.subarray(_, S + hr)),
                              (d.size += S + hr - _));
                            break;
                          case v:
                            M &&
                              (p && (s = dr(p)) && this.parseID3PES(h, s),
                              (p = { data: [], size: 0 })),
                              p &&
                                (p.data.push(i.subarray(_, S + hr)),
                                (p.size += S + hr - _));
                            break;
                          case 0:
                            M && (_ += i[_] + 1), (g = this.W = cr(i, _));
                            break;
                          case g:
                            M && (_ += i[_] + 1);
                            var O = vr(i, _, this.typeSupported, r);
                            (f = O.avc) > 0 && (a.pid = f),
                              (c = O.audio) > 0 &&
                                ((o.pid = c),
                                (o.segmentCodec = O.segmentCodec)),
                              (v = O.id3) > 0 && (h.pid = v),
                              null === m ||
                                y ||
                                (A.warn(
                                  "MPEG-TS PMT found at " +
                                    S +
                                    " after unknown PID '" +
                                    m +
                                    "'. Backtracking to sync byte @" +
                                    T +
                                    " to parse all TS packets."
                                ),
                                (m = null),
                                (S = T - 188)),
                              (y = this.pmtParsed = !0);
                            break;
                          case 17:
                          case 8191:
                            break;
                          default:
                            m = D;
                        }
                      } else x++;
                    if (x > 0) {
                      var R = new Error(
                        "Found " +
                          x +
                          " TS packet/s that do not start with 0x47"
                      );
                      this.observer.emit(w.ERROR, w.ERROR, {
                        type: b.MEDIA_ERROR,
                        details: k.FRAG_PARSING_ERROR,
                        fatal: !1,
                        error: R,
                        reason: R.message,
                      });
                    }
                    (a.pesData = l), (o.pesData = d), (h.pesData = p);
                    var L = {
                      audioTrack: o,
                      videoTrack: a,
                      id3Track: h,
                      textTrack: u,
                    };
                    return e && this.extractRemainingSamples(L), L;
                  }),
                  (i.flush = function () {
                    var t,
                      i = this.remainderData;
                    return (
                      (this.remainderData = null),
                      (t = i
                        ? this.demux(i, -1, !1, !0)
                        : {
                            videoTrack: this.K,
                            audioTrack: this.H,
                            id3Track: this.V,
                            textTrack: this.q,
                          }),
                      this.extractRemainingSamples(t),
                      this.sampleAes ? this.decrypt(t, this.sampleAes) : t
                    );
                  }),
                  (i.extractRemainingSamples = function (t) {
                    var i,
                      n = t.audioTrack,
                      r = t.videoTrack,
                      e = t.id3Track,
                      s = t.textTrack,
                      a = r.pesData,
                      o = n.pesData,
                      h = e.pesData;
                    if (
                      (a && (i = dr(a))
                        ? (this.parseAVCPES(r, s, i, !0), (r.pesData = null))
                        : (r.pesData = a),
                      o && (i = dr(o)))
                    ) {
                      switch (n.segmentCodec) {
                        case "aac":
                          this.parseAACPES(n, i);
                          break;
                        case "mp3":
                          this.parseMPEGPES(n, i);
                      }
                      n.pesData = null;
                    } else
                      null != o &&
                        o.size &&
                        A.log(
                          "last AAC PES packet truncated,might overlap between fragments"
                        ),
                        (n.pesData = o);
                    h && (i = dr(h))
                      ? (this.parseID3PES(e, i), (e.pesData = null))
                      : (e.pesData = h);
                  }),
                  (i.demuxSampleAes = function (t, i, n) {
                    var r = this.demux(t, n, !0, !this.config.progressive),
                      e = (this.sampleAes = new or(
                        this.observer,
                        this.config,
                        i
                      ));
                    return this.decrypt(r, e);
                  }),
                  (i.decrypt = function (t, i) {
                    return new Promise(function (n) {
                      var r = t.audioTrack,
                        e = t.videoTrack;
                      r.samples && "aac" === r.segmentCodec
                        ? i.decryptAacSamples(r.samples, 0, function () {
                            e.samples
                              ? i.decryptAvcSamples(
                                  e.samples,
                                  0,
                                  0,
                                  function () {
                                    n(t);
                                  }
                                )
                              : n(t);
                          })
                        : e.samples &&
                          i.decryptAvcSamples(e.samples, 0, 0, function () {
                            n(t);
                          });
                    });
                  }),
                  (i.destroy = function () {
                    this.G = 0;
                  }),
                  (i.parseAVCPES = function (t, i, n, r) {
                    var e,
                      s = this,
                      a = this.parseAVCNALu(t, n.data),
                      o = this.avcSample,
                      h = !1;
                    (n.data = null),
                      o &&
                        a.length &&
                        !t.audFound &&
                        (pr(o, t),
                        (o = this.avcSample = fr(!1, n.pts, n.dts, ""))),
                      a.forEach(function (r) {
                        switch (r.type) {
                          case 1:
                            (e = !0),
                              o || (o = s.avcSample = fr(!0, n.pts, n.dts, "")),
                              (o.frame = !0);
                            var a = r.data;
                            if (h && a.length > 4) {
                              var u = new ar(a).readSliceType();
                              (2 !== u && 4 !== u && 7 !== u && 9 !== u) ||
                                (o.key = !0);
                            }
                            break;
                          case 5:
                            (e = !0),
                              o || (o = s.avcSample = fr(!0, n.pts, n.dts, "")),
                              (o.key = !0),
                              (o.frame = !0);
                            break;
                          case 6:
                            (e = !0), Rt(r.data, 1, n.pts, i.samples);
                            break;
                          case 7:
                            if (((e = !0), (h = !0), !t.sps)) {
                              var f = r.data,
                                l = new ar(f).readSPS();
                              (t.width = l.width),
                                (t.height = l.height),
                                (t.pixelRatio = l.pixelRatio),
                                (t.sps = [f]),
                                (t.duration = s.G);
                              for (
                                var c = f.subarray(1, 4), v = "avc1.", d = 0;
                                d < 3;
                                d++
                              ) {
                                var p = c[d].toString(16);
                                p.length < 2 && (p = "0" + p), (v += p);
                              }
                              t.codec = v;
                            }
                            break;
                          case 8:
                            (e = !0), t.pps || (t.pps = [r.data]);
                            break;
                          case 9:
                            (e = !1),
                              (t.audFound = !0),
                              o && pr(o, t),
                              (o = s.avcSample = fr(!1, n.pts, n.dts, ""));
                            break;
                          case 12:
                            e = !0;
                            break;
                          default:
                            (e = !1),
                              o && (o.debug += "unknown NAL " + r.type + " ");
                        }
                        o && e && o.units.push(r);
                      }),
                      r && o && (pr(o, t), (this.avcSample = null));
                  }),
                  (i.getLastNalUnit = function (t) {
                    var i,
                      n,
                      r = this.avcSample;
                    if (
                      ((r && 0 !== r.units.length) || (r = t[t.length - 1]),
                      null != (i = r) && i.units)
                    ) {
                      var e = r.units;
                      n = e[e.length - 1];
                    }
                    return n;
                  }),
                  (i.parseAVCNALu = function (t, i) {
                    var n,
                      r,
                      e = i.byteLength,
                      s = t.naluState || 0,
                      a = s,
                      o = [],
                      h = 0,
                      u = -1,
                      f = 0;
                    for (
                      -1 === s && ((u = 0), (f = 31 & i[0]), (s = 0), (h = 1));
                      h < e;

                    )
                      if (((n = i[h++]), s))
                        if (1 !== s)
                          if (n)
                            if (1 === n) {
                              if (u >= 0) {
                                var l = {
                                  data: i.subarray(u, h - s - 1),
                                  type: f,
                                };
                                o.push(l);
                              } else {
                                var c = this.getLastNalUnit(t.samples);
                                if (
                                  c &&
                                  (a &&
                                    h <= 4 - a &&
                                    c.state &&
                                    (c.data = c.data.subarray(
                                      0,
                                      c.data.byteLength - a
                                    )),
                                  (r = h - s - 1) > 0)
                                ) {
                                  var v = new Uint8Array(c.data.byteLength + r);
                                  v.set(c.data, 0),
                                    v.set(i.subarray(0, r), c.data.byteLength),
                                    (c.data = v),
                                    (c.state = 0);
                                }
                              }
                              h < e
                                ? ((u = h), (f = 31 & i[h]), (s = 0))
                                : (s = -1);
                            } else s = 0;
                          else s = 3;
                        else s = n ? 0 : 2;
                      else s = n ? 0 : 1;
                    if (u >= 0 && s >= 0) {
                      var d = { data: i.subarray(u, e), type: f, state: s };
                      o.push(d);
                    }
                    if (0 === o.length) {
                      var p = this.getLastNalUnit(t.samples);
                      if (p) {
                        var m = new Uint8Array(
                          p.data.byteLength + i.byteLength
                        );
                        m.set(p.data, 0),
                          m.set(i, p.data.byteLength),
                          (p.data = m);
                      }
                    }
                    return (t.naluState = s), o;
                  }),
                  (i.parseAACPES = function (t, i) {
                    var n,
                      r,
                      e,
                      s = 0,
                      a = this.aacOverFlow,
                      o = i.data;
                    if (a) {
                      this.aacOverFlow = null;
                      var h = a.missing,
                        u = a.sample.unit.byteLength;
                      if (-1 === h) {
                        var f = new Uint8Array(u + o.byteLength);
                        f.set(a.sample.unit, 0), f.set(o, u), (o = f);
                      } else {
                        var l = u - h;
                        a.sample.unit.set(o.subarray(0, h), l),
                          t.samples.push(a.sample),
                          (s = a.missing);
                      }
                    }
                    for (n = s, r = o.length; n < r - 1 && !Yn(o, n); n++);
                    if (n !== s) {
                      var c,
                        v = n < r - 1;
                      c = v
                        ? "AAC PES did not start with ADTS header,offset:" + n
                        : "No ADTS header found in AAC PES";
                      var d = new Error(c);
                      if (
                        (A.warn("parsing error: " + c),
                        this.observer.emit(w.ERROR, w.ERROR, {
                          type: b.MEDIA_ERROR,
                          details: k.FRAG_PARSING_ERROR,
                          fatal: !1,
                          levelRetry: v,
                          error: d,
                          reason: c,
                        }),
                        !v)
                      )
                        return;
                    }
                    if (
                      (Hn(t, this.observer, o, n, this.audioCodec),
                      void 0 !== i.pts)
                    )
                      e = i.pts;
                    else {
                      if (!a)
                        return void A.warn("[tsdemuxer]: AAC PES unknown PTS");
                      var p = Vn(t.samplerate);
                      e = a.sample.pts + p;
                    }
                    for (var m, y = 0; n < r; ) {
                      if (((n += (m = Gn(t, o, n, e, y)).length), m.missing)) {
                        this.aacOverFlow = m;
                        break;
                      }
                      for (y++; n < r - 1 && !Yn(o, n); n++);
                    }
                  }),
                  (i.parseMPEGPES = function (t, i) {
                    var n = i.data,
                      r = n.length,
                      e = 0,
                      s = 0,
                      a = i.pts;
                    if (void 0 !== a)
                      for (; s < r; )
                        if (er(n, s)) {
                          var o = ir(t, n, s, a, e);
                          if (!o) break;
                          (s += o.length), e++;
                        } else s++;
                    else A.warn("[tsdemuxer]: MPEG PES unknown PTS");
                  }),
                  (i.parseID3PES = function (t, i) {
                    if (void 0 !== i.pts) {
                      var n = o({}, i, {
                        type: this.K ? wi : gi,
                        duration: Number.POSITIVE_INFINITY,
                      });
                      t.samples.push(n);
                    } else A.warn("[tsdemuxer]: ID3 PES unknown PTS");
                  }),
                  t
                );
              })();
            function fr(t, i, n, r) {
              return {
                key: t,
                frame: !1,
                pts: i,
                dts: n,
                units: [],
                debug: r,
                length: 0,
              };
            }
            function lr(t, i) {
              return ((31 & t[i + 1]) << 8) + t[i + 2];
            }
            function cr(t, i) {
              return ((31 & t[i + 10]) << 8) | t[i + 11];
            }
            function vr(t, i, n, r) {
              var e = { audio: -1, avc: -1, id3: -1, segmentCodec: "aac" },
                s = i + 3 + (((15 & t[i + 1]) << 8) | t[i + 2]) - 4;
              for (i += 12 + (((15 & t[i + 10]) << 8) | t[i + 11]); i < s; ) {
                var a = lr(t, i);
                switch (t[i]) {
                  case 207:
                    if (!r) {
                      A.log(
                        "ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream"
                      );
                      break;
                    }
                  case 15:
                    -1 === e.audio && (e.audio = a);
                    break;
                  case 21:
                    -1 === e.id3 && (e.id3 = a);
                    break;
                  case 219:
                    if (!r) {
                      A.log(
                        "H.264 with AES-128-CBC slice encryption found in unencrypted stream"
                      );
                      break;
                    }
                  case 27:
                    -1 === e.avc && (e.avc = a);
                    break;
                  case 3:
                  case 4:
                    !0 !== n.mpeg && !0 !== n.mp3
                      ? A.log("MPEG audio found, not supported in this browser")
                      : -1 === e.audio &&
                        ((e.audio = a), (e.segmentCodec = "mp3"));
                    break;
                  case 36:
                    A.warn("Unsupported HEVC stream type found");
                }
                i += 5 + (((15 & t[i + 3]) << 8) | t[i + 4]);
              }
              return e;
            }
            function dr(t) {
              var i,
                n,
                r,
                e,
                s,
                a = 0,
                o = t.data;
              if (!t || 0 === t.size) return null;
              for (; o[0].length < 19 && o.length > 1; ) {
                var h = new Uint8Array(o[0].length + o[1].length);
                h.set(o[0]),
                  h.set(o[1], o[0].length),
                  (o[0] = h),
                  o.splice(1, 1);
              }
              if (1 === ((i = o[0])[0] << 16) + (i[1] << 8) + i[2]) {
                if ((n = (i[4] << 8) + i[5]) && n > t.size - 6) return null;
                var u = i[7];
                192 & u &&
                  ((e =
                    536870912 * (14 & i[9]) +
                    4194304 * (255 & i[10]) +
                    16384 * (254 & i[11]) +
                    128 * (255 & i[12]) +
                    (254 & i[13]) / 2),
                  64 & u
                    ? e -
                        (s =
                          536870912 * (14 & i[14]) +
                          4194304 * (255 & i[15]) +
                          16384 * (254 & i[16]) +
                          128 * (255 & i[17]) +
                          (254 & i[18]) / 2) >
                        54e5 &&
                      (A.warn(
                        Math.round((e - s) / 9e4) +
                          "s delta between PTS and DTS, align them"
                      ),
                      (e = s))
                    : (s = e));
                var f = (r = i[8]) + 9;
                if (t.size <= f) return null;
                t.size -= f;
                for (
                  var l = new Uint8Array(t.size), c = 0, v = o.length;
                  c < v;
                  c++
                ) {
                  var d = (i = o[c]).byteLength;
                  if (f) {
                    if (f > d) {
                      f -= d;
                      continue;
                    }
                    (i = i.subarray(f)), (d -= f), (f = 0);
                  }
                  l.set(i, a), (a += d);
                }
                return n && (n -= r + 3), { data: l, pts: e, dts: s, len: n };
              }
              return null;
            }
            function pr(t, i) {
              if (t.units.length && t.frame) {
                if (void 0 === t.pts) {
                  var n = i.samples,
                    r = n.length;
                  if (!r) return void i.dropped++;
                  var e = n[r - 1];
                  (t.pts = e.pts), (t.dts = e.dts);
                }
                i.samples.push(t);
              }
              t.debug.length && A.log(t.pts + "/" + t.dts + ":" + t.debug);
            }
            var mr = (function (t) {
                function i() {
                  return t.apply(this, arguments) || this;
                }
                h(i, t);
                var n = i.prototype;
                return (
                  (n.resetInitSegment = function (i, n, r, e) {
                    t.prototype.resetInitSegment.call(this, i, n, r, e),
                      (this.H = {
                        container: "audio/mpeg",
                        type: "audio",
                        id: 2,
                        pid: -1,
                        sequenceNumber: 0,
                        segmentCodec: "mp3",
                        samples: [],
                        manifestCodec: n,
                        duration: e,
                        inputTimeScale: 9e4,
                        dropped: 0,
                      });
                  }),
                  (i.probe = function (t) {
                    if (!t) return !1;
                    for (
                      var i = (nt(t, 0) || []).length, n = t.length;
                      i < n;
                      i++
                    )
                      if (sr(t, i))
                        return A.log("MPEG Audio sync word found !"), !0;
                    return !1;
                  }),
                  (n.canParse = function (t, i) {
                    return (function (t, i) {
                      return rr(t, i) && 4 <= t.length - i;
                    })(t, i);
                  }),
                  (n.appendFrame = function (t, i, n) {
                    if (null !== this.basePTS)
                      return ir(t, i, n, this.basePTS, this.frameIndex);
                  }),
                  i
                );
              })(Un),
              yr = (function () {
                function t() {}
                return (
                  (t.getSilentFrame = function (t, i) {
                    if ("mp4a.40.2" === t) {
                      if (1 === i)
                        return new Uint8Array([0, 200, 0, 128, 35, 128]);
                      if (2 === i)
                        return new Uint8Array([
                          33, 0, 73, 144, 2, 25, 0, 35, 128,
                        ]);
                      if (3 === i)
                        return new Uint8Array([
                          0, 200, 0, 128, 32, 132, 1, 38, 64, 8, 100, 0, 142,
                        ]);
                      if (4 === i)
                        return new Uint8Array([
                          0, 200, 0, 128, 32, 132, 1, 38, 64, 8, 100, 0, 128,
                          44, 128, 8, 2, 56,
                        ]);
                      if (5 === i)
                        return new Uint8Array([
                          0, 200, 0, 128, 32, 132, 1, 38, 64, 8, 100, 0, 130,
                          48, 4, 153, 0, 33, 144, 2, 56,
                        ]);
                      if (6 === i)
                        return new Uint8Array([
                          0, 200, 0, 128, 32, 132, 1, 38, 64, 8, 100, 0, 130,
                          48, 4, 153, 0, 33, 144, 2, 0, 178, 0, 32, 8, 224,
                        ]);
                    } else {
                      if (1 === i)
                        return new Uint8Array([
                          1, 64, 34, 128, 163, 78, 230, 128, 186, 8, 0, 0, 0,
                          28, 6, 241, 193, 10, 90, 90, 90, 90, 90, 90, 90, 90,
                          90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90,
                          90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90,
                          90, 90, 90, 90, 90, 90, 94,
                        ]);
                      if (2 === i)
                        return new Uint8Array([
                          1, 64, 34, 128, 163, 94, 230, 128, 186, 8, 0, 0, 0, 0,
                          149, 0, 6, 241, 161, 10, 90, 90, 90, 90, 90, 90, 90,
                          90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90,
                          90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90,
                          90, 90, 90, 90, 90, 94,
                        ]);
                      if (3 === i)
                        return new Uint8Array([
                          1, 64, 34, 128, 163, 94, 230, 128, 186, 8, 0, 0, 0, 0,
                          149, 0, 6, 241, 161, 10, 90, 90, 90, 90, 90, 90, 90,
                          90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90,
                          90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90,
                          90, 90, 90, 90, 90, 94,
                        ]);
                    }
                  }),
                  t
                );
              })(),
              gr = Math.pow(2, 32) - 1,
              wr = (function () {
                function t() {}
                return (
                  (t.init = function () {
                    var i;
                    for (i in ((t.types = {
                      avc1: [],
                      avcC: [],
                      btrt: [],
                      dinf: [],
                      dref: [],
                      esds: [],
                      ftyp: [],
                      hdlr: [],
                      mdat: [],
                      mdhd: [],
                      mdia: [],
                      mfhd: [],
                      minf: [],
                      moof: [],
                      moov: [],
                      mp4a: [],
                      ".mp3": [],
                      mvex: [],
                      mvhd: [],
                      pasp: [],
                      sdtp: [],
                      stbl: [],
                      stco: [],
                      stsc: [],
                      stsd: [],
                      stsz: [],
                      stts: [],
                      tfdt: [],
                      tfhd: [],
                      traf: [],
                      trak: [],
                      trun: [],
                      trex: [],
                      tkhd: [],
                      vmhd: [],
                      smhd: [],
                    }),
                    t.types))
                      t.types.hasOwnProperty(i) &&
                        (t.types[i] = [
                          i.charCodeAt(0),
                          i.charCodeAt(1),
                          i.charCodeAt(2),
                          i.charCodeAt(3),
                        ]);
                    var n = new Uint8Array([
                        0, 0, 0, 0, 0, 0, 0, 0, 118, 105, 100, 101, 0, 0, 0, 0,
                        0, 0, 0, 0, 0, 0, 0, 0, 86, 105, 100, 101, 111, 72, 97,
                        110, 100, 108, 101, 114, 0,
                      ]),
                      r = new Uint8Array([
                        0, 0, 0, 0, 0, 0, 0, 0, 115, 111, 117, 110, 0, 0, 0, 0,
                        0, 0, 0, 0, 0, 0, 0, 0, 83, 111, 117, 110, 100, 72, 97,
                        110, 100, 108, 101, 114, 0,
                      ]);
                    t.HDLR_TYPES = { video: n, audio: r };
                    var e = new Uint8Array([
                        0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 12, 117, 114, 108, 32,
                        0, 0, 0, 1,
                      ]),
                      s = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]);
                    (t.STTS = t.STSC = t.STCO = s),
                      (t.STSZ = new Uint8Array([
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                      ])),
                      (t.VMHD = new Uint8Array([
                        0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,
                      ])),
                      (t.SMHD = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0])),
                      (t.STSD = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1]));
                    var a = new Uint8Array([105, 115, 111, 109]),
                      o = new Uint8Array([97, 118, 99, 49]),
                      h = new Uint8Array([0, 0, 0, 1]);
                    (t.FTYP = t.box(t.types.ftyp, a, h, a, o)),
                      (t.DINF = t.box(t.types.dinf, t.box(t.types.dref, e)));
                  }),
                  (t.box = function (t) {
                    for (
                      var i = 8,
                        n = arguments.length,
                        r = new Array(n > 1 ? n - 1 : 0),
                        e = 1;
                      e < n;
                      e++
                    )
                      r[e - 1] = arguments[e];
                    for (var s = r.length, a = s; s--; ) i += r[s].byteLength;
                    var o = new Uint8Array(i);
                    for (
                      o[0] = (i >> 24) & 255,
                        o[1] = (i >> 16) & 255,
                        o[2] = (i >> 8) & 255,
                        o[3] = 255 & i,
                        o.set(t, 4),
                        s = 0,
                        i = 8;
                      s < a;
                      s++
                    )
                      o.set(r[s], i), (i += r[s].byteLength);
                    return o;
                  }),
                  (t.hdlr = function (i) {
                    return t.box(t.types.hdlr, t.HDLR_TYPES[i]);
                  }),
                  (t.mdat = function (i) {
                    return t.box(t.types.mdat, i);
                  }),
                  (t.mdhd = function (i, n) {
                    n *= i;
                    var r = Math.floor(n / (gr + 1)),
                      e = Math.floor(n % (gr + 1));
                    return t.box(
                      t.types.mdhd,
                      new Uint8Array([
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        2,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        3,
                        (i >> 24) & 255,
                        (i >> 16) & 255,
                        (i >> 8) & 255,
                        255 & i,
                        r >> 24,
                        (r >> 16) & 255,
                        (r >> 8) & 255,
                        255 & r,
                        e >> 24,
                        (e >> 16) & 255,
                        (e >> 8) & 255,
                        255 & e,
                        85,
                        196,
                        0,
                        0,
                      ])
                    );
                  }),
                  (t.mdia = function (i) {
                    return t.box(
                      t.types.mdia,
                      t.mdhd(i.timescale, i.duration),
                      t.hdlr(i.type),
                      t.minf(i)
                    );
                  }),
                  (t.mfhd = function (i) {
                    return t.box(
                      t.types.mfhd,
                      new Uint8Array([
                        0,
                        0,
                        0,
                        0,
                        i >> 24,
                        (i >> 16) & 255,
                        (i >> 8) & 255,
                        255 & i,
                      ])
                    );
                  }),
                  (t.minf = function (i) {
                    return "audio" === i.type
                      ? t.box(
                          t.types.minf,
                          t.box(t.types.smhd, t.SMHD),
                          t.DINF,
                          t.stbl(i)
                        )
                      : t.box(
                          t.types.minf,
                          t.box(t.types.vmhd, t.VMHD),
                          t.DINF,
                          t.stbl(i)
                        );
                  }),
                  (t.moof = function (i, n, r) {
                    return t.box(t.types.moof, t.mfhd(i), t.traf(r, n));
                  }),
                  (t.moov = function (i) {
                    for (var n = i.length, r = []; n--; ) r[n] = t.trak(i[n]);
                    return t.box.apply(
                      null,
                      [t.types.moov, t.mvhd(i[0].timescale, i[0].duration)]
                        .concat(r)
                        .concat(t.mvex(i))
                    );
                  }),
                  (t.mvex = function (i) {
                    for (var n = i.length, r = []; n--; ) r[n] = t.trex(i[n]);
                    return t.box.apply(null, [t.types.mvex].concat(r));
                  }),
                  (t.mvhd = function (i, n) {
                    n *= i;
                    var r = Math.floor(n / (gr + 1)),
                      e = Math.floor(n % (gr + 1)),
                      s = new Uint8Array([
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        2,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        3,
                        (i >> 24) & 255,
                        (i >> 16) & 255,
                        (i >> 8) & 255,
                        255 & i,
                        r >> 24,
                        (r >> 16) & 255,
                        (r >> 8) & 255,
                        255 & r,
                        e >> 24,
                        (e >> 16) & 255,
                        (e >> 8) & 255,
                        255 & e,
                        0,
                        1,
                        0,
                        0,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        64,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        255,
                        255,
                        255,
                        255,
                      ]);
                    return t.box(t.types.mvhd, s);
                  }),
                  (t.sdtp = function (i) {
                    var n,
                      r,
                      e = i.samples || [],
                      s = new Uint8Array(4 + e.length);
                    for (n = 0; n < e.length; n++)
                      (r = e[n].flags),
                        (s[n + 4] =
                          (r.dependsOn << 4) |
                          (r.isDependedOn << 2) |
                          r.hasRedundancy);
                    return t.box(t.types.sdtp, s);
                  }),
                  (t.stbl = function (i) {
                    return t.box(
                      t.types.stbl,
                      t.stsd(i),
                      t.box(t.types.stts, t.STTS),
                      t.box(t.types.stsc, t.STSC),
                      t.box(t.types.stsz, t.STSZ),
                      t.box(t.types.stco, t.STCO)
                    );
                  }),
                  (t.avc1 = function (i) {
                    var n,
                      r,
                      e,
                      s = [],
                      a = [];
                    for (n = 0; n < i.sps.length; n++)
                      (e = (r = i.sps[n]).byteLength),
                        s.push((e >>> 8) & 255),
                        s.push(255 & e),
                        (s = s.concat(Array.prototype.slice.call(r)));
                    for (n = 0; n < i.pps.length; n++)
                      (e = (r = i.pps[n]).byteLength),
                        a.push((e >>> 8) & 255),
                        a.push(255 & e),
                        (a = a.concat(Array.prototype.slice.call(r)));
                    var o = t.box(
                        t.types.avcC,
                        new Uint8Array(
                          [1, s[3], s[4], s[5], 255, 224 | i.sps.length]
                            .concat(s)
                            .concat([i.pps.length])
                            .concat(a)
                        )
                      ),
                      h = i.width,
                      u = i.height,
                      f = i.pixelRatio[0],
                      l = i.pixelRatio[1];
                    return t.box(
                      t.types.avc1,
                      new Uint8Array([
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        (h >> 8) & 255,
                        255 & h,
                        (u >> 8) & 255,
                        255 & u,
                        0,
                        72,
                        0,
                        0,
                        0,
                        72,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        1,
                        18,
                        100,
                        97,
                        105,
                        108,
                        121,
                        109,
                        111,
                        116,
                        105,
                        111,
                        110,
                        47,
                        104,
                        108,
                        115,
                        46,
                        106,
                        115,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        24,
                        17,
                        17,
                      ]),
                      o,
                      t.box(
                        t.types.btrt,
                        new Uint8Array([
                          0, 28, 156, 128, 0, 45, 198, 192, 0, 45, 198, 192,
                        ])
                      ),
                      t.box(
                        t.types.pasp,
                        new Uint8Array([
                          f >> 24,
                          (f >> 16) & 255,
                          (f >> 8) & 255,
                          255 & f,
                          l >> 24,
                          (l >> 16) & 255,
                          (l >> 8) & 255,
                          255 & l,
                        ])
                      )
                    );
                  }),
                  (t.esds = function (t) {
                    var i = t.config.length;
                    return new Uint8Array(
                      [
                        0,
                        0,
                        0,
                        0,
                        3,
                        23 + i,
                        0,
                        1,
                        0,
                        4,
                        15 + i,
                        64,
                        21,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        5,
                      ]
                        .concat([i])
                        .concat(t.config)
                        .concat([6, 1, 2])
                    );
                  }),
                  (t.mp4a = function (i) {
                    var n = i.samplerate;
                    return t.box(
                      t.types.mp4a,
                      new Uint8Array([
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        i.channelCount,
                        0,
                        16,
                        0,
                        0,
                        0,
                        0,
                        (n >> 8) & 255,
                        255 & n,
                        0,
                        0,
                      ]),
                      t.box(t.types.esds, t.esds(i))
                    );
                  }),
                  (t.mp3 = function (i) {
                    var n = i.samplerate;
                    return t.box(
                      t.types[".mp3"],
                      new Uint8Array([
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        i.channelCount,
                        0,
                        16,
                        0,
                        0,
                        0,
                        0,
                        (n >> 8) & 255,
                        255 & n,
                        0,
                        0,
                      ])
                    );
                  }),
                  (t.stsd = function (i) {
                    return "audio" === i.type
                      ? "mp3" === i.segmentCodec && "mp3" === i.codec
                        ? t.box(t.types.stsd, t.STSD, t.mp3(i))
                        : t.box(t.types.stsd, t.STSD, t.mp4a(i))
                      : t.box(t.types.stsd, t.STSD, t.avc1(i));
                  }),
                  (t.tkhd = function (i) {
                    var n = i.id,
                      r = i.duration * i.timescale,
                      e = i.width,
                      s = i.height,
                      a = Math.floor(r / (gr + 1)),
                      o = Math.floor(r % (gr + 1));
                    return t.box(
                      t.types.tkhd,
                      new Uint8Array([
                        1,
                        0,
                        0,
                        7,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        2,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        3,
                        (n >> 24) & 255,
                        (n >> 16) & 255,
                        (n >> 8) & 255,
                        255 & n,
                        0,
                        0,
                        0,
                        0,
                        a >> 24,
                        (a >> 16) & 255,
                        (a >> 8) & 255,
                        255 & a,
                        o >> 24,
                        (o >> 16) & 255,
                        (o >> 8) & 255,
                        255 & o,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        64,
                        0,
                        0,
                        0,
                        (e >> 8) & 255,
                        255 & e,
                        0,
                        0,
                        (s >> 8) & 255,
                        255 & s,
                        0,
                        0,
                      ])
                    );
                  }),
                  (t.traf = function (i, n) {
                    var r = t.sdtp(i),
                      e = i.id,
                      s = Math.floor(n / (gr + 1)),
                      a = Math.floor(n % (gr + 1));
                    return t.box(
                      t.types.traf,
                      t.box(
                        t.types.tfhd,
                        new Uint8Array([
                          0,
                          0,
                          0,
                          0,
                          e >> 24,
                          (e >> 16) & 255,
                          (e >> 8) & 255,
                          255 & e,
                        ])
                      ),
                      t.box(
                        t.types.tfdt,
                        new Uint8Array([
                          1,
                          0,
                          0,
                          0,
                          s >> 24,
                          (s >> 16) & 255,
                          (s >> 8) & 255,
                          255 & s,
                          a >> 24,
                          (a >> 16) & 255,
                          (a >> 8) & 255,
                          255 & a,
                        ])
                      ),
                      t.trun(i, r.length + 16 + 20 + 8 + 16 + 8 + 8),
                      r
                    );
                  }),
                  (t.trak = function (i) {
                    return (
                      (i.duration = i.duration || 4294967295),
                      t.box(t.types.trak, t.tkhd(i), t.mdia(i))
                    );
                  }),
                  (t.trex = function (i) {
                    var n = i.id;
                    return t.box(
                      t.types.trex,
                      new Uint8Array([
                        0,
                        0,
                        0,
                        0,
                        n >> 24,
                        (n >> 16) & 255,
                        (n >> 8) & 255,
                        255 & n,
                        0,
                        0,
                        0,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        1,
                        0,
                        1,
                      ])
                    );
                  }),
                  (t.trun = function (i, n) {
                    var r,
                      e,
                      s,
                      a,
                      o,
                      h,
                      u = i.samples || [],
                      f = u.length,
                      l = 12 + 16 * f,
                      c = new Uint8Array(l);
                    for (
                      n += 8 + l,
                        c.set(
                          [
                            "video" === i.type ? 1 : 0,
                            0,
                            15,
                            1,
                            (f >>> 24) & 255,
                            (f >>> 16) & 255,
                            (f >>> 8) & 255,
                            255 & f,
                            (n >>> 24) & 255,
                            (n >>> 16) & 255,
                            (n >>> 8) & 255,
                            255 & n,
                          ],
                          0
                        ),
                        r = 0;
                      r < f;
                      r++
                    )
                      (s = (e = u[r]).duration),
                        (a = e.size),
                        (o = e.flags),
                        (h = e.cts),
                        c.set(
                          [
                            (s >>> 24) & 255,
                            (s >>> 16) & 255,
                            (s >>> 8) & 255,
                            255 & s,
                            (a >>> 24) & 255,
                            (a >>> 16) & 255,
                            (a >>> 8) & 255,
                            255 & a,
                            (o.isLeading << 2) | o.dependsOn,
                            (o.isDependedOn << 6) |
                              (o.hasRedundancy << 4) |
                              (o.paddingValue << 1) |
                              o.isNonSync,
                            61440 & o.degradPrio,
                            15 & o.degradPrio,
                            (h >>> 24) & 255,
                            (h >>> 16) & 255,
                            (h >>> 8) & 255,
                            255 & h,
                          ],
                          12 + 16 * r
                        );
                    return t.box(t.types.trun, c);
                  }),
                  (t.initSegment = function (i) {
                    t.types || t.init();
                    var n = t.moov(i),
                      r = new Uint8Array(t.FTYP.byteLength + n.byteLength);
                    return r.set(t.FTYP), r.set(n, t.FTYP.byteLength), r;
                  }),
                  t
                );
              })();
            function br(t, i, n, r) {
              void 0 === n && (n = 1), void 0 === r && (r = !1);
              var e = t * i * n;
              return r ? Math.round(e) : e;
            }
            function kr(t, i) {
              return void 0 === i && (i = !1), br(t, 1e3, 1 / 9e4, i);
            }
            (wr.types = void 0),
              (wr.HDLR_TYPES = void 0),
              (wr.STTS = void 0),
              (wr.STSC = void 0),
              (wr.STCO = void 0),
              (wr.STSZ = void 0),
              (wr.VMHD = void 0),
              (wr.SMHD = void 0),
              (wr.STSD = void 0),
              (wr.FTYP = void 0),
              (wr.DINF = void 0);
            var Er = null,
              Tr = null,
              xr = (function () {
                function t(t, i, n, r) {
                  if (
                    ((this.observer = void 0),
                    (this.config = void 0),
                    (this.typeSupported = void 0),
                    (this.ISGenerated = !1),
                    (this.J = null),
                    (this.Z = null),
                    (this.nextAvcDts = null),
                    (this.nextAudioPts = null),
                    (this.videoSampleDuration = null),
                    (this.isAudioContiguous = !1),
                    (this.isVideoContiguous = !1),
                    (this.observer = t),
                    (this.config = i),
                    (this.typeSupported = n),
                    (this.ISGenerated = !1),
                    null === Er)
                  ) {
                    var e = (navigator.userAgent || "").match(/Chrome\/(\d+)/i);
                    Er = e ? parseInt(e[1]) : 0;
                  }
                  if (null === Tr) {
                    var s = navigator.userAgent.match(/Safari\/(\d+)/i);
                    Tr = s ? parseInt(s[1]) : 0;
                  }
                }
                var i = t.prototype;
                return (
                  (i.destroy = function () {}),
                  (i.resetTimeStamp = function (t) {
                    A.log("[mp4-remuxer]: initPTS & initDTS reset"),
                      (this.J = this.Z = t);
                  }),
                  (i.resetNextTimestamp = function () {
                    A.log("[mp4-remuxer]: reset next timestamp"),
                      (this.isVideoContiguous = !1),
                      (this.isAudioContiguous = !1);
                  }),
                  (i.resetInitSegment = function () {
                    A.log("[mp4-remuxer]: ISGenerated flag reset"),
                      (this.ISGenerated = !1);
                  }),
                  (i.getVideoStartPts = function (t) {
                    var i = !1,
                      n = t.reduce(function (t, n) {
                        var r = n.pts - t;
                        return r < -4294967296
                          ? ((i = !0), Sr(t, n.pts))
                          : r > 0
                          ? t
                          : n.pts;
                      }, t[0].pts);
                    return i && A.debug("PTS rollover detected"), n;
                  }),
                  (i.remux = function (t, i, n, r, e, s, a, o) {
                    var h,
                      u,
                      f,
                      l,
                      c,
                      v,
                      d = e,
                      p = e,
                      m = t.pid > -1,
                      y = i.pid > -1,
                      g = i.samples.length,
                      w = t.samples.length > 0,
                      b = (a && g > 0) || g > 1;
                    if (((!m || w) && (!y || b)) || this.ISGenerated || a) {
                      this.ISGenerated || (f = this.generateIS(t, i, e, s));
                      var k,
                        E = this.isVideoContiguous,
                        T = -1;
                      if (
                        b &&
                        ((T = (function (t) {
                          for (var i = 0; i < t.length; i++)
                            if (t[i].key) return i;
                          return -1;
                        })(i.samples)),
                        !E && this.config.forceKeyFrameOnDiscontinuity)
                      )
                        if (((v = !0), T > 0)) {
                          A.warn(
                            "[mp4-remuxer]: Dropped " +
                              T +
                              " out of " +
                              g +
                              " video samples due to a missing keyframe"
                          );
                          var x = this.getVideoStartPts(i.samples);
                          (i.samples = i.samples.slice(T)),
                            (i.dropped += T),
                            (k = p +=
                              (i.samples[0].pts - x) / i.inputTimeScale);
                        } else
                          -1 === T &&
                            (A.warn(
                              "[mp4-remuxer]: No keyframe found out of " +
                                g +
                                " video samples"
                            ),
                            (v = !1));
                      if (this.ISGenerated) {
                        if (w && b) {
                          var S = this.getVideoStartPts(i.samples),
                            M =
                              (Sr(t.samples[0].pts, S) - S) / i.inputTimeScale;
                          (d += Math.max(0, M)), (p += Math.max(0, -M));
                        }
                        if (w) {
                          if (
                            (t.samplerate ||
                              (A.warn(
                                "[mp4-remuxer]: regenerate InitSegment as audio detected"
                              ),
                              (f = this.generateIS(t, i, e, s))),
                            (u = this.remuxAudio(
                              t,
                              d,
                              this.isAudioContiguous,
                              s,
                              y || b || o === ui ? p : void 0
                            )),
                            b)
                          ) {
                            var D = u ? u.endPTS - u.startPTS : 0;
                            i.inputTimeScale ||
                              (A.warn(
                                "[mp4-remuxer]: regenerate InitSegment as video detected"
                              ),
                              (f = this.generateIS(t, i, e, s))),
                              (h = this.remuxVideo(i, p, E, D));
                          }
                        } else b && (h = this.remuxVideo(i, p, E, 0));
                        h &&
                          ((h.firstKeyFrame = T),
                          (h.independent = -1 !== T),
                          (h.firstKeyFramePTS = k));
                      }
                    }
                    return (
                      this.ISGenerated &&
                        this.J &&
                        this.Z &&
                        (n.samples.length && (c = Ar(n, e, this.J, this.Z)),
                        r.samples.length && (l = Mr(r, e, this.J))),
                      {
                        audio: u,
                        video: h,
                        initSegment: f,
                        independent: v,
                        text: l,
                        id3: c,
                      }
                    );
                  }),
                  (i.generateIS = function (t, i, n, r) {
                    var e,
                      s,
                      a,
                      o = t.samples,
                      h = i.samples,
                      u = this.typeSupported,
                      f = {},
                      l = this.J,
                      c = !l || r,
                      v = "audio/mp4";
                    if (
                      (c && (e = s = 1 / 0),
                      t.config &&
                        o.length &&
                        ((t.timescale = t.samplerate),
                        "mp3" === t.segmentCodec &&
                          (u.mpeg
                            ? ((v = "audio/mpeg"), (t.codec = ""))
                            : u.mp3 && (t.codec = "mp3")),
                        (f.audio = {
                          id: "audio",
                          container: v,
                          codec: t.codec,
                          initSegment:
                            "mp3" === t.segmentCodec && u.mpeg
                              ? new Uint8Array(0)
                              : wr.initSegment([t]),
                          metadata: { channelCount: t.channelCount },
                        }),
                        c &&
                          ((a = t.inputTimeScale),
                          l && a === l.timescale
                            ? (c = !1)
                            : (e = s = o[0].pts - Math.round(a * n)))),
                      i.sps &&
                        i.pps &&
                        h.length &&
                        ((i.timescale = i.inputTimeScale),
                        (f.video = {
                          id: "main",
                          container: "video/mp4",
                          codec: i.codec,
                          initSegment: wr.initSegment([i]),
                          metadata: { width: i.width, height: i.height },
                        }),
                        c))
                    )
                      if (((a = i.inputTimeScale), l && a === l.timescale))
                        c = !1;
                      else {
                        var d = this.getVideoStartPts(h),
                          p = Math.round(a * n);
                        (s = Math.min(s, Sr(h[0].dts, d) - p)),
                          (e = Math.min(e, d - p));
                      }
                    if (Object.keys(f).length)
                      return (
                        (this.ISGenerated = !0),
                        c
                          ? ((this.J = { baseTime: e, timescale: a }),
                            (this.Z = { baseTime: s, timescale: a }))
                          : (e = a = void 0),
                        { tracks: f, initPTS: e, timescale: a }
                      );
                  }),
                  (i.remuxVideo = function (t, i, n, r) {
                    var e,
                      s,
                      a = t.inputTimeScale,
                      h = t.samples,
                      u = [],
                      f = h.length,
                      l = this.J,
                      c = this.nextAvcDts,
                      v = 8,
                      d = this.videoSampleDuration,
                      p = Number.POSITIVE_INFINITY,
                      m = Number.NEGATIVE_INFINITY,
                      y = !1;
                    (n && null !== c) ||
                      (c = i * a - (h[0].pts - Sr(h[0].dts, h[0].pts)));
                    for (
                      var g = (l.baseTime * a) / l.timescale, E = 0;
                      E < f;
                      E++
                    ) {
                      var T = h[E];
                      (T.pts = Sr(T.pts - g, c)),
                        (T.dts = Sr(T.dts - g, c)),
                        T.dts < h[E > 0 ? E - 1 : E].dts && (y = !0);
                    }
                    y &&
                      h.sort(function (t, i) {
                        var n = t.dts - i.dts,
                          r = t.pts - i.pts;
                        return n || r;
                      }),
                      (e = h[0].dts);
                    var x = h[h.length - 1].dts - e,
                      S = x
                        ? Math.round(x / (f - 1))
                        : d || t.inputTimeScale / 30;
                    if (n) {
                      var M = e - c,
                        D = M > S,
                        _ = M < -1;
                      if (
                        (D || _) &&
                        (D
                          ? A.warn(
                              "AVC: " +
                                kr(M, !0) +
                                " ms (" +
                                M +
                                "dts) hole between fragments detected, filling it"
                            )
                          : A.warn(
                              "AVC: " +
                                kr(-M, !0) +
                                " ms (" +
                                M +
                                "dts) overlapping between fragments detected"
                            ),
                        !_ || c >= h[0].pts)
                      ) {
                        e = c;
                        var O = h[0].pts - M;
                        (h[0].dts = e),
                          (h[0].pts = O),
                          A.log(
                            "Video: First PTS/DTS adjusted: " +
                              kr(O, !0) +
                              "/" +
                              kr(e, !0) +
                              ", delta: " +
                              kr(M, !0) +
                              " ms"
                          );
                      }
                    }
                    e = Math.max(0, e);
                    for (var R = 0, L = 0, I = 0; I < f; I++) {
                      for (
                        var P = h[I], C = P.units, N = C.length, U = 0, F = 0;
                        F < N;
                        F++
                      )
                        U += C[F].data.length;
                      (L += U),
                        (R += N),
                        (P.length = U),
                        (P.dts = Math.max(P.dts, e)),
                        (p = Math.min(P.pts, p)),
                        (m = Math.max(P.pts, m));
                    }
                    s = h[f - 1].dts;
                    var j,
                      B = L + 4 * R + 8;
                    try {
                      j = new Uint8Array(B);
                    } catch (t) {
                      return void this.observer.emit(w.ERROR, w.ERROR, {
                        type: b.MUX_ERROR,
                        details: k.REMUX_ALLOC_ERROR,
                        fatal: !1,
                        error: t,
                        bytes: B,
                        reason: "fail allocating video mdat " + B,
                      });
                    }
                    var X = new DataView(j.buffer);
                    X.setUint32(0, B), j.set(wr.types.mdat, 4);
                    for (
                      var Y = !1,
                        $ = Number.POSITIVE_INFINITY,
                        H = Number.POSITIVE_INFINITY,
                        V = Number.NEGATIVE_INFINITY,
                        G = Number.NEGATIVE_INFINITY,
                        W = 0;
                      W < f;
                      W++
                    ) {
                      for (
                        var K = h[W], z = K.units, q = 0, J = 0, Q = z.length;
                        J < Q;
                        J++
                      ) {
                        var Z = z[J],
                          tt = Z.data,
                          it = Z.data.byteLength;
                        X.setUint32(v, it),
                          (v += 4),
                          j.set(tt, v),
                          (v += it),
                          (q += 4 + it);
                      }
                      var nt = void 0;
                      if (W < f - 1)
                        (d = h[W + 1].dts - K.dts), (nt = h[W + 1].pts - K.pts);
                      else {
                        var rt = this.config,
                          et = W > 0 ? K.dts - h[W - 1].dts : S;
                        if (
                          ((nt = W > 0 ? K.pts - h[W - 1].pts : S),
                          rt.stretchShortVideoTrack &&
                            null !== this.nextAudioPts)
                        ) {
                          var st = Math.floor(rt.maxBufferHole * a),
                            at = (r ? p + r * a : this.nextAudioPts) - K.pts;
                          at > st
                            ? ((d = at - et) < 0 ? (d = et) : (Y = !0),
                              A.log(
                                "[mp4-remuxer]: It is approximately " +
                                  at / 90 +
                                  " ms to the next segment; using duration " +
                                  d / 90 +
                                  " ms for the last video frame."
                              ))
                            : (d = et);
                        } else d = et;
                      }
                      var ot = Math.round(K.pts - K.dts);
                      ($ = Math.min($, d)),
                        (V = Math.max(V, d)),
                        (H = Math.min(H, nt)),
                        (G = Math.max(G, nt)),
                        u.push(new _r(K.key, d, q, ot));
                    }
                    if (u.length)
                      if (Er) {
                        if (Er < 70) {
                          var ht = u[0].flags;
                          (ht.dependsOn = 2), (ht.isNonSync = 0);
                        }
                      } else if (
                        Tr &&
                        G - H < V - $ &&
                        S / V < 0.025 &&
                        0 === u[0].cts
                      ) {
                        A.warn(
                          "Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration."
                        );
                        for (var ut = e, ft = 0, lt = u.length; ft < lt; ft++) {
                          var ct = ut + u[ft].duration,
                            vt = ut + u[ft].cts;
                          if (ft < lt - 1) {
                            var dt = ct + u[ft + 1].cts;
                            u[ft].duration = dt - vt;
                          } else u[ft].duration = ft ? u[ft - 1].duration : S;
                          (u[ft].cts = 0), (ut = ct);
                        }
                      }
                    (d = Y || !d ? S : d),
                      (this.nextAvcDts = c = s + d),
                      (this.videoSampleDuration = d),
                      (this.isVideoContiguous = !0);
                    var pt = {
                      data1: wr.moof(
                        t.sequenceNumber++,
                        e,
                        o({}, t, { samples: u })
                      ),
                      data2: j,
                      startPTS: p / a,
                      endPTS: (m + d) / a,
                      startDTS: e / a,
                      endDTS: c / a,
                      type: "video",
                      hasAudio: !1,
                      hasVideo: !0,
                      nb: u.length,
                      dropped: t.dropped,
                    };
                    return (t.samples = []), (t.dropped = 0), pt;
                  }),
                  (i.remuxAudio = function (t, i, n, r, e) {
                    var s = t.inputTimeScale,
                      a = s / (t.samplerate ? t.samplerate : s),
                      h = "aac" === t.segmentCodec ? 1024 : 1152,
                      u = h * a,
                      f = this.J,
                      l = "mp3" === t.segmentCodec && this.typeSupported.mpeg,
                      c = [],
                      v = void 0 !== e,
                      d = t.samples,
                      p = l ? 0 : 8,
                      m = this.nextAudioPts || -1,
                      y = i * s,
                      g = (f.baseTime * s) / f.timescale;
                    if (
                      ((this.isAudioContiguous = n =
                        n ||
                        (d.length &&
                          m > 0 &&
                          ((r && Math.abs(y - m) < 9e3) ||
                            Math.abs(Sr(d[0].pts - g, y) - m) < 20 * u))),
                      d.forEach(function (t) {
                        t.pts = Sr(t.pts - g, y);
                      }),
                      !n || m < 0)
                    ) {
                      if (
                        ((d = d.filter(function (t) {
                          return t.pts >= 0;
                        })),
                        !d.length)
                      )
                        return;
                      m = 0 === e ? 0 : r && !v ? Math.max(0, y) : d[0].pts;
                    }
                    if ("aac" === t.segmentCodec)
                      for (
                        var E = this.config.maxAudioFramesDrift, T = 0, x = m;
                        T < d.length;
                        T++
                      ) {
                        var S = d[T],
                          M = S.pts,
                          D = M - x,
                          _ = Math.abs((1e3 * D) / s);
                        if (D <= -E * u && v)
                          0 === T &&
                            (A.warn(
                              "Audio frame @ " +
                                (M / s).toFixed(3) +
                                "s overlaps nextAudioPts by " +
                                Math.round((1e3 * D) / s) +
                                " ms."
                            ),
                            (this.nextAudioPts = m = x = M));
                        else if (D >= E * u && _ < 1e4 && v) {
                          var O = Math.round(D / u);
                          (x = M - O * u) < 0 && (O--, (x += u)),
                            0 === T && (this.nextAudioPts = m = x),
                            A.warn(
                              "[mp4-remuxer]: Injecting " +
                                O +
                                " audio frame @ " +
                                (x / s).toFixed(3) +
                                "s due to " +
                                Math.round((1e3 * D) / s) +
                                " ms gap."
                            );
                          for (var R = 0; R < O; R++) {
                            var L = Math.max(x, 0),
                              I = yr.getSilentFrame(
                                t.manifestCodec || t.codec,
                                t.channelCount
                              );
                            I ||
                              (A.log(
                                "[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."
                              ),
                              (I = S.unit.subarray())),
                              d.splice(T, 0, { unit: I, pts: L }),
                              (x += u),
                              T++;
                          }
                        }
                        (S.pts = x), (x += u);
                      }
                    for (var P, C = null, N = null, U = 0, F = d.length; F--; )
                      U += d[F].unit.byteLength;
                    for (var j = 0, B = d.length; j < B; j++) {
                      var X = d[j],
                        Y = X.unit,
                        $ = X.pts;
                      if (null !== N)
                        c[j - 1].duration = Math.round(($ - N) / a);
                      else {
                        if (
                          (n && "aac" === t.segmentCodec && ($ = m),
                          (C = $),
                          !(U > 0))
                        )
                          return;
                        U += p;
                        try {
                          P = new Uint8Array(U);
                        } catch (t) {
                          return void this.observer.emit(w.ERROR, w.ERROR, {
                            type: b.MUX_ERROR,
                            details: k.REMUX_ALLOC_ERROR,
                            fatal: !1,
                            error: t,
                            bytes: U,
                            reason: "fail allocating audio mdat " + U,
                          });
                        }
                        l ||
                          (new DataView(P.buffer).setUint32(0, U),
                          P.set(wr.types.mdat, 4));
                      }
                      P.set(Y, p);
                      var H = Y.byteLength;
                      (p += H), c.push(new _r(!0, h, H, 0)), (N = $);
                    }
                    var V = c.length;
                    if (V) {
                      var G = c[c.length - 1];
                      this.nextAudioPts = m = N + a * G.duration;
                      var W = l
                        ? new Uint8Array(0)
                        : wr.moof(
                            t.sequenceNumber++,
                            C / a,
                            o({}, t, { samples: c })
                          );
                      t.samples = [];
                      var K = C / s,
                        z = m / s,
                        q = {
                          data1: W,
                          data2: P,
                          startPTS: K,
                          endPTS: z,
                          startDTS: K,
                          endDTS: z,
                          type: "audio",
                          hasAudio: !0,
                          hasVideo: !1,
                          nb: V,
                        };
                      return (this.isAudioContiguous = !0), q;
                    }
                  }),
                  (i.remuxEmptyAudio = function (t, i, n, r) {
                    var e = t.inputTimeScale,
                      s = e / (t.samplerate ? t.samplerate : e),
                      a = this.nextAudioPts,
                      o = this.Z,
                      h = (9e4 * o.baseTime) / o.timescale,
                      u = (null !== a ? a : r.startDTS * e) + h,
                      f = r.endDTS * e + h,
                      l = 1024 * s,
                      c = Math.ceil((f - u) / l),
                      v = yr.getSilentFrame(
                        t.manifestCodec || t.codec,
                        t.channelCount
                      );
                    if ((A.warn("[mp4-remuxer]: remux empty Audio"), v)) {
                      for (var d = [], p = 0; p < c; p++) {
                        var m = u + p * l;
                        d.push({ unit: v, pts: m, dts: m });
                      }
                      return (t.samples = d), this.remuxAudio(t, i, n, !1);
                    }
                    A.trace(
                      "[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec"
                    );
                  }),
                  t
                );
              })();
            function Sr(t, i) {
              var n;
              if (null === i) return t;
              for (
                n = i < t ? -8589934592 : 8589934592;
                Math.abs(t - i) > 4294967296;

              )
                t += n;
              return t;
            }
            function Ar(t, i, n, r) {
              var e = t.samples.length;
              if (e) {
                for (var s = t.inputTimeScale, a = 0; a < e; a++) {
                  var o = t.samples[a];
                  (o.pts =
                    Sr(o.pts - (n.baseTime * s) / n.timescale, i * s) / s),
                    (o.dts =
                      Sr(o.dts - (r.baseTime * s) / r.timescale, i * s) / s);
                }
                var h = t.samples;
                return (t.samples = []), { samples: h };
              }
            }
            function Mr(t, i, n) {
              var r = t.samples.length;
              if (r) {
                for (var e = t.inputTimeScale, s = 0; s < r; s++) {
                  var a = t.samples[s];
                  a.pts =
                    Sr(a.pts - (9e4 * n.baseTime) / n.timescale, i * e) / e;
                }
                t.samples.sort(function (t, i) {
                  return t.pts - i.pts;
                });
                var o = t.samples;
                return (t.samples = []), { samples: o };
              }
            }
            var Dr,
              _r = function (t, i, n, r) {
                (this.size = void 0),
                  (this.duration = void 0),
                  (this.cts = void 0),
                  (this.flags = void 0),
                  (this.duration = i),
                  (this.size = n),
                  (this.cts = r),
                  (this.flags = new Or(t));
              },
              Or = function (t) {
                (this.isLeading = 0),
                  (this.isDependedOn = 0),
                  (this.hasRedundancy = 0),
                  (this.degradPrio = 0),
                  (this.dependsOn = 1),
                  (this.isNonSync = 1),
                  (this.dependsOn = t ? 2 : 1),
                  (this.isNonSync = t ? 0 : 1);
              },
              Rr = (function () {
                function t() {
                  (this.emitInitSegment = !1),
                    (this.audioCodec = void 0),
                    (this.videoCodec = void 0),
                    (this.initData = void 0),
                    (this.initPTS = null),
                    (this.initTracks = void 0),
                    (this.lastEndTime = null);
                }
                var i = t.prototype;
                return (
                  (i.destroy = function () {}),
                  (i.resetTimeStamp = function (t) {
                    (this.initPTS = t), (this.lastEndTime = null);
                  }),
                  (i.resetNextTimestamp = function () {
                    this.lastEndTime = null;
                  }),
                  (i.resetInitSegment = function (t, i, n, r) {
                    (this.audioCodec = i),
                      (this.videoCodec = n),
                      this.generateInitSegment(
                        (function (t, i) {
                          if (!t || !i) return t;
                          var n = i.keyId;
                          return (
                            n &&
                              i.isCommonEncryption &&
                              Tt(t, ["moov", "trak"]).forEach(function (t) {
                                var i = Tt(t, [
                                    "mdia",
                                    "minf",
                                    "stbl",
                                    "stsd",
                                  ])[0].subarray(8),
                                  r = Tt(i, ["enca"]),
                                  e = r.length > 0;
                                e || (r = Tt(i, ["encv"])),
                                  r.forEach(function (t) {
                                    Tt(e ? t.subarray(28) : t.subarray(78), [
                                      "sinf",
                                    ]).forEach(function (t) {
                                      var i = At(t);
                                      if (i) {
                                        var r = i.subarray(8, 24);
                                        r.some(function (t) {
                                          return 0 !== t;
                                        }) ||
                                          (A.log(
                                            "[eme] Patching keyId in 'enc" +
                                              (e ? "a" : "v") +
                                              ">sinf>>tenc' box: " +
                                              dt(r) +
                                              " -> " +
                                              dt(n)
                                          ),
                                          i.set(n, 8));
                                      }
                                    });
                                  });
                              }),
                            t
                          );
                        })(t, r)
                      ),
                      (this.emitInitSegment = !0);
                  }),
                  (i.generateInitSegment = function (t) {
                    var i = this.audioCodec,
                      n = this.videoCodec;
                    if (null == t || !t.byteLength)
                      return (
                        (this.initTracks = void 0),
                        void (this.initData = void 0)
                      );
                    var r = (this.initData = St(t));
                    i || (i = Lr(r.audio, I)), n || (n = Lr(r.video, P));
                    var e = {};
                    r.audio && r.video
                      ? (e.audiovideo = {
                          container: "video/mp4",
                          codec: i + "," + n,
                          initSegment: t,
                          id: "main",
                        })
                      : r.audio
                      ? (e.audio = {
                          container: "audio/mp4",
                          codec: i,
                          initSegment: t,
                          id: "audio",
                        })
                      : r.video
                      ? (e.video = {
                          container: "video/mp4",
                          codec: n,
                          initSegment: t,
                          id: "main",
                        })
                      : A.warn(
                          "[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."
                        ),
                      (this.initTracks = e);
                  }),
                  (i.remux = function (t, i, n, r, e, s) {
                    var a,
                      o,
                      h = this.initPTS,
                      u = this.lastEndTime,
                      f = {
                        audio: void 0,
                        video: void 0,
                        text: r,
                        id3: n,
                        initSegment: void 0,
                      };
                    g(u) || (u = this.lastEndTime = e || 0);
                    var l = i.samples;
                    if (null == l || !l.length) return f;
                    var c = { initPTS: void 0, timescale: 1 },
                      v = this.initData;
                    if (
                      ((null != (a = v) && a.length) ||
                        (this.generateInitSegment(l), (v = this.initData)),
                      null == (o = v) || !o.length)
                    )
                      return (
                        A.warn(
                          "[passthrough-remuxer.ts]: Failed to generate initSegment."
                        ),
                        f
                      );
                    this.emitInitSegment &&
                      ((c.tracks = this.initTracks),
                      (this.emitInitSegment = !1));
                    var d = (function (t, i) {
                        for (
                          var n = 0,
                            r = 0,
                            e = 0,
                            s = Tt(t, ["moof", "traf"]),
                            a = 0;
                          a < s.length;
                          a++
                        ) {
                          var o = s[a],
                            h = Tt(o, ["tfhd"])[0],
                            u = i[bt(h, 4)];
                          if (u) {
                            var f = u.default,
                              l = bt(h, 0) | (null == f ? void 0 : f.flags),
                              c = null == f ? void 0 : f.duration;
                            8 & l && (c = bt(h, 2 & l ? 12 : 8));
                            for (
                              var v = u.timescale || 9e4,
                                d = Tt(o, ["trun"]),
                                p = 0;
                              p < d.length;
                              p++
                            )
                              !(n = Mt(d[p])) && c && (n = c * bt(d[p], 4)),
                                u.type === P
                                  ? (r += n / v)
                                  : u.type === I && (e += n / v);
                          }
                        }
                        if (0 === r && 0 === e) {
                          for (
                            var m = 0, y = Tt(t, ["sidx"]), g = 0;
                            g < y.length;
                            g++
                          ) {
                            var w = xt(y[g]);
                            null != w &&
                              w.references &&
                              (m += w.references.reduce(function (t, i) {
                                return t + i.info.duration || 0;
                              }, 0));
                          }
                          return m;
                        }
                        return r || e;
                      })(l, v),
                      p = (function (t, i) {
                        return Tt(i, ["moof", "traf"]).reduce(function (i, n) {
                          var r = Tt(n, ["tfdt"])[0],
                            e = r[0],
                            s = Tt(n, ["tfhd"]).reduce(function (i, n) {
                              var s = bt(n, 4),
                                a = t[s];
                              if (a) {
                                var o = bt(r, 4);
                                if (1 === e) {
                                  if (o === pt)
                                    return (
                                      A.warn(
                                        "[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"
                                      ),
                                      i
                                    );
                                  (o *= pt + 1), (o += bt(r, 8));
                                }
                                var h = o / (a.timescale || 9e4);
                                if (isFinite(h) && (null === i || h < i))
                                  return h;
                              }
                              return i;
                            }, null);
                          return null !== s &&
                            isFinite(s) &&
                            (null === i || s < i)
                            ? s
                            : i;
                        }, null);
                      })(v, l),
                      m = null === p ? e : p;
                    ((function (t, i, n, r) {
                      if (null === t) return !0;
                      var e = Math.max(r, 1),
                        s = i - t.baseTime / t.timescale;
                      return Math.abs(s - n) > e;
                    })(h, m, e, d) ||
                      (c.timescale !== h.timescale && s)) &&
                      ((c.initPTS = m - e),
                      h &&
                        1 === h.timescale &&
                        A.warn(
                          "Adjusting initPTS by " + (c.initPTS - h.baseTime)
                        ),
                      (this.initPTS = h =
                        { baseTime: c.initPTS, timescale: 1 }));
                    var y = t ? m - h.baseTime / h.timescale : u,
                      w = y + d;
                    !(function (t, i, n) {
                      Tt(i, ["moof", "traf"]).forEach(function (i) {
                        Tt(i, ["tfhd"]).forEach(function (r) {
                          var e = bt(r, 4),
                            s = t[e];
                          if (s) {
                            var a = s.timescale || 9e4;
                            Tt(i, ["tfdt"]).forEach(function (t) {
                              var i = t[0],
                                r = bt(t, 4);
                              if (0 === i)
                                (r -= n * a), Et(t, 4, (r = Math.max(r, 0)));
                              else {
                                (r *= Math.pow(2, 32)),
                                  (r += bt(t, 8)),
                                  (r -= n * a),
                                  (r = Math.max(r, 0));
                                var e = Math.floor(r / (pt + 1)),
                                  s = Math.floor(r % (pt + 1));
                                Et(t, 4, e), Et(t, 8, s);
                              }
                            });
                          }
                        });
                      });
                    })(v, l, h.baseTime / h.timescale),
                      d > 0
                        ? (this.lastEndTime = w)
                        : (A.warn(
                            "Duration parsed from mp4 should be greater than zero"
                          ),
                          this.resetNextTimestamp());
                    var b = !!v.audio,
                      k = !!v.video,
                      E = "";
                    b && (E += "audio"), k && (E += "video");
                    var T = {
                      data1: l,
                      startPTS: y,
                      startDTS: y,
                      endPTS: w,
                      endDTS: w,
                      type: E,
                      hasAudio: b,
                      hasVideo: k,
                      nb: 1,
                      dropped: 0,
                    };
                    return (
                      (f.audio = "audio" === T.type ? T : void 0),
                      (f.video = "audio" !== T.type ? T : void 0),
                      (f.initSegment = c),
                      (f.id3 = Ar(n, e, h, h)),
                      r.samples.length && (f.text = Mr(r, e, h)),
                      f
                    );
                  }),
                  t
                );
              })();
            function Lr(t, i) {
              var n = null == t ? void 0 : t.codec;
              return n && n.length > 4
                ? n
                : "hvc1" === n || "hev1" === n
                ? "hvc1.1.6.L120.90"
                : "av01" === n
                ? "av01.0.04M.08"
                : "avc1" === n || i === P
                ? "avc1.42e01e"
                : "mp4a.40.5";
            }
            try {
              Dr = self.performance.now.bind(self.performance);
            } catch (t) {
              A.debug("Unable to use Performance API on this environment"),
                (Dr = "undefined" != typeof self && self.Date.now);
            }
            var Ir = [
                { demux: zn, remux: Rr },
                { demux: ur, remux: xr },
                { demux: Wn, remux: xr },
                { demux: mr, remux: xr },
              ],
              Pr = (function () {
                function t(t, i, n, r, e) {
                  (this.async = !1),
                    (this.observer = void 0),
                    (this.typeSupported = void 0),
                    (this.config = void 0),
                    (this.vendor = void 0),
                    (this.id = void 0),
                    (this.demuxer = void 0),
                    (this.remuxer = void 0),
                    (this.decrypter = void 0),
                    (this.probe = void 0),
                    (this.decryptionPromise = null),
                    (this.transmuxConfig = void 0),
                    (this.currentTransmuxState = void 0),
                    (this.observer = t),
                    (this.typeSupported = i),
                    (this.config = n),
                    (this.vendor = r),
                    (this.id = e);
                }
                var i = t.prototype;
                return (
                  (i.configure = function (t) {
                    (this.transmuxConfig = t),
                      this.decrypter && this.decrypter.reset();
                  }),
                  (i.push = function (t, i, n, r) {
                    var e = this,
                      s = n.transmuxing;
                    s.executeStart = Dr();
                    var a = new Uint8Array(t),
                      o = this.currentTransmuxState,
                      h = this.transmuxConfig;
                    r && (this.currentTransmuxState = r);
                    var u = r || o,
                      f = u.contiguous,
                      l = u.discontinuity,
                      c = u.trackSwitch,
                      v = u.accurateTimeOffset,
                      d = u.timeOffset,
                      p = u.initSegmentChange,
                      m = h.audioCodec,
                      y = h.videoCodec,
                      g = h.defaultInitPts,
                      E = h.duration,
                      T = h.initSegmentData,
                      x = (function (t, i) {
                        var n = null;
                        return (
                          t.byteLength > 0 &&
                            null != i &&
                            null != i.key &&
                            null !== i.iv &&
                            null != i.method &&
                            (n = i),
                          n
                        );
                      })(a, i);
                    if (x && "AES-128" === x.method) {
                      var S = this.getDecrypter();
                      if (!S.isSync())
                        return (
                          (this.decryptionPromise = S.webCryptoDecrypt(
                            a,
                            x.key.buffer,
                            x.iv.buffer
                          ).then(function (t) {
                            var i = e.push(t, null, n);
                            return (e.decryptionPromise = null), i;
                          })),
                          this.decryptionPromise
                        );
                      var M = S.softwareDecrypt(a, x.key.buffer, x.iv.buffer);
                      if ((n.part > -1 && (M = S.flush()), !M))
                        return (s.executeEnd = Dr()), Cr(n);
                      a = new Uint8Array(M);
                    }
                    var D = this.needsProbing(l, c);
                    if (D) {
                      var _ = this.configureTransmuxer(a);
                      if (_)
                        return (
                          A.warn("[transmuxer] " + _.message),
                          this.observer.emit(w.ERROR, w.ERROR, {
                            type: b.MEDIA_ERROR,
                            details: k.FRAG_PARSING_ERROR,
                            fatal: !1,
                            error: _,
                            reason: _.message,
                          }),
                          (s.executeEnd = Dr()),
                          Cr(n)
                        );
                    }
                    (l || c || p || D) && this.resetInitSegment(T, m, y, E, i),
                      (l || p || D) && this.resetInitialTimestamp(g),
                      f || this.resetContiguity();
                    var O = this.transmux(a, x, d, v, n),
                      R = this.currentTransmuxState;
                    return (
                      (R.contiguous = !0),
                      (R.discontinuity = !1),
                      (R.trackSwitch = !1),
                      (s.executeEnd = Dr()),
                      O
                    );
                  }),
                  (i.flush = function (t) {
                    var i = this,
                      n = t.transmuxing;
                    n.executeStart = Dr();
                    var r = this.decrypter,
                      e = this.currentTransmuxState,
                      s = this.decryptionPromise;
                    if (s)
                      return s.then(function () {
                        return i.flush(t);
                      });
                    var a = [],
                      o = e.timeOffset;
                    if (r) {
                      var h = r.flush();
                      h && a.push(this.push(h, null, t));
                    }
                    var u = this.demuxer,
                      f = this.remuxer;
                    if (!u || !f) return (n.executeEnd = Dr()), [Cr(t)];
                    var l = u.flush(o);
                    return Nr(l)
                      ? l.then(function (n) {
                          return i.flushRemux(a, n, t), a;
                        })
                      : (this.flushRemux(a, l, t), a);
                  }),
                  (i.flushRemux = function (t, i, n) {
                    var r = i.audioTrack,
                      e = i.videoTrack,
                      s = i.id3Track,
                      a = i.textTrack,
                      o = this.currentTransmuxState,
                      h = o.accurateTimeOffset,
                      u = o.timeOffset;
                    A.log(
                      "[transmuxer.ts]: Flushed fragment " +
                        n.sn +
                        (n.part > -1 ? " p: " + n.part : "") +
                        " of level " +
                        n.level
                    );
                    var f = this.remuxer.remux(r, e, s, a, u, h, !0, this.id);
                    t.push({ remuxResult: f, chunkMeta: n }),
                      (n.transmuxing.executeEnd = Dr());
                  }),
                  (i.resetInitialTimestamp = function (t) {
                    var i = this.demuxer,
                      n = this.remuxer;
                    i && n && (i.resetTimeStamp(t), n.resetTimeStamp(t));
                  }),
                  (i.resetContiguity = function () {
                    var t = this.demuxer,
                      i = this.remuxer;
                    t && i && (t.resetContiguity(), i.resetNextTimestamp());
                  }),
                  (i.resetInitSegment = function (t, i, n, r, e) {
                    var s = this.demuxer,
                      a = this.remuxer;
                    s &&
                      a &&
                      (s.resetInitSegment(t, i, n, r),
                      a.resetInitSegment(t, i, n, e));
                  }),
                  (i.destroy = function () {
                    this.demuxer &&
                      (this.demuxer.destroy(), (this.demuxer = void 0)),
                      this.remuxer &&
                        (this.remuxer.destroy(), (this.remuxer = void 0));
                  }),
                  (i.transmux = function (t, i, n, r, e) {
                    return i && "SAMPLE-AES" === i.method
                      ? this.transmuxSampleAes(t, i, n, r, e)
                      : this.transmuxUnencrypted(t, n, r, e);
                  }),
                  (i.transmuxUnencrypted = function (t, i, n, r) {
                    var e = this.demuxer.demux(
                        t,
                        i,
                        !1,
                        !this.config.progressive
                      ),
                      s = e.audioTrack,
                      a = e.videoTrack,
                      o = e.id3Track,
                      h = e.textTrack;
                    return {
                      remuxResult: this.remuxer.remux(
                        s,
                        a,
                        o,
                        h,
                        i,
                        n,
                        !1,
                        this.id
                      ),
                      chunkMeta: r,
                    };
                  }),
                  (i.transmuxSampleAes = function (t, i, n, r, e) {
                    var s = this;
                    return this.demuxer
                      .demuxSampleAes(t, i, n)
                      .then(function (t) {
                        return {
                          remuxResult: s.remuxer.remux(
                            t.audioTrack,
                            t.videoTrack,
                            t.id3Track,
                            t.textTrack,
                            n,
                            r,
                            !1,
                            s.id
                          ),
                          chunkMeta: e,
                        };
                      });
                  }),
                  (i.configureTransmuxer = function (t) {
                    for (
                      var i,
                        n = this.config,
                        r = this.observer,
                        e = this.typeSupported,
                        s = this.vendor,
                        a = 0,
                        o = Ir.length;
                      a < o;
                      a++
                    )
                      if (Ir[a].demux.probe(t)) {
                        i = Ir[a];
                        break;
                      }
                    if (!i)
                      return new Error(
                        "Failed to find demuxer by probing fragment data"
                      );
                    var h = this.demuxer,
                      u = this.remuxer,
                      f = i.remux,
                      l = i.demux;
                    (u && u instanceof f) || (this.remuxer = new f(r, n, e, s)),
                      (h && h instanceof l) ||
                        ((this.demuxer = new l(r, n, e)),
                        (this.probe = l.probe));
                  }),
                  (i.needsProbing = function (t, i) {
                    return !this.demuxer || !this.remuxer || t || i;
                  }),
                  (i.getDecrypter = function () {
                    var t = this.decrypter;
                    return t || (t = this.decrypter = new kn(this.config)), t;
                  }),
                  t
                );
              })(),
              Cr = function (t) {
                return { remuxResult: {}, chunkMeta: t };
              };
            function Nr(t) {
              return "then" in t && t.then instanceof Function;
            }
            var Ur = function (t, i, n, r, e) {
                (this.audioCodec = void 0),
                  (this.videoCodec = void 0),
                  (this.initSegmentData = void 0),
                  (this.duration = void 0),
                  (this.defaultInitPts = void 0),
                  (this.audioCodec = t),
                  (this.videoCodec = i),
                  (this.initSegmentData = n),
                  (this.duration = r),
                  (this.defaultInitPts = e || null);
              },
              Fr = function (t, i, n, r, e, s) {
                (this.discontinuity = void 0),
                  (this.contiguous = void 0),
                  (this.accurateTimeOffset = void 0),
                  (this.trackSwitch = void 0),
                  (this.timeOffset = void 0),
                  (this.initSegmentChange = void 0),
                  (this.discontinuity = t),
                  (this.contiguous = i),
                  (this.accurateTimeOffset = n),
                  (this.trackSwitch = r),
                  (this.timeOffset = e),
                  (this.initSegmentChange = s);
              },
              jr = { exports: {} };
            !(function (t) {
              var i = Object.prototype.hasOwnProperty,
                n = "~";
              function r() {}
              function e(t, i, n) {
                (this.fn = t), (this.context = i), (this.once = n || !1);
              }
              function s(t, i, r, s, a) {
                if ("function" != typeof r)
                  throw new TypeError("The listener must be a function");
                var o = new e(r, s || t, a),
                  h = n ? n + i : i;
                return (
                  t.tt[h]
                    ? t.tt[h].fn
                      ? (t.tt[h] = [t.tt[h], o])
                      : t.tt[h].push(o)
                    : ((t.tt[h] = o), t.it++),
                  t
                );
              }
              function a(t, i) {
                0 == --t.it ? (t.tt = new r()) : delete t.tt[i];
              }
              function o() {
                (this.tt = new r()), (this.it = 0);
              }
              Object.create &&
                ((r.prototype = Object.create(null)),
                new r().__proto__ || (n = !1)),
                (o.prototype.eventNames = function () {
                  var t,
                    r,
                    e = [];
                  if (0 === this.it) return e;
                  for (r in (t = this.tt))
                    i.call(t, r) && e.push(n ? r.slice(1) : r);
                  return Object.getOwnPropertySymbols
                    ? e.concat(Object.getOwnPropertySymbols(t))
                    : e;
                }),
                (o.prototype.listeners = function (t) {
                  var i = n ? n + t : t,
                    r = this.tt[i];
                  if (!r) return [];
                  if (r.fn) return [r.fn];
                  for (var e = 0, s = r.length, a = new Array(s); e < s; e++)
                    a[e] = r[e].fn;
                  return a;
                }),
                (o.prototype.listenerCount = function (t) {
                  var i = n ? n + t : t,
                    r = this.tt[i];
                  return r ? (r.fn ? 1 : r.length) : 0;
                }),
                (o.prototype.emit = function (t, i, r, e, s, a) {
                  var o = n ? n + t : t;
                  if (!this.tt[o]) return !1;
                  var h,
                    u,
                    f = this.tt[o],
                    l = arguments.length;
                  if (f.fn) {
                    switch (
                      (f.once && this.removeListener(t, f.fn, void 0, !0), l)
                    ) {
                      case 1:
                        return f.fn.call(f.context), !0;
                      case 2:
                        return f.fn.call(f.context, i), !0;
                      case 3:
                        return f.fn.call(f.context, i, r), !0;
                      case 4:
                        return f.fn.call(f.context, i, r, e), !0;
                      case 5:
                        return f.fn.call(f.context, i, r, e, s), !0;
                      case 6:
                        return f.fn.call(f.context, i, r, e, s, a), !0;
                    }
                    for (u = 1, h = new Array(l - 1); u < l; u++)
                      h[u - 1] = arguments[u];
                    f.fn.apply(f.context, h);
                  } else {
                    var c,
                      v = f.length;
                    for (u = 0; u < v; u++)
                      switch (
                        (f[u].once &&
                          this.removeListener(t, f[u].fn, void 0, !0),
                        l)
                      ) {
                        case 1:
                          f[u].fn.call(f[u].context);
                          break;
                        case 2:
                          f[u].fn.call(f[u].context, i);
                          break;
                        case 3:
                          f[u].fn.call(f[u].context, i, r);
                          break;
                        case 4:
                          f[u].fn.call(f[u].context, i, r, e);
                          break;
                        default:
                          if (!h)
                            for (c = 1, h = new Array(l - 1); c < l; c++)
                              h[c - 1] = arguments[c];
                          f[u].fn.apply(f[u].context, h);
                      }
                  }
                  return !0;
                }),
                (o.prototype.on = function (t, i, n) {
                  return s(this, t, i, n, !1);
                }),
                (o.prototype.once = function (t, i, n) {
                  return s(this, t, i, n, !0);
                }),
                (o.prototype.removeListener = function (t, i, r, e) {
                  var s = n ? n + t : t;
                  if (!this.tt[s]) return this;
                  if (!i) return a(this, s), this;
                  var o = this.tt[s];
                  if (o.fn)
                    o.fn !== i ||
                      (e && !o.once) ||
                      (r && o.context !== r) ||
                      a(this, s);
                  else {
                    for (var h = 0, u = [], f = o.length; h < f; h++)
                      (o[h].fn !== i ||
                        (e && !o[h].once) ||
                        (r && o[h].context !== r)) &&
                        u.push(o[h]);
                    u.length
                      ? (this.tt[s] = 1 === u.length ? u[0] : u)
                      : a(this, s);
                  }
                  return this;
                }),
                (o.prototype.removeAllListeners = function (t) {
                  var i;
                  return (
                    t
                      ? ((i = n ? n + t : t), this.tt[i] && a(this, i))
                      : ((this.tt = new r()), (this.it = 0)),
                    this
                  );
                }),
                (o.prototype.off = o.prototype.removeListener),
                (o.prototype.addListener = o.prototype.on),
                (o.prefixed = n),
                (o.EventEmitter = o),
                (t.exports = o);
            })(jr);
            var Br = (function (t) {
              return t &&
                t.nt &&
                Object.prototype.hasOwnProperty.call(t, "default")
                ? t.default
                : t;
            })(jr.exports);
            function Xr(t, i) {
              if (
                !(
                  (n = i.remuxResult).audio ||
                  n.video ||
                  n.text ||
                  n.id3 ||
                  n.initSegment
                )
              )
                return !1;
              var n,
                r = [],
                e = i.remuxResult,
                s = e.audio,
                a = e.video;
              return (
                s && Yr(r, s),
                a && Yr(r, a),
                t.postMessage({ event: "transmuxComplete", data: i }, r),
                !0
              );
            }
            function Yr(t, i) {
              i.data1 && t.push(i.data1.buffer),
                i.data2 && t.push(i.data2.buffer);
            }
            function $r(t, i, n) {
              i.reduce(function (i, n) {
                return Xr(t, n) || i;
              }, !1) ||
                t.postMessage({ event: "transmuxComplete", data: i[0] }),
                t.postMessage({ event: "flush", data: n });
            }
            void 0 !== n &&
              n &&
              (function (t) {
                var i = new Br(),
                  n = function (i, n) {
                    t.postMessage({ event: i, data: n });
                  };
                i.on(w.FRAG_DECRYPTED, n), i.on(w.ERROR, n);
                t.addEventListener("message", function (r) {
                  var e = r.data;
                  switch (e.cmd) {
                    case "init":
                      var s = JSON.parse(e.config);
                      (t.transmuxer = new Pr(
                        i,
                        e.typeSupported,
                        s,
                        e.vendor,
                        e.id
                      )),
                        S(s.debug, e.id),
                        (function () {
                          var t = function (t) {
                            A[t] = function (i) {
                              n("workerLog", { logType: t, message: i });
                            };
                          };
                          for (var i in A) t(i);
                        })(),
                        n("init", null);
                      break;
                    case "configure":
                      t.transmuxer.configure(e.config);
                      break;
                    case "demux":
                      var a = t.transmuxer.push(
                        e.data,
                        e.decryptdata,
                        e.chunkMeta,
                        e.state
                      );
                      Nr(a)
                        ? ((t.transmuxer.async = !0),
                          a
                            .then(function (i) {
                              Xr(t, i);
                            })
                            .catch(function (t) {
                              n(w.ERROR, {
                                type: b.MEDIA_ERROR,
                                details: k.FRAG_PARSING_ERROR,
                                chunkMeta: e.chunkMeta,
                                fatal: !1,
                                error: t,
                                err: t,
                                reason: "transmuxer-worker push error",
                              });
                            }))
                        : ((t.transmuxer.async = !1), Xr(t, a));
                      break;
                    case "flush":
                      var o = e.chunkMeta,
                        h = t.transmuxer.flush(o);
                      Nr(h) || t.transmuxer.async
                        ? (Nr(h) || (h = Promise.resolve(h)),
                          h
                            .then(function (i) {
                              $r(t, i, o);
                            })
                            .catch(function (t) {
                              n(w.ERROR, {
                                type: b.MEDIA_ERROR,
                                details: k.FRAG_PARSING_ERROR,
                                chunkMeta: e.chunkMeta,
                                fatal: !1,
                                error: t,
                                err: t,
                                reason: "transmuxer-worker flush error",
                              });
                            }))
                        : $r(t, h, o);
                  }
                });
              })(self);
            var Hr = Xt() || {
                isTypeSupported: function () {
                  return !1;
                },
              },
              Vr = (function () {
                function t(t, n, r, e) {
                  var s = this;
                  (this.error = null),
                    (this.hls = void 0),
                    (this.id = void 0),
                    (this.observer = void 0),
                    (this.frag = null),
                    (this.part = null),
                    (this.useWorker = void 0),
                    (this.workerContext = null),
                    (this.onwmsg = void 0),
                    (this.transmuxer = null),
                    (this.onTransmuxComplete = void 0),
                    (this.onFlush = void 0);
                  var a = t.config;
                  (this.hls = t),
                    (this.id = n),
                    (this.useWorker = !!a.enableWorker),
                    (this.onTransmuxComplete = r),
                    (this.onFlush = e);
                  var o = function (t, i) {
                    ((i = i || {}).frag = s.frag),
                      (i.id = s.id),
                      t === w.ERROR && (s.error = i.error),
                      s.hls.trigger(t, i);
                  };
                  (this.observer = new Br()),
                    this.observer.on(w.FRAG_DECRYPTED, o),
                    this.observer.on(w.ERROR, o);
                  var h,
                    u,
                    f,
                    l,
                    c = {
                      mp4: Hr.isTypeSupported("video/mp4"),
                      mpeg: Hr.isTypeSupported("audio/mpeg"),
                      mp3: Hr.isTypeSupported('audio/mp4; codecs="mp3"'),
                    },
                    v = navigator.vendor;
                  if (
                    !this.useWorker ||
                    "undefined" == typeof Worker ||
                    (a.workerPath, 0)
                  )
                    this.transmuxer = new Pr(this.observer, c, a, v, n);
                  else
                    try {
                      a.workerPath
                        ? (A.log(
                            "loading Web Worker " +
                              a.workerPath +
                              ' for "' +
                              n +
                              '"'
                          ),
                          (this.workerContext =
                            ((f = a.workerPath),
                            (l = new self.URL(f, self.location.href).href),
                            { worker: new self.Worker(l), scriptURL: l })))
                        : (A.log('injecting Web Worker for "' + n + '"'),
                          (this.workerContext =
                            ((h = new self.Blob(
                              [
                                "var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(" +
                                  i.toString() +
                                  ")(true);",
                              ],
                              { type: "text/javascript" }
                            )),
                            (u = self.URL.createObjectURL(h)),
                            { worker: new self.Worker(u), objectURL: u }))),
                        (this.onwmsg = function (t) {
                          return s.onWorkerMessage(t);
                        });
                      var d = this.workerContext.worker;
                      d.addEventListener("message", this.onwmsg),
                        (d.onerror = function (t) {
                          var i = new Error(
                            t.message +
                              "  (" +
                              t.filename +
                              ":" +
                              t.lineno +
                              ")"
                          );
                          (a.enableWorker = !1),
                            A.warn(
                              'Error in "' +
                                n +
                                '" Web Worker, fallback to inline'
                            ),
                            s.hls.trigger(w.ERROR, {
                              type: b.OTHER_ERROR,
                              details: k.INTERNAL_EXCEPTION,
                              fatal: !1,
                              event: "demuxerWorker",
                              error: i,
                            });
                        }),
                        d.postMessage({
                          cmd: "init",
                          typeSupported: c,
                          vendor: v,
                          id: n,
                          config: JSON.stringify(a),
                        });
                    } catch (t) {
                      A.warn(
                        'Error setting up "' +
                          n +
                          '" Web Worker, fallback to inline',
                        t
                      ),
                        this.resetWorker(),
                        (this.error = null),
                        (this.transmuxer = new Pr(this.observer, c, a, v, n));
                    }
                }
                var n = t.prototype;
                return (
                  (n.resetWorker = function () {
                    if (this.workerContext) {
                      var t = this.workerContext,
                        i = t.worker,
                        n = t.objectURL;
                      n && self.URL.revokeObjectURL(n),
                        i.removeEventListener("message", this.onwmsg),
                        (i.onerror = null),
                        i.terminate(),
                        (this.workerContext = null);
                    }
                  }),
                  (n.destroy = function () {
                    if (this.workerContext)
                      this.resetWorker(), (this.onwmsg = void 0);
                    else {
                      var t = this.transmuxer;
                      t && (t.destroy(), (this.transmuxer = null));
                    }
                    var i = this.observer;
                    i && i.removeAllListeners(),
                      (this.frag = null),
                      (this.observer = null),
                      (this.hls = null);
                  }),
                  (n.push = function (t, i, n, r, e, s, a, o, h, u) {
                    var f,
                      l,
                      c = this;
                    h.transmuxing.start = self.performance.now();
                    var v = this.transmuxer,
                      d = s ? s.start : e.start,
                      p = e.decryptdata,
                      m = this.frag,
                      y = !(m && e.cc === m.cc),
                      g = !(m && h.level === m.level),
                      w = m ? h.sn - m.sn : -1,
                      b = this.part ? h.part - this.part.index : -1,
                      k =
                        0 === w &&
                        h.id > 1 &&
                        h.id === (null == m ? void 0 : m.stats.chunkCount),
                      E =
                        !g &&
                        (1 === w || (0 === w && (1 === b || (k && b <= 0)))),
                      T = self.performance.now();
                    (g || w || 0 === e.stats.parsing.start) &&
                      (e.stats.parsing.start = T),
                      !s || (!b && E) || (s.stats.parsing.start = T);
                    var x = !(
                        m &&
                        (null == (f = e.initSegment) ? void 0 : f.url) ===
                          (null == (l = m.initSegment) ? void 0 : l.url)
                      ),
                      S = new Fr(y, E, o, g, d, x);
                    if (!E || y || x) {
                      A.log(
                        "[transmuxer-interface, " +
                          e.type +
                          "]: Starting new transmux session for sn: " +
                          h.sn +
                          " p: " +
                          h.part +
                          " level: " +
                          h.level +
                          " id: " +
                          h.id +
                          "\n        discontinuity: " +
                          y +
                          "\n        trackSwitch: " +
                          g +
                          "\n        contiguous: " +
                          E +
                          "\n        accurateTimeOffset: " +
                          o +
                          "\n        timeOffset: " +
                          d +
                          "\n        initSegmentChange: " +
                          x
                      );
                      var M = new Ur(n, r, i, a, u);
                      this.configureTransmuxer(M);
                    }
                    if (((this.frag = e), (this.part = s), this.workerContext))
                      this.workerContext.worker.postMessage(
                        {
                          cmd: "demux",
                          data: t,
                          decryptdata: p,
                          chunkMeta: h,
                          state: S,
                        },
                        t instanceof ArrayBuffer ? [t] : []
                      );
                    else if (v) {
                      var D = v.push(t, p, h, S);
                      Nr(D)
                        ? ((v.async = !0),
                          D.then(function (t) {
                            c.handleTransmuxComplete(t);
                          }).catch(function (t) {
                            c.transmuxerError(
                              t,
                              h,
                              "transmuxer-interface push error"
                            );
                          }))
                        : ((v.async = !1), this.handleTransmuxComplete(D));
                    }
                  }),
                  (n.flush = function (t) {
                    var i = this;
                    t.transmuxing.start = self.performance.now();
                    var n = this.transmuxer;
                    if (this.workerContext)
                      this.workerContext.worker.postMessage({
                        cmd: "flush",
                        chunkMeta: t,
                      });
                    else if (n) {
                      var r = n.flush(t);
                      Nr(r) || n.async
                        ? (Nr(r) || (r = Promise.resolve(r)),
                          r
                            .then(function (n) {
                              i.handleFlushResult(n, t);
                            })
                            .catch(function (n) {
                              i.transmuxerError(
                                n,
                                t,
                                "transmuxer-interface flush error"
                              );
                            }))
                        : this.handleFlushResult(r, t);
                    }
                  }),
                  (n.transmuxerError = function (t, i, n) {
                    this.hls &&
                      ((this.error = t),
                      this.hls.trigger(w.ERROR, {
                        type: b.MEDIA_ERROR,
                        details: k.FRAG_PARSING_ERROR,
                        chunkMeta: i,
                        fatal: !1,
                        error: t,
                        err: t,
                        reason: n,
                      }));
                  }),
                  (n.handleFlushResult = function (t, i) {
                    var n = this;
                    t.forEach(function (t) {
                      n.handleTransmuxComplete(t);
                    }),
                      this.onFlush(i);
                  }),
                  (n.onWorkerMessage = function (t) {
                    var i = t.data,
                      n = this.hls;
                    switch (i.event) {
                      case "init":
                        var r,
                          e =
                            null == (r = this.workerContext)
                              ? void 0
                              : r.objectURL;
                        e && self.URL.revokeObjectURL(e);
                        break;
                      case "transmuxComplete":
                        this.handleTransmuxComplete(i.data);
                        break;
                      case "flush":
                        this.onFlush(i.data);
                        break;
                      case "workerLog":
                        A[i.data.logType] && A[i.data.logType](i.data.message);
                        break;
                      default:
                        (i.data = i.data || {}),
                          (i.data.frag = this.frag),
                          (i.data.id = this.id),
                          n.trigger(i.event, i.data);
                    }
                  }),
                  (n.configureTransmuxer = function (t) {
                    var i = this.transmuxer;
                    this.workerContext
                      ? this.workerContext.worker.postMessage({
                          cmd: "configure",
                          config: t,
                        })
                      : i && i.configure(t);
                  }),
                  (n.handleTransmuxComplete = function (t) {
                    (t.chunkMeta.transmuxing.end = self.performance.now()),
                      this.onTransmuxComplete(t);
                  }),
                  t
                );
              })(),
              Gr = (function () {
                function t(t, i, n, r) {
                  (this.config = void 0),
                    (this.media = null),
                    (this.fragmentTracker = void 0),
                    (this.hls = void 0),
                    (this.nudgeRetry = 0),
                    (this.stallReported = !1),
                    (this.stalled = null),
                    (this.moved = !1),
                    (this.seeking = !1),
                    (this.config = t),
                    (this.media = i),
                    (this.fragmentTracker = n),
                    (this.hls = r);
                }
                var i = t.prototype;
                return (
                  (i.destroy = function () {
                    (this.media = null),
                      (this.hls = this.fragmentTracker = null);
                  }),
                  (i.poll = function (t, i) {
                    var n = this.config,
                      r = this.media,
                      e = this.stalled;
                    if (null !== r) {
                      var s = r.currentTime,
                        a = r.seeking,
                        o = this.seeking && !a,
                        h = !this.seeking && a;
                      if (((this.seeking = a), s === t)) {
                        if (h || o) this.stalled = null;
                        else if (
                          !(
                            (r.paused && !a) ||
                            r.ended ||
                            0 === r.playbackRate
                          ) &&
                          cn.getBuffered(r).length
                        ) {
                          var u = cn.bufferInfo(r, s, 0),
                            f = u.len > 0,
                            l = u.nextStart || 0;
                          if (f || l) {
                            if (a) {
                              var c = u.len > 2,
                                v =
                                  !l ||
                                  (i && i.start <= s) ||
                                  (l - s > 2 &&
                                    !this.fragmentTracker.getPartialFragment(
                                      s
                                    ));
                              if (c || v) return;
                              this.moved = !1;
                            }
                            if (!this.moved && null !== this.stalled) {
                              var d,
                                p = Math.max(l, u.start || 0) - s,
                                m = this.hls.levels
                                  ? this.hls.levels[this.hls.currentLevel]
                                  : null,
                                y = (
                                  null == m || null == (d = m.details)
                                    ? void 0
                                    : d.live
                                )
                                  ? 2 * m.details.targetduration
                                  : 2,
                                g = this.fragmentTracker.getPartialFragment(s);
                              if (p > 0 && (p <= y || g))
                                return void this.rt(g);
                            }
                            var w = self.performance.now();
                            if (null !== e) {
                              var b = w - e;
                              if (
                                a ||
                                !(b >= 250) ||
                                (this.et(u), this.media)
                              ) {
                                var k = cn.bufferInfo(r, s, n.maxBufferHole);
                                this.ht(k, b);
                              }
                            } else this.stalled = w;
                          }
                        }
                      } else if (((this.moved = !0), null !== e)) {
                        if (this.stallReported) {
                          var E = self.performance.now() - e;
                          A.warn(
                            "playback not stuck anymore @" +
                              s +
                              ", after " +
                              Math.round(E) +
                              "ms"
                          ),
                            (this.stallReported = !1);
                        }
                        (this.stalled = null), (this.nudgeRetry = 0);
                      }
                    }
                  }),
                  (i.ht = function (t, i) {
                    var n = this.config,
                      r = this.fragmentTracker,
                      e = this.media;
                    if (null !== e) {
                      var s = e.currentTime,
                        a = r.getPartialFragment(s);
                      if (a && (this.rt(a) || !this.media)) return;
                      (t.len > n.maxBufferHole ||
                        (t.nextStart && t.nextStart - s < n.maxBufferHole)) &&
                        i > 1e3 * n.highBufferWatchdogPeriod &&
                        (A.warn("Trying to nudge playhead over buffer-hole"),
                        (this.stalled = null),
                        this.ut());
                    }
                  }),
                  (i.et = function (t) {
                    var i = this.hls,
                      n = this.media;
                    if (!this.stallReported && n) {
                      this.stallReported = !0;
                      var r = new Error(
                        "Playback stalling at @" +
                          n.currentTime +
                          " due to low buffer (" +
                          JSON.stringify(t) +
                          ")"
                      );
                      A.warn(r.message),
                        i.trigger(w.ERROR, {
                          type: b.MEDIA_ERROR,
                          details: k.BUFFER_STALLED_ERROR,
                          fatal: !1,
                          error: r,
                          buffer: t.len,
                        });
                    }
                  }),
                  (i.rt = function (t) {
                    var i = this.config,
                      n = this.hls,
                      r = this.media;
                    if (null === r) return 0;
                    var e = r.currentTime,
                      s = cn.bufferInfo(r, e, 0),
                      a = e < s.start ? s.start : s.nextStart;
                    if (a) {
                      var o = s.len <= i.maxBufferHole,
                        h = s.len > 0 && s.len < 1 && r.readyState < 3,
                        u = a - e;
                      if (u > 0 && (o || h)) {
                        if (u > i.maxBufferHole) {
                          var f = this.fragmentTracker,
                            l = !1;
                          if (0 === e) {
                            var c = f.getAppendedFrag(0, hi);
                            c && a < c.end && (l = !0);
                          }
                          if (!l) {
                            var v = t || f.getAppendedFrag(e, hi);
                            if (v) {
                              for (var d = !1, p = v.end; p < a; ) {
                                var m = f.getPartialFragment(p);
                                if (!m) {
                                  d = !0;
                                  break;
                                }
                                p += m.duration;
                              }
                              if (d) return 0;
                            }
                          }
                        }
                        var y = Math.max(a + 0.05, e + 0.1);
                        if (
                          (A.warn(
                            "skipping hole, adjusting currentTime from " +
                              e +
                              " to " +
                              y
                          ),
                          (this.moved = !0),
                          (this.stalled = null),
                          (r.currentTime = y),
                          t && !t.gap)
                        ) {
                          var g = new Error(
                            "fragment loaded with buffer holes, seeking from " +
                              e +
                              " to " +
                              y
                          );
                          n.trigger(w.ERROR, {
                            type: b.MEDIA_ERROR,
                            details: k.BUFFER_SEEK_OVER_HOLE,
                            fatal: !1,
                            error: g,
                            reason: g.message,
                            frag: t,
                          });
                        }
                        return y;
                      }
                    }
                    return 0;
                  }),
                  (i.ut = function () {
                    var t = this.config,
                      i = this.hls,
                      n = this.media,
                      r = this.nudgeRetry;
                    if (null !== n) {
                      var e = n.currentTime;
                      if ((this.nudgeRetry++, r < t.nudgeMaxRetry)) {
                        var s = e + (r + 1) * t.nudgeOffset,
                          a = new Error(
                            "Nudging 'currentTime' from " + e + " to " + s
                          );
                        A.warn(a.message),
                          (n.currentTime = s),
                          i.trigger(w.ERROR, {
                            type: b.MEDIA_ERROR,
                            details: k.BUFFER_NUDGE_ON_STALL,
                            error: a,
                            fatal: !1,
                          });
                      } else {
                        var o = new Error(
                          "Playhead still not moving while enough data buffered @" +
                            e +
                            " after " +
                            t.nudgeMaxRetry +
                            " nudges"
                        );
                        A.error(o.message),
                          i.trigger(w.ERROR, {
                            type: b.MEDIA_ERROR,
                            details: k.BUFFER_STALLED_ERROR,
                            error: o,
                            fatal: !0,
                          });
                      }
                    }
                  }),
                  t
                );
              })(),
              Wr = (function (t) {
                function i(i, n, r) {
                  var e;
                  return (
                    ((e =
                      t.call(this, i, n, r, "[stream-controller]", hi) ||
                      this).audioCodecSwap = !1),
                    (e.gapController = null),
                    (e.level = -1),
                    (e.ft = !1),
                    (e.altAudio = !1),
                    (e.audioOnly = !1),
                    (e.fragPlaying = null),
                    (e.onvplaying = null),
                    (e.onvseeked = null),
                    (e.fragLastKbps = 0),
                    (e.couldBacktrack = !1),
                    (e.backtrackFragment = null),
                    (e.audioCodecSwitch = !1),
                    (e.videoBuffer = null),
                    e.m(),
                    e
                  );
                }
                h(i, t);
                var n = i.prototype;
                return (
                  (n.m = function () {
                    var t = this.hls;
                    t.on(w.MEDIA_ATTACHED, this.onMediaAttached, this),
                      t.on(w.MEDIA_DETACHING, this.onMediaDetaching, this),
                      t.on(w.MANIFEST_LOADING, this.onManifestLoading, this),
                      t.on(w.MANIFEST_PARSED, this.onManifestParsed, this),
                      t.on(w.LEVEL_LOADING, this.onLevelLoading, this),
                      t.on(w.LEVEL_LOADED, this.onLevelLoaded, this),
                      t.on(
                        w.FRAG_LOAD_EMERGENCY_ABORTED,
                        this.onFragLoadEmergencyAborted,
                        this
                      ),
                      t.on(w.ERROR, this.onError, this),
                      t.on(
                        w.AUDIO_TRACK_SWITCHING,
                        this.onAudioTrackSwitching,
                        this
                      ),
                      t.on(
                        w.AUDIO_TRACK_SWITCHED,
                        this.onAudioTrackSwitched,
                        this
                      ),
                      t.on(w.BUFFER_CREATED, this.onBufferCreated, this),
                      t.on(w.BUFFER_FLUSHED, this.onBufferFlushed, this),
                      t.on(w.LEVELS_UPDATED, this.onLevelsUpdated, this),
                      t.on(w.FRAG_BUFFERED, this.onFragBuffered, this);
                  }),
                  (n.k = function () {
                    var t = this.hls;
                    t.off(w.MEDIA_ATTACHED, this.onMediaAttached, this),
                      t.off(w.MEDIA_DETACHING, this.onMediaDetaching, this),
                      t.off(w.MANIFEST_LOADING, this.onManifestLoading, this),
                      t.off(w.MANIFEST_PARSED, this.onManifestParsed, this),
                      t.off(w.LEVEL_LOADED, this.onLevelLoaded, this),
                      t.off(
                        w.FRAG_LOAD_EMERGENCY_ABORTED,
                        this.onFragLoadEmergencyAborted,
                        this
                      ),
                      t.off(w.ERROR, this.onError, this),
                      t.off(
                        w.AUDIO_TRACK_SWITCHING,
                        this.onAudioTrackSwitching,
                        this
                      ),
                      t.off(
                        w.AUDIO_TRACK_SWITCHED,
                        this.onAudioTrackSwitched,
                        this
                      ),
                      t.off(w.BUFFER_CREATED, this.onBufferCreated, this),
                      t.off(w.BUFFER_FLUSHED, this.onBufferFlushed, this),
                      t.off(w.LEVELS_UPDATED, this.onLevelsUpdated, this),
                      t.off(w.FRAG_BUFFERED, this.onFragBuffered, this);
                  }),
                  (n.onHandlerDestroying = function () {
                    this.k(), this.onMediaDetaching();
                  }),
                  (n.startLoad = function (t) {
                    if (this.levels) {
                      var i = this.lastCurrentTime,
                        n = this.hls;
                      if (
                        (this.stopLoad(),
                        this.setInterval(100),
                        (this.level = -1),
                        !this.startFragRequested)
                      ) {
                        var r = n.startLevel;
                        -1 === r &&
                          (n.config.testBandwidth && this.levels.length > 1
                            ? ((r = 0), (this.bitrateTest = !0))
                            : (r = n.nextAutoLevel)),
                          (this.level = n.nextLoadLevel = r),
                          (this.loadedmetadata = !1);
                      }
                      i > 0 &&
                        -1 === t &&
                        (this.log(
                          "Override startPosition with lastCurrentTime @" +
                            i.toFixed(3)
                        ),
                        (t = i)),
                        (this.state = Tn),
                        (this.nextLoadPosition =
                          this.startPosition =
                          this.lastCurrentTime =
                            t),
                        this.tick();
                    } else (this.ft = !0), (this.state = En);
                  }),
                  (n.stopLoad = function () {
                    (this.ft = !1), t.prototype.stopLoad.call(this);
                  }),
                  (n.doTick = function () {
                    switch (this.state) {
                      case In:
                        var t,
                          i = this.levels,
                          n = this.level,
                          r =
                            null == i || null == (t = i[n])
                              ? void 0
                              : t.details;
                        if (
                          r &&
                          (!r.live || this.levelLastLoaded === this.level)
                        ) {
                          if (this.waitForCdnTuneIn(r)) break;
                          this.state = Tn;
                          break;
                        }
                        if (this.hls.nextLoadLevel !== this.level) {
                          this.state = Tn;
                          break;
                        }
                        break;
                      case An:
                        var e,
                          s = self.performance.now(),
                          a = this.retryDate;
                        (!a ||
                          s >= a ||
                          (null != (e = this.media) && e.seeking)) &&
                          (this.resetStartWhenNotLoaded(this.level),
                          (this.state = Tn));
                    }
                    this.state === Tn && this.doTickIdle(), this.onTickEnd();
                  }),
                  (n.onTickEnd = function () {
                    t.prototype.onTickEnd.call(this),
                      this.checkBuffer(),
                      this.checkFragmentChanged();
                  }),
                  (n.doTickIdle = function () {
                    var t = this.hls,
                      i = this.levelLastLoaded,
                      n = this.levels,
                      r = this.media,
                      e = t.config,
                      s = t.nextLoadLevel;
                    if (
                      null !== i &&
                      (r ||
                        (!this.startFragRequested && e.startFragPrefetch)) &&
                      (!this.altAudio || !this.audioOnly) &&
                      null != n &&
                      n[s]
                    ) {
                      var a = n[s],
                        o = this.getMainFwdBufferInfo();
                      if (null !== o) {
                        var h = this.getLevelDetails();
                        if (h && this.C(o, h)) {
                          var u = {};
                          return (
                            this.altAudio && (u.type = "video"),
                            this.hls.trigger(w.BUFFER_EOS, u),
                            void (this.state = On)
                          );
                        }
                        t.loadLevel !== s &&
                          -1 === t.manualLevel &&
                          this.log(
                            "Adapting to level " +
                              s +
                              " from level " +
                              this.level
                          ),
                          (this.level = t.nextLoadLevel = s);
                        var f = a.details;
                        if (
                          !f ||
                          this.state === In ||
                          (f.live && this.levelLastLoaded !== s)
                        )
                          return (this.level = s), void (this.state = In);
                        var l = o.len,
                          c = this.getMaxBufferLength(a.maxBitrate);
                        if (!(l >= c)) {
                          this.backtrackFragment &&
                            this.backtrackFragment.start > o.end &&
                            (this.backtrackFragment = null);
                          var v = this.backtrackFragment
                              ? this.backtrackFragment.start
                              : o.end,
                            d = this.getNextFragment(v, f);
                          if (
                            this.couldBacktrack &&
                            !this.fragPrevious &&
                            d &&
                            "initSegment" !== d.sn &&
                            this.fragmentTracker.getState(d) !== Zi
                          ) {
                            var p,
                              m =
                                (null != (p = this.backtrackFragment) ? p : d)
                                  .sn - f.startSN,
                              y = f.fragments[m - 1];
                            y &&
                              d.cc === y.cc &&
                              ((d = y), this.fragmentTracker.removeFragment(y));
                          } else
                            this.backtrackFragment &&
                              o.len &&
                              (this.backtrackFragment = null);
                          if (d && this.isLoopLoading(d, v)) {
                            if (!d.gap) {
                              var g = this.audioOnly && !this.altAudio ? I : P,
                                b =
                                  (g === P
                                    ? this.videoBuffer
                                    : this.mediaBuffer) || this.media;
                              b && this.afterBufferFlushed(b, g, hi);
                            }
                            d = this.getNextFragmentLoopLoading(d, f, o, hi, c);
                          }
                          d &&
                            (!d.initSegment ||
                              d.initSegment.data ||
                              this.bitrateTest ||
                              (d = d.initSegment),
                            this.loadFragment(d, a, v));
                        }
                      }
                    }
                  }),
                  (n.loadFragment = function (i, n, r) {
                    var e = this.fragmentTracker.getState(i);
                    (this.fragCurrent = i),
                      e === qi || e === Qi
                        ? "initSegment" === i.sn
                          ? this.B(i, n)
                          : this.bitrateTest
                          ? (this.log(
                              "Fragment " +
                                i.sn +
                                " of level " +
                                i.level +
                                " is being downloaded to test bitrate and will not be buffered"
                            ),
                            this.lt(i, n))
                          : ((this.startFragRequested = !0),
                            t.prototype.loadFragment.call(this, i, n, r))
                        : this.clearTrackerIfNeeded(i);
                  }),
                  (n.getBufferedFrag = function (t) {
                    return this.fragmentTracker.getBufferedFrag(t, hi);
                  }),
                  (n.followingBufferedFrag = function (t) {
                    return t ? this.getBufferedFrag(t.end + 0.5) : null;
                  }),
                  (n.immediateLevelSwitch = function () {
                    this.abortCurrentFrag(),
                      this.flushMainBuffer(0, Number.POSITIVE_INFINITY);
                  }),
                  (n.nextLevelSwitch = function () {
                    var t = this.levels,
                      i = this.media;
                    if (null != i && i.readyState) {
                      var n,
                        r = this.getAppendedFrag(i.currentTime);
                      r && r.start > 1 && this.flushMainBuffer(0, r.start - 1);
                      var e = this.getLevelDetails();
                      if (null != e && e.live) {
                        var s = this.getMainFwdBufferInfo();
                        if (!s || s.len < 2 * e.targetduration) return;
                      }
                      if (!i.paused && t) {
                        var a = t[this.hls.nextLoadLevel],
                          o = this.fragLastKbps;
                        n =
                          o && this.fragCurrent
                            ? (this.fragCurrent.duration * a.maxBitrate) /
                                (1e3 * o) +
                              1
                            : 0;
                      } else n = 0;
                      var h = this.getBufferedFrag(i.currentTime + n);
                      if (h) {
                        var u = this.followingBufferedFrag(h);
                        if (u) {
                          this.abortCurrentFrag();
                          var f = u.maxStartPTS ? u.maxStartPTS : u.start,
                            l = u.duration,
                            c = Math.max(
                              h.end,
                              f +
                                Math.min(
                                  Math.max(
                                    l - this.config.maxFragLookUpTolerance,
                                    0.5 * l
                                  ),
                                  0.75 * l
                                )
                            );
                          this.flushMainBuffer(c, Number.POSITIVE_INFINITY);
                        }
                      }
                    }
                  }),
                  (n.abortCurrentFrag = function () {
                    var t = this.fragCurrent;
                    switch (
                      ((this.fragCurrent = null),
                      (this.backtrackFragment = null),
                      t &&
                        (t.abortRequests(),
                        this.fragmentTracker.removeFragment(t)),
                      this.state)
                    ) {
                      case xn:
                      case Sn:
                      case An:
                      case Dn:
                      case _n:
                        this.state = Tn;
                    }
                    this.nextLoadPosition = this.getLoadPosition();
                  }),
                  (n.flushMainBuffer = function (i, n) {
                    t.prototype.flushMainBuffer.call(
                      this,
                      i,
                      n,
                      this.altAudio ? "video" : null
                    );
                  }),
                  (n.onMediaAttached = function (i, n) {
                    t.prototype.onMediaAttached.call(this, i, n);
                    var r = n.media;
                    (this.onvplaying = this.onMediaPlaying.bind(this)),
                      (this.onvseeked = this.onMediaSeeked.bind(this)),
                      r.addEventListener("playing", this.onvplaying),
                      r.addEventListener("seeked", this.onvseeked),
                      (this.gapController = new Gr(
                        this.config,
                        r,
                        this.fragmentTracker,
                        this.hls
                      ));
                  }),
                  (n.onMediaDetaching = function () {
                    var i = this.media;
                    i &&
                      this.onvplaying &&
                      this.onvseeked &&
                      (i.removeEventListener("playing", this.onvplaying),
                      i.removeEventListener("seeked", this.onvseeked),
                      (this.onvplaying = this.onvseeked = null),
                      (this.videoBuffer = null)),
                      (this.fragPlaying = null),
                      this.gapController &&
                        (this.gapController.destroy(),
                        (this.gapController = null)),
                      t.prototype.onMediaDetaching.call(this);
                  }),
                  (n.onMediaPlaying = function () {
                    this.tick();
                  }),
                  (n.onMediaSeeked = function () {
                    var t = this.media,
                      i = t ? t.currentTime : null;
                    g(i) && this.log("Media seeked to " + i.toFixed(3));
                    var n = this.getMainFwdBufferInfo();
                    null !== n && 0 !== n.len
                      ? this.tick()
                      : this.warn(
                          'Main forward buffer length on "seeked" event ' +
                            (n ? n.len : "empty") +
                            ")"
                        );
                  }),
                  (n.onManifestLoading = function () {
                    this.log("Trigger BUFFER_RESET"),
                      this.hls.trigger(w.BUFFER_RESET, void 0),
                      this.fragmentTracker.removeAllFragments(),
                      (this.couldBacktrack = !1),
                      (this.startPosition = this.lastCurrentTime = 0),
                      (this.levels =
                        this.fragPlaying =
                        this.backtrackFragment =
                          null),
                      (this.altAudio = this.audioOnly = !1);
                  }),
                  (n.onManifestParsed = function (t, i) {
                    var n,
                      r,
                      e,
                      s = !1,
                      a = !1;
                    i.levels.forEach(function (t) {
                      (n = t.audioCodec) &&
                        (-1 !== n.indexOf("mp4a.40.2") && (s = !0),
                        -1 !== n.indexOf("mp4a.40.5") && (a = !0));
                    }),
                      (this.audioCodecSwitch =
                        s &&
                        a &&
                        !(
                          "function" ==
                          typeof (null == (e = Cn()) ||
                          null == (r = e.prototype)
                            ? void 0
                            : r.changeType)
                        )),
                      this.audioCodecSwitch &&
                        this.log(
                          "Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"
                        ),
                      (this.levels = i.levels),
                      (this.startFragRequested = !1);
                  }),
                  (n.onLevelLoading = function (t, i) {
                    var n = this.levels;
                    if (n && this.state === Tn) {
                      var r = n[i.level];
                      (!r.details ||
                        (r.details.live && this.levelLastLoaded !== i.level) ||
                        this.waitForCdnTuneIn(r.details)) &&
                        (this.state = In);
                    }
                  }),
                  (n.onLevelLoaded = function (t, i) {
                    var n,
                      r = this.levels,
                      e = i.level,
                      s = i.details,
                      a = s.totalduration;
                    if (r) {
                      this.log(
                        "Level " +
                          e +
                          " loaded [" +
                          s.startSN +
                          "," +
                          s.endSN +
                          "]" +
                          (s.lastPartSn
                            ? "[part-" +
                              s.lastPartSn +
                              "-" +
                              s.lastPartIndex +
                              "]"
                            : "") +
                          ", cc [" +
                          s.startCC +
                          ", " +
                          s.endCC +
                          "] duration:" +
                          a
                      );
                      var o = r[e],
                        h = this.fragCurrent;
                      !h ||
                        (this.state !== Sn && this.state !== An) ||
                        (h.level === i.level && h.urlId === o.urlId) ||
                        !h.loader ||
                        this.abortCurrentFrag();
                      var u = 0;
                      if (s.live || (null != (n = o.details) && n.live)) {
                        if (
                          (s.fragments[0] || (s.deltaUpdateFailed = !0),
                          s.deltaUpdateFailed)
                        )
                          return;
                        u = this.alignPlaylists(s, o.details);
                      }
                      if (
                        ((o.details = s),
                        (this.levelLastLoaded = e),
                        this.hls.trigger(w.LEVEL_UPDATED, {
                          details: s,
                          level: e,
                        }),
                        this.state === In)
                      ) {
                        if (this.waitForCdnTuneIn(s)) return;
                        this.state = Tn;
                      }
                      this.startFragRequested
                        ? s.live && this.synchronizeToLiveEdge(s)
                        : this.setStartPosition(s, u),
                        this.tick();
                    } else
                      this.warn("Levels were reset while loading level " + e);
                  }),
                  (n.F = function (t) {
                    var i,
                      n = t.frag,
                      r = t.part,
                      e = t.payload,
                      s = this.levels;
                    if (s) {
                      var a = s[n.level],
                        o = a.details;
                      if (!o)
                        return (
                          this.warn(
                            "Dropping fragment " +
                              n.sn +
                              " of level " +
                              n.level +
                              " after level details were reset"
                          ),
                          void this.fragmentTracker.removeFragment(n)
                        );
                      var h = a.videoCodec,
                        u = o.PTSKnown || !o.live,
                        f = null == (i = n.initSegment) ? void 0 : i.data,
                        l = this.ct(a),
                        c = (this.transmuxer =
                          this.transmuxer ||
                          new Vr(
                            this.hls,
                            hi,
                            this.vt.bind(this),
                            this.$.bind(this)
                          )),
                        v = r ? r.index : -1,
                        d = -1 !== v,
                        p = new vn(
                          n.level,
                          n.sn,
                          n.stats.chunkCount,
                          e.byteLength,
                          v,
                          d
                        ),
                        m = this.initPTS[n.cc];
                      c.push(e, f, l, h, n, r, o.totalduration, u, p, m);
                    } else
                      this.warn(
                        "Levels were reset while fragment load was in progress. Fragment " +
                          n.sn +
                          " of level " +
                          n.level +
                          " will not be buffered"
                      );
                  }),
                  (n.onAudioTrackSwitching = function (t, i) {
                    var n = this.altAudio;
                    if (!i.url) {
                      if (this.mediaBuffer !== this.media) {
                        this.log(
                          "Switching on main audio, use media.buffered to schedule main fragment loading"
                        ),
                          (this.mediaBuffer = this.media);
                        var r = this.fragCurrent;
                        r &&
                          (this.log(
                            "Switching to main audio track, cancel main fragment load"
                          ),
                          r.abortRequests(),
                          this.fragmentTracker.removeFragment(r)),
                          this.resetTransmuxer(),
                          this.resetLoadingState();
                      } else this.audioOnly && this.resetTransmuxer();
                      var e = this.hls;
                      n &&
                        (e.trigger(w.BUFFER_FLUSHING, {
                          startOffset: 0,
                          endOffset: Number.POSITIVE_INFINITY,
                          type: null,
                        }),
                        this.fragmentTracker.removeAllFragments()),
                        e.trigger(w.AUDIO_TRACK_SWITCHED, i);
                    }
                  }),
                  (n.onAudioTrackSwitched = function (t, i) {
                    var n = i.id,
                      r = !!this.hls.audioTracks[n].url;
                    if (r) {
                      var e = this.videoBuffer;
                      e &&
                        this.mediaBuffer !== e &&
                        (this.log(
                          "Switching on alternate audio, use video.buffered to schedule main fragment loading"
                        ),
                        (this.mediaBuffer = e));
                    }
                    (this.altAudio = r), this.tick();
                  }),
                  (n.onBufferCreated = function (t, i) {
                    var n,
                      r,
                      e = i.tracks,
                      s = !1;
                    for (var a in e) {
                      var o = e[a];
                      if ("main" === o.id) {
                        if (((r = a), (n = o), "video" === a)) {
                          var h = e[a];
                          h && (this.videoBuffer = h.buffer);
                        }
                      } else s = !0;
                    }
                    s && n
                      ? (this.log(
                          "Alternate track found, use " +
                            r +
                            ".buffered to schedule main fragment loading"
                        ),
                        (this.mediaBuffer = n.buffer))
                      : (this.mediaBuffer = this.media);
                  }),
                  (n.onFragBuffered = function (t, i) {
                    var n = i.frag,
                      r = i.part;
                    if (!n || n.type === hi) {
                      if (this.fragContextChanged(n))
                        return (
                          this.warn(
                            "Fragment " +
                              n.sn +
                              (r ? " p: " + r.index : "") +
                              " of level " +
                              n.level +
                              " finished buffering, but was aborted. state: " +
                              this.state
                          ),
                          void (this.state === _n && (this.state = Tn))
                        );
                      var e = r ? r.stats : n.stats;
                      (this.fragLastKbps = Math.round(
                        (8 * e.total) / (e.buffering.end - e.loading.first)
                      )),
                        "initSegment" !== n.sn && (this.fragPrevious = n),
                        this.fragBufferedComplete(n, r);
                    }
                  }),
                  (n.onError = function (t, i) {
                    var n;
                    if (i.fatal) this.state = Rn;
                    else
                      switch (i.details) {
                        case k.FRAG_GAP:
                        case k.FRAG_PARSING_ERROR:
                        case k.FRAG_DECRYPT_ERROR:
                        case k.FRAG_LOAD_ERROR:
                        case k.FRAG_LOAD_TIMEOUT:
                        case k.KEY_LOAD_ERROR:
                        case k.KEY_LOAD_TIMEOUT:
                          this.onFragmentOrKeyLoadError(hi, i);
                          break;
                        case k.LEVEL_LOAD_ERROR:
                        case k.LEVEL_LOAD_TIMEOUT:
                        case k.LEVEL_PARSING_ERROR:
                          i.levelRetry ||
                            this.state !== In ||
                            (null == (n = i.context) ? void 0 : n.type) !==
                              si ||
                            (this.state = Tn);
                          break;
                        case k.BUFFER_FULL_ERROR:
                          if (!i.parent || "main" !== i.parent) return;
                          this.reduceLengthAndFlushBuffer(i) &&
                            this.flushMainBuffer(0, Number.POSITIVE_INFINITY);
                          break;
                        case k.INTERNAL_EXCEPTION:
                          this.recoverWorkerError(i);
                      }
                  }),
                  (n.checkBuffer = function () {
                    var t = this.media,
                      i = this.gapController;
                    if (t && i && t.readyState) {
                      if (this.loadedmetadata || !cn.getBuffered(t).length) {
                        var n = this.state !== Tn ? this.fragCurrent : null;
                        i.poll(this.lastCurrentTime, n);
                      }
                      this.lastCurrentTime = t.currentTime;
                    }
                  }),
                  (n.onFragLoadEmergencyAborted = function () {
                    (this.state = Tn),
                      this.loadedmetadata ||
                        ((this.startFragRequested = !1),
                        (this.nextLoadPosition = this.startPosition)),
                      this.tickImmediate();
                  }),
                  (n.onBufferFlushed = function (t, i) {
                    var n = i.type;
                    if (n !== I || (this.audioOnly && !this.altAudio)) {
                      var r =
                        (n === P ? this.videoBuffer : this.mediaBuffer) ||
                        this.media;
                      this.afterBufferFlushed(r, n, hi);
                    }
                  }),
                  (n.onLevelsUpdated = function (t, i) {
                    this.levels = i.levels;
                  }),
                  (n.swapAudioCodec = function () {
                    this.audioCodecSwap = !this.audioCodecSwap;
                  }),
                  (n.seekToStartPos = function () {
                    var t = this.media;
                    if (t) {
                      var i = t.currentTime,
                        n = this.startPosition;
                      if (n >= 0 && i < n) {
                        if (t.seeking)
                          return void this.log(
                            "could not seek to " +
                              n +
                              ", already seeking at " +
                              i
                          );
                        var r = cn.getBuffered(t),
                          e = (r.length ? r.start(0) : 0) - n;
                        e > 0 &&
                          (e < this.config.maxBufferHole ||
                            e < this.config.maxFragLookUpTolerance) &&
                          (this.log(
                            "adjusting start position by " +
                              e +
                              " to match buffer start"
                          ),
                          (n += e),
                          (this.startPosition = n)),
                          this.log(
                            "seek to target start position " +
                              n +
                              " from current time " +
                              i
                          ),
                          (t.currentTime = n);
                      }
                    }
                  }),
                  (n.ct = function (t) {
                    var i = this.config.defaultAudioCodec || t.audioCodec;
                    return (
                      this.audioCodecSwap &&
                        i &&
                        (this.log("Swapping audio codec"),
                        (i =
                          -1 !== i.indexOf("mp4a.40.5")
                            ? "mp4a.40.2"
                            : "mp4a.40.5")),
                      i
                    );
                  }),
                  (n.lt = function (t, i) {
                    var n = this;
                    (t.bitrateTest = !0),
                      this.U(t, i).then(function (r) {
                        var e = n.hls;
                        if (r && !n.fragContextChanged(t)) {
                          (i.fragmentError = 0),
                            (n.state = Tn),
                            (n.startFragRequested = !1),
                            (n.bitrateTest = !1);
                          var s = t.stats;
                          (s.parsing.start =
                            s.parsing.end =
                            s.buffering.start =
                            s.buffering.end =
                              self.performance.now()),
                            e.trigger(w.FRAG_LOADED, r),
                            (t.bitrateTest = !1);
                        }
                      });
                  }),
                  (n.vt = function (t) {
                    var i,
                      n = "main",
                      r = this.hls,
                      e = t.remuxResult,
                      s = t.chunkMeta,
                      a = this.getCurrentContext(s);
                    if (a) {
                      var o = a.frag,
                        h = a.part,
                        u = a.level,
                        f = e.video,
                        l = e.text,
                        c = e.id3,
                        v = e.initSegment,
                        d = u.details,
                        p = this.altAudio ? void 0 : e.audio;
                      if (this.fragContextChanged(o))
                        this.fragmentTracker.removeFragment(o);
                      else {
                        if (((this.state = Dn), v)) {
                          if (null != v && v.tracks) {
                            var m = o.initSegment || o;
                            this.dt(u, v.tracks, m, s),
                              r.trigger(w.FRAG_PARSING_INIT_SEGMENT, {
                                frag: m,
                                id: n,
                                tracks: v.tracks,
                              });
                          }
                          var y = v.initPTS,
                            b = v.timescale;
                          g(y) &&
                            ((this.initPTS[o.cc] = {
                              baseTime: y,
                              timescale: b,
                            }),
                            r.trigger(w.INIT_PTS_FOUND, {
                              frag: o,
                              id: n,
                              initPTS: y,
                              timescale: b,
                            }));
                        }
                        if (f && !1 !== e.independent) {
                          if (d) {
                            var k = f.startPTS,
                              E = f.endPTS,
                              T = f.startDTS,
                              x = f.endDTS;
                            if (h)
                              h.elementaryStreams[f.type] = {
                                startPTS: k,
                                endPTS: E,
                                startDTS: T,
                                endDTS: x,
                              };
                            else if (
                              (f.firstKeyFrame &&
                                f.independent &&
                                1 === s.id &&
                                (this.couldBacktrack = !0),
                              f.dropped && f.independent)
                            ) {
                              var S = this.getMainFwdBufferInfo();
                              if (
                                (S ? S.end : this.getLoadPosition()) +
                                  this.config.maxBufferHole <
                                (f.firstKeyFramePTS ? f.firstKeyFramePTS : k) -
                                  this.config.maxBufferHole
                              )
                                return void this.backtrack(o);
                              o.setElementaryStreamInfo(
                                f.type,
                                o.start,
                                E,
                                o.start,
                                x,
                                !0
                              );
                            }
                            o.setElementaryStreamInfo(f.type, k, E, T, x),
                              this.backtrackFragment &&
                                (this.backtrackFragment = o),
                              this.bufferFragmentData(f, o, h, s);
                          }
                        } else if (!1 === e.independent)
                          return void this.backtrack(o);
                        if (p) {
                          var A = p.startPTS,
                            M = p.endPTS,
                            D = p.startDTS,
                            _ = p.endDTS;
                          h &&
                            (h.elementaryStreams[I] = {
                              startPTS: A,
                              endPTS: M,
                              startDTS: D,
                              endDTS: _,
                            }),
                            o.setElementaryStreamInfo(I, A, M, D, _),
                            this.bufferFragmentData(p, o, h, s);
                        }
                        if (
                          d &&
                          null != c &&
                          null != (i = c.samples) &&
                          i.length
                        ) {
                          var O = {
                            id: n,
                            frag: o,
                            details: d,
                            samples: c.samples,
                          };
                          r.trigger(w.FRAG_PARSING_METADATA, O);
                        }
                        if (d && l) {
                          var R = {
                            id: n,
                            frag: o,
                            details: d,
                            samples: l.samples,
                          };
                          r.trigger(w.FRAG_PARSING_USERDATA, R);
                        }
                      }
                    } else this.resetWhenMissingContext(s);
                  }),
                  (n.dt = function (t, i, n, r) {
                    var e = this;
                    if (this.state === Dn) {
                      (this.audioOnly = !!i.audio && !i.video),
                        this.altAudio && !this.audioOnly && delete i.audio;
                      var s = i.audio,
                        a = i.video,
                        o = i.audiovideo;
                      if (s) {
                        var h = t.audioCodec,
                          u = navigator.userAgent.toLowerCase();
                        this.audioCodecSwitch &&
                          (h &&
                            (h =
                              -1 !== h.indexOf("mp4a.40.5")
                                ? "mp4a.40.2"
                                : "mp4a.40.5"),
                          1 !== s.metadata.channelCount &&
                            -1 === u.indexOf("firefox") &&
                            (h = "mp4a.40.5")),
                          -1 !== u.indexOf("android") &&
                            "audio/mpeg" !== s.container &&
                            ((h = "mp4a.40.2"),
                            this.log("Android: force audio codec to " + h)),
                          t.audioCodec &&
                            t.audioCodec !== h &&
                            this.log(
                              'Swapping manifest audio codec "' +
                                t.audioCodec +
                                '" for "' +
                                h +
                                '"'
                            ),
                          (s.levelCodec = h),
                          (s.id = "main"),
                          this.log(
                            "Init audio buffer, container:" +
                              s.container +
                              ", codecs[selected/level/parsed]=[" +
                              (h || "") +
                              "/" +
                              (t.audioCodec || "") +
                              "/" +
                              s.codec +
                              "]"
                          );
                      }
                      a &&
                        ((a.levelCodec = t.videoCodec),
                        (a.id = "main"),
                        this.log(
                          "Init video buffer, container:" +
                            a.container +
                            ", codecs[level/parsed]=[" +
                            (t.videoCodec || "") +
                            "/" +
                            a.codec +
                            "]"
                        )),
                        o &&
                          this.log(
                            "Init audiovideo buffer, container:" +
                              o.container +
                              ", codecs[level/parsed]=[" +
                              (t.attrs.CODECS || "") +
                              "/" +
                              o.codec +
                              "]"
                          ),
                        this.hls.trigger(w.BUFFER_CODECS, i),
                        Object.keys(i).forEach(function (t) {
                          var s = i[t].initSegment;
                          null != s &&
                            s.byteLength &&
                            e.hls.trigger(w.BUFFER_APPENDING, {
                              type: t,
                              data: s,
                              frag: n,
                              part: null,
                              chunkMeta: r,
                              parent: n.type,
                            });
                        }),
                        this.tick();
                    }
                  }),
                  (n.getMainFwdBufferInfo = function () {
                    return this.getFwdBufferInfo(
                      this.mediaBuffer ? this.mediaBuffer : this.media,
                      hi
                    );
                  }),
                  (n.backtrack = function (t) {
                    (this.couldBacktrack = !0),
                      (this.backtrackFragment = t),
                      this.resetTransmuxer(),
                      this.flushBufferGap(t),
                      this.fragmentTracker.removeFragment(t),
                      (this.fragPrevious = null),
                      (this.nextLoadPosition = t.start),
                      (this.state = Tn);
                  }),
                  (n.checkFragmentChanged = function () {
                    var t = this.media,
                      i = null;
                    if (t && t.readyState > 1 && !1 === t.seeking) {
                      var n = t.currentTime;
                      if (
                        (cn.isBuffered(t, n)
                          ? (i = this.getAppendedFrag(n))
                          : cn.isBuffered(t, n + 0.1) &&
                            (i = this.getAppendedFrag(n + 0.1)),
                        i)
                      ) {
                        this.backtrackFragment = null;
                        var r = this.fragPlaying,
                          e = i.level;
                        (r &&
                          i.sn === r.sn &&
                          r.level === e &&
                          i.urlId === r.urlId) ||
                          ((this.fragPlaying = i),
                          this.hls.trigger(w.FRAG_CHANGED, { frag: i }),
                          (r && r.level === e) ||
                            this.hls.trigger(w.LEVEL_SWITCHED, { level: e }));
                      }
                    }
                  }),
                  s(i, [
                    {
                      key: "nextLevel",
                      get: function () {
                        var t = this.nextBufferedFrag;
                        return t ? t.level : -1;
                      },
                    },
                    {
                      key: "currentFrag",
                      get: function () {
                        var t = this.media;
                        return t
                          ? this.fragPlaying ||
                              this.getAppendedFrag(t.currentTime)
                          : null;
                      },
                    },
                    {
                      key: "currentProgramDateTime",
                      get: function () {
                        var t = this.media;
                        if (t) {
                          var i = t.currentTime,
                            n = this.currentFrag;
                          if (n && g(i) && g(n.programDateTime)) {
                            var r = n.programDateTime + 1e3 * (i - n.start);
                            return new Date(r);
                          }
                        }
                        return null;
                      },
                    },
                    {
                      key: "currentLevel",
                      get: function () {
                        var t = this.currentFrag;
                        return t ? t.level : -1;
                      },
                    },
                    {
                      key: "nextBufferedFrag",
                      get: function () {
                        var t = this.currentFrag;
                        return t ? this.followingBufferedFrag(t) : null;
                      },
                    },
                    {
                      key: "forceStartLoad",
                      get: function () {
                        return this.ft;
                      },
                    },
                  ]),
                  i
                );
              })(Pn),
              Kr = (function () {
                function t(t, i, n) {
                  void 0 === i && (i = 0),
                    void 0 === n && (n = 0),
                    (this.halfLife = void 0),
                    (this.alpha_ = void 0),
                    (this.estimate_ = void 0),
                    (this.totalWeight_ = void 0),
                    (this.halfLife = t),
                    (this.alpha_ = t ? Math.exp(Math.log(0.5) / t) : 0),
                    (this.estimate_ = i),
                    (this.totalWeight_ = n);
                }
                var i = t.prototype;
                return (
                  (i.sample = function (t, i) {
                    var n = Math.pow(this.alpha_, t);
                    (this.estimate_ = i * (1 - n) + n * this.estimate_),
                      (this.totalWeight_ += t);
                  }),
                  (i.getTotalWeight = function () {
                    return this.totalWeight_;
                  }),
                  (i.getEstimate = function () {
                    if (this.alpha_) {
                      var t = 1 - Math.pow(this.alpha_, this.totalWeight_);
                      if (t) return this.estimate_ / t;
                    }
                    return this.estimate_;
                  }),
                  t
                );
              })(),
              zr = (function () {
                function t(t, i, n, r) {
                  void 0 === r && (r = 100),
                    (this.defaultEstimate_ = void 0),
                    (this.minWeight_ = void 0),
                    (this.minDelayMs_ = void 0),
                    (this.slow_ = void 0),
                    (this.fast_ = void 0),
                    (this.defaultTTFB_ = void 0),
                    (this.ttfb_ = void 0),
                    (this.defaultEstimate_ = n),
                    (this.minWeight_ = 0.001),
                    (this.minDelayMs_ = 50),
                    (this.slow_ = new Kr(t)),
                    (this.fast_ = new Kr(i)),
                    (this.defaultTTFB_ = r),
                    (this.ttfb_ = new Kr(t));
                }
                var i = t.prototype;
                return (
                  (i.update = function (t, i) {
                    var n = this.slow_,
                      r = this.fast_,
                      e = this.ttfb_;
                    n.halfLife !== t &&
                      (this.slow_ = new Kr(
                        t,
                        n.getEstimate(),
                        n.getTotalWeight()
                      )),
                      r.halfLife !== i &&
                        (this.fast_ = new Kr(
                          i,
                          r.getEstimate(),
                          r.getTotalWeight()
                        )),
                      e.halfLife !== t &&
                        (this.ttfb_ = new Kr(
                          t,
                          e.getEstimate(),
                          e.getTotalWeight()
                        ));
                  }),
                  (i.sample = function (t, i) {
                    var n = (t = Math.max(t, this.minDelayMs_)) / 1e3,
                      r = (8 * i) / n;
                    this.fast_.sample(n, r), this.slow_.sample(n, r);
                  }),
                  (i.sampleTTFB = function (t) {
                    var i = t / 1e3,
                      n = Math.sqrt(2) * Math.exp(-Math.pow(i, 2) / 2);
                    this.ttfb_.sample(n, Math.max(t, 5));
                  }),
                  (i.canEstimate = function () {
                    return this.fast_.getTotalWeight() >= this.minWeight_;
                  }),
                  (i.getEstimate = function () {
                    return this.canEstimate()
                      ? Math.min(
                          this.fast_.getEstimate(),
                          this.slow_.getEstimate()
                        )
                      : this.defaultEstimate_;
                  }),
                  (i.getEstimateTTFB = function () {
                    return this.ttfb_.getTotalWeight() >= this.minWeight_
                      ? this.ttfb_.getEstimate()
                      : this.defaultTTFB_;
                  }),
                  (i.destroy = function () {}),
                  t
                );
              })(),
              qr = (function () {
                function t(t) {
                  (this.hls = void 0),
                    (this.lastLevelLoadSec = 0),
                    (this.lastLoadedFragLevel = 0),
                    (this.yt = -1),
                    (this.timer = -1),
                    (this.onCheck = this.gt.bind(this)),
                    (this.fragCurrent = null),
                    (this.partCurrent = null),
                    (this.bitrateTestDelay = 0),
                    (this.bwEstimator = void 0),
                    (this.hls = t);
                  var i = t.config;
                  (this.bwEstimator = new zr(
                    i.abrEwmaSlowVoD,
                    i.abrEwmaFastVoD,
                    i.abrEwmaDefaultEstimate
                  )),
                    this.registerListeners();
                }
                var i = t.prototype;
                return (
                  (i.registerListeners = function () {
                    var t = this.hls;
                    t.on(w.FRAG_LOADING, this.onFragLoading, this),
                      t.on(w.FRAG_LOADED, this.onFragLoaded, this),
                      t.on(w.FRAG_BUFFERED, this.onFragBuffered, this),
                      t.on(w.LEVEL_SWITCHING, this.onLevelSwitching, this),
                      t.on(w.LEVEL_LOADED, this.onLevelLoaded, this);
                  }),
                  (i.unregisterListeners = function () {
                    var t = this.hls;
                    t.off(w.FRAG_LOADING, this.onFragLoading, this),
                      t.off(w.FRAG_LOADED, this.onFragLoaded, this),
                      t.off(w.FRAG_BUFFERED, this.onFragBuffered, this),
                      t.off(w.LEVEL_SWITCHING, this.onLevelSwitching, this),
                      t.off(w.LEVEL_LOADED, this.onLevelLoaded, this);
                  }),
                  (i.destroy = function () {
                    this.unregisterListeners(),
                      this.clearTimer(),
                      (this.hls = this.onCheck = null),
                      (this.fragCurrent = this.partCurrent = null);
                  }),
                  (i.onFragLoading = function (t, i) {
                    var n,
                      r = i.frag;
                    this.ignoreFragment(r) ||
                      ((this.fragCurrent = r),
                      (this.partCurrent = null != (n = i.part) ? n : null),
                      this.clearTimer(),
                      (this.timer = self.setInterval(this.onCheck, 100)));
                  }),
                  (i.onLevelSwitching = function (t, i) {
                    this.clearTimer();
                  }),
                  (i.getTimeToLoadFrag = function (t, i, n, r) {
                    return t + n / i + (r ? this.lastLevelLoadSec : 0);
                  }),
                  (i.onLevelLoaded = function (t, i) {
                    var n = this.hls.config,
                      r = i.stats,
                      e = r.total,
                      s = r.bwEstimate;
                    g(e) && g(s) && (this.lastLevelLoadSec = (8 * e) / s),
                      i.details.live
                        ? this.bwEstimator.update(
                            n.abrEwmaSlowLive,
                            n.abrEwmaFastLive
                          )
                        : this.bwEstimator.update(
                            n.abrEwmaSlowVoD,
                            n.abrEwmaFastVoD
                          );
                  }),
                  (i.gt = function () {
                    var t = this.fragCurrent,
                      i = this.partCurrent,
                      n = this.hls,
                      r = n.autoLevelEnabled,
                      e = n.media;
                    if (t && e) {
                      var s = performance.now(),
                        a = i ? i.stats : t.stats,
                        o = i ? i.duration : t.duration,
                        h = s - a.loading.start;
                      if (
                        a.aborted ||
                        (a.loaded && a.loaded === a.total) ||
                        0 === t.level
                      )
                        return this.clearTimer(), void (this.yt = -1);
                      if (r && !e.paused && e.playbackRate && e.readyState) {
                        var u = n.mainForwardBufferInfo;
                        if (null !== u) {
                          var f = this.bwEstimator.getEstimateTTFB(),
                            l = Math.abs(e.playbackRate);
                          if (!(h <= Math.max(f, (o / (2 * l)) * 1e3))) {
                            var c = u.len / l;
                            if (!(c >= (2 * o) / l)) {
                              var v = a.loading.first
                                  ? a.loading.first - a.loading.start
                                  : -1,
                                d = a.loaded && v > -1,
                                p = this.bwEstimator.getEstimate(),
                                m = n.levels,
                                y = n.minAutoLevel,
                                b = m[t.level],
                                k =
                                  a.total ||
                                  Math.max(
                                    a.loaded,
                                    Math.round((o * b.maxBitrate) / 8)
                                  ),
                                E = h - v;
                              E < 1 &&
                                d &&
                                (E = Math.min(h, (8 * a.loaded) / p));
                              var T = d ? (1e3 * a.loaded) / E : 0,
                                x = T
                                  ? (k - a.loaded) / T
                                  : (8 * k) / p + f / 1e3;
                              if (!(x <= c)) {
                                var S,
                                  M = T ? 8 * T : p,
                                  D = Number.POSITIVE_INFINITY;
                                for (S = t.level - 1; S > y; S--) {
                                  var _ = m[S].maxBitrate;
                                  if (
                                    (D = this.getTimeToLoadFrag(
                                      f / 1e3,
                                      M,
                                      o * _,
                                      !m[S].details
                                    )) < c
                                  )
                                    break;
                                }
                                D >= x ||
                                  D > 10 * o ||
                                  ((n.nextLoadLevel = S),
                                  d
                                    ? this.bwEstimator.sample(
                                        h - Math.min(f, v),
                                        a.loaded
                                      )
                                    : this.bwEstimator.sampleTTFB(h),
                                  this.clearTimer(),
                                  A.warn(
                                    "[abr] Fragment " +
                                      t.sn +
                                      (i ? " part " + i.index : "") +
                                      " of level " +
                                      t.level +
                                      " is loading too slowly;\n      Time to underbuffer: " +
                                      c.toFixed(3) +
                                      " s\n      Estimated load time for current fragment: " +
                                      x.toFixed(3) +
                                      " s\n      Estimated load time for down switch fragment: " +
                                      D.toFixed(3) +
                                      " s\n      TTFB estimate: " +
                                      v +
                                      "\n      Current BW estimate: " +
                                      (g(p)
                                        ? (p / 1024).toFixed(3)
                                        : "Unknown") +
                                      " Kb/s\n      New BW estimate: " +
                                      (
                                        this.bwEstimator.getEstimate() / 1024
                                      ).toFixed(3) +
                                      " Kb/s\n      Aborting and switching to level " +
                                      S
                                  ),
                                  t.loader &&
                                    ((this.fragCurrent = this.partCurrent =
                                      null),
                                    t.abortRequests()),
                                  n.trigger(w.FRAG_LOAD_EMERGENCY_ABORTED, {
                                    frag: t,
                                    part: i,
                                    stats: a,
                                  }));
                              }
                            }
                          }
                        }
                      }
                    }
                  }),
                  (i.onFragLoaded = function (t, i) {
                    var n = i.frag,
                      r = i.part,
                      e = r ? r.stats : n.stats;
                    if (
                      (n.type === hi &&
                        this.bwEstimator.sampleTTFB(
                          e.loading.first - e.loading.start
                        ),
                      !this.ignoreFragment(n))
                    ) {
                      if (
                        (this.clearTimer(),
                        (this.lastLoadedFragLevel = n.level),
                        (this.yt = -1),
                        this.hls.config.abrMaxWithRealBitrate)
                      ) {
                        var s = r ? r.duration : n.duration,
                          a = this.hls.levels[n.level],
                          o = (a.loaded ? a.loaded.bytes : 0) + e.loaded,
                          h = (a.loaded ? a.loaded.duration : 0) + s;
                        (a.loaded = { bytes: o, duration: h }),
                          (a.realBitrate = Math.round((8 * o) / h));
                      }
                      if (n.bitrateTest) {
                        var u = { stats: e, frag: n, part: r, id: n.type };
                        this.onFragBuffered(w.FRAG_BUFFERED, u),
                          (n.bitrateTest = !1);
                      }
                    }
                  }),
                  (i.onFragBuffered = function (t, i) {
                    var n = i.frag,
                      r = i.part,
                      e = null != r && r.stats.loaded ? r.stats : n.stats;
                    if (!e.aborted && !this.ignoreFragment(n)) {
                      var s =
                        e.parsing.end -
                        e.loading.start -
                        Math.min(
                          e.loading.first - e.loading.start,
                          this.bwEstimator.getEstimateTTFB()
                        );
                      this.bwEstimator.sample(s, e.loaded),
                        (e.bwEstimate = this.bwEstimator.getEstimate()),
                        n.bitrateTest
                          ? (this.bitrateTestDelay = s / 1e3)
                          : (this.bitrateTestDelay = 0);
                    }
                  }),
                  (i.ignoreFragment = function (t) {
                    return t.type !== hi || "initSegment" === t.sn;
                  }),
                  (i.clearTimer = function () {
                    self.clearInterval(this.timer);
                  }),
                  (i.getNextABRAutoLevel = function () {
                    var t = this.fragCurrent,
                      i = this.partCurrent,
                      n = this.hls,
                      r = n.maxAutoLevel,
                      e = n.config,
                      s = n.minAutoLevel,
                      a = n.media,
                      o = i ? i.duration : t ? t.duration : 0,
                      h =
                        a && 0 !== a.playbackRate
                          ? Math.abs(a.playbackRate)
                          : 1,
                      u = this.bwEstimator
                        ? this.bwEstimator.getEstimate()
                        : e.abrEwmaDefaultEstimate,
                      f = n.mainForwardBufferInfo,
                      l = (f ? f.len : 0) / h,
                      c = this.findBestLevel(
                        u,
                        s,
                        r,
                        l,
                        e.abrBandWidthFactor,
                        e.abrBandWidthUpFactor
                      );
                    if (c >= 0) return c;
                    A.trace(
                      "[abr] " +
                        (l ? "rebuffering expected" : "buffer is empty") +
                        ", finding optimal quality level"
                    );
                    var v = o
                        ? Math.min(o, e.maxStarvationDelay)
                        : e.maxStarvationDelay,
                      d = e.abrBandWidthFactor,
                      p = e.abrBandWidthUpFactor;
                    if (!l) {
                      var m = this.bitrateTestDelay;
                      m &&
                        ((v =
                          (o
                            ? Math.min(o, e.maxLoadingDelay)
                            : e.maxLoadingDelay) - m),
                        A.trace(
                          "[abr] bitrate test took " +
                            Math.round(1e3 * m) +
                            "ms, set first fragment max fetchDuration to " +
                            Math.round(1e3 * v) +
                            " ms"
                        ),
                        (d = p = 1));
                    }
                    return (
                      (c = this.findBestLevel(u, s, r, l + v, d, p)),
                      Math.max(c, 0)
                    );
                  }),
                  (i.findBestLevel = function (t, i, n, r, e, s) {
                    for (
                      var a,
                        o = this.fragCurrent,
                        h = this.partCurrent,
                        u = this.lastLoadedFragLevel,
                        f = this.hls.levels,
                        l = f[u],
                        c = !(null == l || null == (a = l.details) || !a.live),
                        v = null == l ? void 0 : l.codecSet,
                        d = h ? h.duration : o ? o.duration : 0,
                        p = this.bwEstimator.getEstimateTTFB() / 1e3,
                        m = i,
                        y = -1,
                        w = n;
                      w >= i;
                      w--
                    ) {
                      var b = f[w];
                      if (!b || (v && b.codecSet !== v))
                        b && ((m = Math.min(w, m)), (y = Math.max(w, y)));
                      else {
                        -1 !== y &&
                          A.trace(
                            "[abr] Skipped level(s) " +
                              m +
                              "-" +
                              y +
                              ' with CODECS:"' +
                              f[y].attrs.CODECS +
                              '"; not compatible with "' +
                              l.attrs.CODECS +
                              '"'
                          );
                        var k,
                          E = b.details,
                          T =
                            (h
                              ? null == E
                                ? void 0
                                : E.partTarget
                              : null == E
                              ? void 0
                              : E.averagetargetduration) || d;
                        k = w <= u ? e * t : s * t;
                        var x = f[w].maxBitrate,
                          S = this.getTimeToLoadFrag(p, k, x * T, void 0 === E);
                        if (
                          (A.trace(
                            "[abr] level:" +
                              w +
                              " adjustedbw-bitrate:" +
                              Math.round(k - x) +
                              " avgDuration:" +
                              T.toFixed(1) +
                              " maxFetchDuration:" +
                              r.toFixed(1) +
                              " fetchDuration:" +
                              S.toFixed(1)
                          ),
                          k > x &&
                            (0 === S ||
                              !g(S) ||
                              (c && !this.bitrateTestDelay) ||
                              S < r))
                        )
                          return w;
                      }
                    }
                    return -1;
                  }),
                  s(t, [
                    {
                      key: "nextAutoLevel",
                      get: function () {
                        var t = this.yt,
                          i = this.bwEstimator;
                        if (-1 !== t && !i.canEstimate()) return t;
                        var n = this.getNextABRAutoLevel();
                        if (-1 !== t) {
                          var r = this.hls.levels;
                          if (
                            r.length > Math.max(t, n) &&
                            r[t].loadError <= r[n].loadError
                          )
                            return t;
                        }
                        return -1 !== t && (n = Math.min(t, n)), n;
                      },
                      set: function (t) {
                        this.yt = t;
                      },
                    },
                  ]),
                  t
                );
              })(),
              Jr = (function () {
                function t() {
                  (this.chunks = []), (this.dataLength = 0);
                }
                var i = t.prototype;
                return (
                  (i.push = function (t) {
                    this.chunks.push(t), (this.dataLength += t.length);
                  }),
                  (i.flush = function () {
                    var t,
                      i = this.chunks,
                      n = this.dataLength;
                    return i.length
                      ? ((t =
                          1 === i.length
                            ? i[0]
                            : (function (t, i) {
                                for (
                                  var n = new Uint8Array(i), r = 0, e = 0;
                                  e < t.length;
                                  e++
                                ) {
                                  var s = t[e];
                                  n.set(s, r), (r += s.length);
                                }
                                return n;
                              })(i, n)),
                        this.reset(),
                        t)
                      : new Uint8Array(0);
                  }),
                  (i.reset = function () {
                    (this.chunks.length = 0), (this.dataLength = 0);
                  }),
                  t
                );
              })(),
              Qr = (function (t) {
                function i(i, n, r) {
                  var e;
                  return (
                    ((e =
                      t.call(this, i, n, r, "[audio-stream-controller]", ui) ||
                      this).videoBuffer = null),
                    (e.videoTrackCC = -1),
                    (e.waitingVideoCC = -1),
                    (e.bufferedTrack = null),
                    (e.switchingTrack = null),
                    (e.trackId = -1),
                    (e.waitingData = null),
                    (e.mainDetails = null),
                    (e.bufferFlushed = !1),
                    (e.cachedTrackLoadedData = null),
                    e.m(),
                    e
                  );
                }
                h(i, t);
                var n = i.prototype;
                return (
                  (n.onHandlerDestroying = function () {
                    this.k(),
                      (this.mainDetails = null),
                      (this.bufferedTrack = null),
                      (this.switchingTrack = null);
                  }),
                  (n.m = function () {
                    var t = this.hls;
                    t.on(w.MEDIA_ATTACHED, this.onMediaAttached, this),
                      t.on(w.MEDIA_DETACHING, this.onMediaDetaching, this),
                      t.on(w.MANIFEST_LOADING, this.onManifestLoading, this),
                      t.on(w.LEVEL_LOADED, this.onLevelLoaded, this),
                      t.on(
                        w.AUDIO_TRACKS_UPDATED,
                        this.onAudioTracksUpdated,
                        this
                      ),
                      t.on(
                        w.AUDIO_TRACK_SWITCHING,
                        this.onAudioTrackSwitching,
                        this
                      ),
                      t.on(w.AUDIO_TRACK_LOADED, this.onAudioTrackLoaded, this),
                      t.on(w.ERROR, this.onError, this),
                      t.on(w.BUFFER_RESET, this.onBufferReset, this),
                      t.on(w.BUFFER_CREATED, this.onBufferCreated, this),
                      t.on(w.BUFFER_FLUSHED, this.onBufferFlushed, this),
                      t.on(w.INIT_PTS_FOUND, this.onInitPtsFound, this),
                      t.on(w.FRAG_BUFFERED, this.onFragBuffered, this);
                  }),
                  (n.k = function () {
                    var t = this.hls;
                    t.off(w.MEDIA_ATTACHED, this.onMediaAttached, this),
                      t.off(w.MEDIA_DETACHING, this.onMediaDetaching, this),
                      t.off(w.MANIFEST_LOADING, this.onManifestLoading, this),
                      t.off(w.LEVEL_LOADED, this.onLevelLoaded, this),
                      t.off(
                        w.AUDIO_TRACKS_UPDATED,
                        this.onAudioTracksUpdated,
                        this
                      ),
                      t.off(
                        w.AUDIO_TRACK_SWITCHING,
                        this.onAudioTrackSwitching,
                        this
                      ),
                      t.off(
                        w.AUDIO_TRACK_LOADED,
                        this.onAudioTrackLoaded,
                        this
                      ),
                      t.off(w.ERROR, this.onError, this),
                      t.off(w.BUFFER_RESET, this.onBufferReset, this),
                      t.off(w.BUFFER_CREATED, this.onBufferCreated, this),
                      t.off(w.BUFFER_FLUSHED, this.onBufferFlushed, this),
                      t.off(w.INIT_PTS_FOUND, this.onInitPtsFound, this),
                      t.off(w.FRAG_BUFFERED, this.onFragBuffered, this);
                  }),
                  (n.onInitPtsFound = function (t, i) {
                    var n = i.frag,
                      r = i.id,
                      e = i.initPTS,
                      s = i.timescale;
                    if ("main" === r) {
                      var a = n.cc;
                      (this.initPTS[n.cc] = { baseTime: e, timescale: s }),
                        this.log(
                          "InitPTS for cc: " + a + " found from main: " + e
                        ),
                        (this.videoTrackCC = a),
                        this.state === Ln && this.tick();
                    }
                  }),
                  (n.startLoad = function (t) {
                    if (!this.levels)
                      return (this.startPosition = t), void (this.state = En);
                    var i = this.lastCurrentTime;
                    this.stopLoad(),
                      this.setInterval(100),
                      i > 0 && -1 === t
                        ? (this.log(
                            "Override startPosition with lastCurrentTime @" +
                              i.toFixed(3)
                          ),
                          (t = i),
                          (this.state = Tn))
                        : ((this.loadedmetadata = !1), (this.state = Mn)),
                      (this.nextLoadPosition =
                        this.startPosition =
                        this.lastCurrentTime =
                          t),
                      this.tick();
                  }),
                  (n.doTick = function () {
                    switch (this.state) {
                      case Tn:
                        this.doTickIdle();
                        break;
                      case Mn:
                        var i,
                          n = this.levels,
                          r = this.trackId,
                          e =
                            null == n || null == (i = n[r])
                              ? void 0
                              : i.details;
                        if (e) {
                          if (this.waitForCdnTuneIn(e)) break;
                          this.state = Ln;
                        }
                        break;
                      case An:
                        var s,
                          a = performance.now(),
                          o = this.retryDate;
                        (!o ||
                          a >= o ||
                          (null != (s = this.media) && s.seeking)) &&
                          (this.log(
                            "RetryDate reached, switch back to IDLE state"
                          ),
                          this.resetStartWhenNotLoaded(this.trackId),
                          (this.state = Tn));
                        break;
                      case Ln:
                        var h = this.waitingData;
                        if (h) {
                          var u = h.frag,
                            f = h.part,
                            l = h.cache,
                            c = h.complete;
                          if (void 0 !== this.initPTS[u.cc]) {
                            (this.waitingData = null),
                              (this.waitingVideoCC = -1),
                              (this.state = Sn);
                            var v = {
                              frag: u,
                              part: f,
                              payload: l.flush(),
                              networkDetails: null,
                            };
                            this.F(v), c && t.prototype.j.call(this, v);
                          } else if (this.videoTrackCC !== this.waitingVideoCC)
                            this.log(
                              "Waiting fragment cc (" +
                                u.cc +
                                ") cancelled because video is at cc " +
                                this.videoTrackCC
                            ),
                              this.clearWaitingFragment();
                          else {
                            var d = this.getLoadPosition(),
                              p = cn.bufferInfo(
                                this.mediaBuffer,
                                d,
                                this.config.maxBufferHole
                              );
                            Yi(p.end, this.config.maxFragLookUpTolerance, u) <
                              0 &&
                              (this.log(
                                "Waiting fragment cc (" +
                                  u.cc +
                                  ") @ " +
                                  u.start +
                                  " cancelled because another fragment at " +
                                  p.end +
                                  " is needed"
                              ),
                              this.clearWaitingFragment());
                          }
                        } else this.state = Tn;
                    }
                    this.onTickEnd();
                  }),
                  (n.clearWaitingFragment = function () {
                    var t = this.waitingData;
                    t &&
                      (this.fragmentTracker.removeFragment(t.frag),
                      (this.waitingData = null),
                      (this.waitingVideoCC = -1),
                      (this.state = Tn));
                  }),
                  (n.resetLoadingState = function () {
                    this.clearWaitingFragment(),
                      t.prototype.resetLoadingState.call(this);
                  }),
                  (n.onTickEnd = function () {
                    var t = this.media;
                    null != t &&
                      t.readyState &&
                      (this.lastCurrentTime = t.currentTime);
                  }),
                  (n.doTickIdle = function () {
                    var t = this.hls,
                      i = this.levels,
                      n = this.media,
                      r = this.trackId,
                      e = t.config;
                    if (
                      null != i &&
                      i[r] &&
                      (n || (!this.startFragRequested && e.startFragPrefetch))
                    ) {
                      var s = i[r],
                        a = s.details;
                      if (
                        !a ||
                        (a.live && this.levelLastLoaded !== r) ||
                        this.waitForCdnTuneIn(a)
                      )
                        this.state = Mn;
                      else {
                        var o = this.mediaBuffer
                          ? this.mediaBuffer
                          : this.media;
                        this.bufferFlushed &&
                          o &&
                          ((this.bufferFlushed = !1),
                          this.afterBufferFlushed(o, I, ui));
                        var h = this.getFwdBufferInfo(o, ui);
                        if (null !== h) {
                          var u = this.bufferedTrack,
                            f = this.switchingTrack;
                          if (!f && this.C(h, a))
                            return (
                              t.trigger(w.BUFFER_EOS, { type: "audio" }),
                              void (this.state = On)
                            );
                          var l = this.getFwdBufferInfo(
                              this.videoBuffer ? this.videoBuffer : this.media,
                              hi
                            ),
                            c = h.len,
                            v = this.getMaxBufferLength(
                              null == l ? void 0 : l.len
                            );
                          if (!(c >= v) || f) {
                            var d = a.fragments[0].start,
                              p = h.end;
                            if (f && n) {
                              var m = this.getLoadPosition();
                              u && f.attrs !== u.attrs && (p = m),
                                a.PTSKnown &&
                                  m < d &&
                                  (h.end > d || h.nextStart) &&
                                  (this.log(
                                    "Alt audio track ahead of main track, seek to start of alt audio track"
                                  ),
                                  (n.currentTime = d + 0.05));
                            }
                            var y = this.getNextFragment(p, a),
                              g = !1;
                            if (
                              (y &&
                                this.isLoopLoading(y, p) &&
                                ((g = !!y.gap),
                                (y = this.getNextFragmentLoopLoading(
                                  y,
                                  a,
                                  h,
                                  hi,
                                  v
                                ))),
                              y)
                            ) {
                              var b = l && y.start > l.end + a.targetduration;
                              if (b || ((null == l || !l.len) && h.len)) {
                                var k = this.getAppendedFrag(y.start, hi);
                                if (null === k) return;
                                if (
                                  (g || (g = !!k.gap || (!!b && 0 === l.len)),
                                  (b && !g) ||
                                    (g && h.nextStart && h.nextStart < k.end))
                                )
                                  return;
                              }
                              this.loadFragment(y, s, p);
                            } else this.bufferFlushed = !0;
                          }
                        }
                      }
                    }
                  }),
                  (n.getMaxBufferLength = function (i) {
                    var n = t.prototype.getMaxBufferLength.call(this);
                    return i
                      ? Math.min(Math.max(n, i), this.config.maxMaxBufferLength)
                      : n;
                  }),
                  (n.onMediaDetaching = function () {
                    (this.videoBuffer = null),
                      t.prototype.onMediaDetaching.call(this);
                  }),
                  (n.onAudioTracksUpdated = function (t, i) {
                    var n = i.audioTracks;
                    this.resetTransmuxer(),
                      (this.levels = n.map(function (t) {
                        return new Mi(t);
                      }));
                  }),
                  (n.onAudioTrackSwitching = function (t, i) {
                    var n = !!i.url;
                    this.trackId = i.id;
                    var r = this.fragCurrent;
                    r &&
                      (r.abortRequests(), this.removeUnbufferedFrags(r.start)),
                      this.resetLoadingState(),
                      n ? this.setInterval(100) : this.resetTransmuxer(),
                      n
                        ? ((this.switchingTrack = i), (this.state = Tn))
                        : ((this.switchingTrack = null),
                          (this.bufferedTrack = i),
                          (this.state = En)),
                      this.tick();
                  }),
                  (n.onManifestLoading = function () {
                    this.fragmentTracker.removeAllFragments(),
                      (this.startPosition = this.lastCurrentTime = 0),
                      (this.bufferFlushed = !1),
                      (this.levels =
                        this.mainDetails =
                        this.waitingData =
                        this.bufferedTrack =
                        this.cachedTrackLoadedData =
                        this.switchingTrack =
                          null),
                      (this.startFragRequested = !1),
                      (this.trackId =
                        this.videoTrackCC =
                        this.waitingVideoCC =
                          -1);
                  }),
                  (n.onLevelLoaded = function (t, i) {
                    (this.mainDetails = i.details),
                      null !== this.cachedTrackLoadedData &&
                        (this.hls.trigger(
                          w.AUDIO_TRACK_LOADED,
                          this.cachedTrackLoadedData
                        ),
                        (this.cachedTrackLoadedData = null));
                  }),
                  (n.onAudioTrackLoaded = function (t, i) {
                    var n;
                    if (null != this.mainDetails) {
                      var r = this.levels,
                        e = i.details,
                        s = i.id;
                      if (r) {
                        this.log(
                          "Track " +
                            s +
                            " loaded [" +
                            e.startSN +
                            "," +
                            e.endSN +
                            "]" +
                            (e.lastPartSn
                              ? "[part-" +
                                e.lastPartSn +
                                "-" +
                                e.lastPartIndex +
                                "]"
                              : "") +
                            ",duration:" +
                            e.totalduration
                        );
                        var a = r[s],
                          o = 0;
                        if (e.live || (null != (n = a.details) && n.live)) {
                          var h = this.mainDetails;
                          if (
                            (e.fragments[0] || (e.deltaUpdateFailed = !0),
                            e.deltaUpdateFailed || !h)
                          )
                            return;
                          !a.details &&
                          e.hasProgramDateTime &&
                          h.hasProgramDateTime
                            ? (yn(e, h), (o = e.fragments[0].start))
                            : (o = this.alignPlaylists(e, a.details));
                        }
                        (a.details = e),
                          (this.levelLastLoaded = s),
                          this.startFragRequested ||
                            (!this.mainDetails && e.live) ||
                            this.setStartPosition(a.details, o),
                          this.state !== Mn ||
                            this.waitForCdnTuneIn(e) ||
                            (this.state = Tn),
                          this.tick();
                      } else
                        this.warn(
                          "Audio tracks were reset while loading level " + s
                        );
                    } else this.cachedTrackLoadedData = i;
                  }),
                  (n.F = function (t) {
                    var i,
                      n = t.frag,
                      r = t.part,
                      e = t.payload,
                      s = this.config,
                      a = this.trackId,
                      o = this.levels;
                    if (o) {
                      var h = o[a];
                      if (h) {
                        var u = h.details;
                        if (!u)
                          return (
                            this.warn(
                              "Audio track details undefined on fragment load progress"
                            ),
                            void this.removeUnbufferedFrags(n.start)
                          );
                        var f =
                            s.defaultAudioCodec || h.audioCodec || "mp4a.40.2",
                          l = this.transmuxer;
                        l ||
                          (l = this.transmuxer =
                            new Vr(
                              this.hls,
                              ui,
                              this.vt.bind(this),
                              this.$.bind(this)
                            ));
                        var c = this.initPTS[n.cc],
                          v = null == (i = n.initSegment) ? void 0 : i.data;
                        if (void 0 !== c) {
                          var d = r ? r.index : -1,
                            p = -1 !== d,
                            m = new vn(
                              n.level,
                              n.sn,
                              n.stats.chunkCount,
                              e.byteLength,
                              d,
                              p
                            );
                          l.push(e, v, f, "", n, r, u.totalduration, !1, m, c);
                        } else
                          this.log(
                            "Unknown video PTS for cc " +
                              n.cc +
                              ", waiting for video PTS before demuxing audio frag " +
                              n.sn +
                              " of [" +
                              u.startSN +
                              " ," +
                              u.endSN +
                              "],track " +
                              a
                          ),
                            (this.waitingData = this.waitingData || {
                              frag: n,
                              part: r,
                              cache: new Jr(),
                              complete: !1,
                            }).cache.push(new Uint8Array(e)),
                            (this.waitingVideoCC = this.videoTrackCC),
                            (this.state = Ln);
                      } else
                        this.warn(
                          "Audio track is undefined on fragment load progress"
                        );
                    } else
                      this.warn(
                        "Audio tracks were reset while fragment load was in progress. Fragment " +
                          n.sn +
                          " of level " +
                          n.level +
                          " will not be buffered"
                      );
                  }),
                  (n.j = function (i) {
                    this.waitingData
                      ? (this.waitingData.complete = !0)
                      : t.prototype.j.call(this, i);
                  }),
                  (n.onBufferReset = function () {
                    (this.mediaBuffer = this.videoBuffer = null),
                      (this.loadedmetadata = !1);
                  }),
                  (n.onBufferCreated = function (t, i) {
                    var n = i.tracks.audio;
                    n && (this.mediaBuffer = n.buffer || null),
                      i.tracks.video &&
                        (this.videoBuffer = i.tracks.video.buffer || null);
                  }),
                  (n.onFragBuffered = function (t, i) {
                    var n = i.frag,
                      e = i.part;
                    if (n.type === ui)
                      if (this.fragContextChanged(n))
                        this.warn(
                          "Fragment " +
                            n.sn +
                            (e ? " p: " + e.index : "") +
                            " of level " +
                            n.level +
                            " finished buffering, but was aborted. state: " +
                            this.state +
                            ", audioSwitch: " +
                            (this.switchingTrack
                              ? this.switchingTrack.name
                              : "false")
                        );
                      else {
                        if ("initSegment" !== n.sn) {
                          this.fragPrevious = n;
                          var s = this.switchingTrack;
                          s &&
                            ((this.bufferedTrack = s),
                            (this.switchingTrack = null),
                            this.hls.trigger(w.AUDIO_TRACK_SWITCHED, r({}, s)));
                        }
                        this.fragBufferedComplete(n, e);
                      }
                    else if (!this.loadedmetadata && n.type === hi) {
                      var a = this.videoBuffer || this.media;
                      a &&
                        cn.getBuffered(a).length &&
                        (this.loadedmetadata = !0);
                    }
                  }),
                  (n.onError = function (i, n) {
                    var r;
                    if (n.fatal) this.state = Rn;
                    else
                      switch (n.details) {
                        case k.FRAG_GAP:
                        case k.FRAG_PARSING_ERROR:
                        case k.FRAG_DECRYPT_ERROR:
                        case k.FRAG_LOAD_ERROR:
                        case k.FRAG_LOAD_TIMEOUT:
                        case k.KEY_LOAD_ERROR:
                        case k.KEY_LOAD_TIMEOUT:
                          this.onFragmentOrKeyLoadError(ui, n);
                          break;
                        case k.AUDIO_TRACK_LOAD_ERROR:
                        case k.AUDIO_TRACK_LOAD_TIMEOUT:
                        case k.LEVEL_PARSING_ERROR:
                          n.levelRetry ||
                            this.state !== Mn ||
                            (null == (r = n.context) ? void 0 : r.type) !==
                              ai ||
                            (this.state = Tn);
                          break;
                        case k.BUFFER_FULL_ERROR:
                          if (!n.parent || "audio" !== n.parent) return;
                          this.reduceLengthAndFlushBuffer(n) &&
                            ((this.bufferedTrack = null),
                            t.prototype.flushMainBuffer.call(
                              this,
                              0,
                              Number.POSITIVE_INFINITY,
                              "audio"
                            ));
                          break;
                        case k.INTERNAL_EXCEPTION:
                          this.recoverWorkerError(n);
                      }
                  }),
                  (n.onBufferFlushed = function (t, i) {
                    i.type === I &&
                      ((this.bufferFlushed = !0),
                      this.state === On && (this.state = Tn));
                  }),
                  (n.vt = function (t) {
                    var i,
                      n = "audio",
                      r = this.hls,
                      e = t.remuxResult,
                      s = t.chunkMeta,
                      a = this.getCurrentContext(s);
                    if (a) {
                      var h = a.frag,
                        u = a.part,
                        f = a.level.details,
                        l = e.audio,
                        c = e.text,
                        v = e.id3,
                        d = e.initSegment;
                      if (!this.fragContextChanged(h) && f) {
                        if (
                          ((this.state = Dn),
                          this.switchingTrack &&
                            l &&
                            this.completeAudioSwitch(this.switchingTrack),
                          null != d && d.tracks)
                        ) {
                          var p = h.initSegment || h;
                          this.dt(d.tracks, p, s),
                            r.trigger(w.FRAG_PARSING_INIT_SEGMENT, {
                              frag: p,
                              id: n,
                              tracks: d.tracks,
                            });
                        }
                        if (l) {
                          var m = l.startPTS,
                            y = l.endPTS,
                            g = l.startDTS,
                            b = l.endDTS;
                          u &&
                            (u.elementaryStreams[I] = {
                              startPTS: m,
                              endPTS: y,
                              startDTS: g,
                              endDTS: b,
                            }),
                            h.setElementaryStreamInfo(I, m, y, g, b),
                            this.bufferFragmentData(l, h, u, s);
                        }
                        if (null != v && null != (i = v.samples) && i.length) {
                          var k = o({ id: n, frag: h, details: f }, v);
                          r.trigger(w.FRAG_PARSING_METADATA, k);
                        }
                        if (c) {
                          var E = o({ id: n, frag: h, details: f }, c);
                          r.trigger(w.FRAG_PARSING_USERDATA, E);
                        }
                      } else this.fragmentTracker.removeFragment(h);
                    } else this.resetWhenMissingContext(s);
                  }),
                  (n.dt = function (t, i, n) {
                    if (this.state === Dn) {
                      t.video && delete t.video;
                      var r = t.audio;
                      if (r) {
                        (r.levelCodec = r.codec),
                          (r.id = "audio"),
                          this.log(
                            "Init audio buffer, container:" +
                              r.container +
                              ", codecs[parsed]=[" +
                              r.codec +
                              "]"
                          ),
                          this.hls.trigger(w.BUFFER_CODECS, t);
                        var e = r.initSegment;
                        if (null != e && e.byteLength) {
                          var s = {
                            type: "audio",
                            frag: i,
                            part: null,
                            chunkMeta: n,
                            parent: i.type,
                            data: e,
                          };
                          this.hls.trigger(w.BUFFER_APPENDING, s);
                        }
                        this.tick();
                      }
                    }
                  }),
                  (n.loadFragment = function (i, n, r) {
                    var e,
                      s = this.fragmentTracker.getState(i);
                    (this.fragCurrent = i),
                      this.switchingTrack || s === qi || s === Qi
                        ? "initSegment" === i.sn
                          ? this.B(i, n)
                          : null != (e = n.details) &&
                            e.live &&
                            !this.initPTS[i.cc]
                          ? (this.log(
                              "Waiting for video PTS in continuity counter " +
                                i.cc +
                                " of live stream before loading audio fragment " +
                                i.sn +
                                " of level " +
                                this.trackId
                            ),
                            (this.state = Ln))
                          : ((this.startFragRequested = !0),
                            t.prototype.loadFragment.call(this, i, n, r))
                        : this.clearTrackerIfNeeded(i);
                  }),
                  (n.completeAudioSwitch = function (i) {
                    var n = this.hls,
                      e = this.media,
                      s = this.bufferedTrack,
                      a = null == s ? void 0 : s.attrs,
                      o = i.attrs;
                    e &&
                      a &&
                      (a.CHANNELS !== o.CHANNELS ||
                        a.NAME !== o.NAME ||
                        a.LANGUAGE !== o.LANGUAGE) &&
                      (this.log("Switching audio track : flushing all audio"),
                      t.prototype.flushMainBuffer.call(
                        this,
                        0,
                        Number.POSITIVE_INFINITY,
                        "audio"
                      )),
                      (this.bufferedTrack = i),
                      (this.switchingTrack = null),
                      n.trigger(w.AUDIO_TRACK_SWITCHED, r({}, i));
                  }),
                  i
                );
              })(Pn),
              Zr = (function (t) {
                function i(i) {
                  var n;
                  return (
                    ((n =
                      t.call(this, i, "[audio-track-controller]") ||
                      this).tracks = []),
                    (n.groupId = null),
                    (n.tracksInGroup = []),
                    (n.trackId = -1),
                    (n.currentTrack = null),
                    (n.selectDefaultTrack = !0),
                    n.registerListeners(),
                    n
                  );
                }
                h(i, t);
                var n = i.prototype;
                return (
                  (n.registerListeners = function () {
                    var t = this.hls;
                    t.on(w.MANIFEST_LOADING, this.onManifestLoading, this),
                      t.on(w.MANIFEST_PARSED, this.onManifestParsed, this),
                      t.on(w.LEVEL_LOADING, this.onLevelLoading, this),
                      t.on(w.LEVEL_SWITCHING, this.onLevelSwitching, this),
                      t.on(w.AUDIO_TRACK_LOADED, this.onAudioTrackLoaded, this),
                      t.on(w.ERROR, this.onError, this);
                  }),
                  (n.unregisterListeners = function () {
                    var t = this.hls;
                    t.off(w.MANIFEST_LOADING, this.onManifestLoading, this),
                      t.off(w.MANIFEST_PARSED, this.onManifestParsed, this),
                      t.off(w.LEVEL_LOADING, this.onLevelLoading, this),
                      t.off(w.LEVEL_SWITCHING, this.onLevelSwitching, this),
                      t.off(
                        w.AUDIO_TRACK_LOADED,
                        this.onAudioTrackLoaded,
                        this
                      ),
                      t.off(w.ERROR, this.onError, this);
                  }),
                  (n.destroy = function () {
                    this.unregisterListeners(),
                      (this.tracks.length = 0),
                      (this.tracksInGroup.length = 0),
                      (this.currentTrack = null),
                      t.prototype.destroy.call(this);
                  }),
                  (n.onManifestLoading = function () {
                    (this.tracks = []),
                      (this.groupId = null),
                      (this.tracksInGroup = []),
                      (this.trackId = -1),
                      (this.currentTrack = null),
                      (this.selectDefaultTrack = !0);
                  }),
                  (n.onManifestParsed = function (t, i) {
                    this.tracks = i.audioTracks || [];
                  }),
                  (n.onAudioTrackLoaded = function (t, i) {
                    var n = i.id,
                      r = i.groupId,
                      e = i.details,
                      s = this.tracksInGroup[n];
                    if (s && s.groupId === r) {
                      var a = s.details;
                      (s.details = i.details),
                        this.log(
                          "audio-track " +
                            n +
                            ' "' +
                            s.name +
                            '" lang:' +
                            s.lang +
                            " group:" +
                            r +
                            " loaded [" +
                            e.startSN +
                            "-" +
                            e.endSN +
                            "]"
                        ),
                        n === this.trackId && this.playlistLoaded(n, i, a);
                    } else
                      this.warn(
                        "Track with id:" +
                          n +
                          " and group:" +
                          r +
                          " not found in active group " +
                          s.groupId
                      );
                  }),
                  (n.onLevelLoading = function (t, i) {
                    this.switchLevel(i.level);
                  }),
                  (n.onLevelSwitching = function (t, i) {
                    this.switchLevel(i.level);
                  }),
                  (n.switchLevel = function (t) {
                    var i = this.hls.levels[t];
                    if (null != i && i.audioGroupIds) {
                      var n = i.audioGroupIds[i.urlId];
                      if (this.groupId !== n) {
                        this.groupId = n || null;
                        var r = this.tracks.filter(function (t) {
                          return !n || t.groupId === n;
                        });
                        this.selectDefaultTrack &&
                          !r.some(function (t) {
                            return t.default;
                          }) &&
                          (this.selectDefaultTrack = !1),
                          (this.tracksInGroup = r);
                        var e = { audioTracks: r };
                        this.log(
                          "Updating audio tracks, " +
                            r.length +
                            " track(s) found in group:" +
                            n
                        ),
                          this.hls.trigger(w.AUDIO_TRACKS_UPDATED, e),
                          this.selectInitialTrack();
                      } else
                        this.shouldReloadPlaylist(this.currentTrack) &&
                          this.setAudioTrack(this.trackId);
                    }
                  }),
                  (n.onError = function (t, i) {
                    !i.fatal &&
                      i.context &&
                      i.context.type === ai &&
                      i.context.id === this.trackId &&
                      i.context.groupId === this.groupId &&
                      ((this.requestScheduled = -1), this.checkRetry(i));
                  }),
                  (n.setAudioTrack = function (t) {
                    var i = this.tracksInGroup;
                    if (t < 0 || t >= i.length)
                      this.warn("Invalid id passed to audio-track controller");
                    else {
                      this.clearTimer();
                      var n = this.currentTrack;
                      i[this.trackId];
                      var e = i[t],
                        s = e.groupId,
                        a = e.name;
                      if (
                        (this.log(
                          "Switching to audio-track " +
                            t +
                            ' "' +
                            a +
                            '" lang:' +
                            e.lang +
                            " group:" +
                            s
                        ),
                        (this.trackId = t),
                        (this.currentTrack = e),
                        (this.selectDefaultTrack = !1),
                        this.hls.trigger(w.AUDIO_TRACK_SWITCHING, r({}, e)),
                        !e.details || e.details.live)
                      ) {
                        var o = this.switchParams(
                          e.url,
                          null == n ? void 0 : n.details
                        );
                        this.loadPlaylist(o);
                      }
                    }
                  }),
                  (n.selectInitialTrack = function () {
                    var t = this.tracksInGroup,
                      i =
                        this.findTrackId(this.currentTrack) |
                        this.findTrackId(null);
                    if (-1 !== i) this.setAudioTrack(i);
                    else {
                      var n = new Error(
                        "No track found for running audio group-ID: " +
                          this.groupId +
                          " track count: " +
                          t.length
                      );
                      this.warn(n.message),
                        this.hls.trigger(w.ERROR, {
                          type: b.MEDIA_ERROR,
                          details: k.AUDIO_TRACK_LOAD_ERROR,
                          fatal: !0,
                          error: n,
                        });
                    }
                  }),
                  (n.findTrackId = function (t) {
                    for (var i = this.tracksInGroup, n = 0; n < i.length; n++) {
                      var r = i[n];
                      if (!this.selectDefaultTrack || r.default) {
                        if (
                          !t ||
                          (void 0 !== t.attrs["STABLE-RENDITION-ID"] &&
                            t.attrs["STABLE-RENDITION-ID"] ===
                              r.attrs["STABLE-RENDITION-ID"])
                        )
                          return r.id;
                        if (t.name === r.name && t.lang === r.lang) return r.id;
                      }
                    }
                    return -1;
                  }),
                  (n.loadPlaylist = function (i) {
                    t.prototype.loadPlaylist.call(this);
                    var n = this.tracksInGroup[this.trackId];
                    if (this.shouldLoadPlaylist(n)) {
                      var r = n.id,
                        e = n.groupId,
                        s = n.url;
                      if (i)
                        try {
                          s = i.addDirectives(s);
                        } catch (t) {
                          this.warn(
                            "Could not construct new URL with HLS Delivery Directives: " +
                              t
                          );
                        }
                      this.log(
                        "loading audio-track playlist " +
                          r +
                          ' "' +
                          n.name +
                          '" lang:' +
                          n.lang +
                          " group:" +
                          e
                      ),
                        this.clearTimer(),
                        this.hls.trigger(w.AUDIO_TRACK_LOADING, {
                          url: s,
                          id: r,
                          groupId: e,
                          deliveryDirectives: i || null,
                        });
                    }
                  }),
                  s(i, [
                    {
                      key: "audioTracks",
                      get: function () {
                        return this.tracksInGroup;
                      },
                    },
                    {
                      key: "audioTrack",
                      get: function () {
                        return this.trackId;
                      },
                      set: function (t) {
                        (this.selectDefaultTrack = !1), this.setAudioTrack(t);
                      },
                    },
                  ]),
                  i
                );
              })(Gi);
            function te(t, i) {
              if (t.length !== i.length) return !1;
              for (var n = 0; n < t.length; n++)
                if (!ie(t[n].attrs, i[n].attrs)) return !1;
              return !0;
            }
            function ie(t, i) {
              var n = t["STABLE-RENDITION-ID"];
              return n
                ? n === i["STABLE-RENDITION-ID"]
                : ![
                    "LANGUAGE",
                    "NAME",
                    "CHARACTERISTICS",
                    "AUTOSELECT",
                    "DEFAULT",
                    "FORCED",
                  ].some(function (n) {
                    return t[n] !== i[n];
                  });
            }
            var ne = (function (t) {
                function i(i, n, r) {
                  var e;
                  return (
                    ((e =
                      t.call(
                        this,
                        i,
                        n,
                        r,
                        "[subtitle-stream-controller]",
                        fi
                      ) || this).levels = []),
                    (e.currentTrackId = -1),
                    (e.tracksBuffered = []),
                    (e.mainDetails = null),
                    e.m(),
                    e
                  );
                }
                h(i, t);
                var n = i.prototype;
                return (
                  (n.onHandlerDestroying = function () {
                    this.k(), (this.mainDetails = null);
                  }),
                  (n.m = function () {
                    var t = this.hls;
                    t.on(w.MEDIA_ATTACHED, this.onMediaAttached, this),
                      t.on(w.MEDIA_DETACHING, this.onMediaDetaching, this),
                      t.on(w.MANIFEST_LOADING, this.onManifestLoading, this),
                      t.on(w.LEVEL_LOADED, this.onLevelLoaded, this),
                      t.on(w.ERROR, this.onError, this),
                      t.on(
                        w.SUBTITLE_TRACKS_UPDATED,
                        this.onSubtitleTracksUpdated,
                        this
                      ),
                      t.on(
                        w.SUBTITLE_TRACK_SWITCH,
                        this.onSubtitleTrackSwitch,
                        this
                      ),
                      t.on(
                        w.SUBTITLE_TRACK_LOADED,
                        this.onSubtitleTrackLoaded,
                        this
                      ),
                      t.on(
                        w.SUBTITLE_FRAG_PROCESSED,
                        this.onSubtitleFragProcessed,
                        this
                      ),
                      t.on(w.BUFFER_FLUSHING, this.onBufferFlushing, this),
                      t.on(w.FRAG_BUFFERED, this.onFragBuffered, this);
                  }),
                  (n.k = function () {
                    var t = this.hls;
                    t.off(w.MEDIA_ATTACHED, this.onMediaAttached, this),
                      t.off(w.MEDIA_DETACHING, this.onMediaDetaching, this),
                      t.off(w.MANIFEST_LOADING, this.onManifestLoading, this),
                      t.off(w.LEVEL_LOADED, this.onLevelLoaded, this),
                      t.off(w.ERROR, this.onError, this),
                      t.off(
                        w.SUBTITLE_TRACKS_UPDATED,
                        this.onSubtitleTracksUpdated,
                        this
                      ),
                      t.off(
                        w.SUBTITLE_TRACK_SWITCH,
                        this.onSubtitleTrackSwitch,
                        this
                      ),
                      t.off(
                        w.SUBTITLE_TRACK_LOADED,
                        this.onSubtitleTrackLoaded,
                        this
                      ),
                      t.off(
                        w.SUBTITLE_FRAG_PROCESSED,
                        this.onSubtitleFragProcessed,
                        this
                      ),
                      t.off(w.BUFFER_FLUSHING, this.onBufferFlushing, this),
                      t.off(w.FRAG_BUFFERED, this.onFragBuffered, this);
                  }),
                  (n.startLoad = function (t) {
                    this.stopLoad(),
                      (this.state = Tn),
                      this.setInterval(500),
                      (this.nextLoadPosition =
                        this.startPosition =
                        this.lastCurrentTime =
                          t),
                      this.tick();
                  }),
                  (n.onManifestLoading = function () {
                    (this.mainDetails = null),
                      this.fragmentTracker.removeAllFragments();
                  }),
                  (n.onMediaDetaching = function () {
                    (this.tracksBuffered = []),
                      t.prototype.onMediaDetaching.call(this);
                  }),
                  (n.onLevelLoaded = function (t, i) {
                    this.mainDetails = i.details;
                  }),
                  (n.onSubtitleFragProcessed = function (t, i) {
                    var n = i.frag,
                      r = i.success;
                    if (((this.fragPrevious = n), (this.state = Tn), r)) {
                      var e = this.tracksBuffered[this.currentTrackId];
                      if (e) {
                        for (var s, a = n.start, o = 0; o < e.length; o++)
                          if (a >= e[o].start && a <= e[o].end) {
                            s = e[o];
                            break;
                          }
                        var h = n.start + n.duration;
                        s
                          ? (s.end = h)
                          : ((s = { start: a, end: h }), e.push(s)),
                          this.fragmentTracker.fragBuffered(n);
                      }
                    }
                  }),
                  (n.onBufferFlushing = function (t, i) {
                    var n = i.startOffset,
                      r = i.endOffset;
                    if (0 === n && r !== Number.POSITIVE_INFINITY) {
                      var e = this.currentTrackId,
                        s = this.levels;
                      if (!s.length || !s[e] || !s[e].details) return;
                      var a = r - s[e].details.targetduration;
                      if (a <= 0) return;
                      (i.endOffsetSubtitles = Math.max(0, a)),
                        this.tracksBuffered.forEach(function (t) {
                          for (var i = 0; i < t.length; )
                            if (t[i].end <= a) t.shift();
                            else {
                              if (!(t[i].start < a)) break;
                              (t[i].start = a), i++;
                            }
                        }),
                        this.fragmentTracker.removeFragmentsInRange(n, a, fi);
                    }
                  }),
                  (n.onFragBuffered = function (t, i) {
                    var n;
                    this.loadedmetadata ||
                      i.frag.type !== hi ||
                      (null != (n = this.media) &&
                        n.buffered.length &&
                        (this.loadedmetadata = !0));
                  }),
                  (n.onError = function (t, i) {
                    var n = i.frag;
                    (null == n ? void 0 : n.type) === fi &&
                      (this.fragCurrent && this.fragCurrent.abortRequests(),
                      this.state !== En && (this.state = Tn));
                  }),
                  (n.onSubtitleTracksUpdated = function (t, i) {
                    var n = this,
                      r = i.subtitleTracks;
                    te(this.levels, r)
                      ? (this.levels = r.map(function (t) {
                          return new Mi(t);
                        }))
                      : ((this.tracksBuffered = []),
                        (this.levels = r.map(function (t) {
                          var i = new Mi(t);
                          return (n.tracksBuffered[i.id] = []), i;
                        })),
                        this.fragmentTracker.removeFragmentsInRange(
                          0,
                          Number.POSITIVE_INFINITY,
                          fi
                        ),
                        (this.fragPrevious = null),
                        (this.mediaBuffer = null));
                  }),
                  (n.onSubtitleTrackSwitch = function (t, i) {
                    if (
                      ((this.currentTrackId = i.id),
                      this.levels.length && -1 !== this.currentTrackId)
                    ) {
                      var n = this.levels[this.currentTrackId];
                      null != n && n.details
                        ? (this.mediaBuffer = this.mediaBufferTimeRanges)
                        : (this.mediaBuffer = null),
                        n && this.setInterval(500);
                    } else this.clearInterval();
                  }),
                  (n.onSubtitleTrackLoaded = function (t, i) {
                    var n,
                      r = i.details,
                      e = i.id,
                      s = this.currentTrackId,
                      a = this.levels;
                    if (a.length) {
                      var o = a[s];
                      if (!(e >= a.length || e !== s) && o) {
                        this.mediaBuffer = this.mediaBufferTimeRanges;
                        var h = 0;
                        if (r.live || (null != (n = o.details) && n.live)) {
                          var u = this.mainDetails;
                          if (r.deltaUpdateFailed || !u) return;
                          var f = u.fragments[0];
                          o.details
                            ? 0 === (h = this.alignPlaylists(r, o.details)) &&
                              f &&
                              Li(r, (h = f.start))
                            : r.hasProgramDateTime && u.hasProgramDateTime
                            ? (yn(r, u), (h = r.fragments[0].start))
                            : f && Li(r, (h = f.start));
                        }
                        (o.details = r),
                          (this.levelLastLoaded = e),
                          this.startFragRequested ||
                            (!this.mainDetails && r.live) ||
                            this.setStartPosition(o.details, h),
                          this.tick(),
                          r.live &&
                            !this.fragCurrent &&
                            this.media &&
                            this.state === Tn &&
                            (Xi(null, r.fragments, this.media.currentTime, 0) ||
                              (this.warn(
                                "Subtitle playlist not aligned with playback"
                              ),
                              (o.details = void 0)));
                      }
                    }
                  }),
                  (n.j = function (t) {
                    var i = this,
                      n = t.frag,
                      r = t.payload,
                      e = n.decryptdata,
                      s = this.hls;
                    if (
                      !this.fragContextChanged(n) &&
                      r &&
                      r.byteLength > 0 &&
                      e &&
                      e.key &&
                      e.iv &&
                      "AES-128" === e.method
                    ) {
                      var a = performance.now();
                      this.decrypter
                        .decrypt(new Uint8Array(r), e.key.buffer, e.iv.buffer)
                        .catch(function (t) {
                          throw (
                            (s.trigger(w.ERROR, {
                              type: b.MEDIA_ERROR,
                              details: k.FRAG_DECRYPT_ERROR,
                              fatal: !1,
                              error: t,
                              reason: t.message,
                              frag: n,
                            }),
                            t)
                          );
                        })
                        .then(function (t) {
                          var i = performance.now();
                          s.trigger(w.FRAG_DECRYPTED, {
                            frag: n,
                            payload: t,
                            stats: { tstart: a, tdecrypt: i },
                          });
                        })
                        .catch(function (t) {
                          i.warn(t.name + ": " + t.message), (i.state = Tn);
                        });
                    }
                  }),
                  (n.doTick = function () {
                    if (this.media) {
                      if (this.state === Tn) {
                        var t = this.currentTrackId,
                          i = this.levels,
                          n = i[t];
                        if (!i.length || !n || !n.details) return;
                        var r = n.details,
                          e = r.targetduration,
                          s = this.config,
                          a = this.getLoadPosition(),
                          o = cn.bufferedInfo(
                            this.tracksBuffered[this.currentTrackId] || [],
                            a - e,
                            s.maxBufferHole
                          ),
                          h = o.end,
                          u = o.len,
                          f = this.getFwdBufferInfo(this.media, hi);
                        if (
                          u >
                          this.getMaxBufferLength(null == f ? void 0 : f.len) +
                            e
                        )
                          return;
                        var l = r.fragments,
                          c = l.length,
                          v = r.edge,
                          d = null,
                          p = this.fragPrevious;
                        if (h < v) {
                          var m = s.maxFragLookUpTolerance;
                          !(d = Xi(p, l, Math.max(l[0].start, h), m)) &&
                            p &&
                            p.start < l[0].start &&
                            (d = l[0]);
                        } else d = l[c - 1];
                        if (!d) return;
                        (d = this.mapToInitFragWhenRequired(d)),
                          this.fragmentTracker.getState(d) === qi &&
                            this.loadFragment(d, n, h);
                      }
                    } else this.state = Tn;
                  }),
                  (n.getMaxBufferLength = function (i) {
                    var n = t.prototype.getMaxBufferLength.call(this);
                    return i ? Math.max(n, i) : n;
                  }),
                  (n.loadFragment = function (i, n, r) {
                    (this.fragCurrent = i),
                      "initSegment" === i.sn
                        ? this.B(i, n)
                        : ((this.startFragRequested = !0),
                          t.prototype.loadFragment.call(this, i, n, r));
                  }),
                  s(i, [
                    {
                      key: "mediaBufferTimeRanges",
                      get: function () {
                        return new re(
                          this.tracksBuffered[this.currentTrackId] || []
                        );
                      },
                    },
                  ]),
                  i
                );
              })(Pn),
              re = function (t) {
                this.buffered = void 0;
                var i = function (i, n, r) {
                  if ((n >>>= 0) > r - 1)
                    throw new DOMException(
                      "Failed to execute '" +
                        i +
                        "' on 'TimeRanges': The index provided (" +
                        n +
                        ") is greater than the maximum bound (" +
                        r +
                        ")"
                    );
                  return t[n][i];
                };
                this.buffered = {
                  get length() {
                    return t.length;
                  },
                  end: function (n) {
                    return i("end", n, t.length);
                  },
                  start: function (n) {
                    return i("start", n, t.length);
                  },
                };
              },
              ee = (function (t) {
                function i(i) {
                  var n;
                  return (
                    ((n =
                      t.call(this, i, "[subtitle-track-controller]") ||
                      this).media = null),
                    (n.tracks = []),
                    (n.groupId = null),
                    (n.tracksInGroup = []),
                    (n.trackId = -1),
                    (n.selectDefaultTrack = !0),
                    (n.queuedDefaultTrack = -1),
                    (n.trackChangeListener = function () {
                      return n.onTextTracksChanged();
                    }),
                    (n.asyncPollTrackChange = function () {
                      return n.pollTrackChange(0);
                    }),
                    (n.useTextTrackPolling = !1),
                    (n.subtitlePollingInterval = -1),
                    (n.wt = !0),
                    n.registerListeners(),
                    n
                  );
                }
                h(i, t);
                var n = i.prototype;
                return (
                  (n.destroy = function () {
                    this.unregisterListeners(),
                      (this.tracks.length = 0),
                      (this.tracksInGroup.length = 0),
                      (this.trackChangeListener = this.asyncPollTrackChange =
                        null),
                      t.prototype.destroy.call(this);
                  }),
                  (n.registerListeners = function () {
                    var t = this.hls;
                    t.on(w.MEDIA_ATTACHED, this.onMediaAttached, this),
                      t.on(w.MEDIA_DETACHING, this.onMediaDetaching, this),
                      t.on(w.MANIFEST_LOADING, this.onManifestLoading, this),
                      t.on(w.MANIFEST_PARSED, this.onManifestParsed, this),
                      t.on(w.LEVEL_LOADING, this.onLevelLoading, this),
                      t.on(w.LEVEL_SWITCHING, this.onLevelSwitching, this),
                      t.on(
                        w.SUBTITLE_TRACK_LOADED,
                        this.onSubtitleTrackLoaded,
                        this
                      ),
                      t.on(w.ERROR, this.onError, this);
                  }),
                  (n.unregisterListeners = function () {
                    var t = this.hls;
                    t.off(w.MEDIA_ATTACHED, this.onMediaAttached, this),
                      t.off(w.MEDIA_DETACHING, this.onMediaDetaching, this),
                      t.off(w.MANIFEST_LOADING, this.onManifestLoading, this),
                      t.off(w.MANIFEST_PARSED, this.onManifestParsed, this),
                      t.off(w.LEVEL_LOADING, this.onLevelLoading, this),
                      t.off(w.LEVEL_SWITCHING, this.onLevelSwitching, this),
                      t.off(
                        w.SUBTITLE_TRACK_LOADED,
                        this.onSubtitleTrackLoaded,
                        this
                      ),
                      t.off(w.ERROR, this.onError, this);
                  }),
                  (n.onMediaAttached = function (t, i) {
                    (this.media = i.media),
                      this.media &&
                        (this.queuedDefaultTrack > -1 &&
                          ((this.subtitleTrack = this.queuedDefaultTrack),
                          (this.queuedDefaultTrack = -1)),
                        (this.useTextTrackPolling = !(
                          this.media.textTracks &&
                          "onchange" in this.media.textTracks
                        )),
                        this.useTextTrackPolling
                          ? this.pollTrackChange(500)
                          : this.media.textTracks.addEventListener(
                              "change",
                              this.asyncPollTrackChange
                            ));
                  }),
                  (n.pollTrackChange = function (t) {
                    self.clearInterval(this.subtitlePollingInterval),
                      (this.subtitlePollingInterval = self.setInterval(
                        this.trackChangeListener,
                        t
                      ));
                  }),
                  (n.onMediaDetaching = function () {
                    this.media &&
                      (self.clearInterval(this.subtitlePollingInterval),
                      this.useTextTrackPolling ||
                        this.media.textTracks.removeEventListener(
                          "change",
                          this.asyncPollTrackChange
                        ),
                      this.trackId > -1 &&
                        (this.queuedDefaultTrack = this.trackId),
                      se(this.media.textTracks).forEach(function (t) {
                        mi(t);
                      }),
                      (this.subtitleTrack = -1),
                      (this.media = null));
                  }),
                  (n.onManifestLoading = function () {
                    (this.tracks = []),
                      (this.groupId = null),
                      (this.tracksInGroup = []),
                      (this.trackId = -1),
                      (this.selectDefaultTrack = !0);
                  }),
                  (n.onManifestParsed = function (t, i) {
                    this.tracks = i.subtitleTracks;
                  }),
                  (n.onSubtitleTrackLoaded = function (t, i) {
                    var n = i.id,
                      r = i.details,
                      e = this.trackId,
                      s = this.tracksInGroup[e];
                    if (s) {
                      var a = s.details;
                      (s.details = i.details),
                        this.log(
                          "subtitle track " +
                            n +
                            " loaded [" +
                            r.startSN +
                            "-" +
                            r.endSN +
                            "]"
                        ),
                        n === this.trackId && this.playlistLoaded(n, i, a);
                    } else this.warn("Invalid subtitle track id " + n);
                  }),
                  (n.onLevelLoading = function (t, i) {
                    this.switchLevel(i.level);
                  }),
                  (n.onLevelSwitching = function (t, i) {
                    this.switchLevel(i.level);
                  }),
                  (n.switchLevel = function (t) {
                    var i = this.hls.levels[t];
                    if (null != i && i.textGroupIds) {
                      var n = i.textGroupIds[i.urlId],
                        r = this.tracksInGroup
                          ? this.tracksInGroup[this.trackId]
                          : void 0;
                      if (this.groupId !== n) {
                        var e = this.tracks.filter(function (t) {
                          return !n || t.groupId === n;
                        });
                        this.tracksInGroup = e;
                        var s =
                          this.findTrackId(null == r ? void 0 : r.name) ||
                          this.findTrackId();
                        this.groupId = n || null;
                        var a = { subtitleTracks: e };
                        this.log(
                          "Updating subtitle tracks, " +
                            e.length +
                            ' track(s) found in "' +
                            n +
                            '" group-id'
                        ),
                          this.hls.trigger(w.SUBTITLE_TRACKS_UPDATED, a),
                          -1 !== s && this.setSubtitleTrack(s, r);
                      } else
                        this.shouldReloadPlaylist(r) &&
                          this.setSubtitleTrack(this.trackId, r);
                    }
                  }),
                  (n.findTrackId = function (t) {
                    for (var i = this.tracksInGroup, n = 0; n < i.length; n++) {
                      var r = i[n];
                      if (
                        (!this.selectDefaultTrack || r.default) &&
                        (!t || t === r.name)
                      )
                        return r.id;
                    }
                    return -1;
                  }),
                  (n.onError = function (t, i) {
                    !i.fatal &&
                      i.context &&
                      i.context.type === oi &&
                      i.context.id === this.trackId &&
                      i.context.groupId === this.groupId &&
                      this.checkRetry(i);
                  }),
                  (n.loadPlaylist = function (i) {
                    t.prototype.loadPlaylist.call(this);
                    var n = this.tracksInGroup[this.trackId];
                    if (this.shouldLoadPlaylist(n)) {
                      var r = n.id,
                        e = n.groupId,
                        s = n.url;
                      if (i)
                        try {
                          s = i.addDirectives(s);
                        } catch (t) {
                          this.warn(
                            "Could not construct new URL with HLS Delivery Directives: " +
                              t
                          );
                        }
                      this.log("Loading subtitle playlist for id " + r),
                        this.hls.trigger(w.SUBTITLE_TRACK_LOADING, {
                          url: s,
                          id: r,
                          groupId: e,
                          deliveryDirectives: i || null,
                        });
                    }
                  }),
                  (n.toggleTrackModes = function (t) {
                    var i = this,
                      n = this.media,
                      r = this.trackId;
                    if (n) {
                      var e = se(n.textTracks),
                        s = e.filter(function (t) {
                          return t.groupId === i.groupId;
                        });
                      if (-1 === t)
                        [].slice.call(e).forEach(function (t) {
                          t.mode = "disabled";
                        });
                      else {
                        var a = s[r];
                        a && (a.mode = "disabled");
                      }
                      var o = s[t];
                      o &&
                        (o.mode = this.subtitleDisplay ? "showing" : "hidden");
                    }
                  }),
                  (n.setSubtitleTrack = function (t, i) {
                    var n,
                      r = this.tracksInGroup;
                    if (this.media) {
                      if (
                        (this.trackId !== t && this.toggleTrackModes(t),
                        !(
                          (this.trackId === t &&
                            (-1 === t || (null != (n = r[t]) && n.details))) ||
                          t < -1 ||
                          t >= r.length
                        ))
                      ) {
                        this.clearTimer();
                        var e = r[t];
                        if (
                          (this.log(
                            "Switching to subtitle-track " +
                              t +
                              (e
                                ? ' "' +
                                  e.name +
                                  '" lang:' +
                                  e.lang +
                                  " group:" +
                                  e.groupId
                                : "")
                          ),
                          (this.trackId = t),
                          e)
                        ) {
                          var s = e.id,
                            a = e.groupId,
                            o = void 0 === a ? "" : a,
                            h = e.name,
                            u = e.type,
                            f = e.url;
                          this.hls.trigger(w.SUBTITLE_TRACK_SWITCH, {
                            id: s,
                            groupId: o,
                            name: h,
                            type: u,
                            url: f,
                          });
                          var l = this.switchParams(
                            e.url,
                            null == i ? void 0 : i.details
                          );
                          this.loadPlaylist(l);
                        } else
                          this.hls.trigger(w.SUBTITLE_TRACK_SWITCH, { id: t });
                      }
                    } else this.queuedDefaultTrack = t;
                  }),
                  (n.onTextTracksChanged = function () {
                    if (
                      (this.useTextTrackPolling ||
                        self.clearInterval(this.subtitlePollingInterval),
                      this.media && this.hls.config.renderTextTracksNatively)
                    ) {
                      for (
                        var t = -1, i = se(this.media.textTracks), n = 0;
                        n < i.length;
                        n++
                      )
                        if ("hidden" === i[n].mode) t = n;
                        else if ("showing" === i[n].mode) {
                          t = n;
                          break;
                        }
                      this.subtitleTrack !== t && (this.subtitleTrack = t);
                    }
                  }),
                  s(i, [
                    {
                      key: "subtitleDisplay",
                      get: function () {
                        return this.wt;
                      },
                      set: function (t) {
                        (this.wt = t),
                          this.trackId > -1 &&
                            this.toggleTrackModes(this.trackId);
                      },
                    },
                    {
                      key: "subtitleTracks",
                      get: function () {
                        return this.tracksInGroup;
                      },
                    },
                    {
                      key: "subtitleTrack",
                      get: function () {
                        return this.trackId;
                      },
                      set: function (t) {
                        this.selectDefaultTrack = !1;
                        var i = this.tracksInGroup
                          ? this.tracksInGroup[this.trackId]
                          : void 0;
                        this.setSubtitleTrack(t, i);
                      },
                    },
                  ]),
                  i
                );
              })(Gi);
            function se(t) {
              for (var i = [], n = 0; n < t.length; n++) {
                var r = t[n];
                ("subtitles" !== r.kind && "captions" !== r.kind) ||
                  !r.label ||
                  i.push(t[n]);
              }
              return i;
            }
            var ae = (function () {
                function t(t) {
                  (this.buffers = void 0),
                    (this.queues = { video: [], audio: [], audiovideo: [] }),
                    (this.buffers = t);
                }
                var i = t.prototype;
                return (
                  (i.append = function (t, i) {
                    var n = this.queues[i];
                    n.push(t),
                      1 === n.length && this.buffers[i] && this.executeNext(i);
                  }),
                  (i.insertAbort = function (t, i) {
                    this.queues[i].unshift(t), this.executeNext(i);
                  }),
                  (i.appendBlocker = function (t) {
                    var i,
                      n = new Promise(function (t) {
                        i = t;
                      }),
                      r = {
                        execute: i,
                        onStart: function () {},
                        onComplete: function () {},
                        onError: function () {},
                      };
                    return this.append(r, t), n;
                  }),
                  (i.executeNext = function (t) {
                    var i = this.buffers,
                      n = this.queues,
                      r = i[t],
                      e = n[t];
                    if (e.length) {
                      var s = e[0];
                      try {
                        s.execute();
                      } catch (i) {
                        A.warn(
                          "[buffer-operation-queue]: Unhandled exception executing the current operation"
                        ),
                          s.onError(i),
                          (null != r && r.updating) ||
                            (e.shift(), this.executeNext(t));
                      }
                    }
                  }),
                  (i.shiftAndExecuteNext = function (t) {
                    this.queues[t].shift(), this.executeNext(t);
                  }),
                  (i.current = function (t) {
                    return this.queues[t][0];
                  }),
                  t
                );
              })(),
              oe = Xt(),
              he = /([ha]vc.)(?:\.[^.,]+)+/,
              ue = (function () {
                function t(t) {
                  var i = this;
                  (this.details = null),
                    (this.bt = null),
                    (this.operationQueue = void 0),
                    (this.listeners = void 0),
                    (this.hls = void 0),
                    (this.bufferCodecEventsExpected = 0),
                    (this.kt = 0),
                    (this.media = null),
                    (this.mediaSource = null),
                    (this.lastMpegAudioChunk = null),
                    (this.appendError = 0),
                    (this.tracks = {}),
                    (this.pendingTracks = {}),
                    (this.sourceBuffer = void 0),
                    (this.Et = function () {
                      var t = i.media,
                        n = i.mediaSource;
                      A.log("[buffer-controller]: Media source opened"),
                        t &&
                          (t.removeEventListener("emptied", i.Tt),
                          i.updateMediaElementDuration(),
                          i.hls.trigger(w.MEDIA_ATTACHED, { media: t })),
                        n && n.removeEventListener("sourceopen", i.Et),
                        i.checkPendingTracks();
                    }),
                    (this.xt = function () {
                      A.log("[buffer-controller]: Media source closed");
                    }),
                    (this.St = function () {
                      A.log("[buffer-controller]: Media source ended");
                    }),
                    (this.Tt = function () {
                      var t = i.media,
                        n = i.bt;
                      t &&
                        t.src !== n &&
                        A.error(
                          "Media element src was set while attaching MediaSource (" +
                            n +
                            " > " +
                            t.src +
                            ")"
                        );
                    }),
                    (this.hls = t),
                    this.At(),
                    this.registerListeners();
                }
                var i = t.prototype;
                return (
                  (i.hasSourceTypes = function () {
                    return (
                      this.getSourceBufferTypes().length > 0 ||
                      Object.keys(this.pendingTracks).length > 0
                    );
                  }),
                  (i.destroy = function () {
                    this.unregisterListeners(),
                      (this.details = null),
                      (this.lastMpegAudioChunk = null);
                  }),
                  (i.registerListeners = function () {
                    var t = this.hls;
                    t.on(w.MEDIA_ATTACHING, this.onMediaAttaching, this),
                      t.on(w.MEDIA_DETACHING, this.onMediaDetaching, this),
                      t.on(w.MANIFEST_LOADING, this.onManifestLoading, this),
                      t.on(w.MANIFEST_PARSED, this.onManifestParsed, this),
                      t.on(w.BUFFER_RESET, this.onBufferReset, this),
                      t.on(w.BUFFER_APPENDING, this.onBufferAppending, this),
                      t.on(w.BUFFER_CODECS, this.onBufferCodecs, this),
                      t.on(w.BUFFER_EOS, this.onBufferEos, this),
                      t.on(w.BUFFER_FLUSHING, this.onBufferFlushing, this),
                      t.on(w.LEVEL_UPDATED, this.onLevelUpdated, this),
                      t.on(w.FRAG_PARSED, this.onFragParsed, this),
                      t.on(w.FRAG_CHANGED, this.onFragChanged, this);
                  }),
                  (i.unregisterListeners = function () {
                    var t = this.hls;
                    t.off(w.MEDIA_ATTACHING, this.onMediaAttaching, this),
                      t.off(w.MEDIA_DETACHING, this.onMediaDetaching, this),
                      t.off(w.MANIFEST_LOADING, this.onManifestLoading, this),
                      t.off(w.MANIFEST_PARSED, this.onManifestParsed, this),
                      t.off(w.BUFFER_RESET, this.onBufferReset, this),
                      t.off(w.BUFFER_APPENDING, this.onBufferAppending, this),
                      t.off(w.BUFFER_CODECS, this.onBufferCodecs, this),
                      t.off(w.BUFFER_EOS, this.onBufferEos, this),
                      t.off(w.BUFFER_FLUSHING, this.onBufferFlushing, this),
                      t.off(w.LEVEL_UPDATED, this.onLevelUpdated, this),
                      t.off(w.FRAG_PARSED, this.onFragParsed, this),
                      t.off(w.FRAG_CHANGED, this.onFragChanged, this);
                  }),
                  (i.At = function () {
                    (this.sourceBuffer = {}),
                      (this.operationQueue = new ae(this.sourceBuffer)),
                      (this.listeners = {
                        audio: [],
                        video: [],
                        audiovideo: [],
                      }),
                      (this.lastMpegAudioChunk = null);
                  }),
                  (i.onManifestLoading = function () {
                    (this.bufferCodecEventsExpected = this.kt = 0),
                      (this.details = null);
                  }),
                  (i.onManifestParsed = function (t, i) {
                    var n = 2;
                    ((i.audio && !i.video) || !i.altAudio) && (n = 1),
                      (this.bufferCodecEventsExpected = this.kt = n),
                      A.log(
                        this.bufferCodecEventsExpected +
                          " bufferCodec event(s) expected"
                      );
                  }),
                  (i.onMediaAttaching = function (t, i) {
                    var n = (this.media = i.media);
                    if (n && oe) {
                      var r = (this.mediaSource = new oe());
                      r.addEventListener("sourceopen", this.Et),
                        r.addEventListener("sourceended", this.St),
                        r.addEventListener("sourceclose", this.xt),
                        (n.src = self.URL.createObjectURL(r)),
                        (this.bt = n.src),
                        n.addEventListener("emptied", this.Tt);
                    }
                  }),
                  (i.onMediaDetaching = function () {
                    var t = this.media,
                      i = this.mediaSource,
                      n = this.bt;
                    if (i) {
                      if (
                        (A.log("[buffer-controller]: media source detaching"),
                        "open" === i.readyState)
                      )
                        try {
                          i.endOfStream();
                        } catch (t) {
                          A.warn(
                            "[buffer-controller]: onMediaDetaching: " +
                              t.message +
                              " while calling endOfStream"
                          );
                        }
                      this.onBufferReset(),
                        i.removeEventListener("sourceopen", this.Et),
                        i.removeEventListener("sourceended", this.St),
                        i.removeEventListener("sourceclose", this.xt),
                        t &&
                          (t.removeEventListener("emptied", this.Tt),
                          n && self.URL.revokeObjectURL(n),
                          t.src === n
                            ? (t.removeAttribute("src"), t.load())
                            : A.warn(
                                "[buffer-controller]: media.src was changed by a third party - skip cleanup"
                              )),
                        (this.mediaSource = null),
                        (this.media = null),
                        (this.bt = null),
                        (this.bufferCodecEventsExpected = this.kt),
                        (this.pendingTracks = {}),
                        (this.tracks = {});
                    }
                    this.hls.trigger(w.MEDIA_DETACHED, void 0);
                  }),
                  (i.onBufferReset = function () {
                    var t = this;
                    this.getSourceBufferTypes().forEach(function (i) {
                      var n = t.sourceBuffer[i];
                      try {
                        n &&
                          (t.removeBufferListeners(i),
                          t.mediaSource && t.mediaSource.removeSourceBuffer(n),
                          (t.sourceBuffer[i] = void 0));
                      } catch (t) {
                        A.warn(
                          "[buffer-controller]: Failed to reset the " +
                            i +
                            " buffer",
                          t
                        );
                      }
                    }),
                      this.At();
                  }),
                  (i.onBufferCodecs = function (t, i) {
                    var n = this,
                      r = this.getSourceBufferTypes().length;
                    Object.keys(i).forEach(function (t) {
                      if (r) {
                        var e = n.tracks[t];
                        if (e && "function" == typeof e.buffer.changeType) {
                          var s = i[t],
                            a = s.id,
                            o = s.codec,
                            h = s.levelCodec,
                            u = s.container,
                            f = s.metadata,
                            l = (e.levelCodec || e.codec).replace(he, "$1"),
                            c = (h || o).replace(he, "$1");
                          if (l !== c) {
                            var v = u + ";codecs=" + (h || o);
                            n.appendChangeType(t, v),
                              A.log(
                                "[buffer-controller]: switching codec " +
                                  l +
                                  " to " +
                                  c
                              ),
                              (n.tracks[t] = {
                                buffer: e.buffer,
                                codec: o,
                                container: u,
                                levelCodec: h,
                                metadata: f,
                                id: a,
                              });
                          }
                        }
                      } else n.pendingTracks[t] = i[t];
                    }),
                      r ||
                        ((this.bufferCodecEventsExpected = Math.max(
                          this.bufferCodecEventsExpected - 1,
                          0
                        )),
                        this.mediaSource &&
                          "open" === this.mediaSource.readyState &&
                          this.checkPendingTracks());
                  }),
                  (i.appendChangeType = function (t, i) {
                    var n = this,
                      r = this.operationQueue,
                      e = {
                        execute: function () {
                          var e = n.sourceBuffer[t];
                          e &&
                            (A.log(
                              "[buffer-controller]: changing " +
                                t +
                                " sourceBuffer type to " +
                                i
                            ),
                            e.changeType(i)),
                            r.shiftAndExecuteNext(t);
                        },
                        onStart: function () {},
                        onComplete: function () {},
                        onError: function (i) {
                          A.warn(
                            "[buffer-controller]: Failed to change " +
                              t +
                              " SourceBuffer type",
                            i
                          );
                        },
                      };
                    r.append(e, t);
                  }),
                  (i.onBufferAppending = function (t, i) {
                    var n = this,
                      r = this.hls,
                      e = this.operationQueue,
                      s = this.tracks,
                      a = i.data,
                      o = i.type,
                      h = i.frag,
                      u = i.part,
                      f = i.chunkMeta,
                      l = f.buffering[o],
                      c = self.performance.now();
                    l.start = c;
                    var v = h.stats.buffering,
                      d = u ? u.stats.buffering : null;
                    0 === v.start && (v.start = c),
                      d && 0 === d.start && (d.start = c);
                    var p = s.audio,
                      m = !1;
                    "audio" === o &&
                      "audio/mpeg" === (null == p ? void 0 : p.container) &&
                      ((m =
                        !this.lastMpegAudioChunk ||
                        1 === f.id ||
                        this.lastMpegAudioChunk.sn !== f.sn),
                      (this.lastMpegAudioChunk = f));
                    var y = h.start,
                      g = {
                        execute: function () {
                          if (((l.executeStart = self.performance.now()), m)) {
                            var t = n.sourceBuffer[o];
                            if (t) {
                              var i = y - t.timestampOffset;
                              Math.abs(i) >= 0.1 &&
                                (A.log(
                                  "[buffer-controller]: Updating audio SourceBuffer timestampOffset to " +
                                    y +
                                    " (delta: " +
                                    i +
                                    ") sn: " +
                                    h.sn +
                                    ")"
                                ),
                                (t.timestampOffset = y));
                            }
                          }
                          n.appendExecutor(a, o);
                        },
                        onStart: function () {},
                        onComplete: function () {
                          var t = self.performance.now();
                          (l.executeEnd = l.end = t),
                            0 === v.first && (v.first = t),
                            d && 0 === d.first && (d.first = t);
                          var i = n.sourceBuffer,
                            r = {};
                          for (var e in i) r[e] = cn.getBuffered(i[e]);
                          (n.appendError = 0),
                            n.hls.trigger(w.BUFFER_APPENDED, {
                              type: o,
                              frag: h,
                              part: u,
                              chunkMeta: f,
                              parent: h.type,
                              timeRanges: r,
                            });
                        },
                        onError: function (t) {
                          A.error(
                            "[buffer-controller]: Error encountered while trying to append to the " +
                              o +
                              " SourceBuffer",
                            t
                          );
                          var i = {
                            type: b.MEDIA_ERROR,
                            parent: h.type,
                            details: k.BUFFER_APPEND_ERROR,
                            frag: h,
                            part: u,
                            chunkMeta: f,
                            error: t,
                            err: t,
                            fatal: !1,
                          };
                          t.code === DOMException.QUOTA_EXCEEDED_ERR
                            ? (i.details = k.BUFFER_FULL_ERROR)
                            : (n.appendError++,
                              (i.details = k.BUFFER_APPEND_ERROR),
                              n.appendError > r.config.appendErrorMaxRetry &&
                                (A.error(
                                  "[buffer-controller]: Failed " +
                                    r.config.appendErrorMaxRetry +
                                    " times to append segment in sourceBuffer"
                                ),
                                (i.fatal = !0))),
                            r.trigger(w.ERROR, i);
                        },
                      };
                    e.append(g, o);
                  }),
                  (i.onBufferFlushing = function (t, i) {
                    var n = this,
                      r = this.operationQueue,
                      e = function (t) {
                        return {
                          execute: n.removeExecutor.bind(
                            n,
                            t,
                            i.startOffset,
                            i.endOffset
                          ),
                          onStart: function () {},
                          onComplete: function () {
                            n.hls.trigger(w.BUFFER_FLUSHED, { type: t });
                          },
                          onError: function (i) {
                            A.warn(
                              "[buffer-controller]: Failed to remove from " +
                                t +
                                " SourceBuffer",
                              i
                            );
                          },
                        };
                      };
                    i.type
                      ? r.append(e(i.type), i.type)
                      : this.getSourceBufferTypes().forEach(function (t) {
                          r.append(e(t), t);
                        });
                  }),
                  (i.onFragParsed = function (t, i) {
                    var n = this,
                      r = i.frag,
                      e = i.part,
                      s = [],
                      a = e ? e.elementaryStreams : r.elementaryStreams;
                    a[C]
                      ? s.push("audiovideo")
                      : (a[I] && s.push("audio"), a[P] && s.push("video")),
                      0 === s.length &&
                        A.warn(
                          "Fragments must have at least one ElementaryStreamType set. type: " +
                            r.type +
                            " level: " +
                            r.level +
                            " sn: " +
                            r.sn
                        ),
                      this.blockBuffers(function () {
                        var t = self.performance.now();
                        (r.stats.buffering.end = t),
                          e && (e.stats.buffering.end = t);
                        var i = e ? e.stats : r.stats;
                        n.hls.trigger(w.FRAG_BUFFERED, {
                          frag: r,
                          part: e,
                          stats: i,
                          id: r.type,
                        });
                      }, s);
                  }),
                  (i.onFragChanged = function (t, i) {
                    this.flushBackBuffer();
                  }),
                  (i.onBufferEos = function (t, i) {
                    var n = this;
                    this.getSourceBufferTypes().reduce(function (t, r) {
                      var e = n.sourceBuffer[r];
                      return (
                        !e ||
                          (i.type && i.type !== r) ||
                          ((e.ending = !0),
                          e.ended ||
                            ((e.ended = !0),
                            A.log(
                              "[buffer-controller]: " +
                                r +
                                " sourceBuffer now EOS"
                            ))),
                        t && !(e && !e.ended)
                      );
                    }, !0) &&
                      (A.log(
                        "[buffer-controller]: Queueing mediaSource.endOfStream()"
                      ),
                      this.blockBuffers(function () {
                        n.getSourceBufferTypes().forEach(function (t) {
                          var i = n.sourceBuffer[t];
                          i && (i.ending = !1);
                        });
                        var t = n.mediaSource;
                        t && "open" === t.readyState
                          ? (A.log(
                              "[buffer-controller]: Calling mediaSource.endOfStream()"
                            ),
                            t.endOfStream())
                          : t &&
                            A.info(
                              "[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: " +
                                t.readyState
                            );
                      }));
                  }),
                  (i.onLevelUpdated = function (t, i) {
                    var n = i.details;
                    n.fragments.length &&
                      ((this.details = n),
                      this.getSourceBufferTypes().length
                        ? this.blockBuffers(
                            this.updateMediaElementDuration.bind(this)
                          )
                        : this.updateMediaElementDuration());
                  }),
                  (i.flushBackBuffer = function () {
                    var t = this.hls,
                      i = this.details,
                      n = this.media,
                      r = this.sourceBuffer;
                    if (n && null !== i) {
                      var e = this.getSourceBufferTypes();
                      if (e.length) {
                        var s =
                          i.live && null !== t.config.liveBackBufferLength
                            ? t.config.liveBackBufferLength
                            : t.config.backBufferLength;
                        if (g(s) && !(s < 0)) {
                          var a = n.currentTime,
                            o = i.levelTargetDuration,
                            h = Math.max(s, o),
                            u = Math.floor(a / o) * o - h;
                          e.forEach(function (n) {
                            var e = r[n];
                            if (e) {
                              var s = cn.getBuffered(e);
                              if (s.length > 0 && u > s.start(0)) {
                                if (
                                  (t.trigger(w.BACK_BUFFER_REACHED, {
                                    bufferEnd: u,
                                  }),
                                  i.live)
                                )
                                  t.trigger(w.LIVE_BACK_BUFFER_REACHED, {
                                    bufferEnd: u,
                                  });
                                else if (
                                  e.ended &&
                                  s.end(s.length - 1) - a < 2 * o
                                )
                                  return void A.info(
                                    "[buffer-controller]: Cannot flush " +
                                      n +
                                      " back buffer while SourceBuffer is in ended state"
                                  );
                                t.trigger(w.BUFFER_FLUSHING, {
                                  startOffset: 0,
                                  endOffset: u,
                                  type: n,
                                });
                              }
                            }
                          });
                        }
                      }
                    }
                  }),
                  (i.updateMediaElementDuration = function () {
                    if (
                      this.details &&
                      this.media &&
                      this.mediaSource &&
                      "open" === this.mediaSource.readyState
                    ) {
                      var t = this.details,
                        i = this.hls,
                        n = this.media,
                        r = this.mediaSource,
                        e = t.fragments[0].start + t.totalduration,
                        s = n.duration,
                        a = g(r.duration) ? r.duration : 0;
                      t.live && i.config.liveDurationInfinity
                        ? (A.log(
                            "[buffer-controller]: Media Source duration is set to Infinity"
                          ),
                          (r.duration = 1 / 0),
                          this.updateSeekableRange(t))
                        : ((e > a && e > s) || !g(s)) &&
                          (A.log(
                            "[buffer-controller]: Updating Media Source duration to " +
                              e.toFixed(3)
                          ),
                          (r.duration = e));
                    }
                  }),
                  (i.updateSeekableRange = function (t) {
                    var i = this.mediaSource,
                      n = t.fragments;
                    if (
                      n.length &&
                      t.live &&
                      null != i &&
                      i.setLiveSeekableRange
                    ) {
                      var r = Math.max(0, n[0].start),
                        e = Math.max(r, r + t.totalduration);
                      i.setLiveSeekableRange(r, e);
                    }
                  }),
                  (i.checkPendingTracks = function () {
                    var t = this.bufferCodecEventsExpected,
                      i = this.operationQueue,
                      n = this.pendingTracks,
                      r = Object.keys(n).length;
                    if ((r && !t) || 2 === r) {
                      this.createSourceBuffers(n), (this.pendingTracks = {});
                      var e = this.getSourceBufferTypes();
                      if (e.length)
                        this.hls.trigger(w.BUFFER_CREATED, {
                          tracks: this.tracks,
                        }),
                          e.forEach(function (t) {
                            i.executeNext(t);
                          });
                      else {
                        var s = new Error(
                          "could not create source buffer for media codec(s)"
                        );
                        this.hls.trigger(w.ERROR, {
                          type: b.MEDIA_ERROR,
                          details: k.BUFFER_INCOMPATIBLE_CODECS_ERROR,
                          fatal: !0,
                          error: s,
                          reason: s.message,
                        });
                      }
                    }
                  }),
                  (i.createSourceBuffers = function (t) {
                    var i = this.sourceBuffer,
                      n = this.mediaSource;
                    if (!n)
                      throw Error(
                        "createSourceBuffers called when mediaSource was null"
                      );
                    for (var r in t)
                      if (!i[r]) {
                        var e = t[r];
                        if (!e)
                          throw Error(
                            "source buffer exists for track " +
                              r +
                              ", however track does not"
                          );
                        var s = e.levelCodec || e.codec,
                          a = e.container + ";codecs=" + s;
                        A.log(
                          "[buffer-controller]: creating sourceBuffer(" +
                            a +
                            ")"
                        );
                        try {
                          var o = (i[r] = n.addSourceBuffer(a)),
                            h = r;
                          this.addBufferListener(h, "updatestart", this.Mt),
                            this.addBufferListener(h, "updateend", this.Dt),
                            this.addBufferListener(h, "error", this._t),
                            (this.tracks[r] = {
                              buffer: o,
                              codec: s,
                              container: e.container,
                              levelCodec: e.levelCodec,
                              metadata: e.metadata,
                              id: e.id,
                            });
                        } catch (t) {
                          A.error(
                            "[buffer-controller]: error while trying to add sourceBuffer: " +
                              t.message
                          ),
                            this.hls.trigger(w.ERROR, {
                              type: b.MEDIA_ERROR,
                              details: k.BUFFER_ADD_CODEC_ERROR,
                              fatal: !1,
                              error: t,
                              mimeType: a,
                            });
                        }
                      }
                  }),
                  (i.Mt = function (t) {
                    this.operationQueue.current(t).onStart();
                  }),
                  (i.Dt = function (t) {
                    var i = this.operationQueue;
                    i.current(t).onComplete(), i.shiftAndExecuteNext(t);
                  }),
                  (i._t = function (t, i) {
                    var n = new Error(t + " SourceBuffer error");
                    A.error("[buffer-controller]: " + n, i),
                      this.hls.trigger(w.ERROR, {
                        type: b.MEDIA_ERROR,
                        details: k.BUFFER_APPENDING_ERROR,
                        error: n,
                        fatal: !1,
                      });
                    var r = this.operationQueue.current(t);
                    r && r.onError(i);
                  }),
                  (i.removeExecutor = function (t, i, n) {
                    var r = this.media,
                      e = this.mediaSource,
                      s = this.operationQueue,
                      a = this.sourceBuffer[t];
                    if (!r || !e || !a)
                      return (
                        A.warn(
                          "[buffer-controller]: Attempting to remove from the " +
                            t +
                            " SourceBuffer, but it does not exist"
                        ),
                        void s.shiftAndExecuteNext(t)
                      );
                    var o = g(r.duration) ? r.duration : 1 / 0,
                      h = g(e.duration) ? e.duration : 1 / 0,
                      u = Math.max(0, i),
                      f = Math.min(n, o, h);
                    f > u && !a.ending
                      ? ((a.ended = !1),
                        A.log(
                          "[buffer-controller]: Removing [" +
                            u +
                            "," +
                            f +
                            "] from the " +
                            t +
                            " SourceBuffer"
                        ),
                        a.remove(u, f))
                      : s.shiftAndExecuteNext(t);
                  }),
                  (i.appendExecutor = function (t, i) {
                    var n = this.operationQueue,
                      r = this.sourceBuffer[i];
                    if (!r)
                      return (
                        A.warn(
                          "[buffer-controller]: Attempting to append to the " +
                            i +
                            " SourceBuffer, but it does not exist"
                        ),
                        void n.shiftAndExecuteNext(i)
                      );
                    (r.ended = !1), r.appendBuffer(t);
                  }),
                  (i.blockBuffers = function (t, i) {
                    var n = this;
                    if (
                      (void 0 === i && (i = this.getSourceBufferTypes()),
                      !i.length)
                    )
                      return (
                        A.log(
                          "[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"
                        ),
                        void Promise.resolve().then(t)
                      );
                    var r = this.operationQueue,
                      e = i.map(function (t) {
                        return r.appendBlocker(t);
                      });
                    Promise.all(e).then(function () {
                      t(),
                        i.forEach(function (t) {
                          var i = n.sourceBuffer[t];
                          (null != i && i.updating) || r.shiftAndExecuteNext(t);
                        });
                    });
                  }),
                  (i.getSourceBufferTypes = function () {
                    return Object.keys(this.sourceBuffer);
                  }),
                  (i.addBufferListener = function (t, i, n) {
                    var r = this.sourceBuffer[t];
                    if (r) {
                      var e = n.bind(this, t);
                      this.listeners[t].push({ event: i, listener: e }),
                        r.addEventListener(i, e);
                    }
                  }),
                  (i.removeBufferListeners = function (t) {
                    var i = this.sourceBuffer[t];
                    i &&
                      this.listeners[t].forEach(function (t) {
                        i.removeEventListener(t.event, t.listener);
                      });
                  }),
                  t
                );
              })(),
              fe = {
                42: 225,
                92: 233,
                94: 237,
                95: 243,
                96: 250,
                123: 231,
                124: 247,
                125: 209,
                126: 241,
                127: 9608,
                128: 174,
                129: 176,
                130: 189,
                131: 191,
                132: 8482,
                133: 162,
                134: 163,
                135: 9834,
                136: 224,
                137: 32,
                138: 232,
                139: 226,
                140: 234,
                141: 238,
                142: 244,
                143: 251,
                144: 193,
                145: 201,
                146: 211,
                147: 218,
                148: 220,
                149: 252,
                150: 8216,
                151: 161,
                152: 42,
                153: 8217,
                154: 9473,
                155: 169,
                156: 8480,
                157: 8226,
                158: 8220,
                159: 8221,
                160: 192,
                161: 194,
                162: 199,
                163: 200,
                164: 202,
                165: 203,
                166: 235,
                167: 206,
                168: 207,
                169: 239,
                170: 212,
                171: 217,
                172: 249,
                173: 219,
                174: 171,
                175: 187,
                176: 195,
                177: 227,
                178: 205,
                179: 204,
                180: 236,
                181: 210,
                182: 242,
                183: 213,
                184: 245,
                185: 123,
                186: 125,
                187: 92,
                188: 94,
                189: 95,
                190: 124,
                191: 8764,
                192: 196,
                193: 228,
                194: 214,
                195: 246,
                196: 223,
                197: 165,
                198: 164,
                199: 9475,
                200: 197,
                201: 229,
                202: 216,
                203: 248,
                204: 9487,
                205: 9491,
                206: 9495,
                207: 9499,
              },
              le = function (t) {
                var i = t;
                return (
                  fe.hasOwnProperty(t) && (i = fe[t]), String.fromCharCode(i)
                );
              },
              ce = 15,
              ve = 100,
              de = {
                17: 1,
                18: 3,
                21: 5,
                22: 7,
                23: 9,
                16: 11,
                19: 12,
                20: 14,
              },
              pe = { 17: 2, 18: 4, 21: 6, 22: 8, 23: 10, 19: 13, 20: 15 },
              me = {
                25: 1,
                26: 3,
                29: 5,
                30: 7,
                31: 9,
                24: 11,
                27: 12,
                28: 14,
              },
              ye = { 25: 2, 26: 4, 29: 6, 30: 8, 31: 10, 27: 13, 28: 15 },
              ge = [
                "white",
                "green",
                "blue",
                "cyan",
                "red",
                "yellow",
                "magenta",
                "black",
                "transparent",
              ],
              we = (function () {
                function t() {
                  (this.time = null), (this.verboseLevel = 0);
                }
                return (
                  (t.prototype.log = function (t, i) {
                    if (this.verboseLevel >= t) {
                      var n = "function" == typeof i ? i() : i;
                      A.log(this.time + " [" + t + "] " + n);
                    }
                  }),
                  t
                );
              })(),
              be = function (t) {
                for (var i = [], n = 0; n < t.length; n++)
                  i.push(t[n].toString(16));
                return i;
              },
              ke = (function () {
                function t(t, i, n, r, e) {
                  (this.foreground = void 0),
                    (this.underline = void 0),
                    (this.italics = void 0),
                    (this.background = void 0),
                    (this.flash = void 0),
                    (this.foreground = t || "white"),
                    (this.underline = i || !1),
                    (this.italics = n || !1),
                    (this.background = r || "black"),
                    (this.flash = e || !1);
                }
                var i = t.prototype;
                return (
                  (i.reset = function () {
                    (this.foreground = "white"),
                      (this.underline = !1),
                      (this.italics = !1),
                      (this.background = "black"),
                      (this.flash = !1);
                  }),
                  (i.setStyles = function (t) {
                    for (
                      var i = [
                          "foreground",
                          "underline",
                          "italics",
                          "background",
                          "flash",
                        ],
                        n = 0;
                      n < i.length;
                      n++
                    ) {
                      var r = i[n];
                      t.hasOwnProperty(r) && (this[r] = t[r]);
                    }
                  }),
                  (i.isDefault = function () {
                    return (
                      "white" === this.foreground &&
                      !this.underline &&
                      !this.italics &&
                      "black" === this.background &&
                      !this.flash
                    );
                  }),
                  (i.equals = function (t) {
                    return (
                      this.foreground === t.foreground &&
                      this.underline === t.underline &&
                      this.italics === t.italics &&
                      this.background === t.background &&
                      this.flash === t.flash
                    );
                  }),
                  (i.copy = function (t) {
                    (this.foreground = t.foreground),
                      (this.underline = t.underline),
                      (this.italics = t.italics),
                      (this.background = t.background),
                      (this.flash = t.flash);
                  }),
                  (i.toString = function () {
                    return (
                      "color=" +
                      this.foreground +
                      ", underline=" +
                      this.underline +
                      ", italics=" +
                      this.italics +
                      ", background=" +
                      this.background +
                      ", flash=" +
                      this.flash
                    );
                  }),
                  t
                );
              })(),
              Ee = (function () {
                function t(t, i, n, r, e, s) {
                  (this.uchar = void 0),
                    (this.penState = void 0),
                    (this.uchar = t || " "),
                    (this.penState = new ke(i, n, r, e, s));
                }
                var i = t.prototype;
                return (
                  (i.reset = function () {
                    (this.uchar = " "), this.penState.reset();
                  }),
                  (i.setChar = function (t, i) {
                    (this.uchar = t), this.penState.copy(i);
                  }),
                  (i.setPenState = function (t) {
                    this.penState.copy(t);
                  }),
                  (i.equals = function (t) {
                    return (
                      this.uchar === t.uchar && this.penState.equals(t.penState)
                    );
                  }),
                  (i.copy = function (t) {
                    (this.uchar = t.uchar), this.penState.copy(t.penState);
                  }),
                  (i.isEmpty = function () {
                    return " " === this.uchar && this.penState.isDefault();
                  }),
                  t
                );
              })(),
              Te = (function () {
                function t(t) {
                  (this.chars = void 0),
                    (this.pos = void 0),
                    (this.currPenState = void 0),
                    (this.cueStartTime = void 0),
                    (this.logger = void 0),
                    (this.chars = []);
                  for (var i = 0; i < ve; i++) this.chars.push(new Ee());
                  (this.logger = t),
                    (this.pos = 0),
                    (this.currPenState = new ke());
                }
                var i = t.prototype;
                return (
                  (i.equals = function (t) {
                    for (var i = !0, n = 0; n < ve; n++)
                      if (!this.chars[n].equals(t.chars[n])) {
                        i = !1;
                        break;
                      }
                    return i;
                  }),
                  (i.copy = function (t) {
                    for (var i = 0; i < ve; i++) this.chars[i].copy(t.chars[i]);
                  }),
                  (i.isEmpty = function () {
                    for (var t = !0, i = 0; i < ve; i++)
                      if (!this.chars[i].isEmpty()) {
                        t = !1;
                        break;
                      }
                    return t;
                  }),
                  (i.setCursor = function (t) {
                    this.pos !== t && (this.pos = t),
                      this.pos < 0
                        ? (this.logger.log(
                            3,
                            "Negative cursor position " + this.pos
                          ),
                          (this.pos = 0))
                        : this.pos > ve &&
                          (this.logger.log(
                            3,
                            "Too large cursor position " + this.pos
                          ),
                          (this.pos = ve));
                  }),
                  (i.moveCursor = function (t) {
                    var i = this.pos + t;
                    if (t > 1)
                      for (var n = this.pos + 1; n < i + 1; n++)
                        this.chars[n].setPenState(this.currPenState);
                    this.setCursor(i);
                  }),
                  (i.backSpace = function () {
                    this.moveCursor(-1),
                      this.chars[this.pos].setChar(" ", this.currPenState);
                  }),
                  (i.insertChar = function (t) {
                    var i = this;
                    t >= 144 && this.backSpace();
                    var n = le(t);
                    this.pos >= ve
                      ? this.logger.log(0, function () {
                          return (
                            "Cannot insert " +
                            t.toString(16) +
                            " (" +
                            n +
                            ") at position " +
                            i.pos +
                            ". Skipping it!"
                          );
                        })
                      : (this.chars[this.pos].setChar(n, this.currPenState),
                        this.moveCursor(1));
                  }),
                  (i.clearFromPos = function (t) {
                    var i;
                    for (i = t; i < ve; i++) this.chars[i].reset();
                  }),
                  (i.clear = function () {
                    this.clearFromPos(0),
                      (this.pos = 0),
                      this.currPenState.reset();
                  }),
                  (i.clearToEndOfRow = function () {
                    this.clearFromPos(this.pos);
                  }),
                  (i.getTextString = function () {
                    for (var t = [], i = !0, n = 0; n < ve; n++) {
                      var r = this.chars[n].uchar;
                      " " !== r && (i = !1), t.push(r);
                    }
                    return i ? "" : t.join("");
                  }),
                  (i.setPenStyles = function (t) {
                    this.currPenState.setStyles(t),
                      this.chars[this.pos].setPenState(this.currPenState);
                  }),
                  t
                );
              })(),
              xe = (function () {
                function t(t) {
                  (this.rows = void 0),
                    (this.currRow = void 0),
                    (this.nrRollUpRows = void 0),
                    (this.lastOutputScreen = void 0),
                    (this.logger = void 0),
                    (this.rows = []);
                  for (var i = 0; i < ce; i++) this.rows.push(new Te(t));
                  (this.logger = t),
                    (this.currRow = 14),
                    (this.nrRollUpRows = null),
                    (this.lastOutputScreen = null),
                    this.reset();
                }
                var i = t.prototype;
                return (
                  (i.reset = function () {
                    for (var t = 0; t < ce; t++) this.rows[t].clear();
                    this.currRow = 14;
                  }),
                  (i.equals = function (t) {
                    for (var i = !0, n = 0; n < ce; n++)
                      if (!this.rows[n].equals(t.rows[n])) {
                        i = !1;
                        break;
                      }
                    return i;
                  }),
                  (i.copy = function (t) {
                    for (var i = 0; i < ce; i++) this.rows[i].copy(t.rows[i]);
                  }),
                  (i.isEmpty = function () {
                    for (var t = !0, i = 0; i < ce; i++)
                      if (!this.rows[i].isEmpty()) {
                        t = !1;
                        break;
                      }
                    return t;
                  }),
                  (i.backSpace = function () {
                    this.rows[this.currRow].backSpace();
                  }),
                  (i.clearToEndOfRow = function () {
                    this.rows[this.currRow].clearToEndOfRow();
                  }),
                  (i.insertChar = function (t) {
                    this.rows[this.currRow].insertChar(t);
                  }),
                  (i.setPen = function (t) {
                    this.rows[this.currRow].setPenStyles(t);
                  }),
                  (i.moveCursor = function (t) {
                    this.rows[this.currRow].moveCursor(t);
                  }),
                  (i.setCursor = function (t) {
                    this.logger.log(2, "setCursor: " + t),
                      this.rows[this.currRow].setCursor(t);
                  }),
                  (i.setPAC = function (t) {
                    this.logger.log(2, function () {
                      return "pacData = " + JSON.stringify(t);
                    });
                    var i = t.row - 1;
                    if (
                      (this.nrRollUpRows &&
                        i < this.nrRollUpRows - 1 &&
                        (i = this.nrRollUpRows - 1),
                      this.nrRollUpRows && this.currRow !== i)
                    ) {
                      for (var n = 0; n < ce; n++) this.rows[n].clear();
                      var r = this.currRow + 1 - this.nrRollUpRows,
                        e = this.lastOutputScreen;
                      if (e) {
                        var s = e.rows[r].cueStartTime,
                          a = this.logger.time;
                        if (s && null !== a && s < a)
                          for (var o = 0; o < this.nrRollUpRows; o++)
                            this.rows[i - this.nrRollUpRows + o + 1].copy(
                              e.rows[r + o]
                            );
                      }
                    }
                    this.currRow = i;
                    var h = this.rows[this.currRow];
                    if (null !== t.indent) {
                      var u = t.indent,
                        f = Math.max(u - 1, 0);
                      h.setCursor(t.indent),
                        (t.color = h.chars[f].penState.foreground);
                    }
                    var l = {
                      foreground: t.color,
                      underline: t.underline,
                      italics: t.italics,
                      background: "black",
                      flash: !1,
                    };
                    this.setPen(l);
                  }),
                  (i.setBkgData = function (t) {
                    this.logger.log(2, function () {
                      return "bkgData = " + JSON.stringify(t);
                    }),
                      this.backSpace(),
                      this.setPen(t),
                      this.insertChar(32);
                  }),
                  (i.setRollUpRows = function (t) {
                    this.nrRollUpRows = t;
                  }),
                  (i.rollUp = function () {
                    var t = this;
                    if (null !== this.nrRollUpRows) {
                      this.logger.log(1, function () {
                        return t.getDisplayText();
                      });
                      var i = this.currRow + 1 - this.nrRollUpRows,
                        n = this.rows.splice(i, 1)[0];
                      n.clear(),
                        this.rows.splice(this.currRow, 0, n),
                        this.logger.log(2, "Rolling up");
                    } else
                      this.logger.log(
                        3,
                        "roll_up but nrRollUpRows not set yet"
                      );
                  }),
                  (i.getDisplayText = function (t) {
                    t = t || !1;
                    for (var i = [], n = "", r = -1, e = 0; e < ce; e++) {
                      var s = this.rows[e].getTextString();
                      s &&
                        ((r = e + 1),
                        t
                          ? i.push("Row " + r + ": '" + s + "'")
                          : i.push(s.trim()));
                    }
                    return (
                      i.length > 0 &&
                        (n = t ? "[" + i.join(" | ") + "]" : i.join("\n")),
                      n
                    );
                  }),
                  (i.getTextAndFormat = function () {
                    return this.rows;
                  }),
                  t
                );
              })(),
              Se = (function () {
                function t(t, i, n) {
                  (this.chNr = void 0),
                    (this.outputFilter = void 0),
                    (this.mode = void 0),
                    (this.verbose = void 0),
                    (this.displayedMemory = void 0),
                    (this.nonDisplayedMemory = void 0),
                    (this.lastOutputScreen = void 0),
                    (this.currRollUpRow = void 0),
                    (this.writeScreen = void 0),
                    (this.cueStartTime = void 0),
                    (this.logger = void 0),
                    (this.chNr = t),
                    (this.outputFilter = i),
                    (this.mode = null),
                    (this.verbose = 0),
                    (this.displayedMemory = new xe(n)),
                    (this.nonDisplayedMemory = new xe(n)),
                    (this.lastOutputScreen = new xe(n)),
                    (this.currRollUpRow = this.displayedMemory.rows[14]),
                    (this.writeScreen = this.displayedMemory),
                    (this.mode = null),
                    (this.cueStartTime = null),
                    (this.logger = n);
                }
                var i = t.prototype;
                return (
                  (i.reset = function () {
                    (this.mode = null),
                      this.displayedMemory.reset(),
                      this.nonDisplayedMemory.reset(),
                      this.lastOutputScreen.reset(),
                      this.outputFilter.reset(),
                      (this.currRollUpRow = this.displayedMemory.rows[14]),
                      (this.writeScreen = this.displayedMemory),
                      (this.mode = null),
                      (this.cueStartTime = null);
                  }),
                  (i.getHandler = function () {
                    return this.outputFilter;
                  }),
                  (i.setHandler = function (t) {
                    this.outputFilter = t;
                  }),
                  (i.setPAC = function (t) {
                    this.writeScreen.setPAC(t);
                  }),
                  (i.setBkgData = function (t) {
                    this.writeScreen.setBkgData(t);
                  }),
                  (i.setMode = function (t) {
                    t !== this.mode &&
                      ((this.mode = t),
                      this.logger.log(2, function () {
                        return "MODE=" + t;
                      }),
                      "MODE_POP-ON" === this.mode
                        ? (this.writeScreen = this.nonDisplayedMemory)
                        : ((this.writeScreen = this.displayedMemory),
                          this.writeScreen.reset()),
                      "MODE_ROLL-UP" !== this.mode &&
                        ((this.displayedMemory.nrRollUpRows = null),
                        (this.nonDisplayedMemory.nrRollUpRows = null)),
                      (this.mode = t));
                  }),
                  (i.insertChars = function (t) {
                    for (var i = this, n = 0; n < t.length; n++)
                      this.writeScreen.insertChar(t[n]);
                    var r =
                      this.writeScreen === this.displayedMemory
                        ? "DISP"
                        : "NON_DISP";
                    this.logger.log(2, function () {
                      return r + ": " + i.writeScreen.getDisplayText(!0);
                    }),
                      ("MODE_PAINT-ON" !== this.mode &&
                        "MODE_ROLL-UP" !== this.mode) ||
                        (this.logger.log(1, function () {
                          return (
                            "DISPLAYED: " + i.displayedMemory.getDisplayText(!0)
                          );
                        }),
                        this.outputDataUpdate());
                  }),
                  (i.ccRCL = function () {
                    this.logger.log(2, "RCL - Resume Caption Loading"),
                      this.setMode("MODE_POP-ON");
                  }),
                  (i.ccBS = function () {
                    this.logger.log(2, "BS - BackSpace"),
                      "MODE_TEXT" !== this.mode &&
                        (this.writeScreen.backSpace(),
                        this.writeScreen === this.displayedMemory &&
                          this.outputDataUpdate());
                  }),
                  (i.ccAOF = function () {}),
                  (i.ccAON = function () {}),
                  (i.ccDER = function () {
                    this.logger.log(2, "DER- Delete to End of Row"),
                      this.writeScreen.clearToEndOfRow(),
                      this.outputDataUpdate();
                  }),
                  (i.ccRU = function (t) {
                    this.logger.log(2, "RU(" + t + ") - Roll Up"),
                      (this.writeScreen = this.displayedMemory),
                      this.setMode("MODE_ROLL-UP"),
                      this.writeScreen.setRollUpRows(t);
                  }),
                  (i.ccFON = function () {
                    this.logger.log(2, "FON - Flash On"),
                      this.writeScreen.setPen({ flash: !0 });
                  }),
                  (i.ccRDC = function () {
                    this.logger.log(2, "RDC - Resume Direct Captioning"),
                      this.setMode("MODE_PAINT-ON");
                  }),
                  (i.ccTR = function () {
                    this.logger.log(2, "TR"), this.setMode("MODE_TEXT");
                  }),
                  (i.ccRTD = function () {
                    this.logger.log(2, "RTD"), this.setMode("MODE_TEXT");
                  }),
                  (i.ccEDM = function () {
                    this.logger.log(2, "EDM - Erase Displayed Memory"),
                      this.displayedMemory.reset(),
                      this.outputDataUpdate(!0);
                  }),
                  (i.ccCR = function () {
                    this.logger.log(2, "CR - Carriage Return"),
                      this.writeScreen.rollUp(),
                      this.outputDataUpdate(!0);
                  }),
                  (i.ccENM = function () {
                    this.logger.log(2, "ENM - Erase Non-displayed Memory"),
                      this.nonDisplayedMemory.reset();
                  }),
                  (i.ccEOC = function () {
                    var t = this;
                    if (
                      (this.logger.log(2, "EOC - End Of Caption"),
                      "MODE_POP-ON" === this.mode)
                    ) {
                      var i = this.displayedMemory;
                      (this.displayedMemory = this.nonDisplayedMemory),
                        (this.nonDisplayedMemory = i),
                        (this.writeScreen = this.nonDisplayedMemory),
                        this.logger.log(1, function () {
                          return "DISP: " + t.displayedMemory.getDisplayText();
                        });
                    }
                    this.outputDataUpdate(!0);
                  }),
                  (i.ccTO = function (t) {
                    this.logger.log(2, "TO(" + t + ") - Tab Offset"),
                      this.writeScreen.moveCursor(t);
                  }),
                  (i.ccMIDROW = function (t) {
                    var i = { flash: !1 };
                    if (
                      ((i.underline = t % 2 == 1),
                      (i.italics = t >= 46),
                      i.italics)
                    )
                      i.foreground = "white";
                    else {
                      var n = Math.floor(t / 2) - 16;
                      i.foreground = [
                        "white",
                        "green",
                        "blue",
                        "cyan",
                        "red",
                        "yellow",
                        "magenta",
                      ][n];
                    }
                    this.logger.log(2, "MIDROW: " + JSON.stringify(i)),
                      this.writeScreen.setPen(i);
                  }),
                  (i.outputDataUpdate = function (t) {
                    void 0 === t && (t = !1);
                    var i = this.logger.time;
                    null !== i &&
                      this.outputFilter &&
                      (null !== this.cueStartTime ||
                      this.displayedMemory.isEmpty()
                        ? this.displayedMemory.equals(this.lastOutputScreen) ||
                          (this.outputFilter.newCue(
                            this.cueStartTime,
                            i,
                            this.lastOutputScreen
                          ),
                          t &&
                            this.outputFilter.dispatchCue &&
                            this.outputFilter.dispatchCue(),
                          (this.cueStartTime = this.displayedMemory.isEmpty()
                            ? null
                            : i))
                        : (this.cueStartTime = i),
                      this.lastOutputScreen.copy(this.displayedMemory));
                  }),
                  (i.cueSplitAtTime = function (t) {
                    this.outputFilter &&
                      (this.displayedMemory.isEmpty() ||
                        (this.outputFilter.newCue &&
                          this.outputFilter.newCue(
                            this.cueStartTime,
                            t,
                            this.displayedMemory
                          ),
                        (this.cueStartTime = t)));
                  }),
                  t
                );
              })(),
              Ae = (function () {
                function t(t, i, n) {
                  (this.channels = void 0),
                    (this.currentChannel = 0),
                    (this.cmdHistory = void 0),
                    (this.logger = void 0);
                  var r = new we();
                  (this.channels = [
                    null,
                    new Se(t, i, r),
                    new Se(t + 1, n, r),
                  ]),
                    (this.cmdHistory = { a: null, b: null }),
                    (this.logger = r);
                }
                var i = t.prototype;
                return (
                  (i.getHandler = function (t) {
                    return this.channels[t].getHandler();
                  }),
                  (i.setHandler = function (t, i) {
                    this.channels[t].setHandler(i);
                  }),
                  (i.addData = function (t, i) {
                    var n,
                      r,
                      e,
                      s = !1;
                    this.logger.time = t;
                    for (var a = 0; a < i.length; a += 2)
                      if (
                        ((r = 127 & i[a]),
                        (e = 127 & i[a + 1]),
                        0 !== r || 0 !== e)
                      ) {
                        if (
                          (this.logger.log(
                            3,
                            "[" +
                              be([i[a], i[a + 1]]) +
                              "] -> (" +
                              be([r, e]) +
                              ")"
                          ),
                          (n = this.parseCmd(r, e)) ||
                            (n = this.parseMidrow(r, e)),
                          n || (n = this.parsePAC(r, e)),
                          n || (n = this.parseBackgroundAttributes(r, e)),
                          !n && (s = this.parseChars(r, e)))
                        ) {
                          var o = this.currentChannel;
                          o && o > 0
                            ? this.channels[o].insertChars(s)
                            : this.logger.log(
                                2,
                                "No channel found yet. TEXT-MODE?"
                              );
                        }
                        n ||
                          s ||
                          this.logger.log(
                            2,
                            "Couldn't parse cleaned data " +
                              be([r, e]) +
                              " orig: " +
                              be([i[a], i[a + 1]])
                          );
                      }
                  }),
                  (i.parseCmd = function (t, i) {
                    var n = this.cmdHistory;
                    if (
                      !(
                        ((20 === t || 28 === t || 21 === t || 29 === t) &&
                          i >= 32 &&
                          i <= 47) ||
                        ((23 === t || 31 === t) && i >= 33 && i <= 35)
                      )
                    )
                      return !1;
                    if (De(t, i, n))
                      return (
                        Me(null, null, n),
                        this.logger.log(
                          3,
                          "Repeated command (" + be([t, i]) + ") is dropped"
                        ),
                        !0
                      );
                    var r = 20 === t || 21 === t || 23 === t ? 1 : 2,
                      e = this.channels[r];
                    return (
                      20 === t || 21 === t || 28 === t || 29 === t
                        ? 32 === i
                          ? e.ccRCL()
                          : 33 === i
                          ? e.ccBS()
                          : 34 === i
                          ? e.ccAOF()
                          : 35 === i
                          ? e.ccAON()
                          : 36 === i
                          ? e.ccDER()
                          : 37 === i
                          ? e.ccRU(2)
                          : 38 === i
                          ? e.ccRU(3)
                          : 39 === i
                          ? e.ccRU(4)
                          : 40 === i
                          ? e.ccFON()
                          : 41 === i
                          ? e.ccRDC()
                          : 42 === i
                          ? e.ccTR()
                          : 43 === i
                          ? e.ccRTD()
                          : 44 === i
                          ? e.ccEDM()
                          : 45 === i
                          ? e.ccCR()
                          : 46 === i
                          ? e.ccENM()
                          : 47 === i && e.ccEOC()
                        : e.ccTO(i - 32),
                      Me(t, i, n),
                      (this.currentChannel = r),
                      !0
                    );
                  }),
                  (i.parseMidrow = function (t, i) {
                    var n = 0;
                    if ((17 === t || 25 === t) && i >= 32 && i <= 47) {
                      if ((n = 17 === t ? 1 : 2) !== this.currentChannel)
                        return (
                          this.logger.log(
                            0,
                            "Mismatch channel in midrow parsing"
                          ),
                          !1
                        );
                      var r = this.channels[n];
                      return (
                        !!r &&
                        (r.ccMIDROW(i),
                        this.logger.log(3, "MIDROW (" + be([t, i]) + ")"),
                        !0)
                      );
                    }
                    return !1;
                  }),
                  (i.parsePAC = function (t, i) {
                    var n,
                      r = this.cmdHistory;
                    if (
                      !(
                        (((t >= 17 && t <= 23) || (t >= 25 && t <= 31)) &&
                          i >= 64 &&
                          i <= 127) ||
                        ((16 === t || 24 === t) && i >= 64 && i <= 95)
                      )
                    )
                      return !1;
                    if (De(t, i, r)) return Me(null, null, r), !0;
                    var e = t <= 23 ? 1 : 2;
                    n =
                      i >= 64 && i <= 95
                        ? 1 === e
                          ? de[t]
                          : me[t]
                        : 1 === e
                        ? pe[t]
                        : ye[t];
                    var s = this.channels[e];
                    return (
                      !!s &&
                      (s.setPAC(this.interpretPAC(n, i)),
                      Me(t, i, r),
                      (this.currentChannel = e),
                      !0)
                    );
                  }),
                  (i.interpretPAC = function (t, i) {
                    var n,
                      r = {
                        color: null,
                        italics: !1,
                        indent: null,
                        underline: !1,
                        row: t,
                      };
                    return (
                      (n = i > 95 ? i - 96 : i - 64),
                      (r.underline = 1 == (1 & n)),
                      n <= 13
                        ? (r.color = [
                            "white",
                            "green",
                            "blue",
                            "cyan",
                            "red",
                            "yellow",
                            "magenta",
                            "white",
                          ][Math.floor(n / 2)])
                        : n <= 15
                        ? ((r.italics = !0), (r.color = "white"))
                        : (r.indent = 4 * Math.floor((n - 16) / 2)),
                      r
                    );
                  }),
                  (i.parseChars = function (t, i) {
                    var n,
                      r,
                      e = null,
                      s = null;
                    if (
                      (t >= 25 ? ((n = 2), (s = t - 8)) : ((n = 1), (s = t)),
                      s >= 17 && s <= 19
                        ? ((r =
                            17 === s ? i + 80 : 18 === s ? i + 112 : i + 144),
                          this.logger.log(
                            2,
                            "Special char '" + le(r) + "' in channel " + n
                          ),
                          (e = [r]))
                        : t >= 32 && t <= 127 && (e = 0 === i ? [t] : [t, i]),
                      e)
                    ) {
                      var a = be(e);
                      this.logger.log(3, "Char codes =  " + a.join(",")),
                        Me(t, i, this.cmdHistory);
                    }
                    return e;
                  }),
                  (i.parseBackgroundAttributes = function (t, i) {
                    var n;
                    if (
                      !(
                        ((16 === t || 24 === t) && i >= 32 && i <= 47) ||
                        ((23 === t || 31 === t) && i >= 45 && i <= 47)
                      )
                    )
                      return !1;
                    var r = {};
                    16 === t || 24 === t
                      ? ((n = Math.floor((i - 32) / 2)),
                        (r.background = ge[n]),
                        i % 2 == 1 && (r.background = r.background + "_semi"))
                      : 45 === i
                      ? (r.background = "transparent")
                      : ((r.foreground = "black"),
                        47 === i && (r.underline = !0));
                    var e = t <= 23 ? 1 : 2;
                    return (
                      this.channels[e].setBkgData(r),
                      Me(t, i, this.cmdHistory),
                      !0
                    );
                  }),
                  (i.reset = function () {
                    for (
                      var t = 0;
                      t < Object.keys(this.channels).length;
                      t++
                    ) {
                      var i = this.channels[t];
                      i && i.reset();
                    }
                    this.cmdHistory = { a: null, b: null };
                  }),
                  (i.cueSplitAtTime = function (t) {
                    for (var i = 0; i < this.channels.length; i++) {
                      var n = this.channels[i];
                      n && n.cueSplitAtTime(t);
                    }
                  }),
                  t
                );
              })();
            function Me(t, i, n) {
              (n.a = t), (n.b = i);
            }
            function De(t, i, n) {
              return n.a === t && n.b === i;
            }
            var _e = (function () {
                function t(t, i) {
                  (this.timelineController = void 0),
                    (this.cueRanges = []),
                    (this.trackName = void 0),
                    (this.startTime = null),
                    (this.endTime = null),
                    (this.screen = null),
                    (this.timelineController = t),
                    (this.trackName = i);
                }
                var i = t.prototype;
                return (
                  (i.dispatchCue = function () {
                    null !== this.startTime &&
                      (this.timelineController.addCues(
                        this.trackName,
                        this.startTime,
                        this.endTime,
                        this.screen,
                        this.cueRanges
                      ),
                      (this.startTime = null));
                  }),
                  (i.newCue = function (t, i, n) {
                    (null === this.startTime || this.startTime > t) &&
                      (this.startTime = t),
                      (this.endTime = i),
                      (this.screen = n),
                      this.timelineController.createCaptionsTrack(
                        this.trackName
                      );
                  }),
                  (i.reset = function () {
                    (this.cueRanges = []), (this.startTime = null);
                  }),
                  t
                );
              })(),
              Oe = (function () {
                if ("undefined" != typeof self && self.VTTCue)
                  return self.VTTCue;
                var t = ["", "lr", "rl"],
                  i = ["start", "middle", "end", "left", "right"];
                function n(t, i) {
                  if ("string" != typeof i) return !1;
                  if (!Array.isArray(t)) return !1;
                  var n = i.toLowerCase();
                  return !!~t.indexOf(n) && n;
                }
                function r(t) {
                  return n(i, t);
                }
                function e(t) {
                  for (
                    var i = arguments.length,
                      n = new Array(i > 1 ? i - 1 : 0),
                      r = 1;
                    r < i;
                    r++
                  )
                    n[r - 1] = arguments[r];
                  for (var e = 1; e < arguments.length; e++) {
                    var s = arguments[e];
                    for (var a in s) t[a] = s[a];
                  }
                  return t;
                }
                function s(i, s, a) {
                  var o = this,
                    h = { enumerable: !0 };
                  o.hasBeenReset = !1;
                  var u = "",
                    f = !1,
                    l = i,
                    c = s,
                    v = a,
                    d = null,
                    p = "",
                    m = !0,
                    y = "auto",
                    g = "start",
                    w = 50,
                    b = "middle",
                    k = 50,
                    E = "middle";
                  Object.defineProperty(
                    o,
                    "id",
                    e({}, h, {
                      get: function () {
                        return u;
                      },
                      set: function (t) {
                        u = "" + t;
                      },
                    })
                  ),
                    Object.defineProperty(
                      o,
                      "pauseOnExit",
                      e({}, h, {
                        get: function () {
                          return f;
                        },
                        set: function (t) {
                          f = !!t;
                        },
                      })
                    ),
                    Object.defineProperty(
                      o,
                      "startTime",
                      e({}, h, {
                        get: function () {
                          return l;
                        },
                        set: function (t) {
                          if ("number" != typeof t)
                            throw new TypeError(
                              "Start time must be set to a number."
                            );
                          (l = t), (this.hasBeenReset = !0);
                        },
                      })
                    ),
                    Object.defineProperty(
                      o,
                      "endTime",
                      e({}, h, {
                        get: function () {
                          return c;
                        },
                        set: function (t) {
                          if ("number" != typeof t)
                            throw new TypeError(
                              "End time must be set to a number."
                            );
                          (c = t), (this.hasBeenReset = !0);
                        },
                      })
                    ),
                    Object.defineProperty(
                      o,
                      "text",
                      e({}, h, {
                        get: function () {
                          return v;
                        },
                        set: function (t) {
                          (v = "" + t), (this.hasBeenReset = !0);
                        },
                      })
                    ),
                    Object.defineProperty(
                      o,
                      "region",
                      e({}, h, {
                        get: function () {
                          return d;
                        },
                        set: function (t) {
                          (d = t), (this.hasBeenReset = !0);
                        },
                      })
                    ),
                    Object.defineProperty(
                      o,
                      "vertical",
                      e({}, h, {
                        get: function () {
                          return p;
                        },
                        set: function (i) {
                          var r = (function (i) {
                            return n(t, i);
                          })(i);
                          if (!1 === r)
                            throw new SyntaxError(
                              "An invalid or illegal string was specified."
                            );
                          (p = r), (this.hasBeenReset = !0);
                        },
                      })
                    ),
                    Object.defineProperty(
                      o,
                      "snapToLines",
                      e({}, h, {
                        get: function () {
                          return m;
                        },
                        set: function (t) {
                          (m = !!t), (this.hasBeenReset = !0);
                        },
                      })
                    ),
                    Object.defineProperty(
                      o,
                      "line",
                      e({}, h, {
                        get: function () {
                          return y;
                        },
                        set: function (t) {
                          if ("number" != typeof t && "auto" !== t)
                            throw new SyntaxError(
                              "An invalid number or illegal string was specified."
                            );
                          (y = t), (this.hasBeenReset = !0);
                        },
                      })
                    ),
                    Object.defineProperty(
                      o,
                      "lineAlign",
                      e({}, h, {
                        get: function () {
                          return g;
                        },
                        set: function (t) {
                          var i = r(t);
                          if (!i)
                            throw new SyntaxError(
                              "An invalid or illegal string was specified."
                            );
                          (g = i), (this.hasBeenReset = !0);
                        },
                      })
                    ),
                    Object.defineProperty(
                      o,
                      "position",
                      e({}, h, {
                        get: function () {
                          return w;
                        },
                        set: function (t) {
                          if (t < 0 || t > 100)
                            throw new Error(
                              "Position must be between 0 and 100."
                            );
                          (w = t), (this.hasBeenReset = !0);
                        },
                      })
                    ),
                    Object.defineProperty(
                      o,
                      "positionAlign",
                      e({}, h, {
                        get: function () {
                          return b;
                        },
                        set: function (t) {
                          var i = r(t);
                          if (!i)
                            throw new SyntaxError(
                              "An invalid or illegal string was specified."
                            );
                          (b = i), (this.hasBeenReset = !0);
                        },
                      })
                    ),
                    Object.defineProperty(
                      o,
                      "size",
                      e({}, h, {
                        get: function () {
                          return k;
                        },
                        set: function (t) {
                          if (t < 0 || t > 100)
                            throw new Error("Size must be between 0 and 100.");
                          (k = t), (this.hasBeenReset = !0);
                        },
                      })
                    ),
                    Object.defineProperty(
                      o,
                      "align",
                      e({}, h, {
                        get: function () {
                          return E;
                        },
                        set: function (t) {
                          var i = r(t);
                          if (!i)
                            throw new SyntaxError(
                              "An invalid or illegal string was specified."
                            );
                          (E = i), (this.hasBeenReset = !0);
                        },
                      })
                    ),
                    (o.displayState = void 0);
                }
                return (
                  (s.prototype.getCueAsHTML = function () {
                    return self.WebVTT.convertCueToDOMTree(self, this.text);
                  }),
                  s
                );
              })(),
              Re = (function () {
                function t() {}
                return (
                  (t.prototype.decode = function (t, i) {
                    if (!t) return "";
                    if ("string" != typeof t)
                      throw new Error("Error - expected string data.");
                    return decodeURIComponent(encodeURIComponent(t));
                  }),
                  t
                );
              })();
            function Le(t) {
              function i(t, i, n, r) {
                return (
                  3600 * (0 | t) + 60 * (0 | i) + (0 | n) + parseFloat(r || 0)
                );
              }
              var n = t.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);
              return n
                ? parseFloat(n[2]) > 59
                  ? i(n[2], n[3], 0, n[4])
                  : i(n[1], n[2], n[3], n[4])
                : null;
            }
            var Ie = (function () {
              function t() {
                this.values = Object.create(null);
              }
              var i = t.prototype;
              return (
                (i.set = function (t, i) {
                  this.get(t) || "" === i || (this.values[t] = i);
                }),
                (i.get = function (t, i, n) {
                  return n
                    ? this.has(t)
                      ? this.values[t]
                      : i[n]
                    : this.has(t)
                    ? this.values[t]
                    : i;
                }),
                (i.has = function (t) {
                  return t in this.values;
                }),
                (i.alt = function (t, i, n) {
                  for (var r = 0; r < n.length; ++r)
                    if (i === n[r]) {
                      this.set(t, i);
                      break;
                    }
                }),
                (i.integer = function (t, i) {
                  /^-?\d+$/.test(i) && this.set(t, parseInt(i, 10));
                }),
                (i.percent = function (t, i) {
                  if (/^([\d]{1,3})(\.[\d]*)?%$/.test(i)) {
                    var n = parseFloat(i);
                    if (n >= 0 && n <= 100) return this.set(t, n), !0;
                  }
                  return !1;
                }),
                t
              );
            })();
            function Pe(t, i, n, r) {
              var e = r ? t.split(r) : [t];
              for (var s in e)
                if ("string" == typeof e[s]) {
                  var a = e[s].split(n);
                  2 === a.length && i(a[0], a[1]);
                }
            }
            var Ce = new Oe(0, 0, ""),
              Ne = "middle" === Ce.align ? "middle" : "center";
            function Ue(t, i, n) {
              var r = t;
              function e() {
                var i = Le(t);
                if (null === i) throw new Error("Malformed timestamp: " + r);
                return (t = t.replace(/^[^\sa-zA-Z-]+/, "")), i;
              }
              function s() {
                t = t.replace(/^\s+/, "");
              }
              if ((s(), (i.startTime = e()), s(), "--\x3e" !== t.slice(0, 3)))
                throw new Error(
                  "Malformed time stamp (time stamps must be separated by '--\x3e'): " +
                    r
                );
              (t = t.slice(3)),
                s(),
                (i.endTime = e()),
                s(),
                (function (t, i) {
                  var r = new Ie();
                  Pe(
                    t,
                    function (t, i) {
                      var e;
                      switch (t) {
                        case "region":
                          for (var s = n.length - 1; s >= 0; s--)
                            if (n[s].id === i) {
                              r.set(t, n[s].region);
                              break;
                            }
                          break;
                        case "vertical":
                          r.alt(t, i, ["rl", "lr"]);
                          break;
                        case "line":
                          (e = i.split(",")),
                            r.integer(t, e[0]),
                            r.percent(t, e[0]) && r.set("snapToLines", !1),
                            r.alt(t, e[0], ["auto"]),
                            2 === e.length &&
                              r.alt("lineAlign", e[1], ["start", Ne, "end"]);
                          break;
                        case "position":
                          (e = i.split(",")),
                            r.percent(t, e[0]),
                            2 === e.length &&
                              r.alt("positionAlign", e[1], [
                                "start",
                                Ne,
                                "end",
                                "line-left",
                                "line-right",
                                "auto",
                              ]);
                          break;
                        case "size":
                          r.percent(t, i);
                          break;
                        case "align":
                          r.alt(t, i, ["start", Ne, "end", "left", "right"]);
                      }
                    },
                    /:/,
                    /\s/
                  ),
                    (i.region = r.get("region", null)),
                    (i.vertical = r.get("vertical", ""));
                  var e = r.get("line", "auto");
                  "auto" === e && -1 === Ce.line && (e = -1),
                    (i.line = e),
                    (i.lineAlign = r.get("lineAlign", "start")),
                    (i.snapToLines = r.get("snapToLines", !0)),
                    (i.size = r.get("size", 100)),
                    (i.align = r.get("align", Ne));
                  var s = r.get("position", "auto");
                  "auto" === s &&
                    50 === Ce.position &&
                    (s =
                      "start" === i.align || "left" === i.align
                        ? 0
                        : "end" === i.align || "right" === i.align
                        ? 100
                        : 50),
                    (i.position = s);
                })(t, i);
            }
            function Fe(t) {
              return t.replace(/<br(?: \/)?>/gi, "\n");
            }
            var je = (function () {
                function t() {
                  (this.state = "INITIAL"),
                    (this.buffer = ""),
                    (this.decoder = new Re()),
                    (this.regionList = []),
                    (this.cue = null),
                    (this.oncue = void 0),
                    (this.onparsingerror = void 0),
                    (this.onflush = void 0);
                }
                var i = t.prototype;
                return (
                  (i.parse = function (t) {
                    var i = this;
                    function n() {
                      var t = i.buffer,
                        n = 0;
                      for (
                        t = Fe(t);
                        n < t.length && "\r" !== t[n] && "\n" !== t[n];

                      )
                        ++n;
                      var r = t.slice(0, n);
                      return (
                        "\r" === t[n] && ++n,
                        "\n" === t[n] && ++n,
                        (i.buffer = t.slice(n)),
                        r
                      );
                    }
                    t && (i.buffer += i.decoder.decode(t, { stream: !0 }));
                    try {
                      var r = "";
                      if ("INITIAL" === i.state) {
                        if (!/\r\n|\n/.test(i.buffer)) return this;
                        var e = (r = n()).match(/^()?WEBVTT([ \t].*)?$/);
                        if (null == e || !e[0])
                          throw new Error("Malformed WebVTT signature.");
                        i.state = "HEADER";
                      }
                      for (var s = !1; i.buffer; ) {
                        if (!/\r\n|\n/.test(i.buffer)) return this;
                        switch ((s ? (s = !1) : (r = n()), i.state)) {
                          case "HEADER":
                            /:/.test(r)
                              ? Pe(r, function (t, i) {}, /:/)
                              : r || (i.state = "ID");
                            continue;
                          case "NOTE":
                            r || (i.state = "ID");
                            continue;
                          case "ID":
                            if (/^NOTE($|[ \t])/.test(r)) {
                              i.state = "NOTE";
                              break;
                            }
                            if (!r) continue;
                            if (
                              ((i.cue = new Oe(0, 0, "")),
                              (i.state = "CUE"),
                              -1 === r.indexOf("--\x3e"))
                            ) {
                              i.cue.id = r;
                              continue;
                            }
                          case "CUE":
                            if (!i.cue) {
                              i.state = "BADCUE";
                              continue;
                            }
                            try {
                              Ue(r, i.cue, i.regionList);
                            } catch (t) {
                              (i.cue = null), (i.state = "BADCUE");
                              continue;
                            }
                            i.state = "CUETEXT";
                            continue;
                          case "CUETEXT":
                            var a = -1 !== r.indexOf("--\x3e");
                            if (!r || (a && (s = !0))) {
                              i.oncue && i.cue && i.oncue(i.cue),
                                (i.cue = null),
                                (i.state = "ID");
                              continue;
                            }
                            if (null === i.cue) continue;
                            i.cue.text && (i.cue.text += "\n"),
                              (i.cue.text += r);
                            continue;
                          case "BADCUE":
                            r || (i.state = "ID");
                        }
                      }
                    } catch (t) {
                      "CUETEXT" === i.state &&
                        i.cue &&
                        i.oncue &&
                        i.oncue(i.cue),
                        (i.cue = null),
                        (i.state =
                          "INITIAL" === i.state ? "BADWEBVTT" : "BADCUE");
                    }
                    return this;
                  }),
                  (i.flush = function () {
                    var t = this;
                    try {
                      if (
                        ((t.cue || "HEADER" === t.state) &&
                          ((t.buffer += "\n\n"), t.parse()),
                        "INITIAL" === t.state || "BADWEBVTT" === t.state)
                      )
                        throw new Error("Malformed WebVTT signature.");
                    } catch (i) {
                      t.onparsingerror && t.onparsingerror(i);
                    }
                    return t.onflush && t.onflush(), this;
                  }),
                  t
                );
              })(),
              Be = /\r\n|\n\r|\n|\r/g,
              Xe = function (t, i, n) {
                return void 0 === n && (n = 0), t.slice(n, n + i.length) === i;
              },
              Ye = function (t) {
                for (var i = 5381, n = t.length; n; )
                  i = (33 * i) ^ t.charCodeAt(--n);
                return (i >>> 0).toString();
              };
            function $e(t, i, n) {
              return Ye(t.toString()) + Ye(i.toString()) + Ye(n);
            }
            var He = "stpp.ttml.im1t",
              Ve = /^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,
              Ge = /^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,
              We = {
                left: "start",
                center: "center",
                right: "end",
                start: "start",
                end: "end",
              };
            function Ke(t, i, n, r) {
              var e = Tt(new Uint8Array(t), ["mdat"]);
              if (0 !== e.length) {
                var s,
                  a,
                  h,
                  u = e.map(function (t) {
                    return vt(t);
                  }),
                  f =
                    ((s = i.baseTime),
                    1,
                    void 0 === (a = i.timescale) && (a = 1),
                    void 0 === h && (h = !1),
                    br(s, 1, 1 / a, h));
                try {
                  u.forEach(function (t) {
                    return n(
                      (function (t, i) {
                        var n = new DOMParser()
                          .parseFromString(t, "text/xml")
                          .getElementsByTagName("tt")[0];
                        if (!n) throw new Error("Invalid ttml");
                        var r = {
                            frameRate: 30,
                            subFrameRate: 1,
                            frameRateMultiplier: 0,
                            tickRate: 0,
                          },
                          e = Object.keys(r).reduce(function (t, i) {
                            return (
                              (t[i] = n.getAttribute("ttp:" + i) || r[i]), t
                            );
                          }, {}),
                          s = "preserve" !== n.getAttribute("xml:space"),
                          a = qe(ze(n, "styling", "style")),
                          h = qe(ze(n, "layout", "region")),
                          u = ze(n, "body", "[begin]");
                        return [].map
                          .call(u, function (t) {
                            var n = Je(t, s);
                            if (!n || !t.hasAttribute("begin")) return null;
                            var r = ts(t.getAttribute("begin"), e),
                              u = ts(t.getAttribute("dur"), e),
                              f = ts(t.getAttribute("end"), e);
                            if (null === r) throw Ze(t);
                            if (null === f) {
                              if (null === u) throw Ze(t);
                              f = r + u;
                            }
                            var l = new Oe(r - i, f - i, n);
                            l.id = $e(l.startTime, l.endTime, l.text);
                            var c = (function (t, i, n) {
                                var r = "http://www.w3.org/ns/ttml#styling",
                                  e = null,
                                  s =
                                    null != t && t.hasAttribute("style")
                                      ? t.getAttribute("style")
                                      : null;
                                return (
                                  s && n.hasOwnProperty(s) && (e = n[s]),
                                  [
                                    "displayAlign",
                                    "textAlign",
                                    "color",
                                    "backgroundColor",
                                    "fontSize",
                                    "fontFamily",
                                  ].reduce(function (n, s) {
                                    var a =
                                      Qe(i, r, s) || Qe(t, r, s) || Qe(e, r, s);
                                    return a && (n[s] = a), n;
                                  }, {})
                                );
                              })(
                                h[t.getAttribute("region")],
                                a[t.getAttribute("style")],
                                a
                              ),
                              v = c.textAlign;
                            if (v) {
                              var d = We[v];
                              d && (l.lineAlign = d), (l.align = v);
                            }
                            return o(l, c), l;
                          })
                          .filter(function (t) {
                            return null !== t;
                          });
                      })(t, f)
                    );
                  });
                } catch (t) {
                  r(t);
                }
              } else r(new Error("Could not parse IMSC1 mdat"));
            }
            function ze(t, i, n) {
              var r = t.getElementsByTagName(i)[0];
              return r ? [].slice.call(r.querySelectorAll(n)) : [];
            }
            function qe(t) {
              return t.reduce(function (t, i) {
                var n = i.getAttribute("xml:id");
                return n && (t[n] = i), t;
              }, {});
            }
            function Je(t, i) {
              return [].slice.call(t.childNodes).reduce(function (t, n, r) {
                var e;
                return "br" === n.nodeName && r
                  ? t + "\n"
                  : null != (e = n.childNodes) && e.length
                  ? Je(n, i)
                  : i
                  ? t + n.textContent.trim().replace(/\s+/g, " ")
                  : t + n.textContent;
              }, "");
            }
            function Qe(t, i, n) {
              return t && t.hasAttributeNS(i, n)
                ? t.getAttributeNS(i, n)
                : null;
            }
            function Ze(t) {
              return new Error("Could not parse ttml timestamp " + t);
            }
            function ts(t, i) {
              if (!t) return null;
              var n = Le(t);
              return (
                null === n &&
                  (Ve.test(t)
                    ? (n = (function (t, i) {
                        var n = Ve.exec(t),
                          r = (0 | n[4]) + (0 | n[5]) / i.subFrameRate;
                        return (
                          3600 * (0 | n[1]) +
                          60 * (0 | n[2]) +
                          (0 | n[3]) +
                          r / i.frameRate
                        );
                      })(t, i))
                    : Ge.test(t) &&
                      (n = (function (t, i) {
                        var n = Ge.exec(t),
                          r = Number(n[1]);
                        switch (n[2]) {
                          case "h":
                            return 3600 * r;
                          case "m":
                            return 60 * r;
                          case "ms":
                            return 1e3 * r;
                          case "f":
                            return r / i.frameRate;
                          case "t":
                            return r / i.tickRate;
                        }
                        return r;
                      })(t, i))),
                n
              );
            }
            var is = (function () {
              function t(t) {
                if (
                  ((this.hls = void 0),
                  (this.media = null),
                  (this.config = void 0),
                  (this.enabled = !0),
                  (this.Cues = void 0),
                  (this.textTracks = []),
                  (this.tracks = []),
                  (this.initPTS = []),
                  (this.unparsedVttFrags = []),
                  (this.captionsTracks = {}),
                  (this.nonNativeCaptionsTracks = {}),
                  (this.cea608Parser1 = void 0),
                  (this.cea608Parser2 = void 0),
                  (this.lastSn = -1),
                  (this.lastPartIndex = -1),
                  (this.prevCC = -1),
                  (this.vttCCs = {
                    ccOffset: 0,
                    presentationOffset: 0,
                    0: { start: 0, prevCC: -1, new: !0 },
                  }),
                  (this.captionsProperties = void 0),
                  (this.hls = t),
                  (this.config = t.config),
                  (this.Cues = t.config.cueHandler),
                  (this.captionsProperties = {
                    textTrack1: {
                      label: this.config.captionsTextTrack1Label,
                      languageCode: this.config.captionsTextTrack1LanguageCode,
                    },
                    textTrack2: {
                      label: this.config.captionsTextTrack2Label,
                      languageCode: this.config.captionsTextTrack2LanguageCode,
                    },
                    textTrack3: {
                      label: this.config.captionsTextTrack3Label,
                      languageCode: this.config.captionsTextTrack3LanguageCode,
                    },
                    textTrack4: {
                      label: this.config.captionsTextTrack4Label,
                      languageCode: this.config.captionsTextTrack4LanguageCode,
                    },
                  }),
                  this.config.enableCEA708Captions)
                ) {
                  var i = new _e(this, "textTrack1"),
                    n = new _e(this, "textTrack2"),
                    r = new _e(this, "textTrack3"),
                    e = new _e(this, "textTrack4");
                  (this.cea608Parser1 = new Ae(1, i, n)),
                    (this.cea608Parser2 = new Ae(3, r, e));
                }
                t.on(w.MEDIA_ATTACHING, this.onMediaAttaching, this),
                  t.on(w.MEDIA_DETACHING, this.onMediaDetaching, this),
                  t.on(w.MANIFEST_LOADING, this.onManifestLoading, this),
                  t.on(w.MANIFEST_LOADED, this.onManifestLoaded, this),
                  t.on(
                    w.SUBTITLE_TRACKS_UPDATED,
                    this.onSubtitleTracksUpdated,
                    this
                  ),
                  t.on(w.FRAG_LOADING, this.onFragLoading, this),
                  t.on(w.FRAG_LOADED, this.onFragLoaded, this),
                  t.on(
                    w.FRAG_PARSING_USERDATA,
                    this.onFragParsingUserdata,
                    this
                  ),
                  t.on(w.FRAG_DECRYPTED, this.onFragDecrypted, this),
                  t.on(w.INIT_PTS_FOUND, this.onInitPtsFound, this),
                  t.on(
                    w.SUBTITLE_TRACKS_CLEARED,
                    this.onSubtitleTracksCleared,
                    this
                  ),
                  t.on(w.BUFFER_FLUSHING, this.onBufferFlushing, this);
              }
              var i = t.prototype;
              return (
                (i.destroy = function () {
                  var t = this.hls;
                  t.off(w.MEDIA_ATTACHING, this.onMediaAttaching, this),
                    t.off(w.MEDIA_DETACHING, this.onMediaDetaching, this),
                    t.off(w.MANIFEST_LOADING, this.onManifestLoading, this),
                    t.off(w.MANIFEST_LOADED, this.onManifestLoaded, this),
                    t.off(
                      w.SUBTITLE_TRACKS_UPDATED,
                      this.onSubtitleTracksUpdated,
                      this
                    ),
                    t.off(w.FRAG_LOADING, this.onFragLoading, this),
                    t.off(w.FRAG_LOADED, this.onFragLoaded, this),
                    t.off(
                      w.FRAG_PARSING_USERDATA,
                      this.onFragParsingUserdata,
                      this
                    ),
                    t.off(w.FRAG_DECRYPTED, this.onFragDecrypted, this),
                    t.off(w.INIT_PTS_FOUND, this.onInitPtsFound, this),
                    t.off(
                      w.SUBTITLE_TRACKS_CLEARED,
                      this.onSubtitleTracksCleared,
                      this
                    ),
                    t.off(w.BUFFER_FLUSHING, this.onBufferFlushing, this),
                    (this.hls =
                      this.config =
                      this.cea608Parser1 =
                      this.cea608Parser2 =
                        null);
                }),
                (i.addCues = function (t, i, n, r, e) {
                  for (var s, a, o, h, u = !1, f = e.length; f--; ) {
                    var l = e[f],
                      c =
                        ((s = l[0]),
                        (a = l[1]),
                        (o = i),
                        (h = n),
                        Math.min(a, h) - Math.max(s, o));
                    if (
                      c >= 0 &&
                      ((l[0] = Math.min(l[0], i)),
                      (l[1] = Math.max(l[1], n)),
                      (u = !0),
                      c / (n - i) > 0.5)
                    )
                      return;
                  }
                  if (
                    (u || e.push([i, n]), this.config.renderTextTracksNatively)
                  ) {
                    var v = this.captionsTracks[t];
                    this.Cues.newCue(v, i, n, r);
                  } else {
                    var d = this.Cues.newCue(null, i, n, r);
                    this.hls.trigger(w.CUES_PARSED, {
                      type: "captions",
                      cues: d,
                      track: t,
                    });
                  }
                }),
                (i.onInitPtsFound = function (t, i) {
                  var n = this,
                    r = i.frag,
                    e = i.id,
                    s = i.initPTS,
                    a = i.timescale,
                    o = this.unparsedVttFrags;
                  "main" === e &&
                    (this.initPTS[r.cc] = { baseTime: s, timescale: a }),
                    o.length &&
                      ((this.unparsedVttFrags = []),
                      o.forEach(function (t) {
                        n.onFragLoaded(w.FRAG_LOADED, t);
                      }));
                }),
                (i.getExistingTrack = function (t) {
                  var i = this.media;
                  if (i)
                    for (var n = 0; n < i.textTracks.length; n++) {
                      var r = i.textTracks[n];
                      if (r[t]) return r;
                    }
                  return null;
                }),
                (i.createCaptionsTrack = function (t) {
                  this.config.renderTextTracksNatively
                    ? this.createNativeTrack(t)
                    : this.createNonNativeTrack(t);
                }),
                (i.createNativeTrack = function (t) {
                  if (!this.captionsTracks[t]) {
                    var i = this.captionsProperties,
                      n = this.captionsTracks,
                      r = this.media,
                      e = i[t],
                      s = e.label,
                      a = e.languageCode,
                      o = this.getExistingTrack(t);
                    if (o) (n[t] = o), mi(n[t]), di(n[t], r);
                    else {
                      var h = this.createTextTrack("captions", s, a);
                      h && ((h[t] = !0), (n[t] = h));
                    }
                  }
                }),
                (i.createNonNativeTrack = function (t) {
                  if (!this.nonNativeCaptionsTracks[t]) {
                    var i = this.captionsProperties[t];
                    if (i) {
                      var n = {
                        Ot: t,
                        label: i.label,
                        kind: "captions",
                        default: !!i.media && !!i.media.default,
                        closedCaptions: i.media,
                      };
                      (this.nonNativeCaptionsTracks[t] = n),
                        this.hls.trigger(w.NON_NATIVE_TEXT_TRACKS_FOUND, {
                          tracks: [n],
                        });
                    }
                  }
                }),
                (i.createTextTrack = function (t, i, n) {
                  var r = this.media;
                  if (r) return r.addTextTrack(t, i, n);
                }),
                (i.onMediaAttaching = function (t, i) {
                  (this.media = i.media), this.Rt();
                }),
                (i.onMediaDetaching = function () {
                  var t = this.captionsTracks;
                  Object.keys(t).forEach(function (i) {
                    mi(t[i]), delete t[i];
                  }),
                    (this.nonNativeCaptionsTracks = {});
                }),
                (i.onManifestLoading = function () {
                  (this.lastSn = -1),
                    (this.lastPartIndex = -1),
                    (this.prevCC = -1),
                    (this.vttCCs = {
                      ccOffset: 0,
                      presentationOffset: 0,
                      0: { start: 0, prevCC: -1, new: !0 },
                    }),
                    this.Rt(),
                    (this.tracks = []),
                    (this.captionsTracks = {}),
                    (this.nonNativeCaptionsTracks = {}),
                    (this.textTracks = []),
                    (this.unparsedVttFrags = this.unparsedVttFrags || []),
                    (this.initPTS = []),
                    this.cea608Parser1 &&
                      this.cea608Parser2 &&
                      (this.cea608Parser1.reset(), this.cea608Parser2.reset());
                }),
                (i.Rt = function () {
                  var t = this.media;
                  if (t) {
                    var i = t.textTracks;
                    if (i) for (var n = 0; n < i.length; n++) mi(i[n]);
                  }
                }),
                (i.onSubtitleTracksUpdated = function (t, i) {
                  var n = this,
                    r = i.subtitleTracks || [],
                    e = r.some(function (t) {
                      return t.textCodec === He;
                    });
                  if (
                    this.config.enableWebVTT ||
                    (e && this.config.enableIMSC1)
                  ) {
                    if (te(this.tracks, r)) return void (this.tracks = r);
                    if (
                      ((this.textTracks = []),
                      (this.tracks = r),
                      this.config.renderTextTracksNatively)
                    ) {
                      var s = this.media ? this.media.textTracks : null;
                      this.tracks.forEach(function (t, i) {
                        var r;
                        if (s && i < s.length) {
                          for (var e = null, a = 0; a < s.length; a++)
                            if (ns(s[a], t)) {
                              e = s[a];
                              break;
                            }
                          e && (r = e);
                        }
                        if (r) mi(r);
                        else {
                          var o = n.Lt(t);
                          (r = n.createTextTrack(o, t.name, t.lang)) &&
                            (r.mode = "disabled");
                        }
                        r && ((r.groupId = t.groupId), n.textTracks.push(r));
                      });
                    } else if (this.tracks.length) {
                      var a = this.tracks.map(function (t) {
                        return {
                          label: t.name,
                          kind: t.type.toLowerCase(),
                          default: t.default,
                          subtitleTrack: t,
                        };
                      });
                      this.hls.trigger(w.NON_NATIVE_TEXT_TRACKS_FOUND, {
                        tracks: a,
                      });
                    }
                  }
                }),
                (i.Lt = function (t) {
                  if (t.attrs.CHARACTERISTICS) {
                    var i = /transcribes-spoken-dialog/gi.test(
                        t.attrs.CHARACTERISTICS
                      ),
                      n = /describes-music-and-sound/gi.test(
                        t.attrs.CHARACTERISTICS
                      );
                    if (i && n) return "captions";
                  }
                  return "subtitles";
                }),
                (i.onManifestLoaded = function (t, i) {
                  var n = this;
                  this.config.enableCEA708Captions &&
                    i.captions &&
                    i.captions.forEach(function (t) {
                      var i = /(?:CC|SERVICE)([1-4])/.exec(t.instreamId);
                      if (i) {
                        var r = "textTrack" + i[1],
                          e = n.captionsProperties[r];
                        e &&
                          ((e.label = t.name),
                          t.lang && (e.languageCode = t.lang),
                          (e.media = t));
                      }
                    });
                }),
                (i.closedCaptionsForLevel = function (t) {
                  var i = this.hls.levels[t.level];
                  return null == i ? void 0 : i.attrs["CLOSED-CAPTIONS"];
                }),
                (i.onFragLoading = function (t, i) {
                  var n = this.cea608Parser1,
                    r = this.cea608Parser2,
                    e = this.lastSn,
                    s = this.lastPartIndex;
                  if (this.enabled && n && r && i.frag.type === hi) {
                    var a,
                      o,
                      h = i.frag.sn,
                      u =
                        null !=
                        (a =
                          null == i || null == (o = i.part) ? void 0 : o.index)
                          ? a
                          : -1;
                    h === e + 1 ||
                      (h === e && u === s + 1) ||
                      (n.reset(), r.reset()),
                      (this.lastSn = h),
                      (this.lastPartIndex = u);
                  }
                }),
                (i.onFragLoaded = function (t, i) {
                  var n = i.frag,
                    r = i.payload,
                    e = this.initPTS,
                    s = this.unparsedVttFrags;
                  if (n.type === fi)
                    if (r.byteLength) {
                      if (!e[n.cc])
                        return (
                          s.push(i),
                          void (
                            e.length &&
                            this.hls.trigger(w.SUBTITLE_FRAG_PROCESSED, {
                              success: !1,
                              frag: n,
                              error: new Error("Missing initial subtitle PTS"),
                            })
                          )
                        );
                      var a = n.decryptdata,
                        o = "stats" in i;
                      if (null == a || !a.encrypted || o) {
                        var h = this.tracks[n.level],
                          u = this.vttCCs;
                        u[n.cc] ||
                          ((u[n.cc] = {
                            start: n.start,
                            prevCC: this.prevCC,
                            new: !0,
                          }),
                          (this.prevCC = n.cc)),
                          h && h.textCodec === He
                            ? this.It(n, r)
                            : this.Pt(n, r, u);
                      }
                    } else
                      this.hls.trigger(w.SUBTITLE_FRAG_PROCESSED, {
                        success: !1,
                        frag: n,
                        error: new Error("Empty subtitle payload"),
                      });
                }),
                (i.It = function (t, i) {
                  var n = this,
                    r = this.hls;
                  Ke(
                    i,
                    this.initPTS[t.cc],
                    function (i) {
                      n.Ct(i, t.level),
                        r.trigger(w.SUBTITLE_FRAG_PROCESSED, {
                          success: !0,
                          frag: t,
                        });
                    },
                    function (i) {
                      A.log("Failed to parse IMSC1: " + i),
                        r.trigger(w.SUBTITLE_FRAG_PROCESSED, {
                          success: !1,
                          frag: t,
                          error: i,
                        });
                    }
                  );
                }),
                (i.Pt = function (t, i, n) {
                  var r,
                    e = this,
                    s = this.hls;
                  !(function (t, i, n, r, e, s, a) {
                    var o,
                      h,
                      u,
                      f = new je(),
                      l = vt(new Uint8Array(t))
                        .trim()
                        .replace(Be, "\n")
                        .split("\n"),
                      c = [],
                      v =
                        ((o = i.baseTime),
                        void 0 === (h = i.timescale) && (h = 1),
                        br(o, 9e4, 1 / h)),
                      d = "00:00.000",
                      p = 0,
                      m = 0,
                      y = !0;
                    (f.oncue = function (t) {
                      var i = n[r],
                        s = n.ccOffset,
                        a = (p - v) / 9e4;
                      null != i &&
                        i.new &&
                        (void 0 !== m
                          ? (s = n.ccOffset = i.start)
                          : (function (t, i, n) {
                              var r = t[i],
                                e = t[r.prevCC];
                              if (!e || (!e.new && r.new))
                                return (
                                  (t.ccOffset = t.presentationOffset = r.start),
                                  void (r.new = !1)
                                );
                              for (; null != (s = e) && s.new; ) {
                                var s;
                                (t.ccOffset += r.start - e.start),
                                  (r.new = !1),
                                  (e = t[(r = e).prevCC]);
                              }
                              t.presentationOffset = n;
                            })(n, r, a)),
                        a && (s = a - n.presentationOffset);
                      var o = t.endTime - t.startTime,
                        h = Sr(9e4 * (t.startTime + s - m), 9e4 * e) / 9e4;
                      (t.startTime = Math.max(h, 0)),
                        (t.endTime = Math.max(h + o, 0));
                      var u = t.text.trim();
                      (t.text = decodeURIComponent(encodeURIComponent(u))),
                        t.id || (t.id = $e(t.startTime, t.endTime, u)),
                        t.endTime > 0 && c.push(t);
                    }),
                      (f.onparsingerror = function (t) {
                        u = t;
                      }),
                      (f.onflush = function () {
                        u ? a(u) : s(c);
                      }),
                      l.forEach(function (t) {
                        if (y) {
                          if (Xe(t, "X-TIMESTAMP-MAP=")) {
                            (y = !1),
                              t
                                .slice(16)
                                .split(",")
                                .forEach(function (t) {
                                  Xe(t, "LOCAL:")
                                    ? (d = t.slice(6))
                                    : Xe(t, "MPEGTS:") &&
                                      (p = parseInt(t.slice(7)));
                                });
                            try {
                              m =
                                (function (t) {
                                  var i = parseInt(t.slice(-3)),
                                    n = parseInt(t.slice(-6, -4)),
                                    r = parseInt(t.slice(-9, -7)),
                                    e =
                                      t.length > 9
                                        ? parseInt(
                                            t.substring(0, t.indexOf(":"))
                                          )
                                        : 0;
                                  if (!(g(i) && g(n) && g(r) && g(e)))
                                    throw Error(
                                      "Malformed X-TIMESTAMP-MAP: Local:" + t
                                    );
                                  return (
                                    (i += 1e3 * n), (i += 6e4 * r) + 36e5 * e
                                  );
                                })(d) / 1e3;
                            } catch (t) {
                              u = t;
                            }
                            return;
                          }
                          "" === t && (y = !1);
                        }
                        f.parse(t + "\n");
                      }),
                      f.flush();
                  })(
                    null != (r = t.initSegment) && r.data
                      ? Dt(t.initSegment.data, new Uint8Array(i))
                      : i,
                    this.initPTS[t.cc],
                    n,
                    t.cc,
                    t.start,
                    function (i) {
                      e.Ct(i, t.level),
                        s.trigger(w.SUBTITLE_FRAG_PROCESSED, {
                          success: !0,
                          frag: t,
                        });
                    },
                    function (n) {
                      e.Nt(t, i),
                        A.log("Failed to parse VTT cue: " + n),
                        s.trigger(w.SUBTITLE_FRAG_PROCESSED, {
                          success: !1,
                          frag: t,
                          error: n,
                        });
                    }
                  );
                }),
                (i.Nt = function (t, i) {
                  var n = this,
                    r = this.tracks[t.level];
                  r.textCodec ||
                    Ke(
                      i,
                      this.initPTS[t.cc],
                      function () {
                        (r.textCodec = He), n.It(t, i);
                      },
                      function () {
                        r.textCodec = "wvtt";
                      }
                    );
                }),
                (i.Ct = function (t, i) {
                  var n = this.hls;
                  if (this.config.renderTextTracksNatively) {
                    var r = this.textTracks[i];
                    if (!r || "disabled" === r.mode) return;
                    t.forEach(function (t) {
                      return pi(r, t);
                    });
                  } else {
                    var e = this.tracks[i];
                    if (!e) return;
                    var s = e.default ? "default" : "subtitles" + i;
                    n.trigger(w.CUES_PARSED, {
                      type: "subtitles",
                      cues: t,
                      track: s,
                    });
                  }
                }),
                (i.onFragDecrypted = function (t, i) {
                  var n = i.frag;
                  if (n.type === fi) {
                    if (!this.initPTS[n.cc])
                      return void this.unparsedVttFrags.push(i);
                    this.onFragLoaded(w.FRAG_LOADED, i);
                  }
                }),
                (i.onSubtitleTracksCleared = function () {
                  (this.tracks = []), (this.captionsTracks = {});
                }),
                (i.onFragParsingUserdata = function (t, i) {
                  var n = this.cea608Parser1,
                    r = this.cea608Parser2;
                  if (this.enabled && n && r) {
                    var e = i.frag,
                      s = i.samples;
                    if (
                      e.type !== hi ||
                      "NONE" !== this.closedCaptionsForLevel(e)
                    )
                      for (var a = 0; a < s.length; a++) {
                        var o = s[a].bytes;
                        if (o) {
                          var h = this.extractCea608Data(o);
                          n.addData(s[a].pts, h[0]), r.addData(s[a].pts, h[1]);
                        }
                      }
                  }
                }),
                (i.onBufferFlushing = function (t, i) {
                  var n = i.startOffset,
                    r = i.endOffset,
                    e = i.endOffsetSubtitles,
                    s = i.type,
                    a = this.media;
                  if (a && !(a.currentTime < r)) {
                    if (!s || "video" === s) {
                      var o = this.captionsTracks;
                      Object.keys(o).forEach(function (t) {
                        return yi(o[t], n, r);
                      });
                    }
                    if (
                      this.config.renderTextTracksNatively &&
                      0 === n &&
                      void 0 !== e
                    ) {
                      var h = this.textTracks;
                      Object.keys(h).forEach(function (t) {
                        return yi(h[t], n, e);
                      });
                    }
                  }
                }),
                (i.extractCea608Data = function (t) {
                  for (
                    var i = [[], []], n = 31 & t[0], r = 2, e = 0;
                    e < n;
                    e++
                  ) {
                    var s = t[r++],
                      a = 127 & t[r++],
                      o = 127 & t[r++];
                    if ((0 !== a || 0 !== o) && 0 != (4 & s)) {
                      var h = 3 & s;
                      (0 !== h && 1 !== h) || (i[h].push(a), i[h].push(o));
                    }
                  }
                  return i;
                }),
                t
              );
            })();
            function ns(t, i) {
              return (
                !!t && t.label === i.name && !(t.textTrack1 || t.textTrack2)
              );
            }
            var rs = (function () {
                function t(t) {
                  (this.hls = void 0),
                    (this.autoLevelCapping = void 0),
                    (this.firstLevel = void 0),
                    (this.media = void 0),
                    (this.restrictedLevels = void 0),
                    (this.timer = void 0),
                    (this.clientRect = void 0),
                    (this.streamController = void 0),
                    (this.hls = t),
                    (this.autoLevelCapping = Number.POSITIVE_INFINITY),
                    (this.firstLevel = -1),
                    (this.media = null),
                    (this.restrictedLevels = []),
                    (this.timer = void 0),
                    (this.clientRect = null),
                    this.registerListeners();
                }
                var i = t.prototype;
                return (
                  (i.setStreamController = function (t) {
                    this.streamController = t;
                  }),
                  (i.destroy = function () {
                    this.unregisterListener(),
                      this.hls.config.capLevelToPlayerSize &&
                        this.stopCapping(),
                      (this.media = null),
                      (this.clientRect = null),
                      (this.hls = this.streamController = null);
                  }),
                  (i.registerListeners = function () {
                    var t = this.hls;
                    t.on(
                      w.FPS_DROP_LEVEL_CAPPING,
                      this.onFpsDropLevelCapping,
                      this
                    ),
                      t.on(w.MEDIA_ATTACHING, this.onMediaAttaching, this),
                      t.on(w.MANIFEST_PARSED, this.onManifestParsed, this),
                      t.on(w.BUFFER_CODECS, this.onBufferCodecs, this),
                      t.on(w.MEDIA_DETACHING, this.onMediaDetaching, this);
                  }),
                  (i.unregisterListener = function () {
                    var t = this.hls;
                    t.off(
                      w.FPS_DROP_LEVEL_CAPPING,
                      this.onFpsDropLevelCapping,
                      this
                    ),
                      t.off(w.MEDIA_ATTACHING, this.onMediaAttaching, this),
                      t.off(w.MANIFEST_PARSED, this.onManifestParsed, this),
                      t.off(w.BUFFER_CODECS, this.onBufferCodecs, this),
                      t.off(w.MEDIA_DETACHING, this.onMediaDetaching, this);
                  }),
                  (i.onFpsDropLevelCapping = function (t, i) {
                    var n = this.hls.levels[i.droppedLevel];
                    this.isLevelAllowed(n) &&
                      this.restrictedLevels.push({
                        bitrate: n.bitrate,
                        height: n.height,
                        width: n.width,
                      });
                  }),
                  (i.onMediaAttaching = function (t, i) {
                    (this.media =
                      i.media instanceof HTMLVideoElement ? i.media : null),
                      (this.clientRect = null);
                  }),
                  (i.onManifestParsed = function (t, i) {
                    var n = this.hls;
                    (this.restrictedLevels = []),
                      (this.firstLevel = i.firstLevel),
                      n.config.capLevelToPlayerSize &&
                        i.video &&
                        this.startCapping();
                  }),
                  (i.onBufferCodecs = function (t, i) {
                    this.hls.config.capLevelToPlayerSize &&
                      i.video &&
                      this.startCapping();
                  }),
                  (i.onMediaDetaching = function () {
                    this.stopCapping();
                  }),
                  (i.detectPlayerSize = function () {
                    if (
                      this.media &&
                      this.mediaHeight > 0 &&
                      this.mediaWidth > 0
                    ) {
                      var t = this.hls.levels;
                      if (t.length) {
                        var i = this.hls;
                        (i.autoLevelCapping = this.getMaxLevel(t.length - 1)),
                          i.autoLevelCapping > this.autoLevelCapping &&
                            this.streamController &&
                            this.streamController.nextLevelSwitch(),
                          (this.autoLevelCapping = i.autoLevelCapping);
                      }
                    }
                  }),
                  (i.getMaxLevel = function (i) {
                    var n = this,
                      r = this.hls.levels;
                    if (!r.length) return -1;
                    var e = r.filter(function (t, r) {
                      return n.isLevelAllowed(t) && r <= i;
                    });
                    return (
                      (this.clientRect = null),
                      t.getMaxLevelByMediaSize(
                        e,
                        this.mediaWidth,
                        this.mediaHeight
                      )
                    );
                  }),
                  (i.startCapping = function () {
                    this.timer ||
                      ((this.autoLevelCapping = Number.POSITIVE_INFINITY),
                      (this.hls.firstLevel = this.getMaxLevel(this.firstLevel)),
                      self.clearInterval(this.timer),
                      (this.timer = self.setInterval(
                        this.detectPlayerSize.bind(this),
                        1e3
                      )),
                      this.detectPlayerSize());
                  }),
                  (i.stopCapping = function () {
                    (this.restrictedLevels = []),
                      (this.firstLevel = -1),
                      (this.autoLevelCapping = Number.POSITIVE_INFINITY),
                      this.timer &&
                        (self.clearInterval(this.timer), (this.timer = void 0));
                  }),
                  (i.getDimensions = function () {
                    if (this.clientRect) return this.clientRect;
                    var t = this.media,
                      i = { width: 0, height: 0 };
                    if (t) {
                      var n = t.getBoundingClientRect();
                      (i.width = n.width),
                        (i.height = n.height),
                        i.width ||
                          i.height ||
                          ((i.width = n.right - n.left || t.width || 0),
                          (i.height = n.bottom - n.top || t.height || 0));
                    }
                    return (this.clientRect = i), i;
                  }),
                  (i.isLevelAllowed = function (t) {
                    return !this.restrictedLevels.some(function (i) {
                      return (
                        t.bitrate === i.bitrate &&
                        t.width === i.width &&
                        t.height === i.height
                      );
                    });
                  }),
                  (t.getMaxLevelByMediaSize = function (t, i, n) {
                    if (null == t || !t.length) return -1;
                    for (
                      var r, e, s = t.length - 1, a = 0;
                      a < t.length;
                      a += 1
                    ) {
                      var o = t[a];
                      if (
                        (o.width >= i || o.height >= n) &&
                        ((r = o),
                        !(e = t[a + 1]) ||
                          r.width !== e.width ||
                          r.height !== e.height)
                      ) {
                        s = a;
                        break;
                      }
                    }
                    return s;
                  }),
                  s(t, [
                    {
                      key: "mediaWidth",
                      get: function () {
                        return (
                          this.getDimensions().width * this.contentScaleFactor
                        );
                      },
                    },
                    {
                      key: "mediaHeight",
                      get: function () {
                        return (
                          this.getDimensions().height * this.contentScaleFactor
                        );
                      },
                    },
                    {
                      key: "contentScaleFactor",
                      get: function () {
                        var t = 1;
                        if (!this.hls.config.ignoreDevicePixelRatio)
                          try {
                            t = self.devicePixelRatio;
                          } catch (t) {}
                        return t;
                      },
                    },
                  ]),
                  t
                );
              })(),
              es = (function () {
                function t(t) {
                  (this.hls = void 0),
                    (this.isVideoPlaybackQualityAvailable = !1),
                    (this.timer = void 0),
                    (this.media = null),
                    (this.lastTime = void 0),
                    (this.lastDroppedFrames = 0),
                    (this.lastDecodedFrames = 0),
                    (this.streamController = void 0),
                    (this.hls = t),
                    this.registerListeners();
                }
                var i = t.prototype;
                return (
                  (i.setStreamController = function (t) {
                    this.streamController = t;
                  }),
                  (i.registerListeners = function () {
                    this.hls.on(w.MEDIA_ATTACHING, this.onMediaAttaching, this);
                  }),
                  (i.unregisterListeners = function () {
                    this.hls.off(
                      w.MEDIA_ATTACHING,
                      this.onMediaAttaching,
                      this
                    );
                  }),
                  (i.destroy = function () {
                    this.timer && clearInterval(this.timer),
                      this.unregisterListeners(),
                      (this.isVideoPlaybackQualityAvailable = !1),
                      (this.media = null);
                  }),
                  (i.onMediaAttaching = function (t, i) {
                    var n = this.hls.config;
                    if (n.capLevelOnFPSDrop) {
                      var r =
                        i.media instanceof self.HTMLVideoElement
                          ? i.media
                          : null;
                      (this.media = r),
                        r &&
                          "function" == typeof r.getVideoPlaybackQuality &&
                          (this.isVideoPlaybackQualityAvailable = !0),
                        self.clearInterval(this.timer),
                        (this.timer = self.setInterval(
                          this.checkFPSInterval.bind(this),
                          n.fpsDroppedMonitoringPeriod
                        ));
                    }
                  }),
                  (i.checkFPS = function (t, i, n) {
                    var r = performance.now();
                    if (i) {
                      if (this.lastTime) {
                        var e = r - this.lastTime,
                          s = n - this.lastDroppedFrames,
                          a = i - this.lastDecodedFrames,
                          o = (1e3 * s) / e,
                          h = this.hls;
                        if (
                          (h.trigger(w.FPS_DROP, {
                            currentDropped: s,
                            currentDecoded: a,
                            totalDroppedFrames: n,
                          }),
                          o > 0 &&
                            s > h.config.fpsDroppedMonitoringThreshold * a)
                        ) {
                          var u = h.currentLevel;
                          A.warn(
                            "drop FPS ratio greater than max allowed value for currentLevel: " +
                              u
                          ),
                            u > 0 &&
                              (-1 === h.autoLevelCapping ||
                                h.autoLevelCapping >= u) &&
                              ((u -= 1),
                              h.trigger(w.FPS_DROP_LEVEL_CAPPING, {
                                level: u,
                                droppedLevel: h.currentLevel,
                              }),
                              (h.autoLevelCapping = u),
                              this.streamController.nextLevelSwitch());
                        }
                      }
                      (this.lastTime = r),
                        (this.lastDroppedFrames = n),
                        (this.lastDecodedFrames = i);
                    }
                  }),
                  (i.checkFPSInterval = function () {
                    var t = this.media;
                    if (t)
                      if (this.isVideoPlaybackQualityAvailable) {
                        var i = t.getVideoPlaybackQuality();
                        this.checkFPS(
                          t,
                          i.totalVideoFrames,
                          i.droppedVideoFrames
                        );
                      } else
                        this.checkFPS(
                          t,
                          t.webkitDecodedFrameCount,
                          t.webkitDroppedFrameCount
                        );
                  }),
                  t
                );
              })(),
              ss = "[eme]",
              as = (function () {
                function t(i) {
                  (this.hls = void 0),
                    (this.config = void 0),
                    (this.media = null),
                    (this.keyFormatPromise = null),
                    (this.keySystemAccessPromises = {}),
                    (this.Ut = 0),
                    (this.mediaKeySessions = []),
                    (this.keyIdToKeySessionPromise = {}),
                    (this.setMediaKeysQueue = t.CDMCleanupPromise
                      ? [t.CDMCleanupPromise]
                      : []),
                    (this.onMediaEncrypted = this.Ft.bind(this)),
                    (this.onWaitingForKey = this.jt.bind(this)),
                    (this.debug = A.debug.bind(A, ss)),
                    (this.log = A.log.bind(A, ss)),
                    (this.warn = A.warn.bind(A, ss)),
                    (this.error = A.error.bind(A, ss)),
                    (this.hls = i),
                    (this.config = i.config),
                    this.registerListeners();
                }
                var i = t.prototype;
                return (
                  (i.destroy = function () {
                    this.unregisterListeners(), this.onMediaDetached();
                    var t = this.config;
                    (t.requestMediaKeySystemAccessFunc = null),
                      (t.licenseXhrSetup = t.licenseResponseCallback = void 0),
                      (t.drmSystems = t.drmSystemOptions = {}),
                      (this.hls =
                        this.onMediaEncrypted =
                        this.onWaitingForKey =
                        this.keyIdToKeySessionPromise =
                          null),
                      (this.config = null);
                  }),
                  (i.registerListeners = function () {
                    this.hls.on(w.MEDIA_ATTACHED, this.onMediaAttached, this),
                      this.hls.on(w.MEDIA_DETACHED, this.onMediaDetached, this),
                      this.hls.on(
                        w.MANIFEST_LOADING,
                        this.onManifestLoading,
                        this
                      ),
                      this.hls.on(
                        w.MANIFEST_LOADED,
                        this.onManifestLoaded,
                        this
                      );
                  }),
                  (i.unregisterListeners = function () {
                    this.hls.off(w.MEDIA_ATTACHED, this.onMediaAttached, this),
                      this.hls.off(
                        w.MEDIA_DETACHED,
                        this.onMediaDetached,
                        this
                      ),
                      this.hls.off(
                        w.MANIFEST_LOADING,
                        this.onManifestLoading,
                        this
                      ),
                      this.hls.off(
                        w.MANIFEST_LOADED,
                        this.onManifestLoaded,
                        this
                      );
                  }),
                  (i.getLicenseServerUrl = function (t) {
                    var i = this.config,
                      n = i.drmSystems,
                      r = i.widevineLicenseUrl,
                      e = n[t];
                    if (e) return e.licenseUrl;
                    if (t === Y.WIDEVINE && r) return r;
                    throw new Error(
                      'no license server URL configured for key-system "' +
                        t +
                        '"'
                    );
                  }),
                  (i.getServerCertificateUrl = function (t) {
                    var i = this.config.drmSystems[t];
                    if (i) return i.serverCertificateUrl;
                    this.log(
                      'No Server Certificate in config.drmSystems["' + t + '"]'
                    );
                  }),
                  (i.attemptKeySystemAccess = function (t) {
                    var i = this,
                      n = this.hls.levels,
                      r = function (t, i, n) {
                        return !!t && n.indexOf(t) === i;
                      },
                      e = n
                        .map(function (t) {
                          return t.audioCodec;
                        })
                        .filter(r),
                      s = n
                        .map(function (t) {
                          return t.videoCodec;
                        })
                        .filter(r);
                    return (
                      e.length + s.length === 0 && s.push("avc1.42e01e"),
                      new Promise(function (n, r) {
                        !(function t(a) {
                          var o = a.shift();
                          i.getMediaKeysPromise(o, e, s)
                            .then(function (t) {
                              return n({ keySystem: o, mediaKeys: t });
                            })
                            .catch(function (i) {
                              a.length
                                ? t(a)
                                : r(
                                    i instanceof os
                                      ? i
                                      : new os(
                                          {
                                            type: b.KEY_SYSTEM_ERROR,
                                            details: k.KEY_SYSTEM_NO_ACCESS,
                                            error: i,
                                            fatal: !0,
                                          },
                                          i.message
                                        )
                                  );
                            });
                        })(t);
                      })
                    );
                  }),
                  (i.requestMediaKeySystemAccess = function (t, i) {
                    var n = this.config.requestMediaKeySystemAccessFunc;
                    if ("function" != typeof n) {
                      var r =
                        "Configured requestMediaKeySystemAccess is not a function " +
                        n;
                      return (
                        null === J &&
                          "http:" === self.location.protocol &&
                          (r =
                            "navigator.requestMediaKeySystemAccess is not available over insecure protocol " +
                            location.protocol),
                        Promise.reject(new Error(r))
                      );
                    }
                    return n(t, i);
                  }),
                  (i.getMediaKeysPromise = function (t, i, n) {
                    var r = this,
                      e = (function (t, i, n, r) {
                        var e;
                        switch (t) {
                          case Y.FAIRPLAY:
                            e = ["cenc", "sinf"];
                            break;
                          case Y.WIDEVINE:
                          case Y.PLAYREADY:
                            e = ["cenc"];
                            break;
                          case Y.CLEARKEY:
                            e = ["cenc", "keyids"];
                            break;
                          default:
                            throw new Error("Unknown key-system: " + t);
                        }
                        return (function (t, i, n, r) {
                          return [
                            {
                              initDataTypes: t,
                              persistentState:
                                r.persistentState || "not-allowed",
                              distinctiveIdentifier:
                                r.distinctiveIdentifier || "not-allowed",
                              sessionTypes: r.sessionTypes || [
                                r.sessionType || "temporary",
                              ],
                              audioCapabilities: i.map(function (t) {
                                return {
                                  contentType: 'audio/mp4; codecs="' + t + '"',
                                  robustness: r.audioRobustness || "",
                                  encryptionScheme:
                                    r.audioEncryptionScheme || null,
                                };
                              }),
                              videoCapabilities: n.map(function (t) {
                                return {
                                  contentType: 'video/mp4; codecs="' + t + '"',
                                  robustness: r.videoRobustness || "",
                                  encryptionScheme:
                                    r.videoEncryptionScheme || null,
                                };
                              }),
                            },
                          ];
                        })(e, i, n, r);
                      })(t, i, n, this.config.drmSystemOptions),
                      s = this.keySystemAccessPromises[t],
                      a = null == s ? void 0 : s.keySystemAccess;
                    if (!a) {
                      this.log(
                        'Requesting encrypted media "' +
                          t +
                          '" key-system access with config: ' +
                          JSON.stringify(e)
                      ),
                        (a = this.requestMediaKeySystemAccess(t, e));
                      var o = (this.keySystemAccessPromises[t] = {
                        keySystemAccess: a,
                      });
                      return (
                        a.catch(function (i) {
                          r.log(
                            'Failed to obtain access to key-system "' +
                              t +
                              '": ' +
                              i
                          );
                        }),
                        a.then(function (i) {
                          r.log(
                            'Access for key-system "' +
                              i.keySystem +
                              '" obtained'
                          );
                          var n = r.fetchServerCertificate(t);
                          return (
                            r.log('Create media-keys for "' + t + '"'),
                            (o.mediaKeys = i
                              .createMediaKeys()
                              .then(function (i) {
                                return (
                                  r.log('Media-keys created for "' + t + '"'),
                                  n.then(function (n) {
                                    return n
                                      ? r.setMediaKeysServerCertificate(i, t, n)
                                      : i;
                                  })
                                );
                              })),
                            o.mediaKeys.catch(function (i) {
                              r.error(
                                'Failed to create media-keys for "' +
                                  t +
                                  '"}: ' +
                                  i
                              );
                            }),
                            o.mediaKeys
                          );
                        })
                      );
                    }
                    return a.then(function () {
                      return s.mediaKeys;
                    });
                  }),
                  (i.createMediaKeySessionContext = function (t) {
                    var i = t.decryptdata,
                      n = t.keySystem,
                      r = t.mediaKeys;
                    this.log(
                      'Creating key-system session "' +
                        n +
                        '" keyId: ' +
                        dt(i.keyId || [])
                    );
                    var e = r.createSession(),
                      s = {
                        decryptdata: i,
                        keySystem: n,
                        mediaKeys: r,
                        mediaKeysSession: e,
                        keyStatus: "status-pending",
                      };
                    return this.mediaKeySessions.push(s), s;
                  }),
                  (i.renewKeySession = function (t) {
                    var i = t.decryptdata;
                    if (i.pssh) {
                      var n = this.createMediaKeySessionContext(t),
                        r = this.getKeyIdString(i);
                      this.keyIdToKeySessionPromise[r] =
                        this.generateRequestWithPreferredKeySession(
                          n,
                          "cenc",
                          i.pssh,
                          "expired"
                        );
                    } else
                      this.warn(
                        "Could not renew expired session. Missing pssh initData."
                      );
                    this.removeSession(t);
                  }),
                  (i.getKeyIdString = function (t) {
                    if (!t)
                      throw new Error(
                        "Could not read keyId of undefined decryptdata"
                      );
                    if (null === t.keyId) throw new Error("keyId is null");
                    return dt(t.keyId);
                  }),
                  (i.updateKeySession = function (t, i) {
                    var n,
                      r = t.mediaKeysSession;
                    return (
                      this.log(
                        'Updating key-session "' +
                          r.sessionId +
                          '" for keyID ' +
                          dt(
                            (null == (n = t.decryptdata) ? void 0 : n.keyId) ||
                              []
                          ) +
                          "\n      } (data length: " +
                          (i ? i.byteLength : i) +
                          ")"
                      ),
                      r.update(i)
                    );
                  }),
                  (i.selectKeySystemFormat = function (t) {
                    var i = Object.keys(t.levelkeys || {});
                    return (
                      this.keyFormatPromise ||
                        (this.log(
                          "Selecting key-system from fragment (sn: " +
                            t.sn +
                            " " +
                            t.type +
                            ": " +
                            t.level +
                            ") key formats " +
                            i.join(", ")
                        ),
                        (this.keyFormatPromise = this.getKeyFormatPromise(i))),
                      this.keyFormatPromise
                    );
                  }),
                  (i.getKeyFormatPromise = function (t) {
                    var i = this;
                    return new Promise(function (n, r) {
                      var e = q(i.config),
                        s = t.map(W).filter(function (t) {
                          return !!t && -1 !== e.indexOf(t);
                        });
                      return i
                        .getKeySystemSelectionPromise(s)
                        .then(function (t) {
                          var i = t.keySystem,
                            e = z(i);
                          e
                            ? n(e)
                            : r(
                                new Error(
                                  'Unable to find format for key-system "' +
                                    i +
                                    '"'
                                )
                              );
                        })
                        .catch(r);
                    });
                  }),
                  (i.loadKey = function (t) {
                    var i = this,
                      n = t.keyInfo.decryptdata,
                      r = this.getKeyIdString(n),
                      e =
                        "(keyId: " +
                        r +
                        ' format: "' +
                        n.keyFormat +
                        '" method: ' +
                        n.method +
                        " uri: " +
                        n.uri +
                        ")";
                    this.log("Starting session for key " + e);
                    var s = this.keyIdToKeySessionPromise[r];
                    return (
                      s ||
                        (s = this.keyIdToKeySessionPromise[r] =
                          this.getKeySystemForKeyPromise(n).then(function (r) {
                            var s = r.keySystem,
                              a = r.mediaKeys;
                            return (
                              i.throwIfDestroyed(),
                              i.log(
                                "Handle encrypted media sn: " +
                                  t.frag.sn +
                                  " " +
                                  t.frag.type +
                                  ": " +
                                  t.frag.level +
                                  " using key " +
                                  e
                              ),
                              i.attemptSetMediaKeys(s, a).then(function () {
                                i.throwIfDestroyed();
                                var t = i.createMediaKeySessionContext({
                                  keySystem: s,
                                  mediaKeys: a,
                                  decryptdata: n,
                                });
                                return i.generateRequestWithPreferredKeySession(
                                  t,
                                  "cenc",
                                  n.pssh,
                                  "playlist-key"
                                );
                              })
                            );
                          })).catch(function (t) {
                          return i.handleError(t);
                        }),
                      s
                    );
                  }),
                  (i.throwIfDestroyed = function (t) {
                    if (!this.hls) throw new Error("invalid state");
                  }),
                  (i.handleError = function (t) {
                    this.hls &&
                      (this.error(t.message),
                      t instanceof os
                        ? this.hls.trigger(w.ERROR, t.data)
                        : this.hls.trigger(w.ERROR, {
                            type: b.KEY_SYSTEM_ERROR,
                            details: k.KEY_SYSTEM_NO_KEYS,
                            error: t,
                            fatal: !0,
                          }));
                  }),
                  (i.getKeySystemForKeyPromise = function (t) {
                    var i = this.getKeyIdString(t),
                      n = this.keyIdToKeySessionPromise[i];
                    if (!n) {
                      var r = W(t.keyFormat),
                        e = r ? [r] : q(this.config);
                      return this.attemptKeySystemAccess(e);
                    }
                    return n;
                  }),
                  (i.getKeySystemSelectionPromise = function (t) {
                    if ((t.length || (t = q(this.config)), 0 === t.length))
                      throw new os(
                        {
                          type: b.KEY_SYSTEM_ERROR,
                          details: k.KEY_SYSTEM_NO_CONFIGURED_LICENSE,
                          fatal: !0,
                        },
                        "Missing key-system license configuration options " +
                          JSON.stringify({ drmSystems: this.config.drmSystems })
                      );
                    return this.attemptKeySystemAccess(t);
                  }),
                  (i.Ft = function (t) {
                    var i = this,
                      n = t.initDataType,
                      r = t.initData;
                    if (
                      (this.debug(
                        '"' + t.type + '" event: init data type: "' + n + '"'
                      ),
                      null !== r)
                    ) {
                      var e, s;
                      if ("sinf" === n && this.config.drmSystems[Y.FAIRPLAY]) {
                        var a = gt(new Uint8Array(r));
                        try {
                          var o = B(JSON.parse(a).sinf),
                            h = At(new Uint8Array(o));
                          if (!h) return;
                          (e = h.subarray(8, 24)), (s = Y.FAIRPLAY);
                        } catch (t) {
                          return void this.warn(
                            'Failed to parse sinf "encrypted" event message initData'
                          );
                        }
                      } else {
                        var u = (function (t) {
                          if (!(t instanceof ArrayBuffer) || t.byteLength < 32)
                            return null;
                          var i = {
                              version: 0,
                              systemId: "",
                              kids: null,
                              data: null,
                            },
                            n = new DataView(t),
                            r = n.getUint32(0);
                          if (t.byteLength !== r && r > 44) return null;
                          if (1886614376 !== n.getUint32(4)) return null;
                          if (
                            ((i.version = n.getUint32(8) >>> 24), i.version > 1)
                          )
                            return null;
                          i.systemId = dt(new Uint8Array(t, 12, 16));
                          var e = n.getUint32(28);
                          if (0 === i.version) {
                            if (r - 32 < e) return null;
                            i.data = new Uint8Array(t, 32, e);
                          } else if (1 === i.version) {
                            i.kids = [];
                            for (var s = 0; s < e; s++)
                              i.kids.push(new Uint8Array(t, 32 + 16 * s, 16));
                          }
                          return i;
                        })(r);
                        if (null === u) return;
                        0 === u.version &&
                          u.systemId === K &&
                          u.data &&
                          (e = u.data.subarray(8, 24)),
                          (s = (function (t) {
                            if (t === K) return Y.WIDEVINE;
                          })(u.systemId));
                      }
                      if (s && e) {
                        for (
                          var f = dt(e),
                            l = this.keyIdToKeySessionPromise,
                            c = this.mediaKeySessions,
                            v = l[f],
                            d = function () {
                              var t = c[p],
                                s = t.decryptdata;
                              if (s.pssh || !s.keyId) return "continue";
                              var a = dt(s.keyId);
                              return f === a ||
                                -1 !== s.uri.replace(/-/g, "").indexOf(f)
                                ? ((v = l[a]),
                                  delete l[a],
                                  (s.pssh = new Uint8Array(r)),
                                  (s.keyId = e),
                                  (v = l[f] =
                                    v.then(function () {
                                      return i.generateRequestWithPreferredKeySession(
                                        t,
                                        n,
                                        r,
                                        "encrypted-event-key-match"
                                      );
                                    })),
                                  "break")
                                : void 0;
                            },
                            p = 0;
                          p < c.length;
                          p++
                        ) {
                          var m = d();
                          if ("continue" !== m && "break" === m) break;
                        }
                        v ||
                          (v = l[f] =
                            this.getKeySystemSelectionPromise([s]).then(
                              function (t) {
                                var s,
                                  a = t.keySystem,
                                  o = t.mediaKeys;
                                i.throwIfDestroyed();
                                var h = new Pt(
                                  "ISO-23001-7",
                                  f,
                                  null != (s = z(a)) ? s : ""
                                );
                                return (
                                  (h.pssh = new Uint8Array(r)),
                                  (h.keyId = e),
                                  i.attemptSetMediaKeys(a, o).then(function () {
                                    i.throwIfDestroyed();
                                    var t = i.createMediaKeySessionContext({
                                      decryptdata: h,
                                      keySystem: a,
                                      mediaKeys: o,
                                    });
                                    return i.generateRequestWithPreferredKeySession(
                                      t,
                                      n,
                                      r,
                                      "encrypted-event-no-match"
                                    );
                                  })
                                );
                              }
                            )),
                          v.catch(function (t) {
                            return i.handleError(t);
                          });
                      }
                    }
                  }),
                  (i.jt = function (t) {
                    this.log('"' + t.type + '" event');
                  }),
                  (i.attemptSetMediaKeys = function (t, i) {
                    var n = this,
                      r = this.setMediaKeysQueue.slice();
                    this.log('Setting media-keys for "' + t + '"');
                    var e = Promise.all(r).then(function () {
                      if (!n.media)
                        throw new Error(
                          "Attempted to set mediaKeys without media element attached"
                        );
                      return n.media.setMediaKeys(i);
                    });
                    return (
                      this.setMediaKeysQueue.push(e),
                      e.then(function () {
                        n.log('Media-keys set for "' + t + '"'),
                          r.push(e),
                          (n.setMediaKeysQueue = n.setMediaKeysQueue.filter(
                            function (t) {
                              return -1 === r.indexOf(t);
                            }
                          ));
                      })
                    );
                  }),
                  (i.generateRequestWithPreferredKeySession = function (
                    t,
                    i,
                    n,
                    r
                  ) {
                    var e,
                      s,
                      a = this,
                      o =
                        null == (e = this.config.drmSystems) ||
                        null == (s = e[t.keySystem])
                          ? void 0
                          : s.generateRequest;
                    if (o)
                      try {
                        var h = o.call(this.hls, i, n, t);
                        if (!h)
                          throw new Error(
                            "Invalid response from configured generateRequest filter"
                          );
                        (i = h.initDataType),
                          (n = t.decryptdata.pssh =
                            h.initData ? new Uint8Array(h.initData) : null);
                      } catch (t) {
                        var u;
                        if (
                          (this.warn(t.message),
                          null != (u = this.hls) && u.config.debug)
                        )
                          throw t;
                      }
                    if (null === n)
                      return (
                        this.log(
                          'Skipping key-session request for "' +
                            r +
                            '" (no initData)'
                        ),
                        Promise.resolve(t)
                      );
                    var f = this.getKeyIdString(t.decryptdata);
                    this.log(
                      'Generating key-session request for "' +
                        r +
                        '": ' +
                        f +
                        " (init data type: " +
                        i +
                        " length: " +
                        (n ? n.byteLength : null) +
                        ")"
                    );
                    var l = new Br();
                    (t.mediaKeysSession.onmessage = function (i) {
                      var n = t.mediaKeysSession;
                      if (n) {
                        var r = i.messageType,
                          e = i.message;
                        a.log(
                          '"' +
                            r +
                            '" message event for session "' +
                            n.sessionId +
                            '" message size: ' +
                            e.byteLength
                        ),
                          "license-request" === r || "license-renewal" === r
                            ? a.renewLicense(t, e).catch(function (t) {
                                a.handleError(t), l.emit("error", t);
                              })
                            : "license-release" === r
                            ? t.keySystem === Y.FAIRPLAY &&
                              (a.updateKeySession(t, X("acknowledged")),
                              a.removeSession(t))
                            : a.warn(
                                'unhandled media key message type "' + r + '"'
                              );
                      } else l.emit("error", new Error("invalid state"));
                    }),
                      (t.mediaKeysSession.onkeystatuseschange = function (i) {
                        if (t.mediaKeysSession) {
                          a.onKeyStatusChange(t);
                          var n = t.keyStatus;
                          l.emit("keyStatus", n),
                            "expired" === n &&
                              (a.warn(t.keySystem + " expired for key " + f),
                              a.renewKeySession(t));
                        } else l.emit("error", new Error("invalid state"));
                      });
                    var c = new Promise(function (t, i) {
                      l.on("error", i),
                        l.on("keyStatus", function (n) {
                          n.startsWith("usable")
                            ? t()
                            : "output-restricted" === n
                            ? i(
                                new os(
                                  {
                                    type: b.KEY_SYSTEM_ERROR,
                                    details:
                                      k.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,
                                    fatal: !1,
                                  },
                                  "HDCP level output restricted"
                                )
                              )
                            : "internal-error" === n
                            ? i(
                                new os(
                                  {
                                    type: b.KEY_SYSTEM_ERROR,
                                    details: k.KEY_SYSTEM_STATUS_INTERNAL_ERROR,
                                    fatal: !0,
                                  },
                                  'key status changed to "' + n + '"'
                                )
                              )
                            : "expired" === n
                            ? i(
                                new Error(
                                  "key expired while generating request"
                                )
                              )
                            : a.warn('unhandled key status change "' + n + '"');
                        });
                    });
                    return t.mediaKeysSession
                      .generateRequest(i, n)
                      .then(function () {
                        var i;
                        a.log(
                          'Request generated for key-session "' +
                            (null == (i = t.mediaKeysSession)
                              ? void 0
                              : i.sessionId) +
                            '" keyId: ' +
                            f
                        );
                      })
                      .catch(function (t) {
                        throw new os(
                          {
                            type: b.KEY_SYSTEM_ERROR,
                            details: k.KEY_SYSTEM_NO_SESSION,
                            error: t,
                            fatal: !1,
                          },
                          "Error generating key-session request: " + t
                        );
                      })
                      .then(function () {
                        return c;
                      })
                      .catch(function (i) {
                        throw (l.removeAllListeners(), a.removeSession(t), i);
                      })
                      .then(function () {
                        return l.removeAllListeners(), t;
                      });
                  }),
                  (i.onKeyStatusChange = function (t) {
                    var i = this;
                    t.mediaKeysSession.keyStatuses.forEach(function (n, r) {
                      i.log(
                        'key status change "' +
                          n +
                          '" for keyStatuses keyId: ' +
                          dt(
                            "buffer" in r
                              ? new Uint8Array(
                                  r.buffer,
                                  r.byteOffset,
                                  r.byteLength
                                )
                              : new Uint8Array(r)
                          ) +
                          " session keyId: " +
                          dt(new Uint8Array(t.decryptdata.keyId || [])) +
                          " uri: " +
                          t.decryptdata.uri
                      ),
                        (t.keyStatus = n);
                    });
                  }),
                  (i.fetchServerCertificate = function (t) {
                    var i = this.config,
                      n = new (0, i.loader)(i),
                      e = this.getServerCertificateUrl(t);
                    return e
                      ? (this.log('Fetching serverCertificate for "' + t + '"'),
                        new Promise(function (s, a) {
                          var o = { responseType: "arraybuffer", url: e },
                            h = i.certLoadPolicy.default,
                            u = {
                              loadPolicy: h,
                              timeout: h.maxLoadTimeMs,
                              maxRetry: 0,
                              retryDelay: 0,
                              maxRetryDelay: 0,
                            },
                            f = {
                              onSuccess: function (t, i, n, r) {
                                s(t.data);
                              },
                              onError: function (i, n, s, h) {
                                a(
                                  new os(
                                    {
                                      type: b.KEY_SYSTEM_ERROR,
                                      details:
                                        k.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,
                                      fatal: !0,
                                      networkDetails: s,
                                      response: r(
                                        { url: o.url, data: void 0 },
                                        i
                                      ),
                                    },
                                    '"' +
                                      t +
                                      '" certificate request failed (' +
                                      e +
                                      "). Status: " +
                                      i.code +
                                      " (" +
                                      i.text +
                                      ")"
                                  )
                                );
                              },
                              onTimeout: function (i, n, r) {
                                a(
                                  new os(
                                    {
                                      type: b.KEY_SYSTEM_ERROR,
                                      details:
                                        k.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,
                                      fatal: !0,
                                      networkDetails: r,
                                      response: { url: o.url, data: void 0 },
                                    },
                                    '"' +
                                      t +
                                      '" certificate request timed out (' +
                                      e +
                                      ")"
                                  )
                                );
                              },
                              onAbort: function (t, i, n) {
                                a(new Error("aborted"));
                              },
                            };
                          n.load(o, u, f);
                        }))
                      : Promise.resolve();
                  }),
                  (i.setMediaKeysServerCertificate = function (t, i, n) {
                    var r = this;
                    return new Promise(function (e, s) {
                      t.setServerCertificate(n)
                        .then(function (s) {
                          r.log(
                            "setServerCertificate " +
                              (s ? "success" : "not supported by CDM") +
                              " (" +
                              (null == n ? void 0 : n.byteLength) +
                              ') on "' +
                              i +
                              '"'
                          ),
                            e(t);
                        })
                        .catch(function (t) {
                          s(
                            new os(
                              {
                                type: b.KEY_SYSTEM_ERROR,
                                details:
                                  k.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,
                                error: t,
                                fatal: !0,
                              },
                              t.message
                            )
                          );
                        });
                    });
                  }),
                  (i.renewLicense = function (t, i) {
                    var n = this;
                    return this.requestLicense(t, new Uint8Array(i)).then(
                      function (i) {
                        return n
                          .updateKeySession(t, new Uint8Array(i))
                          .catch(function (t) {
                            throw new os(
                              {
                                type: b.KEY_SYSTEM_ERROR,
                                details: k.KEY_SYSTEM_SESSION_UPDATE_FAILED,
                                error: t,
                                fatal: !0,
                              },
                              t.message
                            );
                          });
                      }
                    );
                  }),
                  (i.setupLicenseXHR = function (t, i, n, r) {
                    var e = this,
                      s = this.config.licenseXhrSetup;
                    return s
                      ? Promise.resolve()
                          .then(function () {
                            if (!n.decryptdata) throw new Error("Key removed");
                            return s.call(e.hls, t, i, n, r);
                          })
                          .catch(function (a) {
                            if (!n.decryptdata) throw a;
                            return (
                              t.open("POST", i, !0), s.call(e.hls, t, i, n, r)
                            );
                          })
                          .then(function (n) {
                            return (
                              t.readyState || t.open("POST", i, !0),
                              { xhr: t, licenseChallenge: n || r }
                            );
                          })
                      : (t.open("POST", i, !0),
                        Promise.resolve({ xhr: t, licenseChallenge: r }));
                  }),
                  (i.requestLicense = function (t, i) {
                    var n = this,
                      r = this.config.keyLoadPolicy.default;
                    return new Promise(function (e, s) {
                      var a = n.getLicenseServerUrl(t.keySystem);
                      n.log("Sending license request to URL: " + a);
                      var o = new XMLHttpRequest();
                      (o.responseType = "arraybuffer"),
                        (o.onreadystatechange = function () {
                          if (!n.hls || !t.mediaKeysSession)
                            return s(new Error("invalid state"));
                          if (4 === o.readyState)
                            if (200 === o.status) {
                              n.Ut = 0;
                              var h = o.response;
                              n.log(
                                "License received " +
                                  (h instanceof ArrayBuffer ? h.byteLength : h)
                              );
                              var u = n.config.licenseResponseCallback;
                              if (u)
                                try {
                                  h = u.call(n.hls, o, a, t);
                                } catch (t) {
                                  n.error(t);
                                }
                              e(h);
                            } else {
                              var f = r.errorRetry,
                                l = f ? f.maxNumRetry : 0;
                              if (
                                (n.Ut++,
                                n.Ut > l || (o.status >= 400 && o.status < 500))
                              )
                                s(
                                  new os(
                                    {
                                      type: b.KEY_SYSTEM_ERROR,
                                      details:
                                        k.KEY_SYSTEM_LICENSE_REQUEST_FAILED,
                                      fatal: !0,
                                      networkDetails: o,
                                      response: {
                                        url: a,
                                        data: void 0,
                                        code: o.status,
                                        text: o.statusText,
                                      },
                                    },
                                    "License Request XHR failed (" +
                                      a +
                                      "). Status: " +
                                      o.status +
                                      " (" +
                                      o.statusText +
                                      ")"
                                  )
                                );
                              else {
                                var c = l - n.Ut + 1;
                                n.warn(
                                  "Retrying license request, " +
                                    c +
                                    " attempts left"
                                ),
                                  n.requestLicense(t, i).then(e, s);
                              }
                            }
                        }),
                        t.licenseXhr &&
                          t.licenseXhr.readyState !== XMLHttpRequest.DONE &&
                          t.licenseXhr.abort(),
                        (t.licenseXhr = o),
                        n.setupLicenseXHR(o, a, t, i).then(function (t) {
                          var i = t.xhr,
                            n = t.licenseChallenge;
                          i.send(n);
                        });
                    });
                  }),
                  (i.onMediaAttached = function (t, i) {
                    if (this.config.emeEnabled) {
                      var n = i.media;
                      (this.media = n),
                        n.addEventListener("encrypted", this.onMediaEncrypted),
                        n.addEventListener(
                          "waitingforkey",
                          this.onWaitingForKey
                        );
                    }
                  }),
                  (i.onMediaDetached = function () {
                    var i = this,
                      n = this.media,
                      r = this.mediaKeySessions;
                    n &&
                      (n.removeEventListener(
                        "encrypted",
                        this.onMediaEncrypted
                      ),
                      n.removeEventListener(
                        "waitingforkey",
                        this.onWaitingForKey
                      ),
                      (this.media = null)),
                      (this.Ut = 0),
                      (this.setMediaKeysQueue = []),
                      (this.mediaKeySessions = []),
                      (this.keyIdToKeySessionPromise = {}),
                      Pt.clearKeyUriToKeyIdMap();
                    var e = r.length;
                    t.CDMCleanupPromise = Promise.all(
                      r
                        .map(function (t) {
                          return i.removeSession(t);
                        })
                        .concat(
                          null == n
                            ? void 0
                            : n.setMediaKeys(null).catch(function (t) {
                                i.log(
                                  "Could not clear media keys: " +
                                    t +
                                    ". media.src: " +
                                    (null == n ? void 0 : n.src)
                                );
                              })
                        )
                    )
                      .then(function () {
                        e &&
                          (i.log(
                            "finished closing key sessions and clearing media keys"
                          ),
                          (r.length = 0));
                      })
                      .catch(function (t) {
                        i.log(
                          "Could not close sessions and clear media keys: " +
                            t +
                            ". media.src: " +
                            (null == n ? void 0 : n.src)
                        );
                      });
                  }),
                  (i.onManifestLoading = function () {
                    this.keyFormatPromise = null;
                  }),
                  (i.onManifestLoaded = function (t, i) {
                    var n = i.sessionKeys;
                    if (n && this.config.emeEnabled && !this.keyFormatPromise) {
                      var r = n.reduce(function (t, i) {
                        return (
                          -1 === t.indexOf(i.keyFormat) && t.push(i.keyFormat),
                          t
                        );
                      }, []);
                      this.log(
                        "Selecting key-system from session-keys " + r.join(", ")
                      ),
                        (this.keyFormatPromise = this.getKeyFormatPromise(r));
                    }
                  }),
                  (i.removeSession = function (t) {
                    var i = this,
                      n = t.mediaKeysSession,
                      r = t.licenseXhr;
                    if (n) {
                      this.log(
                        "Remove licenses and keys and close session " +
                          n.sessionId
                      ),
                        (n.onmessage = null),
                        (n.onkeystatuseschange = null),
                        r && r.readyState !== XMLHttpRequest.DONE && r.abort(),
                        (t.mediaKeysSession =
                          t.decryptdata =
                          t.licenseXhr =
                            void 0);
                      var e = this.mediaKeySessions.indexOf(t);
                      return (
                        e > -1 && this.mediaKeySessions.splice(e, 1),
                        n
                          .remove()
                          .catch(function (t) {
                            i.log("Could not remove session: " + t);
                          })
                          .then(function () {
                            return n.close();
                          })
                          .catch(function (t) {
                            i.log("Could not close session: " + t);
                          })
                      );
                    }
                  }),
                  t
                );
              })();
            as.CDMCleanupPromise = void 0;
            var os = (function (t) {
                function i(i, n) {
                  var r;
                  return (
                    ((r = t.call(this, n) || this).data = void 0),
                    i.error || (i.error = new Error(n)),
                    (r.data = i),
                    (i.err = i.error),
                    r
                  );
                }
                return h(i, t), i;
              })(c(Error)),
              hs = "a",
              us = "av",
              fs = (function () {
                function t(i) {
                  var n = this;
                  (this.hls = void 0),
                    (this.config = void 0),
                    (this.media = void 0),
                    (this.sid = void 0),
                    (this.cid = void 0),
                    (this.useHeaders = !1),
                    (this.initialized = !1),
                    (this.starved = !1),
                    (this.buffering = !0),
                    (this.audioBuffer = void 0),
                    (this.videoBuffer = void 0),
                    (this.onWaiting = function () {
                      n.initialized && (n.starved = !0), (n.buffering = !0);
                    }),
                    (this.onPlaying = function () {
                      n.initialized || (n.initialized = !0), (n.buffering = !1);
                    }),
                    (this.applyPlaylistData = function (t) {
                      try {
                        n.apply(t, { ot: "m", su: !n.initialized });
                      } catch (t) {
                        A.warn("Could not generate manifest CMCD data.", t);
                      }
                    }),
                    (this.applyFragmentData = function (t) {
                      try {
                        var i = t.frag,
                          r = n.hls.levels[i.level],
                          e = n.getObjectType(i),
                          s = { d: 1e3 * i.duration, ot: e };
                        ("v" !== e && e !== hs && e != us) ||
                          ((s.br = r.bitrate / 1e3),
                          (s.tb = n.getTopBandwidth(e) / 1e3),
                          (s.bl = n.getBufferLength(e))),
                          n.apply(t, s);
                      } catch (t) {
                        A.warn("Could not generate segment CMCD data.", t);
                      }
                    }),
                    (this.hls = i);
                  var r = (this.config = i.config),
                    e = r.cmcd;
                  null != e &&
                    ((r.pLoader = this.createPlaylistLoader()),
                    (r.fLoader = this.createFragmentLoader()),
                    (this.sid = e.sessionId || t.uuid()),
                    (this.cid = e.contentId),
                    (this.useHeaders = !0 === e.useHeaders),
                    this.registerListeners());
                }
                var i = t.prototype;
                return (
                  (i.registerListeners = function () {
                    var t = this.hls;
                    t.on(w.MEDIA_ATTACHED, this.onMediaAttached, this),
                      t.on(w.MEDIA_DETACHED, this.onMediaDetached, this),
                      t.on(w.BUFFER_CREATED, this.onBufferCreated, this);
                  }),
                  (i.unregisterListeners = function () {
                    var t = this.hls;
                    t.off(w.MEDIA_ATTACHED, this.onMediaAttached, this),
                      t.off(w.MEDIA_DETACHED, this.onMediaDetached, this),
                      t.off(w.BUFFER_CREATED, this.onBufferCreated, this);
                  }),
                  (i.destroy = function () {
                    this.unregisterListeners(),
                      this.onMediaDetached(),
                      (this.hls =
                        this.config =
                        this.audioBuffer =
                        this.videoBuffer =
                          null);
                  }),
                  (i.onMediaAttached = function (t, i) {
                    (this.media = i.media),
                      this.media.addEventListener("waiting", this.onWaiting),
                      this.media.addEventListener("playing", this.onPlaying);
                  }),
                  (i.onMediaDetached = function () {
                    this.media &&
                      (this.media.removeEventListener(
                        "waiting",
                        this.onWaiting
                      ),
                      this.media.removeEventListener("playing", this.onPlaying),
                      (this.media = null));
                  }),
                  (i.onBufferCreated = function (t, i) {
                    var n, r;
                    (this.audioBuffer =
                      null == (n = i.tracks.audio) ? void 0 : n.buffer),
                      (this.videoBuffer =
                        null == (r = i.tracks.video) ? void 0 : r.buffer);
                  }),
                  (i.createData = function () {
                    var t;
                    return {
                      v: 1,
                      sf: "h",
                      sid: this.sid,
                      cid: this.cid,
                      pr: null == (t = this.media) ? void 0 : t.playbackRate,
                      mtp: this.hls.bandwidthEstimate / 1e3,
                    };
                  }),
                  (i.apply = function (i, n) {
                    void 0 === n && (n = {}), o(n, this.createData());
                    var r = "i" === n.ot || "v" === n.ot || n.ot === us;
                    if (
                      (this.starved &&
                        r &&
                        ((n.bs = !0), (n.su = !0), (this.starved = !1)),
                      null == n.su && (n.su = this.buffering),
                      this.useHeaders)
                    ) {
                      var e = t.toHeaders(n);
                      if (!Object.keys(e).length) return;
                      i.headers || (i.headers = {}), o(i.headers, e);
                    } else {
                      var s = t.toQuery(n);
                      if (!s) return;
                      i.url = t.appendQueryToUri(i.url, s);
                    }
                  }),
                  (i.getObjectType = function (t) {
                    var i = t.type;
                    return "subtitle" === i
                      ? "tt"
                      : "initSegment" === t.sn
                      ? "i"
                      : "audio" === i
                      ? hs
                      : "main" === i
                      ? this.hls.audioTracks.length
                        ? "v"
                        : us
                      : void 0;
                  }),
                  (i.getTopBandwidth = function (t) {
                    var i,
                      n = 0,
                      r = this.hls;
                    if (t === hs) i = r.audioTracks;
                    else {
                      var e = r.maxAutoLevel,
                        s = e > -1 ? e + 1 : r.levels.length;
                      i = r.levels.slice(0, s);
                    }
                    for (var a, o = d(i); !(a = o()).done; ) {
                      var h = a.value;
                      h.bitrate > n && (n = h.bitrate);
                    }
                    return n > 0 ? n : NaN;
                  }),
                  (i.getBufferLength = function (t) {
                    var i = this.hls.media,
                      n = t === hs ? this.audioBuffer : this.videoBuffer;
                    return n && i
                      ? 1e3 *
                          cn.bufferInfo(
                            n,
                            i.currentTime,
                            this.config.maxBufferHole
                          ).len
                      : NaN;
                  }),
                  (i.createPlaylistLoader = function () {
                    var t = this.config.pLoader,
                      i = this.applyPlaylistData,
                      n = t || this.config.loader;
                    return (function () {
                      function t(t) {
                        (this.loader = void 0), (this.loader = new n(t));
                      }
                      var r = t.prototype;
                      return (
                        (r.destroy = function () {
                          this.loader.destroy();
                        }),
                        (r.abort = function () {
                          this.loader.abort();
                        }),
                        (r.load = function (t, n, r) {
                          i(t), this.loader.load(t, n, r);
                        }),
                        s(t, [
                          {
                            key: "stats",
                            get: function () {
                              return this.loader.stats;
                            },
                          },
                          {
                            key: "context",
                            get: function () {
                              return this.loader.context;
                            },
                          },
                        ]),
                        t
                      );
                    })();
                  }),
                  (i.createFragmentLoader = function () {
                    var t = this.config.fLoader,
                      i = this.applyFragmentData,
                      n = t || this.config.loader;
                    return (function () {
                      function t(t) {
                        (this.loader = void 0), (this.loader = new n(t));
                      }
                      var r = t.prototype;
                      return (
                        (r.destroy = function () {
                          this.loader.destroy();
                        }),
                        (r.abort = function () {
                          this.loader.abort();
                        }),
                        (r.load = function (t, n, r) {
                          i(t), this.loader.load(t, n, r);
                        }),
                        s(t, [
                          {
                            key: "stats",
                            get: function () {
                              return this.loader.stats;
                            },
                          },
                          {
                            key: "context",
                            get: function () {
                              return this.loader.context;
                            },
                          },
                        ]),
                        t
                      );
                    })();
                  }),
                  (t.uuid = function () {
                    var t = URL.createObjectURL(new Blob()),
                      i = t.toString();
                    return (
                      URL.revokeObjectURL(t), i.slice(i.lastIndexOf("/") + 1)
                    );
                  }),
                  (t.serialize = function (t) {
                    for (
                      var i,
                        n = [],
                        r = function (t) {
                          return (
                            !Number.isNaN(t) &&
                            null != t &&
                            "" !== t &&
                            !1 !== t
                          );
                        },
                        e = function (t) {
                          return Math.round(t);
                        },
                        s = function (t) {
                          return 100 * e(t / 100);
                        },
                        a = {
                          br: e,
                          d: e,
                          bl: s,
                          dl: s,
                          mtp: s,
                          nor: function (t) {
                            return encodeURIComponent(t);
                          },
                          rtp: s,
                          tb: e,
                        },
                        o = d(Object.keys(t || {}).sort());
                      !(i = o()).done;

                    ) {
                      var h = i.value,
                        u = t[h];
                      if (
                        r(u) &&
                        !(("v" === h && 1 === u) || ("pr" == h && 1 === u))
                      ) {
                        var f = a[h];
                        f && (u = f(u));
                        var l,
                          c = typeof u;
                        (l =
                          "ot" === h || "sf" === h || "st" === h
                            ? h + "=" + u
                            : "boolean" === c
                            ? h
                            : "number" === c
                            ? h + "=" + u
                            : h + "=" + JSON.stringify(u)),
                          n.push(l);
                      }
                    }
                    return n.join(",");
                  }),
                  (t.toHeaders = function (i) {
                    for (
                      var n = {},
                        r = ["Object", "Request", "Session", "Status"],
                        e = [{}, {}, {}, {}],
                        s = {
                          br: 0,
                          d: 0,
                          ot: 0,
                          tb: 0,
                          bl: 1,
                          dl: 1,
                          mtp: 1,
                          nor: 1,
                          nrr: 1,
                          su: 1,
                          cid: 2,
                          pr: 2,
                          sf: 2,
                          sid: 2,
                          st: 2,
                          v: 2,
                          bs: 3,
                          rtp: 3,
                        },
                        a = 0,
                        o = Object.keys(i);
                      a < o.length;
                      a++
                    ) {
                      var h = o[a];
                      e[null != s[h] ? s[h] : 1][h] = i[h];
                    }
                    for (var u = 0; u < e.length; u++) {
                      var f = t.serialize(e[u]);
                      f && (n["CMCD-" + r[u]] = f);
                    }
                    return n;
                  }),
                  (t.toQuery = function (i) {
                    return "CMCD=" + encodeURIComponent(t.serialize(i));
                  }),
                  (t.appendQueryToUri = function (t, i) {
                    if (!i) return t;
                    var n = t.includes("?") ? "&" : "?";
                    return "" + t + n + i;
                  }),
                  t
                );
              })(),
              ls = (function () {
                function t(t) {
                  (this.hls = void 0),
                    (this.log = void 0),
                    (this.loader = null),
                    (this.uri = null),
                    (this.pathwayId = "."),
                    (this.pathwayPriority = null),
                    (this.timeToLoad = 300),
                    (this.reloadTimer = -1),
                    (this.updated = 0),
                    (this.started = !1),
                    (this.enabled = !0),
                    (this.levels = null),
                    (this.audioTracks = null),
                    (this.subtitleTracks = null),
                    (this.penalizedPathways = {}),
                    (this.hls = t),
                    (this.log = A.log.bind(A, "[content-steering]:")),
                    this.registerListeners();
                }
                var i = t.prototype;
                return (
                  (i.registerListeners = function () {
                    var t = this.hls;
                    t.on(w.MANIFEST_LOADING, this.onManifestLoading, this),
                      t.on(w.MANIFEST_LOADED, this.onManifestLoaded, this),
                      t.on(w.MANIFEST_PARSED, this.onManifestParsed, this),
                      t.on(w.ERROR, this.onError, this);
                  }),
                  (i.unregisterListeners = function () {
                    var t = this.hls;
                    t &&
                      (t.off(w.MANIFEST_LOADING, this.onManifestLoading, this),
                      t.off(w.MANIFEST_LOADED, this.onManifestLoaded, this),
                      t.off(w.MANIFEST_PARSED, this.onManifestParsed, this),
                      t.off(w.ERROR, this.onError, this));
                  }),
                  (i.startLoad = function () {
                    if (
                      ((this.started = !0),
                      self.clearTimeout(this.reloadTimer),
                      this.enabled && this.uri)
                    )
                      if (this.updated) {
                        var t = Math.max(
                          1e3 * this.timeToLoad -
                            (performance.now() - this.updated),
                          0
                        );
                        this.scheduleRefresh(this.uri, t);
                      } else this.loadSteeringManifest(this.uri);
                  }),
                  (i.stopLoad = function () {
                    (this.started = !1),
                      this.loader &&
                        (this.loader.destroy(), (this.loader = null)),
                      self.clearTimeout(this.reloadTimer);
                  }),
                  (i.destroy = function () {
                    this.unregisterListeners(),
                      this.stopLoad(),
                      (this.hls = null),
                      (this.levels =
                        this.audioTracks =
                        this.subtitleTracks =
                          null);
                  }),
                  (i.removeLevel = function (t) {
                    var i = this.levels;
                    i &&
                      (this.levels = i.filter(function (i) {
                        return i !== t;
                      }));
                  }),
                  (i.onManifestLoading = function () {
                    this.stopLoad(),
                      (this.enabled = !0),
                      (this.timeToLoad = 300),
                      (this.updated = 0),
                      (this.uri = null),
                      (this.pathwayId = "."),
                      (this.levels =
                        this.audioTracks =
                        this.subtitleTracks =
                          null);
                  }),
                  (i.onManifestLoaded = function (t, i) {
                    var n = i.contentSteering;
                    null !== n &&
                      ((this.pathwayId = n.pathwayId),
                      (this.uri = n.uri),
                      this.started && this.startLoad());
                  }),
                  (i.onManifestParsed = function (t, i) {
                    (this.audioTracks = i.audioTracks),
                      (this.subtitleTracks = i.subtitleTracks);
                  }),
                  (i.onError = function (t, i) {
                    var n = i.errorAction;
                    if (
                      2 === (null == n ? void 0 : n.action) &&
                      1 === n.flags
                    ) {
                      var r = this.pathwayPriority,
                        e = this.pathwayId;
                      this.penalizedPathways[e] ||
                        (this.penalizedPathways[e] = performance.now()),
                        !r &&
                          this.levels &&
                          (r = this.levels.reduce(function (t, i) {
                            return (
                              -1 === t.indexOf(i.pathwayId) &&
                                t.push(i.pathwayId),
                              t
                            );
                          }, [])),
                        r &&
                          r.length > 1 &&
                          (this.updatePathwayPriority(r),
                          (n.resolved = this.pathwayId !== e));
                    }
                  }),
                  (i.filterParsedLevels = function (t) {
                    this.levels = t;
                    var i = this.getLevelsForPathway(this.pathwayId);
                    if (0 === i.length) {
                      var n = t[0].pathwayId;
                      this.log(
                        "No levels found in Pathway " +
                          this.pathwayId +
                          '. Setting initial Pathway to "' +
                          n +
                          '"'
                      ),
                        (i = this.getLevelsForPathway(n)),
                        (this.pathwayId = n);
                    }
                    return i.length !== t.length
                      ? (this.log(
                          "Found " +
                            i.length +
                            "/" +
                            t.length +
                            ' levels in Pathway "' +
                            this.pathwayId +
                            '"'
                        ),
                        i)
                      : t;
                  }),
                  (i.getLevelsForPathway = function (t) {
                    return null === this.levels
                      ? []
                      : this.levels.filter(function (i) {
                          return t === i.pathwayId;
                        });
                  }),
                  (i.updatePathwayPriority = function (t) {
                    var i;
                    this.pathwayPriority = t;
                    var n = this.penalizedPathways,
                      r = performance.now();
                    Object.keys(n).forEach(function (t) {
                      r - n[t] > 3e5 && delete n[t];
                    });
                    for (var e = 0; e < t.length; e++) {
                      var s = t[e];
                      if (!n[s]) {
                        if (s === this.pathwayId) return;
                        var a = this.hls.nextLoadLevel,
                          o = this.hls.levels[a];
                        if ((i = this.getLevelsForPathway(s)).length > 0) {
                          this.log('Setting Pathway to "' + s + '"'),
                            (this.pathwayId = s),
                            this.hls.trigger(w.LEVELS_UPDATED, { levels: i });
                          var h = this.hls.levels[a];
                          o &&
                            h &&
                            this.levels &&
                            (h.attrs["STABLE-VARIANT-ID"] !==
                              o.attrs["STABLE-VARIANT-ID"] &&
                              h.bitrate !== o.bitrate &&
                              this.log(
                                "Unstable Pathways change from bitrate " +
                                  o.bitrate +
                                  " to " +
                                  h.bitrate
                              ),
                            (this.hls.nextLoadLevel = a));
                          break;
                        }
                      }
                    }
                  }),
                  (i.clonePathways = function (t) {
                    var i = this,
                      n = this.levels;
                    if (n) {
                      var r = {},
                        e = {};
                      t.forEach(function (t) {
                        var s = t.ID,
                          a = t["BASE-ID"],
                          h = t["URI-REPLACEMENT"];
                        if (
                          !n.some(function (t) {
                            return t.pathwayId === s;
                          })
                        ) {
                          var u = i.getLevelsForPathway(a).map(function (t) {
                            var i = o({}, t);
                            (i.details = void 0),
                              (i.url = vs(
                                t.uri,
                                t.attrs["STABLE-VARIANT-ID"],
                                "PER-VARIANT-URIS",
                                h
                              ));
                            var n = new _(t.attrs);
                            n["PATHWAY-ID"] = s;
                            var a = n.AUDIO && n.AUDIO + "_clone_" + s,
                              u = n.SUBTITLES && n.SUBTITLES + "_clone_" + s;
                            a && ((r[n.AUDIO] = a), (n.AUDIO = a)),
                              u && ((e[n.SUBTITLES] = u), (n.SUBTITLES = u)),
                              (i.attrs = n);
                            var f = new Mi(i);
                            return Ki(f, "audio", a), Ki(f, "text", u), f;
                          });
                          n.push.apply(n, u),
                            cs(i.audioTracks, r, h, s),
                            cs(i.subtitleTracks, e, h, s);
                        }
                      });
                    }
                  }),
                  (i.loadSteeringManifest = function (t) {
                    var i,
                      n = this,
                      r = this.hls.config,
                      e = r.loader;
                    this.loader && this.loader.destroy(),
                      (this.loader = new e(r));
                    try {
                      i = new self.URL(t);
                    } catch (i) {
                      return (
                        (this.enabled = !1),
                        void this.log(
                          "Failed to parse Steering Manifest URI: " + t
                        )
                      );
                    }
                    if ("data:" !== i.protocol) {
                      var s =
                        0 |
                        (this.hls.bandwidthEstimate ||
                          r.abrEwmaDefaultEstimate);
                      i.searchParams.set("_HLS_pathway", this.pathwayId),
                        i.searchParams.set("_HLS_throughput", "" + s);
                    }
                    var a = { responseType: "json", url: i.href },
                      o = r.steeringManifestLoadPolicy.default,
                      h = o.errorRetry || o.timeoutRetry || {},
                      u = {
                        loadPolicy: o,
                        timeout: o.maxLoadTimeMs,
                        maxRetry: h.maxNumRetry || 0,
                        retryDelay: h.retryDelayMs || 0,
                        maxRetryDelay: h.maxRetryDelayMs || 0,
                      },
                      f = {
                        onSuccess: function (t, r, e, s) {
                          n.log('Loaded steering manifest: "' + i + '"');
                          var a = t.data;
                          if (1 === a.VERSION) {
                            (n.updated = performance.now()),
                              (n.timeToLoad = a.TTL);
                            var o = a["RELOAD-URI"],
                              h = a["PATHWAY-CLONES"],
                              u = a["PATHWAY-PRIORITY"];
                            if (o)
                              try {
                                n.uri = new self.URL(o, i).href;
                              } catch (t) {
                                return (
                                  (n.enabled = !1),
                                  void n.log(
                                    "Failed to parse Steering Manifest RELOAD-URI: " +
                                      o
                                  )
                                );
                              }
                            n.scheduleRefresh(n.uri || e.url),
                              h && n.clonePathways(h),
                              u && n.updatePathwayPriority(u);
                          } else
                            n.log(
                              "Steering VERSION " +
                                a.VERSION +
                                " not supported!"
                            );
                        },
                        onError: function (t, i, r, e) {
                          if (
                            (n.log(
                              "Error loading steering manifest: " +
                                t.code +
                                " " +
                                t.text +
                                " (" +
                                i.url +
                                ")"
                            ),
                            n.stopLoad(),
                            410 === t.code)
                          )
                            return (
                              (n.enabled = !1),
                              void n.log(
                                "Steering manifest " +
                                  i.url +
                                  " no longer available"
                              )
                            );
                          var s = 1e3 * n.timeToLoad;
                          if (429 !== t.code)
                            n.scheduleRefresh(n.uri || i.url, s);
                          else {
                            var a = n.loader;
                            if (
                              "function" ==
                              typeof (null == a ? void 0 : a.getResponseHeader)
                            ) {
                              var o = a.getResponseHeader("Retry-After");
                              o && (s = 1e3 * parseFloat(o));
                            }
                            n.log(
                              "Steering manifest " + i.url + " rate limited"
                            );
                          }
                        },
                        onTimeout: function (t, i, r) {
                          n.log(
                            "Timeout loading steering manifest (" + i.url + ")"
                          ),
                            n.scheduleRefresh(n.uri || i.url);
                        },
                      };
                    this.log("Requesting steering manifest: " + i),
                      this.loader.load(a, u, f);
                  }),
                  (i.scheduleRefresh = function (t, i) {
                    var n = this;
                    void 0 === i && (i = 1e3 * this.timeToLoad),
                      self.clearTimeout(this.reloadTimer),
                      (this.reloadTimer = self.setTimeout(function () {
                        n.loadSteeringManifest(t);
                      }, i));
                  }),
                  t
                );
              })();
            function cs(t, i, n, r) {
              t &&
                Object.keys(i).forEach(function (e) {
                  var s = t
                    .filter(function (t) {
                      return t.groupId === e;
                    })
                    .map(function (t) {
                      var s = o({}, t);
                      return (
                        (s.details = void 0),
                        (s.attrs = new _(s.attrs)),
                        (s.url = s.attrs.URI =
                          vs(
                            t.url,
                            t.attrs["STABLE-RENDITION-ID"],
                            "PER-RENDITION-URIS",
                            n
                          )),
                        (s.groupId = s.attrs["GROUP-ID"] = i[e]),
                        (s.attrs["PATHWAY-ID"] = r),
                        s
                      );
                    });
                  t.push.apply(t, s);
                });
            }
            function vs(t, i, n, r) {
              var e,
                s = r.HOST,
                a = r.PARAMS,
                o = r[n];
              i && (e = null == o ? void 0 : o[i]) && (t = e);
              var h = new self.URL(t);
              return (
                s && !e && (h.host = s),
                a &&
                  Object.keys(a)
                    .sort()
                    .forEach(function (t) {
                      t && h.searchParams.set(t, a[t]);
                    }),
                h.href
              );
            }
            var ds = /^age:\s*[\d.]+\s*$/im,
              ps = (function () {
                function t(t) {
                  (this.xhrSetup = void 0),
                    (this.requestTimeout = void 0),
                    (this.retryTimeout = void 0),
                    (this.retryDelay = void 0),
                    (this.config = null),
                    (this.callbacks = null),
                    (this.context = void 0),
                    (this.loader = null),
                    (this.stats = void 0),
                    (this.xhrSetup = (t && t.xhrSetup) || null),
                    (this.stats = new L()),
                    (this.retryDelay = 0);
                }
                var i = t.prototype;
                return (
                  (i.destroy = function () {
                    (this.callbacks = null),
                      this.abortInternal(),
                      (this.loader = null),
                      (this.config = null);
                  }),
                  (i.abortInternal = function () {
                    var t = this.loader;
                    self.clearTimeout(this.requestTimeout),
                      self.clearTimeout(this.retryTimeout),
                      t &&
                        ((t.onreadystatechange = null),
                        (t.onprogress = null),
                        4 !== t.readyState &&
                          ((this.stats.aborted = !0), t.abort()));
                  }),
                  (i.abort = function () {
                    var t;
                    this.abortInternal(),
                      null != (t = this.callbacks) &&
                        t.onAbort &&
                        this.callbacks.onAbort(
                          this.stats,
                          this.context,
                          this.loader
                        );
                  }),
                  (i.load = function (t, i, n) {
                    if (this.stats.loading.start)
                      throw new Error("Loader can only be used once.");
                    (this.stats.loading.start = self.performance.now()),
                      (this.context = t),
                      (this.config = i),
                      (this.callbacks = n),
                      this.loadInternal();
                  }),
                  (i.loadInternal = function () {
                    var t = this,
                      i = this.config,
                      n = this.context;
                    if (i) {
                      var r = (this.loader = new self.XMLHttpRequest()),
                        e = this.stats;
                      (e.loading.first = 0), (e.loaded = 0);
                      var s = this.xhrSetup;
                      s
                        ? Promise.resolve()
                            .then(function () {
                              if (!t.stats.aborted) return s(r, n.url);
                            })
                            .catch(function (t) {
                              return r.open("GET", n.url, !0), s(r, n.url);
                            })
                            .then(function () {
                              t.stats.aborted || t.openAndSendXhr(r, n, i);
                            })
                            .catch(function (i) {
                              t.callbacks.onError(
                                { code: r.status, text: i.message },
                                n,
                                r,
                                e
                              );
                            })
                        : this.openAndSendXhr(r, n, i);
                    }
                  }),
                  (i.openAndSendXhr = function (t, i, n) {
                    t.readyState || t.open("GET", i.url, !0);
                    var r = this.context.headers,
                      e = n.loadPolicy,
                      s = e.maxTimeToFirstByteMs,
                      a = e.maxLoadTimeMs;
                    if (r) for (var o in r) t.setRequestHeader(o, r[o]);
                    i.rangeEnd &&
                      t.setRequestHeader(
                        "Range",
                        "bytes=" + i.rangeStart + "-" + (i.rangeEnd - 1)
                      ),
                      (t.onreadystatechange = this.readystatechange.bind(this)),
                      (t.onprogress = this.loadprogress.bind(this)),
                      (t.responseType = i.responseType),
                      self.clearTimeout(this.requestTimeout),
                      (n.timeout = s && g(s) ? s : a),
                      (this.requestTimeout = self.setTimeout(
                        this.loadtimeout.bind(this),
                        n.timeout
                      )),
                      t.send();
                  }),
                  (i.readystatechange = function () {
                    var t = this.context,
                      i = this.loader,
                      n = this.stats;
                    if (t && i) {
                      var r = i.readyState,
                        e = this.config;
                      if (
                        !n.aborted &&
                        r >= 2 &&
                        (0 === n.loading.first &&
                          ((n.loading.first = Math.max(
                            self.performance.now(),
                            n.loading.start
                          )),
                          e.timeout !== e.loadPolicy.maxLoadTimeMs &&
                            (self.clearTimeout(this.requestTimeout),
                            (e.timeout = e.loadPolicy.maxLoadTimeMs),
                            (this.requestTimeout = self.setTimeout(
                              this.loadtimeout.bind(this),
                              e.loadPolicy.maxLoadTimeMs -
                                (n.loading.first - n.loading.start)
                            )))),
                        4 === r)
                      ) {
                        self.clearTimeout(this.requestTimeout),
                          (i.onreadystatechange = null),
                          (i.onprogress = null);
                        var s = i.status,
                          a = "text" !== i.responseType;
                        if (
                          s >= 200 &&
                          s < 300 &&
                          ((a && i.response) || null !== i.responseText)
                        ) {
                          n.loading.end = Math.max(
                            self.performance.now(),
                            n.loading.first
                          );
                          var o = a ? i.response : i.responseText,
                            h =
                              "arraybuffer" === i.responseType
                                ? o.byteLength
                                : o.length;
                          if (
                            ((n.loaded = n.total = h),
                            (n.bwEstimate =
                              (8e3 * n.total) /
                              (n.loading.end - n.loading.first)),
                            !this.callbacks)
                          )
                            return;
                          var u = this.callbacks.onProgress;
                          if ((u && u(n, t, o, i), !this.callbacks)) return;
                          var f = { url: i.responseURL, data: o, code: s };
                          this.callbacks.onSuccess(f, n, t, i);
                        } else {
                          var l = e.loadPolicy.errorRetry;
                          ji(l, n.retry, !1, s)
                            ? this.retry(l)
                            : (A.error(s + " while loading " + t.url),
                              this.callbacks.onError(
                                { code: s, text: i.statusText },
                                t,
                                i,
                                n
                              ));
                        }
                      }
                    }
                  }),
                  (i.loadtimeout = function () {
                    var t,
                      i =
                        null == (t = this.config)
                          ? void 0
                          : t.loadPolicy.timeoutRetry;
                    if (ji(i, this.stats.retry, !0)) this.retry(i);
                    else {
                      A.warn("timeout while loading " + this.context.url);
                      var n = this.callbacks;
                      n &&
                        (this.abortInternal(),
                        n.onTimeout(this.stats, this.context, this.loader));
                    }
                  }),
                  (i.retry = function (t) {
                    var i = this.context,
                      n = this.stats;
                    (this.retryDelay = Ui(t, n.retry)),
                      n.retry++,
                      A.warn(
                        (status ? "HTTP Status " + status : "Timeout") +
                          " while loading " +
                          i.url +
                          ", retrying " +
                          n.retry +
                          "/" +
                          t.maxNumRetry +
                          " in " +
                          this.retryDelay +
                          "ms"
                      ),
                      this.abortInternal(),
                      (this.loader = null),
                      self.clearTimeout(this.retryTimeout),
                      (this.retryTimeout = self.setTimeout(
                        this.loadInternal.bind(this),
                        this.retryDelay
                      ));
                  }),
                  (i.loadprogress = function (t) {
                    var i = this.stats;
                    (i.loaded = t.loaded),
                      t.lengthComputable && (i.total = t.total);
                  }),
                  (i.getCacheAge = function () {
                    var t = null;
                    if (
                      this.loader &&
                      ds.test(this.loader.getAllResponseHeaders())
                    ) {
                      var i = this.loader.getResponseHeader("age");
                      t = i ? parseFloat(i) : null;
                    }
                    return t;
                  }),
                  (i.getResponseHeader = function (t) {
                    return this.loader &&
                      new RegExp("^" + t + ":\\s*[\\d.]+\\s*$", "im").test(
                        this.loader.getAllResponseHeaders()
                      )
                      ? this.loader.getResponseHeader(t)
                      : null;
                  }),
                  t
                );
              })(),
              ms = /(\d+)-(\d+)\/(\d+)/,
              ys = (function () {
                function t(t) {
                  (this.fetchSetup = void 0),
                    (this.requestTimeout = void 0),
                    (this.request = void 0),
                    (this.response = void 0),
                    (this.controller = void 0),
                    (this.context = void 0),
                    (this.config = null),
                    (this.callbacks = null),
                    (this.stats = void 0),
                    (this.loader = null),
                    (this.fetchSetup = t.fetchSetup || gs),
                    (this.controller = new self.AbortController()),
                    (this.stats = new L());
                }
                var i = t.prototype;
                return (
                  (i.destroy = function () {
                    (this.loader = this.callbacks = null), this.abortInternal();
                  }),
                  (i.abortInternal = function () {
                    var t = this.response;
                    (null != t && t.ok) ||
                      ((this.stats.aborted = !0), this.controller.abort());
                  }),
                  (i.abort = function () {
                    var t;
                    this.abortInternal(),
                      null != (t = this.callbacks) &&
                        t.onAbort &&
                        this.callbacks.onAbort(
                          this.stats,
                          this.context,
                          this.response
                        );
                  }),
                  (i.load = function (t, i, n) {
                    var r = this,
                      e = this.stats;
                    if (e.loading.start)
                      throw new Error("Loader can only be used once.");
                    e.loading.start = self.performance.now();
                    var s = (function (t, i) {
                        var n = {
                          method: "GET",
                          mode: "cors",
                          credentials: "same-origin",
                          signal: i,
                          headers: new self.Headers(o({}, t.headers)),
                        };
                        return (
                          t.rangeEnd &&
                            n.headers.set(
                              "Range",
                              "bytes=" +
                                t.rangeStart +
                                "-" +
                                String(t.rangeEnd - 1)
                            ),
                          n
                        );
                      })(t, this.controller.signal),
                      a = n.onProgress,
                      h = "arraybuffer" === t.responseType,
                      u = h ? "byteLength" : "length",
                      f = i.loadPolicy,
                      l = f.maxTimeToFirstByteMs,
                      c = f.maxLoadTimeMs;
                    (this.context = t),
                      (this.config = i),
                      (this.callbacks = n),
                      (this.request = this.fetchSetup(t, s)),
                      self.clearTimeout(this.requestTimeout),
                      (i.timeout = l && g(l) ? l : c),
                      (this.requestTimeout = self.setTimeout(function () {
                        r.abortInternal(), n.onTimeout(e, t, r.response);
                      }, i.timeout)),
                      self
                        .fetch(this.request)
                        .then(function (s) {
                          r.response = r.loader = s;
                          var o = Math.max(
                            self.performance.now(),
                            e.loading.start
                          );
                          if (
                            (self.clearTimeout(r.requestTimeout),
                            (i.timeout = c),
                            (r.requestTimeout = self.setTimeout(function () {
                              r.abortInternal(), n.onTimeout(e, t, r.response);
                            }, c - (o - e.loading.start))),
                            !s.ok)
                          ) {
                            var u = s.status,
                              f = s.statusText;
                            throw new ws(
                              f || "fetch, bad network response",
                              u,
                              s
                            );
                          }
                          return (
                            (e.loading.first = o),
                            (e.total =
                              (function (t) {
                                var i = t.get("Content-Range");
                                if (i) {
                                  var n = (function (t) {
                                    var i = ms.exec(t);
                                    if (i)
                                      return (
                                        parseInt(i[2]) - parseInt(i[1]) + 1
                                      );
                                  })(i);
                                  if (g(n)) return n;
                                }
                                var r = t.get("Content-Length");
                                if (r) return parseInt(r);
                              })(s.headers) || e.total),
                            a && g(i.highWaterMark)
                              ? r.loadProgressively(s, e, t, i.highWaterMark, a)
                              : h
                              ? s.arrayBuffer()
                              : "json" === t.responseType
                              ? s.json()
                              : s.text()
                          );
                        })
                        .then(function (s) {
                          var o = r.response;
                          self.clearTimeout(r.requestTimeout),
                            (e.loading.end = Math.max(
                              self.performance.now(),
                              e.loading.first
                            ));
                          var h = s[u];
                          h && (e.loaded = e.total = h);
                          var f = { url: o.url, data: s, code: o.status };
                          a && !g(i.highWaterMark) && a(e, t, s, o),
                            n.onSuccess(f, e, t, o);
                        })
                        .catch(function (i) {
                          if (
                            (self.clearTimeout(r.requestTimeout), !e.aborted)
                          ) {
                            var s = (i && i.code) || 0,
                              a = i ? i.message : null;
                            n.onError(
                              { code: s, text: a },
                              t,
                              i ? i.details : null,
                              e
                            );
                          }
                        });
                  }),
                  (i.getCacheAge = function () {
                    var t = null;
                    if (this.response) {
                      var i = this.response.headers.get("age");
                      t = i ? parseFloat(i) : null;
                    }
                    return t;
                  }),
                  (i.getResponseHeader = function (t) {
                    return this.response ? this.response.headers.get(t) : null;
                  }),
                  (i.loadProgressively = function (t, i, n, r, e) {
                    void 0 === r && (r = 0);
                    var s = new Jr(),
                      a = t.body.getReader();
                    return (function o() {
                      return a
                        .read()
                        .then(function (a) {
                          if (a.done)
                            return (
                              s.dataLength && e(i, n, s.flush(), t),
                              Promise.resolve(new ArrayBuffer(0))
                            );
                          var h = a.value,
                            u = h.length;
                          return (
                            (i.loaded += u),
                            u < r || s.dataLength
                              ? (s.push(h),
                                s.dataLength >= r && e(i, n, s.flush(), t))
                              : e(i, n, h, t),
                            o()
                          );
                        })
                        .catch(function () {
                          return Promise.reject();
                        });
                    })();
                  }),
                  t
                );
              })();
            function gs(t, i) {
              return new self.Request(t.url, i);
            }
            var ws = (function (t) {
                function i(i, n, r) {
                  var e;
                  return (
                    ((e = t.call(this, i) || this).code = void 0),
                    (e.details = void 0),
                    (e.code = n),
                    (e.details = r),
                    e
                  );
                }
                return h(i, t), i;
              })(c(Error)),
              bs = /\s/,
              ks = r(
                r(
                  {
                    autoStartLoad: !0,
                    startPosition: -1,
                    defaultAudioCodec: void 0,
                    debug: !1,
                    capLevelOnFPSDrop: !1,
                    capLevelToPlayerSize: !1,
                    ignoreDevicePixelRatio: !1,
                    initialLiveManifestSize: 1,
                    maxBufferLength: 30,
                    backBufferLength: 1 / 0,
                    maxBufferSize: 6e7,
                    maxBufferHole: 0.1,
                    highBufferWatchdogPeriod: 2,
                    nudgeOffset: 0.1,
                    nudgeMaxRetry: 3,
                    maxFragLookUpTolerance: 0.25,
                    liveSyncDurationCount: 3,
                    liveMaxLatencyDurationCount: 1 / 0,
                    liveSyncDuration: void 0,
                    liveMaxLatencyDuration: void 0,
                    maxLiveSyncPlaybackRate: 1,
                    liveDurationInfinity: !1,
                    liveBackBufferLength: null,
                    maxMaxBufferLength: 600,
                    enableWorker: !0,
                    workerPath: null,
                    enableSoftwareAES: !0,
                    startLevel: void 0,
                    startFragPrefetch: !1,
                    fpsDroppedMonitoringPeriod: 5e3,
                    fpsDroppedMonitoringThreshold: 0.2,
                    appendErrorMaxRetry: 3,
                    loader: ps,
                    fLoader: void 0,
                    pLoader: void 0,
                    xhrSetup: void 0,
                    licenseXhrSetup: void 0,
                    licenseResponseCallback: void 0,
                    abrController: qr,
                    bufferController: ue,
                    capLevelController: rs,
                    errorController: Vi,
                    fpsController: es,
                    stretchShortVideoTrack: !1,
                    maxAudioFramesDrift: 1,
                    forceKeyFrameOnDiscontinuity: !0,
                    abrEwmaFastLive: 3,
                    abrEwmaSlowLive: 9,
                    abrEwmaFastVoD: 3,
                    abrEwmaSlowVoD: 9,
                    abrEwmaDefaultEstimate: 5e5,
                    abrBandWidthFactor: 0.95,
                    abrBandWidthUpFactor: 0.7,
                    abrMaxWithRealBitrate: !1,
                    maxStarvationDelay: 4,
                    maxLoadingDelay: 4,
                    minAutoBitrate: 0,
                    emeEnabled: !1,
                    widevineLicenseUrl: void 0,
                    drmSystems: {},
                    drmSystemOptions: {},
                    requestMediaKeySystemAccessFunc: J,
                    testBandwidth: !0,
                    progressive: !1,
                    lowLatencyMode: !0,
                    cmcd: void 0,
                    enableDateRangeMetadataCues: !0,
                    enableEmsgMetadataCues: !0,
                    enableID3MetadataCues: !0,
                    certLoadPolicy: {
                      default: {
                        maxTimeToFirstByteMs: 8e3,
                        maxLoadTimeMs: 2e4,
                        timeoutRetry: null,
                        errorRetry: null,
                      },
                    },
                    keyLoadPolicy: {
                      default: {
                        maxTimeToFirstByteMs: 8e3,
                        maxLoadTimeMs: 2e4,
                        timeoutRetry: {
                          maxNumRetry: 1,
                          retryDelayMs: 1e3,
                          maxRetryDelayMs: 2e4,
                          backoff: "linear",
                        },
                        errorRetry: {
                          maxNumRetry: 8,
                          retryDelayMs: 1e3,
                          maxRetryDelayMs: 2e4,
                          backoff: "linear",
                        },
                      },
                    },
                    manifestLoadPolicy: {
                      default: {
                        maxTimeToFirstByteMs: 1 / 0,
                        maxLoadTimeMs: 2e4,
                        timeoutRetry: {
                          maxNumRetry: 2,
                          retryDelayMs: 0,
                          maxRetryDelayMs: 0,
                        },
                        errorRetry: {
                          maxNumRetry: 1,
                          retryDelayMs: 1e3,
                          maxRetryDelayMs: 8e3,
                        },
                      },
                    },
                    playlistLoadPolicy: {
                      default: {
                        maxTimeToFirstByteMs: 1e4,
                        maxLoadTimeMs: 2e4,
                        timeoutRetry: {
                          maxNumRetry: 2,
                          retryDelayMs: 0,
                          maxRetryDelayMs: 0,
                        },
                        errorRetry: {
                          maxNumRetry: 2,
                          retryDelayMs: 1e3,
                          maxRetryDelayMs: 8e3,
                        },
                      },
                    },
                    fragLoadPolicy: {
                      default: {
                        maxTimeToFirstByteMs: 1e4,
                        maxLoadTimeMs: 12e4,
                        timeoutRetry: {
                          maxNumRetry: 4,
                          retryDelayMs: 0,
                          maxRetryDelayMs: 0,
                        },
                        errorRetry: {
                          maxNumRetry: 6,
                          retryDelayMs: 1e3,
                          maxRetryDelayMs: 8e3,
                        },
                      },
                    },
                    steeringManifestLoadPolicy: {
                      default: {
                        maxTimeToFirstByteMs: 1e4,
                        maxLoadTimeMs: 2e4,
                        timeoutRetry: {
                          maxNumRetry: 2,
                          retryDelayMs: 0,
                          maxRetryDelayMs: 0,
                        },
                        errorRetry: {
                          maxNumRetry: 1,
                          retryDelayMs: 1e3,
                          maxRetryDelayMs: 8e3,
                        },
                      },
                    },
                    manifestLoadingTimeOut: 1e4,
                    manifestLoadingMaxRetry: 1,
                    manifestLoadingRetryDelay: 1e3,
                    manifestLoadingMaxRetryTimeout: 64e3,
                    levelLoadingTimeOut: 1e4,
                    levelLoadingMaxRetry: 4,
                    levelLoadingRetryDelay: 1e3,
                    levelLoadingMaxRetryTimeout: 64e3,
                    fragLoadingTimeOut: 2e4,
                    fragLoadingMaxRetry: 6,
                    fragLoadingRetryDelay: 1e3,
                    fragLoadingMaxRetryTimeout: 64e3,
                  },
                  {
                    cueHandler: {
                      newCue: function (t, i, n, r) {
                        for (
                          var e,
                            s,
                            a,
                            o,
                            h,
                            u = [],
                            f = self.VTTCue || self.TextTrackCue,
                            l = 0;
                          l < r.rows.length;
                          l++
                        )
                          if (
                            ((a = !0),
                            (o = 0),
                            (h = ""),
                            !(e = r.rows[l]).isEmpty())
                          ) {
                            for (var c, v = 0; v < e.chars.length; v++)
                              bs.test(e.chars[v].uchar) && a
                                ? o++
                                : ((h += e.chars[v].uchar), (a = !1));
                            (e.cueStartTime = i),
                              i === n && (n += 1e-4),
                              o >= 16 ? o-- : o++;
                            var d = Fe(h.trim()),
                              p = $e(i, n, d);
                            (null != t &&
                              null != (c = t.cues) &&
                              c.getCueById(p)) ||
                              (((s = new f(i, n, d)).id = p),
                              (s.line = l + 1),
                              (s.align = "left"),
                              (s.position =
                                10 +
                                Math.min(80, 10 * Math.floor((8 * o) / 32))),
                              u.push(s));
                          }
                        return (
                          t &&
                            u.length &&
                            (u.sort(function (t, i) {
                              return "auto" === t.line || "auto" === i.line
                                ? 0
                                : t.line > 8 && i.line > 8
                                ? i.line - t.line
                                : t.line - i.line;
                            }),
                            u.forEach(function (i) {
                              return pi(t, i);
                            })),
                          u
                        );
                      },
                    },
                    enableWebVTT: !0,
                    enableIMSC1: !0,
                    enableCEA708Captions: !0,
                    captionsTextTrack1Label: "English",
                    captionsTextTrack1LanguageCode: "en",
                    captionsTextTrack2Label: "Spanish",
                    captionsTextTrack2LanguageCode: "es",
                    captionsTextTrack3Label: "Unknown CC",
                    captionsTextTrack3LanguageCode: "",
                    captionsTextTrack4Label: "Unknown CC",
                    captionsTextTrack4LanguageCode: "",
                    renderTextTracksNatively: !0,
                  }
                ),
                {},
                {
                  subtitleStreamController: ne,
                  subtitleTrackController: ee,
                  timelineController: is,
                  audioStreamController: Qr,
                  audioTrackController: Zr,
                  emeController: as,
                  cmcdController: fs,
                  contentSteeringController: ls,
                }
              );
            function Es(t) {
              return t && "object" == typeof t
                ? Array.isArray(t)
                  ? t.map(Es)
                  : Object.keys(t).reduce(function (i, n) {
                      return (i[n] = Es(t[n])), i;
                    }, {})
                : t;
            }
            var Ts = (function () {
              function t(i) {
                void 0 === i && (i = {}),
                  (this.config = void 0),
                  (this.userConfig = void 0),
                  (this.coreComponents = void 0),
                  (this.networkControllers = void 0),
                  (this.Bt = new Br()),
                  (this.Xt = void 0),
                  (this.Yt = null),
                  (this.abrController = void 0),
                  (this.bufferController = void 0),
                  (this.capLevelController = void 0),
                  (this.latencyController = void 0),
                  (this.levelController = void 0),
                  (this.streamController = void 0),
                  (this.audioTrackController = void 0),
                  (this.subtitleTrackController = void 0),
                  (this.emeController = void 0),
                  (this.cmcdController = void 0),
                  (this.$t = null),
                  (this.url = null),
                  S(i.debug || !1, "Hls instance");
                var n = (this.config = (function (t, i) {
                  if (
                    (i.liveSyncDurationCount ||
                      i.liveMaxLatencyDurationCount) &&
                    (i.liveSyncDuration || i.liveMaxLatencyDuration)
                  )
                    throw new Error(
                      "Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration"
                    );
                  if (
                    void 0 !== i.liveMaxLatencyDurationCount &&
                    (void 0 === i.liveSyncDurationCount ||
                      i.liveMaxLatencyDurationCount <= i.liveSyncDurationCount)
                  )
                    throw new Error(
                      'Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"'
                    );
                  if (
                    void 0 !== i.liveMaxLatencyDuration &&
                    (void 0 === i.liveSyncDuration ||
                      i.liveMaxLatencyDuration <= i.liveSyncDuration)
                  )
                    throw new Error(
                      'Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"'
                    );
                  var n = Es(t),
                    e = [
                      "TimeOut",
                      "MaxRetry",
                      "RetryDelay",
                      "MaxRetryTimeout",
                    ];
                  return (
                    ["manifest", "level", "frag"].forEach(function (t) {
                      var r = ("level" === t ? "playlist" : t) + "LoadPolicy",
                        s = void 0 === i[r],
                        a = [];
                      e.forEach(function (e) {
                        var o = t + "Loading" + e,
                          h = i[o];
                        if (void 0 !== h && s) {
                          a.push(o);
                          var u = n[r].default;
                          switch (((i[r] = { default: u }), e)) {
                            case "TimeOut":
                              (u.maxLoadTimeMs = h),
                                (u.maxTimeToFirstByteMs = h);
                              break;
                            case "MaxRetry":
                              (u.errorRetry.maxNumRetry = h),
                                (u.timeoutRetry.maxNumRetry = h);
                              break;
                            case "RetryDelay":
                              (u.errorRetry.retryDelayMs = h),
                                (u.timeoutRetry.retryDelayMs = h);
                              break;
                            case "MaxRetryTimeout":
                              (u.errorRetry.maxRetryDelayMs = h),
                                (u.timeoutRetry.maxRetryDelayMs = h);
                          }
                        }
                      }),
                        a.length &&
                          A.warn(
                            'hls.js config: "' +
                              a.join('", "') +
                              '" setting(s) are deprecated, use "' +
                              r +
                              '": ' +
                              JSON.stringify(i[r])
                          );
                    }),
                    r(r({}, n), i)
                  );
                })(t.DefaultConfig, i));
                (this.userConfig = i),
                  (this.Xt = -1),
                  n.progressive &&
                    (function (t) {
                      var i = t.loader;
                      i !== ys && i !== ps
                        ? (A.log(
                            "[config]: Custom loader detected, cannot enable progressive streaming"
                          ),
                          (t.progressive = !1))
                        : (function () {
                            if (
                              self.fetch &&
                              self.AbortController &&
                              self.ReadableStream &&
                              self.Request
                            )
                              try {
                                return new self.ReadableStream({}), !0;
                              } catch (t) {}
                            return !1;
                          })() &&
                          ((t.loader = ys),
                          (t.progressive = !0),
                          (t.enableSoftwareAES = !0),
                          A.log(
                            "[config]: Progressive streaming enabled, using FetchLoader"
                          ));
                    })(n);
                var e = n.abrController,
                  s = n.bufferController,
                  a = n.capLevelController,
                  o = n.errorController,
                  h = n.fpsController,
                  u = new o(this),
                  f = (this.abrController = new e(this)),
                  l = (this.bufferController = new s(this)),
                  c = (this.capLevelController = new a(this)),
                  v = new h(this),
                  d = new vi(this),
                  p = new Ti(this),
                  m = n.contentSteeringController,
                  y = m ? new m(this) : null,
                  g = (this.levelController = new Wi(this, y)),
                  b = new tn(this),
                  k = new un(this.config),
                  E = (this.streamController = new Wr(this, b, k));
                c.setStreamController(E), v.setStreamController(E);
                var T = [d, g, E];
                y && T.splice(1, 0, y), (this.networkControllers = T);
                var x = [f, l, c, v, p, b];
                this.audioTrackController = this.createController(
                  n.audioTrackController,
                  T
                );
                var M = n.audioStreamController;
                M && T.push(new M(this, b, k)),
                  (this.subtitleTrackController = this.createController(
                    n.subtitleTrackController,
                    T
                  ));
                var D = n.subtitleStreamController;
                D && T.push(new D(this, b, k)),
                  this.createController(n.timelineController, x),
                  (k.emeController = this.emeController =
                    this.createController(n.emeController, x)),
                  (this.cmcdController = this.createController(
                    n.cmcdController,
                    x
                  )),
                  (this.latencyController = this.createController(xi, x)),
                  (this.coreComponents = x),
                  T.push(u);
                var _ = u.onErrorOut;
                "function" == typeof _ && this.on(w.ERROR, _, u);
              }
              t.isSupported = function () {
                return (function () {
                  var t = Xt();
                  if (!t) return !1;
                  var i = Cn(),
                    n =
                      t &&
                      "function" == typeof t.isTypeSupported &&
                      t.isTypeSupported(
                        'video/mp4; codecs="avc1.42E01E,mp4a.40.2"'
                      ),
                    r =
                      !i ||
                      (i.prototype &&
                        "function" == typeof i.prototype.appendBuffer &&
                        "function" == typeof i.prototype.remove);
                  return !!n && !!r;
                })();
              };
              var i = t.prototype;
              return (
                (i.createController = function (t, i) {
                  if (t) {
                    var n = new t(this);
                    return i && i.push(n), n;
                  }
                  return null;
                }),
                (i.on = function (t, i, n) {
                  void 0 === n && (n = this), this.Bt.on(t, i, n);
                }),
                (i.once = function (t, i, n) {
                  void 0 === n && (n = this), this.Bt.once(t, i, n);
                }),
                (i.removeAllListeners = function (t) {
                  this.Bt.removeAllListeners(t);
                }),
                (i.off = function (t, i, n, r) {
                  void 0 === n && (n = this), this.Bt.off(t, i, n, r);
                }),
                (i.listeners = function (t) {
                  return this.Bt.listeners(t);
                }),
                (i.emit = function (t, i, n) {
                  return this.Bt.emit(t, i, n);
                }),
                (i.trigger = function (t, i) {
                  if (this.config.debug) return this.emit(t, t, i);
                  try {
                    return this.emit(t, t, i);
                  } catch (i) {
                    A.error(
                      "An internal error happened while handling event " +
                        t +
                        '. Error message: "' +
                        i.message +
                        '". Here is a stacktrace:',
                      i
                    ),
                      this.trigger(w.ERROR, {
                        type: b.OTHER_ERROR,
                        details: k.INTERNAL_EXCEPTION,
                        fatal: !1,
                        event: t,
                        error: i,
                      });
                  }
                  return !1;
                }),
                (i.listenerCount = function (t) {
                  return this.Bt.listenerCount(t);
                }),
                (i.destroy = function () {
                  A.log("destroy"),
                    this.trigger(w.DESTROYING, void 0),
                    this.detachMedia(),
                    this.removeAllListeners(),
                    (this.Xt = -1),
                    (this.url = null),
                    this.networkControllers.forEach(function (t) {
                      return t.destroy();
                    }),
                    (this.networkControllers.length = 0),
                    this.coreComponents.forEach(function (t) {
                      return t.destroy();
                    }),
                    (this.coreComponents.length = 0);
                  var t = this.config;
                  (t.xhrSetup = t.fetchSetup = void 0),
                    (this.userConfig = null);
                }),
                (i.attachMedia = function (t) {
                  A.log("attachMedia"),
                    (this.$t = t),
                    this.trigger(w.MEDIA_ATTACHING, { media: t });
                }),
                (i.detachMedia = function () {
                  A.log("detachMedia"),
                    this.trigger(w.MEDIA_DETACHING, void 0),
                    (this.$t = null);
                }),
                (i.loadSource = function (t) {
                  this.stopLoad();
                  var i = this.media,
                    n = this.url,
                    r = (this.url = y.buildAbsoluteURL(self.location.href, t, {
                      alwaysNormalize: !0,
                    }));
                  A.log("loadSource:" + r),
                    i &&
                      n &&
                      (n !== r || this.bufferController.hasSourceTypes()) &&
                      (this.detachMedia(), this.attachMedia(i)),
                    this.trigger(w.MANIFEST_LOADING, { url: t });
                }),
                (i.startLoad = function (t) {
                  void 0 === t && (t = -1),
                    A.log("startLoad(" + t + ")"),
                    this.networkControllers.forEach(function (i) {
                      i.startLoad(t);
                    });
                }),
                (i.stopLoad = function () {
                  A.log("stopLoad"),
                    this.networkControllers.forEach(function (t) {
                      t.stopLoad();
                    });
                }),
                (i.swapAudioCodec = function () {
                  A.log("swapAudioCodec"),
                    this.streamController.swapAudioCodec();
                }),
                (i.recoverMediaError = function () {
                  A.log("recoverMediaError");
                  var t = this.$t;
                  this.detachMedia(), t && this.attachMedia(t);
                }),
                (i.removeLevel = function (t, i) {
                  void 0 === i && (i = 0),
                    this.levelController.removeLevel(t, i);
                }),
                s(
                  t,
                  [
                    {
                      key: "levels",
                      get: function () {
                        return this.levelController.levels || [];
                      },
                    },
                    {
                      key: "currentLevel",
                      get: function () {
                        return this.streamController.currentLevel;
                      },
                      set: function (t) {
                        A.log("set currentLevel:" + t),
                          (this.loadLevel = t),
                          this.abrController.clearTimer(),
                          this.streamController.immediateLevelSwitch();
                      },
                    },
                    {
                      key: "nextLevel",
                      get: function () {
                        return this.streamController.nextLevel;
                      },
                      set: function (t) {
                        A.log("set nextLevel:" + t),
                          (this.levelController.manualLevel = t),
                          this.streamController.nextLevelSwitch();
                      },
                    },
                    {
                      key: "loadLevel",
                      get: function () {
                        return this.levelController.level;
                      },
                      set: function (t) {
                        A.log("set loadLevel:" + t),
                          (this.levelController.manualLevel = t);
                      },
                    },
                    {
                      key: "nextLoadLevel",
                      get: function () {
                        return this.levelController.nextLoadLevel;
                      },
                      set: function (t) {
                        this.levelController.nextLoadLevel = t;
                      },
                    },
                    {
                      key: "firstLevel",
                      get: function () {
                        return Math.max(
                          this.levelController.firstLevel,
                          this.minAutoLevel
                        );
                      },
                      set: function (t) {
                        A.log("set firstLevel:" + t),
                          (this.levelController.firstLevel = t);
                      },
                    },
                    {
                      key: "startLevel",
                      get: function () {
                        return this.levelController.startLevel;
                      },
                      set: function (t) {
                        A.log("set startLevel:" + t),
                          -1 !== t && (t = Math.max(t, this.minAutoLevel)),
                          (this.levelController.startLevel = t);
                      },
                    },
                    {
                      key: "capLevelToPlayerSize",
                      get: function () {
                        return this.config.capLevelToPlayerSize;
                      },
                      set: function (t) {
                        var i = !!t;
                        i !== this.config.capLevelToPlayerSize &&
                          (i
                            ? this.capLevelController.startCapping()
                            : (this.capLevelController.stopCapping(),
                              (this.autoLevelCapping = -1),
                              this.streamController.nextLevelSwitch()),
                          (this.config.capLevelToPlayerSize = i));
                      },
                    },
                    {
                      key: "autoLevelCapping",
                      get: function () {
                        return this.Xt;
                      },
                      set: function (t) {
                        this.Xt !== t &&
                          (A.log("set autoLevelCapping:" + t), (this.Xt = t));
                      },
                    },
                    {
                      key: "bandwidthEstimate",
                      get: function () {
                        var t = this.abrController.bwEstimator;
                        return t ? t.getEstimate() : NaN;
                      },
                    },
                    {
                      key: "ttfbEstimate",
                      get: function () {
                        var t = this.abrController.bwEstimator;
                        return t ? t.getEstimateTTFB() : NaN;
                      },
                    },
                    {
                      key: "maxHdcpLevel",
                      get: function () {
                        return this.Yt;
                      },
                      set: function (t) {
                        Si.indexOf(t) > -1 && (this.Yt = t);
                      },
                    },
                    {
                      key: "autoLevelEnabled",
                      get: function () {
                        return -1 === this.levelController.manualLevel;
                      },
                    },
                    {
                      key: "manualLevel",
                      get: function () {
                        return this.levelController.manualLevel;
                      },
                    },
                    {
                      key: "minAutoLevel",
                      get: function () {
                        var t = this.levels,
                          i = this.config.minAutoBitrate;
                        if (!t) return 0;
                        for (var n = t.length, r = 0; r < n; r++)
                          if (t[r].maxBitrate >= i) return r;
                        return 0;
                      },
                    },
                    {
                      key: "maxAutoLevel",
                      get: function () {
                        var t,
                          i = this.levels,
                          n = this.autoLevelCapping,
                          r = this.maxHdcpLevel;
                        if (
                          ((t = -1 === n && i && i.length ? i.length - 1 : n),
                          r)
                        )
                          for (var e = t; e--; ) {
                            var s = i[e].attrs["HDCP-LEVEL"];
                            if (s && s <= r) return e;
                          }
                        return t;
                      },
                    },
                    {
                      key: "nextAutoLevel",
                      get: function () {
                        return Math.min(
                          Math.max(
                            this.abrController.nextAutoLevel,
                            this.minAutoLevel
                          ),
                          this.maxAutoLevel
                        );
                      },
                      set: function (t) {
                        this.abrController.nextAutoLevel = Math.max(
                          this.minAutoLevel,
                          t
                        );
                      },
                    },
                    {
                      key: "playingDate",
                      get: function () {
                        return this.streamController.currentProgramDateTime;
                      },
                    },
                    {
                      key: "mainForwardBufferInfo",
                      get: function () {
                        return this.streamController.getMainFwdBufferInfo();
                      },
                    },
                    {
                      key: "audioTracks",
                      get: function () {
                        var t = this.audioTrackController;
                        return t ? t.audioTracks : [];
                      },
                    },
                    {
                      key: "audioTrack",
                      get: function () {
                        var t = this.audioTrackController;
                        return t ? t.audioTrack : -1;
                      },
                      set: function (t) {
                        var i = this.audioTrackController;
                        i && (i.audioTrack = t);
                      },
                    },
                    {
                      key: "subtitleTracks",
                      get: function () {
                        var t = this.subtitleTrackController;
                        return t ? t.subtitleTracks : [];
                      },
                    },
                    {
                      key: "subtitleTrack",
                      get: function () {
                        var t = this.subtitleTrackController;
                        return t ? t.subtitleTrack : -1;
                      },
                      set: function (t) {
                        var i = this.subtitleTrackController;
                        i && (i.subtitleTrack = t);
                      },
                    },
                    {
                      key: "media",
                      get: function () {
                        return this.$t;
                      },
                    },
                    {
                      key: "subtitleDisplay",
                      get: function () {
                        var t = this.subtitleTrackController;
                        return !!t && t.subtitleDisplay;
                      },
                      set: function (t) {
                        var i = this.subtitleTrackController;
                        i && (i.subtitleDisplay = t);
                      },
                    },
                    {
                      key: "lowLatencyMode",
                      get: function () {
                        return this.config.lowLatencyMode;
                      },
                      set: function (t) {
                        this.config.lowLatencyMode = t;
                      },
                    },
                    {
                      key: "liveSyncPosition",
                      get: function () {
                        return this.latencyController.liveSyncPosition;
                      },
                    },
                    {
                      key: "latency",
                      get: function () {
                        return this.latencyController.latency;
                      },
                    },
                    {
                      key: "maxLatency",
                      get: function () {
                        return this.latencyController.maxLatency;
                      },
                    },
                    {
                      key: "targetLatency",
                      get: function () {
                        return this.latencyController.targetLatency;
                      },
                    },
                    {
                      key: "drift",
                      get: function () {
                        return this.latencyController.drift;
                      },
                    },
                    {
                      key: "forceStartLoad",
                      get: function () {
                        return this.streamController.forceStartLoad;
                      },
                    },
                  ],
                  [
                    {
                      key: "version",
                      get: function () {
                        return "1.4.5";
                      },
                    },
                    {
                      key: "Events",
                      get: function () {
                        return w;
                      },
                    },
                    {
                      key: "ErrorTypes",
                      get: function () {
                        return b;
                      },
                    },
                    {
                      key: "ErrorDetails",
                      get: function () {
                        return k;
                      },
                    },
                    {
                      key: "DefaultConfig",
                      get: function () {
                        return t.defaultConfig ? t.defaultConfig : ks;
                      },
                      set: function (i) {
                        t.defaultConfig = i;
                      },
                    },
                  ]
                ),
                t
              );
            })();
            return (Ts.defaultConfig = void 0), Ts;
          }),
            (t.exports = r());
        })(!1);
      },
      617: function (t, i, n) {
        t.exports = (function () {
          for (
            var t =
                '.tippy-iOS{cursor:pointer!important}.tippy-notransition{transition:none!important}.tippy-popper{-webkit-perspective:700px;perspective:700px;z-index:9999;outline:0;transition-timing-function:cubic-bezier(.165,.84,.44,1);pointer-events:none;line-height:1.4}.tippy-popper[x-placement^=top] .tippy-backdrop{border-radius:40% 40% 0 0}.tippy-popper[x-placement^=top] .tippy-roundarrow{bottom:-8px;-webkit-transform-origin:50% 0;transform-origin:50% 0}.tippy-popper[x-placement^=top] .tippy-roundarrow svg{position:absolute;left:0;-webkit-transform:rotate(180deg);transform:rotate(180deg)}.tippy-popper[x-placement^=top] .tippy-arrow{border-top:8px solid #333;border-right:8px solid transparent;border-left:8px solid transparent;bottom:-7px;margin:0 6px;-webkit-transform-origin:50% 0;transform-origin:50% 0}.tippy-popper[x-placement^=top] .tippy-backdrop{-webkit-transform-origin:0 25%;transform-origin:0 25%}.tippy-popper[x-placement^=top] .tippy-backdrop[data-state=visible]{-webkit-transform:scale(1) translate(-50%,-55%);transform:scale(1) translate(-50%,-55%)}.tippy-popper[x-placement^=top] .tippy-backdrop[data-state=hidden]{-webkit-transform:scale(.2) translate(-50%,-45%);transform:scale(.2) translate(-50%,-45%);opacity:0}.tippy-popper[x-placement^=top] [data-animation=shift-toward][data-state=visible]{-webkit-transform:translateY(-10px);transform:translateY(-10px)}.tippy-popper[x-placement^=top] [data-animation=shift-toward][data-state=hidden]{opacity:0;-webkit-transform:translateY(-20px);transform:translateY(-20px)}.tippy-popper[x-placement^=top] [data-animation=perspective]{-webkit-transform-origin:bottom;transform-origin:bottom}.tippy-popper[x-placement^=top] [data-animation=perspective][data-state=visible]{-webkit-transform:translateY(-10px) rotateX(0);transform:translateY(-10px) rotateX(0)}.tippy-popper[x-placement^=top] [data-animation=perspective][data-state=hidden]{opacity:0;-webkit-transform:translateY(0) rotateX(60deg);transform:translateY(0) rotateX(60deg)}.tippy-popper[x-placement^=top] [data-animation=fade][data-state=visible]{-webkit-transform:translateY(-10px);transform:translateY(-10px)}.tippy-popper[x-placement^=top] [data-animation=fade][data-state=hidden]{opacity:0;-webkit-transform:translateY(-10px);transform:translateY(-10px)}.tippy-popper[x-placement^=top] [data-animation=shift-away][data-state=visible]{-webkit-transform:translateY(-10px);transform:translateY(-10px)}.tippy-popper[x-placement^=top] [data-animation=shift-away][data-state=hidden]{opacity:0;-webkit-transform:translateY(0);transform:translateY(0)}.tippy-popper[x-placement^=top] [data-animation=scale][data-state=visible]{-webkit-transform:translateY(-10px) scale(1);transform:translateY(-10px) scale(1)}.tippy-popper[x-placement^=top] [data-animation=scale][data-state=hidden]{opacity:0;-webkit-transform:translateY(0) scale(.5);transform:translateY(0) scale(.5)}.tippy-popper[x-placement^=bottom] .tippy-backdrop{border-radius:0 0 30% 30%}.tippy-popper[x-placement^=bottom] .tippy-roundarrow{top:-8px;-webkit-transform-origin:50% 100%;transform-origin:50% 100%}.tippy-popper[x-placement^=bottom] .tippy-roundarrow svg{position:absolute;left:0;-webkit-transform:rotate(0);transform:rotate(0)}.tippy-popper[x-placement^=bottom] .tippy-arrow{border-bottom:8px solid #333;border-right:8px solid transparent;border-left:8px solid transparent;top:-7px;margin:0 6px;-webkit-transform-origin:50% 100%;transform-origin:50% 100%}.tippy-popper[x-placement^=bottom] .tippy-backdrop{-webkit-transform-origin:0 -50%;transform-origin:0 -50%}.tippy-popper[x-placement^=bottom] .tippy-backdrop[data-state=visible]{-webkit-transform:scale(1) translate(-50%,-45%);transform:scale(1) translate(-50%,-45%)}.tippy-popper[x-placement^=bottom] .tippy-backdrop[data-state=hidden]{-webkit-transform:scale(.2) translate(-50%);transform:scale(.2) translate(-50%);opacity:0}.tippy-popper[x-placement^=bottom] [data-animation=shift-toward][data-state=visible]{-webkit-transform:translateY(10px);transform:translateY(10px)}.tippy-popper[x-placement^=bottom] [data-animation=shift-toward][data-state=hidden]{opacity:0;-webkit-transform:translateY(20px);transform:translateY(20px)}.tippy-popper[x-placement^=bottom] [data-animation=perspective]{-webkit-transform-origin:top;transform-origin:top}.tippy-popper[x-placement^=bottom] [data-animation=perspective][data-state=visible]{-webkit-transform:translateY(10px) rotateX(0);transform:translateY(10px) rotateX(0)}.tippy-popper[x-placement^=bottom] [data-animation=perspective][data-state=hidden]{opacity:0;-webkit-transform:translateY(0) rotateX(-60deg);transform:translateY(0) rotateX(-60deg)}.tippy-popper[x-placement^=bottom] [data-animation=fade][data-state=visible]{-webkit-transform:translateY(10px);transform:translateY(10px)}.tippy-popper[x-placement^=bottom] [data-animation=fade][data-state=hidden]{opacity:0;-webkit-transform:translateY(10px);transform:translateY(10px)}.tippy-popper[x-placement^=bottom] [data-animation=shift-away][data-state=visible]{-webkit-transform:translateY(10px);transform:translateY(10px)}.tippy-popper[x-placement^=bottom] [data-animation=shift-away][data-state=hidden]{opacity:0;-webkit-transform:translateY(0);transform:translateY(0)}.tippy-popper[x-placement^=bottom] [data-animation=scale][data-state=visible]{-webkit-transform:translateY(10px) scale(1);transform:translateY(10px) scale(1)}.tippy-popper[x-placement^=bottom] [data-animation=scale][data-state=hidden]{opacity:0;-webkit-transform:translateY(0) scale(.5);transform:translateY(0) scale(.5)}.tippy-popper[x-placement^=left] .tippy-backdrop{border-radius:50% 0 0 50%}.tippy-popper[x-placement^=left] .tippy-roundarrow{right:-16px;-webkit-transform-origin:33.33333333% 50%;transform-origin:33.33333333% 50%}.tippy-popper[x-placement^=left] .tippy-roundarrow svg{position:absolute;left:0;-webkit-transform:rotate(90deg);transform:rotate(90deg)}.tippy-popper[x-placement^=left] .tippy-arrow{border-left:8px solid #333;border-top:8px solid transparent;border-bottom:8px solid transparent;right:-7px;margin:3px 0;-webkit-transform-origin:0 50%;transform-origin:0 50%}.tippy-popper[x-placement^=left] .tippy-backdrop{-webkit-transform-origin:50% 0;transform-origin:50% 0}.tippy-popper[x-placement^=left] .tippy-backdrop[data-state=visible]{-webkit-transform:scale(1) translate(-50%,-50%);transform:scale(1) translate(-50%,-50%)}.tippy-popper[x-placement^=left] .tippy-backdrop[data-state=hidden]{-webkit-transform:scale(.2) translate(-75%,-50%);transform:scale(.2) translate(-75%,-50%);opacity:0}.tippy-popper[x-placement^=left] [data-animation=shift-toward][data-state=visible]{-webkit-transform:translateX(-10px);transform:translateX(-10px)}.tippy-popper[x-placement^=left] [data-animation=shift-toward][data-state=hidden]{opacity:0;-webkit-transform:translateX(-20px);transform:translateX(-20px)}.tippy-popper[x-placement^=left] [data-animation=perspective]{-webkit-transform-origin:right;transform-origin:right}.tippy-popper[x-placement^=left] [data-animation=perspective][data-state=visible]{-webkit-transform:translateX(-10px) rotateY(0);transform:translateX(-10px) rotateY(0)}.tippy-popper[x-placement^=left] [data-animation=perspective][data-state=hidden]{opacity:0;-webkit-transform:translateX(0) rotateY(-60deg);transform:translateX(0) rotateY(-60deg)}.tippy-popper[x-placement^=left] [data-animation=fade][data-state=visible]{-webkit-transform:translateX(-10px);transform:translateX(-10px)}.tippy-popper[x-placement^=left] [data-animation=fade][data-state=hidden]{opacity:0;-webkit-transform:translateX(-10px);transform:translateX(-10px)}.tippy-popper[x-placement^=left] [data-animation=shift-away][data-state=visible]{-webkit-transform:translateX(-10px);transform:translateX(-10px)}.tippy-popper[x-placement^=left] [data-animation=shift-away][data-state=hidden]{opacity:0;-webkit-transform:translateX(0);transform:translateX(0)}.tippy-popper[x-placement^=left] [data-animation=scale][data-state=visible]{-webkit-transform:translateX(-10px) scale(1);transform:translateX(-10px) scale(1)}.tippy-popper[x-placement^=left] [data-animation=scale][data-state=hidden]{opacity:0;-webkit-transform:translateX(0) scale(.5);transform:translateX(0) scale(.5)}.tippy-popper[x-placement^=right] .tippy-backdrop{border-radius:0 50% 50% 0}.tippy-popper[x-placement^=right] .tippy-roundarrow{left:-16px;-webkit-transform-origin:66.66666666% 50%;transform-origin:66.66666666% 50%}.tippy-popper[x-placement^=right] .tippy-roundarrow svg{position:absolute;left:0;-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}.tippy-popper[x-placement^=right] .tippy-arrow{border-right:8px solid #333;border-top:8px solid transparent;border-bottom:8px solid transparent;left:-7px;margin:3px 0;-webkit-transform-origin:100% 50%;transform-origin:100% 50%}.tippy-popper[x-placement^=right] .tippy-backdrop{-webkit-transform-origin:-50% 0;transform-origin:-50% 0}.tippy-popper[x-placement^=right] .tippy-backdrop[data-state=visible]{-webkit-transform:scale(1) translate(-50%,-50%);transform:scale(1) translate(-50%,-50%)}.tippy-popper[x-placement^=right] .tippy-backdrop[data-state=hidden]{-webkit-transform:scale(.2) translate(-25%,-50%);transform:scale(.2) translate(-25%,-50%);opacity:0}.tippy-popper[x-placement^=right] [data-animation=shift-toward][data-state=visible]{-webkit-transform:translateX(10px);transform:translateX(10px)}.tippy-popper[x-placement^=right] [data-animation=shift-toward][data-state=hidden]{opacity:0;-webkit-transform:translateX(20px);transform:translateX(20px)}.tippy-popper[x-placement^=right] [data-animation=perspective]{-webkit-transform-origin:left;transform-origin:left}.tippy-popper[x-placement^=right] [data-animation=perspective][data-state=visible]{-webkit-transform:translateX(10px) rotateY(0);transform:translateX(10px) rotateY(0)}.tippy-popper[x-placement^=right] [data-animation=perspective][data-state=hidden]{opacity:0;-webkit-transform:translateX(0) rotateY(60deg);transform:translateX(0) rotateY(60deg)}.tippy-popper[x-placement^=right] [data-animation=fade][data-state=visible]{-webkit-transform:translateX(10px);transform:translateX(10px)}.tippy-popper[x-placement^=right] [data-animation=fade][data-state=hidden]{opacity:0;-webkit-transform:translateX(10px);transform:translateX(10px)}.tippy-popper[x-placement^=right] [data-animation=shift-away][data-state=visible]{-webkit-transform:translateX(10px);transform:translateX(10px)}.tippy-popper[x-placement^=right] [data-animation=shift-away][data-state=hidden]{opacity:0;-webkit-transform:translateX(0);transform:translateX(0)}.tippy-popper[x-placement^=right] [data-animation=scale][data-state=visible]{-webkit-transform:translateX(10px) scale(1);transform:translateX(10px) scale(1)}.tippy-popper[x-placement^=right] [data-animation=scale][data-state=hidden]{opacity:0;-webkit-transform:translateX(0) scale(.5);transform:translateX(0) scale(.5)}.tippy-tooltip{position:relative;color:#fff;border-radius:4px;font-size:.9rem;padding:.3rem .6rem;max-width:350px;text-align:center;will-change:transform;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background-color:#333}.tippy-tooltip[data-size=small]{padding:.2rem .4rem;font-size:.75rem}.tippy-tooltip[data-size=large]{padding:.4rem .8rem;font-size:1rem}.tippy-tooltip[data-animatefill]{overflow:hidden;background-color:transparent}.tippy-tooltip[data-interactive],.tippy-tooltip[data-interactive] path{pointer-events:auto}.tippy-tooltip[data-inertia][data-state=visible]{transition-timing-function:cubic-bezier(.53,2,.36,.85)}.tippy-tooltip[data-inertia][data-state=hidden]{transition-timing-function:ease}.tippy-arrow,.tippy-roundarrow{position:absolute;width:0;height:0}.tippy-roundarrow{width:24px;height:8px;fill:#333;pointer-events:none}.tippy-backdrop{position:absolute;will-change:transform;background-color:#333;border-radius:50%;width:calc(110% + 2rem);left:50%;top:50%;z-index:-1;transition:all cubic-bezier(.46,.1,.52,.98);-webkit-backface-visibility:hidden;backface-visibility:hidden}.tippy-backdrop:after{content:"";float:left;padding-top:100%}.tippy-backdrop+.tippy-content{transition-property:opacity}.tippy-backdrop+.tippy-content[data-state=visible]{opacity:1}.tippy-backdrop+.tippy-content[data-state=hidden]{opacity:0}@media (max-width:360px){.tippy-popper{max-width:96%;max-width:calc(100% - 20px)}}',
              i = "3.2.0",
              r =
                Object.assign ||
                function (t) {
                  for (var i = 1; i < arguments.length; i++) {
                    var n = arguments[i];
                    for (var r in n)
                      Object.prototype.hasOwnProperty.call(n, r) &&
                        (t[r] = n[r]);
                  }
                  return t;
                },
              e = {
                a11y: !0,
                allowHTML: !0,
                animateFill: !0,
                animation: "shift-away",
                appendTo: function () {
                  return document.body;
                },
                arrow: !1,
                arrowTransform: "",
                arrowType: "sharp",
                content: "",
                delay: [0, 20],
                distance: 10,
                duration: [325, 275],
                flip: !0,
                flipBehavior: "flip",
                followCursor: !1,
                hideOnClick: !0,
                inertia: !1,
                interactive: !1,
                interactiveBorder: 2,
                interactiveDebounce: 0,
                lazy: !0,
                livePlacement: !0,
                multiple: !1,
                offset: 0,
                onHidden: function () {},
                onHide: function () {},
                onMount: function () {},
                onShow: function () {},
                onShown: function () {},
                performance: !1,
                placement: "top",
                popperOptions: {},
                shouldPopperHideOnBlur: function () {
                  return !0;
                },
                showOnInit: !1,
                size: "regular",
                sticky: !1,
                target: "",
                theme: "dark",
                touch: !0,
                touchHold: !1,
                trigger: "mouseenter focus",
                updateDuration: 200,
                wait: null,
                zIndex: 9999,
              },
              s = function (t) {
                e = r({}, e, t);
              },
              a = [
                "arrowType",
                "distance",
                "flip",
                "flipBehavior",
                "offset",
                "placement",
                "popperOptions",
              ],
              o = "undefined" != typeof window,
              h = o ? navigator : {},
              u = o ? window : {},
              f = ("MutationObserver" in u),
              l = /MSIE |Trident\//.test(h.userAgent),
              c = /iPhone|iPad|iPod/.test(h.platform) && !u.MSStream,
              v = ("ontouchstart" in u),
              d =
                "undefined" != typeof window && "undefined" != typeof document,
              p = ["Edge", "Trident", "Firefox"],
              m = 0,
              y = 0;
            y < p.length;
            y += 1
          )
            if (d && navigator.userAgent.indexOf(p[y]) >= 0) {
              m = 1;
              break;
            }
          function g(t) {
            var i = !1;
            return function () {
              i ||
                ((i = !0),
                window.Promise.resolve().then(function () {
                  (i = !1), t();
                }));
            };
          }
          function w(t) {
            var i = !1;
            return function () {
              i ||
                ((i = !0),
                setTimeout(function () {
                  (i = !1), t();
                }, m));
            };
          }
          var b = d && window.Promise ? g : w;
          function k(t) {
            return t && "[object Function]" === {}.toString.call(t);
          }
          function E(t, i) {
            if (1 !== t.nodeType) return [];
            var n = t.ownerDocument.defaultView.getComputedStyle(t, null);
            return i ? n[i] : n;
          }
          function T(t) {
            return "HTML" === t.nodeName ? t : t.parentNode || t.host;
          }
          function x(t) {
            if (!t) return document.body;
            switch (t.nodeName) {
              case "HTML":
              case "BODY":
                return t.ownerDocument.body;
              case "#document":
                return t.body;
            }
            var i = E(t),
              n = i.overflow,
              r = i.overflowX,
              e = i.overflowY;
            return /(auto|scroll|overlay)/.test(n + e + r) ? t : x(T(t));
          }
          var S =
              d && !(!window.MSInputMethodContext || !document.documentMode),
            A = d && /MSIE 10/.test(navigator.userAgent);
          function M(t) {
            return 11 === t ? S : 10 === t ? A : S || A;
          }
          function D(t) {
            if (!t) return document.documentElement;
            for (
              var i = M(10) ? document.body : null, n = t.offsetParent || null;
              n === i && t.nextElementSibling;

            )
              n = (t = t.nextElementSibling).offsetParent;
            var r = n && n.nodeName;
            return r && "BODY" !== r && "HTML" !== r
              ? -1 !== ["TH", "TD", "TABLE"].indexOf(n.nodeName) &&
                "static" === E(n, "position")
                ? D(n)
                : n
              : t
              ? t.ownerDocument.documentElement
              : document.documentElement;
          }
          function _(t) {
            var i = t.nodeName;
            return (
              "BODY" !== i && ("HTML" === i || D(t.firstElementChild) === t)
            );
          }
          function O(t) {
            return null !== t.parentNode ? O(t.parentNode) : t;
          }
          function R(t, i) {
            if (!(t && t.nodeType && i && i.nodeType))
              return document.documentElement;
            var n =
                t.compareDocumentPosition(i) & Node.DOCUMENT_POSITION_FOLLOWING,
              r = n ? t : i,
              e = n ? i : t,
              s = document.createRange();
            s.setStart(r, 0), s.setEnd(e, 0);
            var a = s.commonAncestorContainer;
            if ((t !== a && i !== a) || r.contains(e)) return _(a) ? a : D(a);
            var o = O(t);
            return o.host ? R(o.host, i) : R(t, O(i).host);
          }
          function L(t) {
            var i =
                "top" ===
                (arguments.length > 1 && void 0 !== arguments[1]
                  ? arguments[1]
                  : "top")
                  ? "scrollTop"
                  : "scrollLeft",
              n = t.nodeName;
            if ("BODY" === n || "HTML" === n) {
              var r = t.ownerDocument.documentElement;
              return (t.ownerDocument.scrollingElement || r)[i];
            }
            return t[i];
          }
          function I(t, i) {
            var n =
                arguments.length > 2 && void 0 !== arguments[2] && arguments[2],
              r = L(i, "top"),
              e = L(i, "left"),
              s = n ? -1 : 1;
            return (
              (t.top += r * s),
              (t.bottom += r * s),
              (t.left += e * s),
              (t.right += e * s),
              t
            );
          }
          function P(t, i) {
            var n = "x" === i ? "Left" : "Top",
              r = "Left" === n ? "Right" : "Bottom";
            return (
              parseFloat(t["border" + n + "Width"], 10) +
              parseFloat(t["border" + r + "Width"], 10)
            );
          }
          function C(t, i, n, r) {
            return Math.max(
              i["offset" + t],
              i["scroll" + t],
              n["client" + t],
              n["offset" + t],
              n["scroll" + t],
              M(10)
                ? parseInt(n["offset" + t]) +
                    parseInt(r["margin" + ("Height" === t ? "Top" : "Left")]) +
                    parseInt(
                      r["margin" + ("Height" === t ? "Bottom" : "Right")]
                    )
                : 0
            );
          }
          function N(t) {
            var i = t.body,
              n = t.documentElement,
              r = M(10) && getComputedStyle(n);
            return { height: C("Height", i, n, r), width: C("Width", i, n, r) };
          }
          var U = function (t, i) {
              if (!(t instanceof i))
                throw new TypeError("Cannot call a class as a function");
            },
            F = (function () {
              function t(t, i) {
                for (var n = 0; n < i.length; n++) {
                  var r = i[n];
                  (r.enumerable = r.enumerable || !1),
                    (r.configurable = !0),
                    "value" in r && (r.writable = !0),
                    Object.defineProperty(t, r.key, r);
                }
              }
              return function (i, n, r) {
                return n && t(i.prototype, n), r && t(i, r), i;
              };
            })(),
            j = function (t, i, n) {
              return (
                i in t
                  ? Object.defineProperty(t, i, {
                      value: n,
                      enumerable: !0,
                      configurable: !0,
                      writable: !0,
                    })
                  : (t[i] = n),
                t
              );
            },
            B =
              Object.assign ||
              function (t) {
                for (var i = 1; i < arguments.length; i++) {
                  var n = arguments[i];
                  for (var r in n)
                    Object.prototype.hasOwnProperty.call(n, r) && (t[r] = n[r]);
                }
                return t;
              };
          function X(t) {
            return B({}, t, {
              right: t.left + t.width,
              bottom: t.top + t.height,
            });
          }
          function Y(t) {
            var i = {};
            try {
              if (M(10)) {
                i = t.getBoundingClientRect();
                var n = L(t, "top"),
                  r = L(t, "left");
                (i.top += n), (i.left += r), (i.bottom += n), (i.right += r);
              } else i = t.getBoundingClientRect();
            } catch (t) {}
            var e = {
                left: i.left,
                top: i.top,
                width: i.right - i.left,
                height: i.bottom - i.top,
              },
              s = "HTML" === t.nodeName ? N(t.ownerDocument) : {},
              a = s.width || t.clientWidth || e.right - e.left,
              o = s.height || t.clientHeight || e.bottom - e.top,
              h = t.offsetWidth - a,
              u = t.offsetHeight - o;
            if (h || u) {
              var f = E(t);
              (h -= P(f, "x")),
                (u -= P(f, "y")),
                (e.width -= h),
                (e.height -= u);
            }
            return X(e);
          }
          function $(t, i) {
            var n =
                arguments.length > 2 && void 0 !== arguments[2] && arguments[2],
              r = M(10),
              e = "HTML" === i.nodeName,
              s = Y(t),
              a = Y(i),
              o = x(t),
              h = E(i),
              u = parseFloat(h.borderTopWidth, 10),
              f = parseFloat(h.borderLeftWidth, 10);
            n &&
              e &&
              ((a.top = Math.max(a.top, 0)), (a.left = Math.max(a.left, 0)));
            var l = X({
              top: s.top - a.top - u,
              left: s.left - a.left - f,
              width: s.width,
              height: s.height,
            });
            if (((l.marginTop = 0), (l.marginLeft = 0), !r && e)) {
              var c = parseFloat(h.marginTop, 10),
                v = parseFloat(h.marginLeft, 10);
              (l.top -= u - c),
                (l.bottom -= u - c),
                (l.left -= f - v),
                (l.right -= f - v),
                (l.marginTop = c),
                (l.marginLeft = v);
            }
            return (
              (r && !n ? i.contains(o) : i === o && "BODY" !== o.nodeName) &&
                (l = I(l, i)),
              l
            );
          }
          function H(t) {
            var i =
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1],
              n = t.ownerDocument.documentElement,
              r = $(t, n),
              e = Math.max(n.clientWidth, window.innerWidth || 0),
              s = Math.max(n.clientHeight, window.innerHeight || 0),
              a = i ? 0 : L(n),
              o = i ? 0 : L(n, "left");
            return X({
              top: a - r.top + r.marginTop,
              left: o - r.left + r.marginLeft,
              width: e,
              height: s,
            });
          }
          function V(t) {
            var i = t.nodeName;
            return (
              "BODY" !== i &&
              "HTML" !== i &&
              ("fixed" === E(t, "position") || V(T(t)))
            );
          }
          function G(t) {
            if (!t || !t.parentElement || M()) return document.documentElement;
            for (var i = t.parentElement; i && "none" === E(i, "transform"); )
              i = i.parentElement;
            return i || document.documentElement;
          }
          function W(t, i, n, r) {
            var e =
                arguments.length > 4 && void 0 !== arguments[4] && arguments[4],
              s = { top: 0, left: 0 },
              a = e ? G(t) : R(t, i);
            if ("viewport" === r) s = H(a, e);
            else {
              var o = void 0;
              "scrollParent" === r
                ? "BODY" === (o = x(T(i))).nodeName &&
                  (o = t.ownerDocument.documentElement)
                : (o = "window" === r ? t.ownerDocument.documentElement : r);
              var h = $(o, a, e);
              if ("HTML" !== o.nodeName || V(a)) s = h;
              else {
                var u = N(t.ownerDocument),
                  f = u.height,
                  l = u.width;
                (s.top += h.top - h.marginTop),
                  (s.bottom = f + h.top),
                  (s.left += h.left - h.marginLeft),
                  (s.right = l + h.left);
              }
            }
            var c = "number" == typeof (n = n || 0);
            return (
              (s.left += c ? n : n.left || 0),
              (s.top += c ? n : n.top || 0),
              (s.right -= c ? n : n.right || 0),
              (s.bottom -= c ? n : n.bottom || 0),
              s
            );
          }
          function K(t) {
            return t.width * t.height;
          }
          function z(t, i, n, r, e) {
            var s =
              arguments.length > 5 && void 0 !== arguments[5]
                ? arguments[5]
                : 0;
            if (-1 === t.indexOf("auto")) return t;
            var a = W(n, r, s, e),
              o = {
                top: { width: a.width, height: i.top - a.top },
                right: { width: a.right - i.right, height: a.height },
                bottom: { width: a.width, height: a.bottom - i.bottom },
                left: { width: i.left - a.left, height: a.height },
              },
              h = Object.keys(o)
                .map(function (t) {
                  return B({ key: t }, o[t], { area: K(o[t]) });
                })
                .sort(function (t, i) {
                  return i.area - t.area;
                }),
              u = h.filter(function (t) {
                var i = t.width,
                  r = t.height;
                return i >= n.clientWidth && r >= n.clientHeight;
              }),
              f = u.length > 0 ? u[0].key : h[0].key,
              l = t.split("-")[1];
            return f + (l ? "-" + l : "");
          }
          function q(t, i, n) {
            var r =
              arguments.length > 3 && void 0 !== arguments[3]
                ? arguments[3]
                : null;
            return $(n, r ? G(i) : R(i, n), r);
          }
          function J(t) {
            var i = t.ownerDocument.defaultView.getComputedStyle(t),
              n = parseFloat(i.marginTop) + parseFloat(i.marginBottom),
              r = parseFloat(i.marginLeft) + parseFloat(i.marginRight);
            return { width: t.offsetWidth + r, height: t.offsetHeight + n };
          }
          function Q(t) {
            var i = {
              left: "right",
              right: "left",
              bottom: "top",
              top: "bottom",
            };
            return t.replace(/left|right|bottom|top/g, function (t) {
              return i[t];
            });
          }
          function Z(t, i, n) {
            n = n.split("-")[0];
            var r = J(t),
              e = { width: r.width, height: r.height },
              s = -1 !== ["right", "left"].indexOf(n),
              a = s ? "top" : "left",
              o = s ? "left" : "top",
              h = s ? "height" : "width",
              u = s ? "width" : "height";
            return (
              (e[a] = i[a] + i[h] / 2 - r[h] / 2),
              (e[o] = n === o ? i[o] - r[u] : i[Q(o)]),
              e
            );
          }
          function tt(t, i) {
            return Array.prototype.find ? t.find(i) : t.filter(i)[0];
          }
          function it(t, i, n) {
            if (Array.prototype.findIndex)
              return t.findIndex(function (t) {
                return t[i] === n;
              });
            var r = tt(t, function (t) {
              return t[i] === n;
            });
            return t.indexOf(r);
          }
          function nt(t, i, n) {
            return (
              (void 0 === n ? t : t.slice(0, it(t, "name", n))).forEach(
                function (t) {
                  t.function;
                  var n = t.function || t.fn;
                  t.enabled &&
                    k(n) &&
                    ((i.offsets.popper = X(i.offsets.popper)),
                    (i.offsets.reference = X(i.offsets.reference)),
                    (i = n(i, t)));
                }
              ),
              i
            );
          }
          function rt() {
            if (!this.state.isDestroyed) {
              var t = {
                instance: this,
                styles: {},
                arrowStyles: {},
                attributes: {},
                flipped: !1,
                offsets: {},
              };
              (t.offsets.reference = q(
                this.state,
                this.popper,
                this.reference,
                this.options.positionFixed
              )),
                (t.placement = z(
                  this.options.placement,
                  t.offsets.reference,
                  this.popper,
                  this.reference,
                  this.options.modifiers.flip.boundariesElement,
                  this.options.modifiers.flip.padding
                )),
                (t.originalPlacement = t.placement),
                (t.positionFixed = this.options.positionFixed),
                (t.offsets.popper = Z(
                  this.popper,
                  t.offsets.reference,
                  t.placement
                )),
                (t.offsets.popper.position = this.options.positionFixed
                  ? "fixed"
                  : "absolute"),
                (t = nt(this.modifiers, t)),
                this.state.isCreated
                  ? this.options.onUpdate(t)
                  : ((this.state.isCreated = !0), this.options.onCreate(t));
            }
          }
          function et(t, i) {
            return t.some(function (t) {
              var n = t.name;
              return t.enabled && n === i;
            });
          }
          function st(t) {
            for (
              var i = [!1, "ms", "Webkit", "Moz", "O"],
                n = t.charAt(0).toUpperCase() + t.slice(1),
                r = 0;
              r < i.length;
              r++
            ) {
              var e = i[r],
                s = e ? "" + e + n : t;
              if (void 0 !== document.body.style[s]) return s;
            }
            return null;
          }
          function at() {
            return (
              (this.state.isDestroyed = !0),
              et(this.modifiers, "applyStyle") &&
                (this.popper.removeAttribute("x-placement"),
                (this.popper.style.position = ""),
                (this.popper.style.top = ""),
                (this.popper.style.left = ""),
                (this.popper.style.right = ""),
                (this.popper.style.bottom = ""),
                (this.popper.style.willChange = ""),
                (this.popper.style[st("transform")] = "")),
              this.disableEventListeners(),
              this.options.removeOnDestroy &&
                this.popper.parentNode.removeChild(this.popper),
              this
            );
          }
          function ot(t) {
            var i = t.ownerDocument;
            return i ? i.defaultView : window;
          }
          function ht(t, i, n, r) {
            var e = "BODY" === t.nodeName,
              s = e ? t.ownerDocument.defaultView : t;
            s.addEventListener(i, n, { passive: !0 }),
              e || ht(x(s.parentNode), i, n, r),
              r.push(s);
          }
          function ut(t, i, n, r) {
            (n.updateBound = r),
              ot(t).addEventListener("resize", n.updateBound, { passive: !0 });
            var e = x(t);
            return (
              ht(e, "scroll", n.updateBound, n.scrollParents),
              (n.scrollElement = e),
              (n.eventsEnabled = !0),
              n
            );
          }
          function ft() {
            this.state.eventsEnabled ||
              (this.state = ut(
                this.reference,
                this.options,
                this.state,
                this.scheduleUpdate
              ));
          }
          function lt(t, i) {
            return (
              ot(t).removeEventListener("resize", i.updateBound),
              i.scrollParents.forEach(function (t) {
                t.removeEventListener("scroll", i.updateBound);
              }),
              (i.updateBound = null),
              (i.scrollParents = []),
              (i.scrollElement = null),
              (i.eventsEnabled = !1),
              i
            );
          }
          function ct() {
            this.state.eventsEnabled &&
              (cancelAnimationFrame(this.scheduleUpdate),
              (this.state = lt(this.reference, this.state)));
          }
          function vt(t) {
            return "" !== t && !isNaN(parseFloat(t)) && isFinite(t);
          }
          function dt(t, i) {
            Object.keys(i).forEach(function (n) {
              var r = "";
              -1 !==
                ["width", "height", "top", "right", "bottom", "left"].indexOf(
                  n
                ) &&
                vt(i[n]) &&
                (r = "px"),
                (t.style[n] = i[n] + r);
            });
          }
          function pt(t, i) {
            Object.keys(i).forEach(function (n) {
              !1 !== i[n] ? t.setAttribute(n, i[n]) : t.removeAttribute(n);
            });
          }
          function mt(t) {
            return (
              dt(t.instance.popper, t.styles),
              pt(t.instance.popper, t.attributes),
              t.arrowElement &&
                Object.keys(t.arrowStyles).length &&
                dt(t.arrowElement, t.arrowStyles),
              t
            );
          }
          function yt(t, i, n, r, e) {
            var s = q(e, i, t, n.positionFixed),
              a = z(
                n.placement,
                s,
                i,
                t,
                n.modifiers.flip.boundariesElement,
                n.modifiers.flip.padding
              );
            return (
              i.setAttribute("x-placement", a),
              dt(i, { position: n.positionFixed ? "fixed" : "absolute" }),
              n
            );
          }
          function gt(t, i) {
            var n = i.x,
              r = i.y,
              e = t.offsets.popper,
              s = tt(t.instance.modifiers, function (t) {
                return "applyStyle" === t.name;
              }).gpuAcceleration,
              a = void 0 !== s ? s : i.gpuAcceleration,
              o = D(t.instance.popper),
              h = Y(o),
              u = { position: e.position },
              f = {
                left: Math.floor(e.left),
                top: Math.round(e.top),
                bottom: Math.round(e.bottom),
                right: Math.floor(e.right),
              },
              l = "bottom" === n ? "top" : "bottom",
              c = "right" === r ? "left" : "right",
              v = st("transform"),
              d = void 0,
              p = void 0;
            if (
              ((p =
                "bottom" === l
                  ? "HTML" === o.nodeName
                    ? -o.clientHeight + f.bottom
                    : -h.height + f.bottom
                  : f.top),
              (d =
                "right" === c
                  ? "HTML" === o.nodeName
                    ? -o.clientWidth + f.right
                    : -h.width + f.right
                  : f.left),
              a && v)
            )
              (u[v] = "translate3d(" + d + "px, " + p + "px, 0)"),
                (u[l] = 0),
                (u[c] = 0),
                (u.willChange = "transform");
            else {
              var m = "bottom" === l ? -1 : 1,
                y = "right" === c ? -1 : 1;
              (u[l] = p * m), (u[c] = d * y), (u.willChange = l + ", " + c);
            }
            var g = { "x-placement": t.placement };
            return (
              (t.attributes = B({}, g, t.attributes)),
              (t.styles = B({}, u, t.styles)),
              (t.arrowStyles = B({}, t.offsets.arrow, t.arrowStyles)),
              t
            );
          }
          function wt(t, i, n) {
            var r = tt(t, function (t) {
                return t.name === i;
              }),
              e =
                !!r &&
                t.some(function (t) {
                  return t.name === n && t.enabled && t.order < r.order;
                });
            return e;
          }
          function bt(t, i) {
            var n;
            if (!wt(t.instance.modifiers, "arrow", "keepTogether")) return t;
            var r = i.element;
            if ("string" == typeof r) {
              if (!(r = t.instance.popper.querySelector(r))) return t;
            } else if (!t.instance.popper.contains(r)) return t;
            var e = t.placement.split("-")[0],
              s = t.offsets,
              a = s.popper,
              o = s.reference,
              h = -1 !== ["left", "right"].indexOf(e),
              u = h ? "height" : "width",
              f = h ? "Top" : "Left",
              l = f.toLowerCase(),
              c = h ? "left" : "top",
              v = h ? "bottom" : "right",
              d = J(r)[u];
            o[v] - d < a[l] && (t.offsets.popper[l] -= a[l] - (o[v] - d)),
              o[l] + d > a[v] && (t.offsets.popper[l] += o[l] + d - a[v]),
              (t.offsets.popper = X(t.offsets.popper));
            var p = o[l] + o[u] / 2 - d / 2,
              m = E(t.instance.popper),
              y = parseFloat(m["margin" + f], 10),
              g = parseFloat(m["border" + f + "Width"], 10),
              w = p - t.offsets.popper[l] - y - g;
            return (
              (w = Math.max(Math.min(a[u] - d, w), 0)),
              (t.arrowElement = r),
              (t.offsets.arrow =
                (j((n = {}), l, Math.round(w)), j(n, c, ""), n)),
              t
            );
          }
          function kt(t) {
            return "end" === t ? "start" : "start" === t ? "end" : t;
          }
          var Et = [
              "auto-start",
              "auto",
              "auto-end",
              "top-start",
              "top",
              "top-end",
              "right-start",
              "right",
              "right-end",
              "bottom-end",
              "bottom",
              "bottom-start",
              "left-end",
              "left",
              "left-start",
            ],
            Tt = Et.slice(3);
          function xt(t) {
            var i =
                arguments.length > 1 && void 0 !== arguments[1] && arguments[1],
              n = Tt.indexOf(t),
              r = Tt.slice(n + 1).concat(Tt.slice(0, n));
            return i ? r.reverse() : r;
          }
          var St = {
            FLIP: "flip",
            CLOCKWISE: "clockwise",
            COUNTERCLOCKWISE: "counterclockwise",
          };
          function At(t, i) {
            if (et(t.instance.modifiers, "inner")) return t;
            if (t.flipped && t.placement === t.originalPlacement) return t;
            var n = W(
                t.instance.popper,
                t.instance.reference,
                i.padding,
                i.boundariesElement,
                t.positionFixed
              ),
              r = t.placement.split("-")[0],
              e = Q(r),
              s = t.placement.split("-")[1] || "",
              a = [];
            switch (i.behavior) {
              case St.FLIP:
                a = [r, e];
                break;
              case St.CLOCKWISE:
                a = xt(r);
                break;
              case St.COUNTERCLOCKWISE:
                a = xt(r, !0);
                break;
              default:
                a = i.behavior;
            }
            return (
              a.forEach(function (o, h) {
                if (r !== o || a.length === h + 1) return t;
                (r = t.placement.split("-")[0]), (e = Q(r));
                var u = t.offsets.popper,
                  f = t.offsets.reference,
                  l = Math.floor,
                  c =
                    ("left" === r && l(u.right) > l(f.left)) ||
                    ("right" === r && l(u.left) < l(f.right)) ||
                    ("top" === r && l(u.bottom) > l(f.top)) ||
                    ("bottom" === r && l(u.top) < l(f.bottom)),
                  v = l(u.left) < l(n.left),
                  d = l(u.right) > l(n.right),
                  p = l(u.top) < l(n.top),
                  m = l(u.bottom) > l(n.bottom),
                  y =
                    ("left" === r && v) ||
                    ("right" === r && d) ||
                    ("top" === r && p) ||
                    ("bottom" === r && m),
                  g = -1 !== ["top", "bottom"].indexOf(r),
                  w =
                    !!i.flipVariations &&
                    ((g && "start" === s && v) ||
                      (g && "end" === s && d) ||
                      (!g && "start" === s && p) ||
                      (!g && "end" === s && m));
                (c || y || w) &&
                  ((t.flipped = !0),
                  (c || y) && (r = a[h + 1]),
                  w && (s = kt(s)),
                  (t.placement = r + (s ? "-" + s : "")),
                  (t.offsets.popper = B(
                    {},
                    t.offsets.popper,
                    Z(t.instance.popper, t.offsets.reference, t.placement)
                  )),
                  (t = nt(t.instance.modifiers, t, "flip")));
              }),
              t
            );
          }
          function Mt(t) {
            var i = t.offsets,
              n = i.popper,
              r = i.reference,
              e = t.placement.split("-")[0],
              s = Math.floor,
              a = -1 !== ["top", "bottom"].indexOf(e),
              o = a ? "right" : "bottom",
              h = a ? "left" : "top",
              u = a ? "width" : "height";
            return (
              n[o] < s(r[h]) && (t.offsets.popper[h] = s(r[h]) - n[u]),
              n[h] > s(r[o]) && (t.offsets.popper[h] = s(r[o])),
              t
            );
          }
          function Dt(t, i, n, r) {
            var e = t.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),
              s = +e[1],
              a = e[2];
            if (!s) return t;
            if (0 === a.indexOf("%")) {
              return (X("%p" === a ? n : r)[i] / 100) * s;
            }
            return "vh" === a || "vw" === a
              ? (("vh" === a
                  ? Math.max(
                      document.documentElement.clientHeight,
                      window.innerHeight || 0
                    )
                  : Math.max(
                      document.documentElement.clientWidth,
                      window.innerWidth || 0
                    )) /
                  100) *
                  s
              : s;
          }
          function _t(t, i, n, r) {
            var e = [0, 0],
              s = -1 !== ["right", "left"].indexOf(r),
              a = t.split(/(\+|\-)/).map(function (t) {
                return t.trim();
              }),
              o = a.indexOf(
                tt(a, function (t) {
                  return -1 !== t.search(/,|\s/);
                })
              );
            a[o] && a[o].indexOf(",");
            var h = /\s*,\s*|\s+/,
              u =
                -1 !== o
                  ? [
                      a.slice(0, o).concat([a[o].split(h)[0]]),
                      [a[o].split(h)[1]].concat(a.slice(o + 1)),
                    ]
                  : [a];
            return (
              (u = u.map(function (t, r) {
                var e = (1 === r ? !s : s) ? "height" : "width",
                  a = !1;
                return t
                  .reduce(function (t, i) {
                    return "" === t[t.length - 1] &&
                      -1 !== ["+", "-"].indexOf(i)
                      ? ((t[t.length - 1] = i), (a = !0), t)
                      : a
                      ? ((t[t.length - 1] += i), (a = !1), t)
                      : t.concat(i);
                  }, [])
                  .map(function (t) {
                    return Dt(t, e, i, n);
                  });
              })).forEach(function (t, i) {
                t.forEach(function (n, r) {
                  vt(n) && (e[i] += n * ("-" === t[r - 1] ? -1 : 1));
                });
              }),
              e
            );
          }
          function Ot(t, i) {
            var n = i.offset,
              r = t.placement,
              e = t.offsets,
              s = e.popper,
              a = e.reference,
              o = r.split("-")[0],
              h = void 0;
            return (
              (h = vt(+n) ? [+n, 0] : _t(n, s, a, o)),
              "left" === o
                ? ((s.top += h[0]), (s.left -= h[1]))
                : "right" === o
                ? ((s.top += h[0]), (s.left += h[1]))
                : "top" === o
                ? ((s.left += h[0]), (s.top -= h[1]))
                : "bottom" === o && ((s.left += h[0]), (s.top += h[1])),
              (t.popper = s),
              t
            );
          }
          function Rt(t, i) {
            var n = i.boundariesElement || D(t.instance.popper);
            t.instance.reference === n && (n = D(n));
            var r = st("transform"),
              e = t.instance.popper.style,
              s = e.top,
              a = e.left,
              o = e[r];
            (e.top = ""), (e.left = ""), (e[r] = "");
            var h = W(
              t.instance.popper,
              t.instance.reference,
              i.padding,
              n,
              t.positionFixed
            );
            (e.top = s), (e.left = a), (e[r] = o), (i.boundaries = h);
            var u = i.priority,
              f = t.offsets.popper,
              l = {
                primary: function (t) {
                  var n = f[t];
                  return (
                    f[t] < h[t] &&
                      !i.escapeWithReference &&
                      (n = Math.max(f[t], h[t])),
                    j({}, t, n)
                  );
                },
                secondary: function (t) {
                  var n = "right" === t ? "left" : "top",
                    r = f[n];
                  return (
                    f[t] > h[t] &&
                      !i.escapeWithReference &&
                      (r = Math.min(
                        f[n],
                        h[t] - ("right" === t ? f.width : f.height)
                      )),
                    j({}, n, r)
                  );
                },
              };
            return (
              u.forEach(function (t) {
                var i =
                  -1 !== ["left", "top"].indexOf(t) ? "primary" : "secondary";
                f = B({}, f, l[i](t));
              }),
              (t.offsets.popper = f),
              t
            );
          }
          function Lt(t) {
            var i = t.placement,
              n = i.split("-")[0],
              r = i.split("-")[1];
            if (r) {
              var e = t.offsets,
                s = e.reference,
                a = e.popper,
                o = -1 !== ["bottom", "top"].indexOf(n),
                h = o ? "left" : "top",
                u = o ? "width" : "height",
                f = {
                  start: j({}, h, s[h]),
                  end: j({}, h, s[h] + s[u] - a[u]),
                };
              t.offsets.popper = B({}, a, f[r]);
            }
            return t;
          }
          function It(t) {
            if (!wt(t.instance.modifiers, "hide", "preventOverflow")) return t;
            var i = t.offsets.reference,
              n = tt(t.instance.modifiers, function (t) {
                return "preventOverflow" === t.name;
              }).boundaries;
            if (
              i.bottom < n.top ||
              i.left > n.right ||
              i.top > n.bottom ||
              i.right < n.left
            ) {
              if (!0 === t.hide) return t;
              (t.hide = !0), (t.attributes["x-out-of-boundaries"] = "");
            } else {
              if (!1 === t.hide) return t;
              (t.hide = !1), (t.attributes["x-out-of-boundaries"] = !1);
            }
            return t;
          }
          function Pt(t) {
            var i = t.placement,
              n = i.split("-")[0],
              r = t.offsets,
              e = r.popper,
              s = r.reference,
              a = -1 !== ["left", "right"].indexOf(n),
              o = -1 === ["top", "left"].indexOf(n);
            return (
              (e[a ? "left" : "top"] =
                s[n] - (o ? e[a ? "width" : "height"] : 0)),
              (t.placement = Q(i)),
              (t.offsets.popper = X(e)),
              t
            );
          }
          var Ct = {
              placement: "bottom",
              positionFixed: !1,
              eventsEnabled: !0,
              removeOnDestroy: !1,
              onCreate: function () {},
              onUpdate: function () {},
              modifiers: {
                shift: { order: 100, enabled: !0, fn: Lt },
                offset: { order: 200, enabled: !0, fn: Ot, offset: 0 },
                preventOverflow: {
                  order: 300,
                  enabled: !0,
                  fn: Rt,
                  priority: ["left", "right", "top", "bottom"],
                  padding: 5,
                  boundariesElement: "scrollParent",
                },
                keepTogether: { order: 400, enabled: !0, fn: Mt },
                arrow: {
                  order: 500,
                  enabled: !0,
                  fn: bt,
                  element: "[x-arrow]",
                },
                flip: {
                  order: 600,
                  enabled: !0,
                  fn: At,
                  behavior: "flip",
                  padding: 5,
                  boundariesElement: "viewport",
                },
                inner: { order: 700, enabled: !1, fn: Pt },
                hide: { order: 800, enabled: !0, fn: It },
                computeStyle: {
                  order: 850,
                  enabled: !0,
                  fn: gt,
                  gpuAcceleration: !0,
                  x: "bottom",
                  y: "right",
                },
                applyStyle: {
                  order: 900,
                  enabled: !0,
                  fn: mt,
                  onLoad: yt,
                  gpuAcceleration: void 0,
                },
              },
            },
            Nt = (function () {
              function t(i, n) {
                var r = this,
                  e =
                    arguments.length > 2 && void 0 !== arguments[2]
                      ? arguments[2]
                      : {};
                U(this, t),
                  (this.scheduleUpdate = function () {
                    return requestAnimationFrame(r.update);
                  }),
                  (this.update = b(this.update.bind(this))),
                  (this.options = B({}, t.Defaults, e)),
                  (this.state = {
                    isDestroyed: !1,
                    isCreated: !1,
                    scrollParents: [],
                  }),
                  (this.reference = i && i.jquery ? i[0] : i),
                  (this.popper = n && n.jquery ? n[0] : n),
                  (this.options.modifiers = {}),
                  Object.keys(B({}, t.Defaults.modifiers, e.modifiers)).forEach(
                    function (i) {
                      r.options.modifiers[i] = B(
                        {},
                        t.Defaults.modifiers[i] || {},
                        e.modifiers ? e.modifiers[i] : {}
                      );
                    }
                  ),
                  (this.modifiers = Object.keys(this.options.modifiers)
                    .map(function (t) {
                      return B({ name: t }, r.options.modifiers[t]);
                    })
                    .sort(function (t, i) {
                      return t.order - i.order;
                    })),
                  this.modifiers.forEach(function (t) {
                    t.enabled &&
                      k(t.onLoad) &&
                      t.onLoad(r.reference, r.popper, r.options, t, r.state);
                  }),
                  this.update();
                var s = this.options.eventsEnabled;
                s && this.enableEventListeners(),
                  (this.state.eventsEnabled = s);
              }
              return (
                F(t, [
                  {
                    key: "update",
                    value: function () {
                      return rt.call(this);
                    },
                  },
                  {
                    key: "destroy",
                    value: function () {
                      return at.call(this);
                    },
                  },
                  {
                    key: "enableEventListeners",
                    value: function () {
                      return ft.call(this);
                    },
                  },
                  {
                    key: "disableEventListeners",
                    value: function () {
                      return ct.call(this);
                    },
                  },
                ]),
                t
              );
            })();
          (Nt.Utils = (
            "undefined" != typeof window ? window : n.g
          ).PopperUtils),
            (Nt.placements = Et),
            (Nt.Defaults = Ct);
          var Ut = {
              POPPER: ".tippy-popper",
              TOOLTIP: ".tippy-tooltip",
              CONTENT: ".tippy-content",
              BACKDROP: ".tippy-backdrop",
              ARROW: ".tippy-arrow",
              ROUND_ARROW: ".tippy-roundarrow",
            },
            Ft = { x: !0 },
            jt = function (t) {
              if (f) {
                var i = document.createElement("style");
                (i.type = "text/css"),
                  (i.textContent = t),
                  document.head.insertBefore(i, document.head.firstChild);
              }
            },
            Bt = function (t) {
              return [].slice.call(t);
            },
            Xt = function (t, i) {
              i.content instanceof Element
                ? (Wt(t, ""), t.appendChild(i.content))
                : (t[i.allowHTML ? "innerHTML" : "textContent"] = i.content);
            },
            Yt = function (t) {
              return (
                !(t instanceof Element) ||
                (hi.call(
                  t,
                  "a[href],area[href],button,details,input,textarea,select,iframe,[tabindex]"
                ) &&
                  !t.hasAttribute("disabled"))
              );
            },
            $t = function (t, i) {
              t.filter(Boolean).forEach(function (t) {
                t.style.transitionDuration = i + "ms";
              });
            },
            Ht = function (t) {
              var i = function (i) {
                return t.querySelector(i);
              };
              return {
                tooltip: i(Ut.TOOLTIP),
                backdrop: i(Ut.BACKDROP),
                content: i(Ut.CONTENT),
                arrow: i(Ut.ARROW) || i(Ut.ROUND_ARROW),
              };
            },
            Vt = function (t) {
              return "[object Object]" === {}.toString.call(t);
            },
            Gt = function () {
              return document.createElement("div");
            },
            Wt = function (t, i) {
              t[Ft.x && "innerHTML"] =
                i instanceof Element ? i[Ft.x && "innerHTML"] : i;
            },
            Kt = function (t) {
              if (t instanceof Element || Vt(t)) return [t];
              if (t instanceof NodeList) return Bt(t);
              if (Array.isArray(t)) return t;
              try {
                return Bt(document.querySelectorAll(t));
              } catch (t) {
                return [];
              }
            },
            zt = function (t) {
              return !isNaN(t) && !isNaN(parseFloat(t));
            },
            qt = function (t, i, n) {
              if (Array.isArray(t)) {
                var r = t[i];
                return null == r ? n : r;
              }
              return t;
            },
            Jt = function (t) {
              var i = Gt();
              return (
                "round" === t
                  ? ((i.className = "tippy-roundarrow"),
                    Wt(
                      i,
                      '<svg viewBox="0 0 24 8" xmlns="http://www.w3.org/2000/svg"><path d="M3 8s2.021-.015 5.253-4.218C9.584 2.051 10.797 1.007 12 1c1.203-.007 2.416 1.035 3.761 2.782C19.012 8.005 21 8 21 8H3z"/></svg>'
                    ))
                  : (i.className = "tippy-arrow"),
                i
              );
            },
            Qt = function () {
              var t = Gt();
              return (
                (t.className = "tippy-backdrop"),
                t.setAttribute("data-state", "hidden"),
                t
              );
            },
            Zt = function (t, i) {
              t.setAttribute("tabindex", "-1"),
                i.setAttribute("data-interactive", "");
            },
            ti = function (t, i) {
              t.removeAttribute("tabindex"),
                i.removeAttribute("data-interactive");
            },
            ii = function (t) {
              t.setAttribute("data-inertia", "");
            },
            ni = function (t) {
              t.removeAttribute("data-inertia");
            },
            ri = function (t, i) {
              var n = Gt();
              (n.className = "tippy-popper"),
                n.setAttribute("role", "tooltip"),
                (n.id = "tippy-" + t),
                (n.style.zIndex = i.zIndex);
              var r = Gt();
              (r.className = "tippy-tooltip"),
                r.setAttribute("data-size", i.size),
                r.setAttribute("data-animation", i.animation),
                r.setAttribute("data-state", "hidden"),
                i.theme.split(" ").forEach(function (t) {
                  r.classList.add(t + "-theme");
                });
              var e = Gt();
              return (
                (e.className = "tippy-content"),
                e.setAttribute("data-state", "hidden"),
                i.interactive && Zt(n, r),
                i.arrow && r.appendChild(Jt(i.arrowType)),
                i.animateFill &&
                  (r.appendChild(Qt()), r.setAttribute("data-animatefill", "")),
                i.inertia && r.setAttribute("data-inertia", ""),
                Xt(e, i),
                r.appendChild(e),
                n.appendChild(r),
                n.addEventListener("focusout", function (t) {
                  t.relatedTarget &&
                    n.Ht &&
                    !fi(t.relatedTarget, function (t) {
                      return t === n;
                    }) &&
                    t.relatedTarget !== n.Ht.reference &&
                    n.Ht.props.shouldPopperHideOnBlur(t) &&
                    n.Ht.hide();
                }),
                n
              );
            },
            ei = function (t, i, n) {
              var r = Ht(t),
                e = r.tooltip,
                s = r.content,
                a = r.backdrop,
                o = r.arrow;
              (t.style.zIndex = n.zIndex),
                e.setAttribute("data-size", n.size),
                e.setAttribute("data-animation", n.animation),
                i.content !== n.content && Xt(s, n),
                !i.animateFill && n.animateFill
                  ? (e.appendChild(Qt()),
                    e.setAttribute("data-animatefill", ""))
                  : i.animateFill &&
                    !n.animateFill &&
                    (e.removeChild(a), e.removeAttribute("data-animatefill")),
                !i.arrow && n.arrow
                  ? e.appendChild(Jt(n.arrowType))
                  : i.arrow && !n.arrow && e.removeChild(o),
                i.arrow &&
                  n.arrow &&
                  i.arrowType !== n.arrowType &&
                  e.replaceChild(Jt(n.arrowType), o),
                !i.interactive && n.interactive
                  ? Zt(t, e)
                  : i.interactive && !n.interactive && ti(t, e),
                !i.inertia && n.inertia
                  ? ii(e)
                  : i.inertia && !n.inertia && ni(e),
                i.theme !== n.theme &&
                  (i.theme.split(" ").forEach(function (t) {
                    e.classList.remove(t + "-theme");
                  }),
                  n.theme.split(" ").forEach(function (t) {
                    e.classList.add(t + "-theme");
                  }));
            },
            si = function (t) {
              Bt(document.querySelectorAll(Ut.POPPER)).forEach(function (i) {
                var n = i.Ht;
                !n ||
                  !0 !== n.props.hideOnClick ||
                  (t && i === t.popper) ||
                  n.hide();
              });
            },
            ai = function (t) {
              return Object.keys(e).reduce(function (i, n) {
                var r = (t.getAttribute("data-tippy-" + n) || "").trim();
                return r
                  ? ("content" === n
                      ? (i[n] = r)
                      : "true" === r
                      ? (i[n] = !0)
                      : "false" === r
                      ? (i[n] = !1)
                      : zt(r)
                      ? (i[n] = Number(r))
                      : "[" === r[0] || "{" === r[0]
                      ? (i[n] = JSON.parse(r))
                      : (i[n] = r),
                    i)
                  : i;
              }, {});
            },
            oi = function (t) {
              var i = {
                isVirtual: !0,
                attributes: t.attributes || {},
                setAttribute: function (i, n) {
                  t.attributes[i] = n;
                },
                getAttribute: function (i) {
                  return t.attributes[i];
                },
                removeAttribute: function (i) {
                  delete t.attributes[i];
                },
                hasAttribute: function (i) {
                  return i in t.attributes;
                },
                addEventListener: function () {},
                removeEventListener: function () {},
                classList: {
                  classNames: {},
                  add: function (i) {
                    t.classList.classNames[i] = !0;
                  },
                  remove: function (i) {
                    delete t.classList.classNames[i];
                  },
                  contains: function (i) {
                    return i in t.classList.classNames;
                  },
                },
              };
              for (var n in i) t[n] = i[n];
              return t;
            },
            hi = (function () {
              if (o) {
                var t = Element.prototype;
                return (
                  t.matches ||
                  t.matchesSelector ||
                  t.webkitMatchesSelector ||
                  t.mozMatchesSelector ||
                  t.msMatchesSelector
                );
              }
            })(),
            ui = function (t, i) {
              return (
                Element.prototype.closest ||
                function (t) {
                  for (var i = this; i; ) {
                    if (hi.call(i, t)) return i;
                    i = i.parentElement;
                  }
                }
              ).call(t, i);
            },
            fi = function (t, i) {
              for (; t; ) {
                if (i(t)) return t;
                t = t.parentElement;
              }
            },
            li = function (t) {
              var i = window.scrollX || window.pageXOffset,
                n = window.scrollY || window.pageYOffset;
              t.focus(), scroll(i, n);
            },
            ci = function (t) {
              t.offsetHeight;
            },
            vi = function (t, i) {
              return (i ? t : { X: "Y", Y: "X" }[t]) || "";
            },
            di = function (t, i, n, r) {
              var e = i[0],
                s = i[1];
              return e || s
                ? {
                    scale: s ? (n ? e + ", " + s : s + ", " + e) : "" + e,
                    translate: s
                      ? n
                        ? r
                          ? e + "px, " + -s + "px"
                          : e + "px, " + s + "px"
                        : r
                        ? -s + "px, " + e + "px"
                        : s + "px, " + e + "px"
                      : r
                      ? -e + "px"
                      : e + "px",
                  }[t]
                : "";
            },
            pi = function (t, i) {
              var n = t.match(new RegExp(i + "([XY])"));
              return n ? n[1] : "";
            },
            mi = function (t, i) {
              var n = t.match(i);
              return n ? n[1].split(",").map(parseFloat) : [];
            },
            yi = {
              translate: /translateX?Y?\(([^)]+)\)/,
              scale: /scaleX?Y?\(([^)]+)\)/,
            },
            gi = function (t, i) {
              var n = xi(ui(t, Ut.POPPER)),
                r = "top" === n || "bottom" === n,
                e = "right" === n || "bottom" === n,
                s = {
                  translate: {
                    axis: pi(i, "translate"),
                    numbers: mi(i, yi.translate),
                  },
                  scale: { axis: pi(i, "scale"), numbers: mi(i, yi.scale) },
                },
                a = i
                  .replace(
                    yi.translate,
                    "translate" +
                      vi(s.translate.axis, r) +
                      "(" +
                      di("translate", s.translate.numbers, r, e) +
                      ")"
                  )
                  .replace(
                    yi.scale,
                    "scale" +
                      vi(s.scale.axis, r) +
                      "(" +
                      di("scale", s.scale.numbers, r, e) +
                      ")"
                  );
              t.style[
                void 0 !== document.body.style.transform
                  ? "transform"
                  : "webkitTransform"
              ] = a;
            },
            wi = function (t, i) {
              t.filter(Boolean).forEach(function (t) {
                t.setAttribute("data-state", i);
              });
            },
            bi = function (t, i) {
              var n = t.popper,
                r = t.options,
                e = r.onCreate,
                s = r.onUpdate;
              r.onCreate = r.onUpdate = function () {
                ci(n), i(), s(), (r.onCreate = e), (r.onUpdate = s);
              };
            },
            ki = function (t) {
              setTimeout(t, 1);
            },
            Ei = function (t, i, n, r) {
              if (!t) return !0;
              var e = n.clientX,
                s = n.clientY,
                a = r.interactiveBorder,
                o = r.distance,
                h = i.top - s > ("top" === t ? a + o : a),
                u = s - i.bottom > ("bottom" === t ? a + o : a),
                f = i.left - e > ("left" === t ? a + o : a),
                l = e - i.right > ("right" === t ? a + o : a);
              return h || u || f || l;
            },
            Ti = function (t, i) {
              return -(t - i) + "px";
            },
            xi = function (t) {
              var i = t.getAttribute("x-placement");
              return i ? i.split("-")[0] : "";
            },
            Si = function (t, i) {
              var n = r({}, i, i.performance ? {} : ai(t));
              return (
                n.arrow && (n.animateFill = !1),
                "function" == typeof n.appendTo && (n.appendTo = i.appendTo(t)),
                "function" == typeof n.content && (n.content = i.content(t)),
                n
              );
            },
            Ai = function (t, i, n) {
              t[i + "EventListener"]("transitionend", n);
            },
            Mi = function (t, i) {
              var n = void 0;
              return function () {
                var r = this,
                  e = arguments;
                clearTimeout(n),
                  (n = setTimeout(function () {
                    return t.apply(r, e);
                  }, i));
              };
            },
            Di = function (t, i) {
              for (var n in t || {})
                if (!(n in i))
                  throw Error("[tippy]: `" + n + "` is not a valid option");
            },
            _i = !1,
            Oi = function () {
              _i ||
                ((_i = !0),
                c && document.body.classList.add("tippy-iOS"),
                window.performance &&
                  document.addEventListener("mousemove", Li));
            },
            Ri = 0,
            Li = function t() {
              var i = performance.now();
              i - Ri < 20 &&
                ((_i = !1),
                document.removeEventListener("mousemove", t),
                c || document.body.classList.remove("tippy-iOS")),
                (Ri = i);
            },
            Ii = function (t) {
              var i = t.target;
              if (!(i instanceof Element)) return si();
              var n = ui(i, Ut.POPPER);
              if (!(n && n.Ht && n.Ht.props.interactive)) {
                var r = fi(i, function (t) {
                  return t.Ht && t.Ht.reference === t;
                });
                if (r) {
                  var e = r.Ht,
                    s = e.props.trigger.indexOf("click") > -1;
                  if (_i || s) return si(e);
                  if (!0 !== e.props.hideOnClick || s) return;
                  e.clearDelayTimeouts();
                }
                si();
              }
            },
            Pi = function () {
              var t = document.activeElement;
              t && t.blur && t.Ht && t.blur();
            },
            Ci = function () {
              Bt(document.querySelectorAll(Ut.POPPER)).forEach(function (t) {
                var i = t.Ht;
                i.props.livePlacement || i.popperInstance.scheduleUpdate();
              });
            };
          function Ni() {
            document.addEventListener("click", Ii, !0),
              document.addEventListener("touchstart", Oi, { passive: !0 }),
              window.addEventListener("blur", Pi),
              window.addEventListener("resize", Ci),
              v ||
                (!navigator.maxTouchPoints && !navigator.msMaxTouchPoints) ||
                document.addEventListener("pointerdown", Oi);
          }
          var Ui = 1;
          function Fi(t, i) {
            var n = Si(t, i);
            if (!n.multiple && t.Ht) return null;
            var s = null,
              o = {},
              h = null,
              u = 0,
              f = 0,
              c = !1,
              d = function () {},
              p = [],
              m = !1,
              y = n.interactiveDebounce > 0 ? Mi(R, n.interactiveDebounce) : R,
              g = Ui++,
              w = ri(g, n);
            w.addEventListener("mouseenter", function (t) {
              k.props.interactive &&
                k.state.isVisible &&
                "mouseenter" === o.type &&
                A(t);
            }),
              w.addEventListener("mouseleave", function (t) {
                k.props.interactive &&
                  "mouseenter" === o.type &&
                  0 === k.props.interactiveDebounce &&
                  Ei(xi(w), w.getBoundingClientRect(), t, k.props) &&
                  M();
              });
            var b = Ht(w),
              k = {
                id: g,
                reference: t,
                popper: w,
                popperChildren: b,
                popperInstance: null,
                props: n,
                state: {
                  isEnabled: !0,
                  isVisible: !1,
                  isDestroyed: !1,
                  isMounted: !1,
                  isShown: !1,
                },
                clearDelayTimeouts: z,
                set: q,
                setContent: J,
                show: Q,
                hide: Z,
                enable: W,
                disable: K,
                destroy: tt,
              };
            return (
              V(),
              t.addEventListener("click", E),
              n.lazy ||
                ((k.popperInstance = U()),
                k.popperInstance.disableEventListeners()),
              n.showOnInit && A(),
              !n.a11y || n.target || Yt(t) || t.setAttribute("tabindex", "0"),
              (t.Ht = k),
              (w.Ht = k),
              k
            );
            function E() {
              ki(function () {
                m = !1;
              });
            }
            function T() {
              (s = new MutationObserver(function () {
                k.popperInstance.update();
              })).observe(w, { childList: !0, subtree: !0, characterData: !0 });
            }
            function x(t) {
              var i = (h = t),
                n = i.clientX,
                r = i.clientY;
              if (k.popperInstance) {
                var e = xi(k.popper),
                  s = k.popperChildren.arrow ? 20 : 5,
                  a = "top" === e || "bottom" === e,
                  o = "left" === e || "right" === e,
                  u = a ? Math.max(s, n) : n,
                  f = o ? Math.max(s, r) : r;
                a && u > s && (u = Math.min(n, window.innerWidth - s)),
                  o && f > s && (f = Math.min(r, window.innerHeight - s));
                var l = k.reference.getBoundingClientRect(),
                  c = k.props.followCursor,
                  v = "horizontal" === c,
                  d = "vertical" === c;
                (k.popperInstance.reference = {
                  getBoundingClientRect: function () {
                    return {
                      width: 0,
                      height: 0,
                      top: v ? l.top : f,
                      bottom: v ? l.bottom : f,
                      left: d ? l.left : u,
                      right: d ? l.right : u,
                    };
                  },
                  clientWidth: 0,
                  clientHeight: 0,
                }),
                  k.popperInstance.scheduleUpdate();
              }
            }
            function S(t) {
              var i = ui(t.target, k.props.target);
              i &&
                !i.Ht &&
                (Fi(i, r({}, k.props, { target: "", showOnInit: !0 })), A(t));
            }
            function A(t) {
              if ((z(), !k.state.isVisible)) {
                if (k.props.target) return S(t);
                if (((c = !0), k.props.wait)) return k.props.wait(k, t);
                j() && document.addEventListener("mousemove", x);
                var i = qt(k.props.delay, 0, e.delay);
                i
                  ? (u = setTimeout(function () {
                      Q();
                    }, i))
                  : Q();
              }
            }
            function M() {
              if ((z(), !k.state.isVisible)) return D();
              c = !1;
              var t = qt(k.props.delay, 1, e.delay);
              t
                ? (f = setTimeout(function () {
                    k.state.isVisible && Z();
                  }, t))
                : Z();
            }
            function D() {
              document.removeEventListener("mousemove", x), (h = null);
            }
            function _() {
              document.body.removeEventListener("mouseleave", M),
                document.removeEventListener("mousemove", y);
            }
            function O(t) {
              k.state.isEnabled &&
                !N(t) &&
                (k.state.isVisible || (o = t),
                "click" === t.type &&
                !1 !== k.props.hideOnClick &&
                k.state.isVisible
                  ? M()
                  : A(t));
            }
            function R(t) {
              var i = fi(t.target, function (t) {
                  return t.Ht;
                }),
                n = ui(t.target, Ut.POPPER) === k.popper,
                r = i === k.reference;
              n ||
                r ||
                (Ei(
                  xi(k.popper),
                  k.popper.getBoundingClientRect(),
                  t,
                  k.props
                ) &&
                  (_(), M()));
            }
            function L(t) {
              if (!N(t))
                return k.props.interactive
                  ? (document.body.addEventListener("mouseleave", M),
                    void document.addEventListener("mousemove", y))
                  : void M();
            }
            function I(t) {
              if (t.target === k.reference) {
                if (k.props.interactive) {
                  if (!t.relatedTarget) return;
                  if (ui(t.relatedTarget, Ut.POPPER)) return;
                }
                M();
              }
            }
            function P(t) {
              ui(t.target, k.props.target) && A(t);
            }
            function C(t) {
              ui(t.target, k.props.target) && M();
            }
            function N(t) {
              var i = t.type.indexOf("touch") > -1,
                n = v && _i && k.props.touchHold && !i,
                r = _i && !k.props.touchHold && i;
              return n || r;
            }
            function U() {
              var t = k.popperChildren.tooltip,
                i = k.props.popperOptions,
                n = Ut["round" === k.props.arrowType ? "ROUND_ARROW" : "ARROW"],
                a = t.querySelector(n),
                o = r({ placement: k.props.placement }, i || {}, {
                  modifiers: r({}, i ? i.modifiers : {}, {
                    arrow: r(
                      { element: n },
                      i && i.modifiers ? i.modifiers.arrow : {}
                    ),
                    flip: r(
                      {
                        enabled: k.props.flip,
                        padding: k.props.distance + 5,
                        behavior: k.props.flipBehavior,
                      },
                      i && i.modifiers ? i.modifiers.flip : {}
                    ),
                    offset: r(
                      { offset: k.props.offset },
                      i && i.modifiers ? i.modifiers.offset : {}
                    ),
                  }),
                  onCreate: function () {
                    (t.style[xi(k.popper)] = Ti(k.props.distance, e.distance)),
                      a &&
                        k.props.arrowTransform &&
                        gi(a, k.props.arrowTransform);
                  },
                  onUpdate: function () {
                    var i = t.style;
                    (i.top = ""),
                      (i.bottom = ""),
                      (i.left = ""),
                      (i.right = ""),
                      (i[xi(k.popper)] = Ti(k.props.distance, e.distance)),
                      a &&
                        k.props.arrowTransform &&
                        gi(a, k.props.arrowTransform);
                  },
                });
              return s || T(), new Nt(k.reference, k.popper, o);
            }
            function F(t) {
              k.popperInstance
                ? j() ||
                  (k.popperInstance.scheduleUpdate(),
                  k.props.livePlacement &&
                    k.popperInstance.enableEventListeners())
                : ((k.popperInstance = U()),
                  (k.props.livePlacement && !j()) ||
                    k.popperInstance.disableEventListeners()),
                (k.popperInstance.reference = k.reference);
              var i = k.popperChildren.arrow;
              if (j()) {
                i && (i.style.margin = "0");
                var n = qt(k.props.delay, 0, e.delay);
                o.type && x(n && h ? h : o);
              } else i && (i.style.margin = "");
              bi(k.popperInstance, t),
                k.props.appendTo.contains(k.popper) ||
                  (k.props.appendTo.appendChild(k.popper),
                  k.props.onMount(k),
                  (k.state.isMounted = !0));
            }
            function j() {
              return k.props.followCursor && !_i && "focus" !== o.type;
            }
            function B() {
              $t([k.popper], l ? 0 : k.props.updateDuration),
                (function t() {
                  k.popperInstance && k.popperInstance.scheduleUpdate(),
                    k.state.isMounted
                      ? requestAnimationFrame(t)
                      : $t([k.popper], 0);
                })();
            }
            function X(t, i) {
              $(t, function () {
                !k.state.isVisible &&
                  k.props.appendTo.contains(k.popper) &&
                  i();
              });
            }
            function Y(t, i) {
              $(t, i);
            }
            function $(t, i) {
              if (0 === t) return i();
              var n = k.popperChildren.tooltip,
                r = function t(r) {
                  r.target === n && (Ai(n, "remove", t), i());
                };
              Ai(n, "remove", d), Ai(n, "add", r), (d = r);
            }
            function H(t, i, n) {
              k.reference.addEventListener(t, i),
                n.push({ eventType: t, handler: i });
            }
            function V() {
              p = k.props.trigger
                .trim()
                .split(" ")
                .reduce(function (t, i) {
                  if ("manual" === i) return t;
                  if (k.props.target)
                    switch (i) {
                      case "mouseenter":
                        H("mouseover", P, t), H("mouseout", C, t);
                        break;
                      case "focus":
                        H("focusin", P, t), H("focusout", C, t);
                        break;
                      case "click":
                        H(i, P, t);
                    }
                  else
                    switch (
                      (H(i, O, t),
                      k.props.touchHold &&
                        (H("touchstart", O, t), H("touchend", L, t)),
                      i)
                    ) {
                      case "mouseenter":
                        H("mouseleave", L, t);
                        break;
                      case "focus":
                        H(l ? "focusout" : "blur", I, t);
                    }
                  return t;
                }, []);
            }
            function G() {
              p.forEach(function (t) {
                var i = t.eventType,
                  n = t.handler;
                k.reference.removeEventListener(i, n);
              });
            }
            function W() {
              k.state.isEnabled = !0;
            }
            function K() {
              k.state.isEnabled = !1;
            }
            function z() {
              clearTimeout(u), clearTimeout(f);
            }
            function q() {
              var t =
                arguments.length > 0 && void 0 !== arguments[0]
                  ? arguments[0]
                  : {};
              Di(t, e);
              var i = k.props,
                n = Si(k.reference, r({}, k.props, t, { performance: !0 }));
              (n.performance = t.hasOwnProperty("performance")
                ? t.performance
                : i.performance),
                (k.props = n),
                (t.hasOwnProperty("trigger") ||
                  t.hasOwnProperty("touchHold")) &&
                  (G(), V()),
                t.hasOwnProperty("interactiveDebounce") &&
                  (_(), (y = Mi(R, t.interactiveDebounce))),
                ei(k.popper, i, n),
                (k.popperChildren = Ht(k.popper)),
                k.popperInstance &&
                  a.some(function (i) {
                    return t.hasOwnProperty(i);
                  }) &&
                  (k.popperInstance.destroy(),
                  (k.popperInstance = U()),
                  k.state.isVisible || k.popperInstance.disableEventListeners(),
                  k.props.followCursor && h && x(h));
            }
            function J(t) {
              q({ content: t });
            }
            function Q() {
              var t =
                arguments.length > 0 && void 0 !== arguments[0]
                  ? arguments[0]
                  : qt(k.props.duration, 0, e.duration[0]);
              if (
                !k.state.isDestroyed &&
                k.state.isEnabled &&
                (!_i || k.props.touch)
              )
                return k.reference.isVirtual ||
                  document.documentElement.contains(k.reference)
                  ? void (
                      k.reference.hasAttribute("disabled") ||
                      (m
                        ? (m = !1)
                        : !1 !== k.props.onShow(k) &&
                          ((k.popper.style.visibility = "visible"),
                          (k.state.isVisible = !0),
                          $t(
                            [
                              k.popper,
                              k.popperChildren.tooltip,
                              k.popperChildren.backdrop,
                            ],
                            0
                          ),
                          F(function () {
                            k.state.isVisible &&
                              (j() || k.popperInstance.update(),
                              $t(
                                [
                                  k.popperChildren.tooltip,
                                  k.popperChildren.backdrop,
                                  k.popperChildren.content,
                                ],
                                t
                              ),
                              k.popperChildren.backdrop &&
                                (k.popperChildren.content.style.transitionDelay =
                                  Math.round(t / 6) + "ms"),
                              k.props.interactive &&
                                k.reference.classList.add("tippy-active"),
                              k.props.sticky && B(),
                              wi(
                                [
                                  k.popperChildren.tooltip,
                                  k.popperChildren.backdrop,
                                  k.popperChildren.content,
                                ],
                                "visible"
                              ),
                              Y(t, function () {
                                0 === k.props.updateDuration &&
                                  k.popperChildren.tooltip.classList.add(
                                    "tippy-notransition"
                                  ),
                                  k.props.interactive &&
                                    ["focus", "click"].indexOf(o.type) > -1 &&
                                    li(k.popper),
                                  k.reference.setAttribute(
                                    "aria-describedby",
                                    k.popper.id
                                  ),
                                  k.props.onShown(k),
                                  (k.state.isShown = !0);
                              }));
                          })))
                    )
                  : tt();
            }
            function Z() {
              var t =
                arguments.length > 0 && void 0 !== arguments[0]
                  ? arguments[0]
                  : qt(k.props.duration, 1, e.duration[1]);
              !k.state.isDestroyed &&
                k.state.isEnabled &&
                !1 !== k.props.onHide(k) &&
                (0 === k.props.updateDuration &&
                  k.popperChildren.tooltip.classList.remove(
                    "tippy-notransition"
                  ),
                k.props.interactive &&
                  k.reference.classList.remove("tippy-active"),
                (k.popper.style.visibility = "hidden"),
                (k.state.isVisible = !1),
                (k.state.isShown = !1),
                $t(
                  [
                    k.popperChildren.tooltip,
                    k.popperChildren.backdrop,
                    k.popperChildren.content,
                  ],
                  t
                ),
                wi(
                  [
                    k.popperChildren.tooltip,
                    k.popperChildren.backdrop,
                    k.popperChildren.content,
                  ],
                  "hidden"
                ),
                k.props.interactive &&
                  !m &&
                  ["focus", "click"].indexOf(o.type) > -1 &&
                  ("focus" === o.type && (m = !0), li(k.reference)),
                X(t, function () {
                  c || D(),
                    k.reference.removeAttribute("aria-describedby"),
                    k.popperInstance.disableEventListeners(),
                    k.props.appendTo.removeChild(k.popper),
                    (k.state.isMounted = !1),
                    k.props.onHidden(k);
                }));
            }
            function tt(t) {
              k.state.isDestroyed ||
                (k.state.isMounted && Z(0),
                G(),
                k.reference.removeEventListener("click", E),
                delete k.reference.Ht,
                k.props.target &&
                  t &&
                  Bt(k.reference.querySelectorAll(k.props.target)).forEach(
                    function (t) {
                      return t.Ht && t.Ht.destroy();
                    }
                  ),
                k.popperInstance && k.popperInstance.destroy(),
                s && s.disconnect(),
                (k.state.isDestroyed = !0));
            }
          }
          var ji = !1;
          function Bi(t, i, n) {
            Di(i, e), ji || (Ni(), (ji = !0));
            var s = r({}, e, i);
            Vt(t) && oi(t);
            var a = Kt(t),
              o = a[0],
              h = (n && o ? [o] : a).reduce(function (t, i) {
                var n = i && Fi(i, s);
                return n && t.push(n), t;
              }, []);
            return {
              targets: t,
              props: s,
              instances: h,
              destroyAll: function () {
                this.instances.forEach(function (t) {
                  t.destroy();
                }),
                  (this.instances = []);
              },
            };
          }
          (Bi.version = i),
            (Bi.defaults = e),
            (Bi.one = function (t, i) {
              return Bi(t, i, !0).instances[0];
            }),
            (Bi.setDefaults = function (t) {
              s(t), (Bi.defaults = e);
            }),
            (Bi.disableAnimations = function () {
              Bi.setDefaults({
                duration: 0,
                updateDuration: 0,
                animateFill: !1,
              });
            }),
            (Bi.hideAllPoppers = si),
            (Bi.useCapture = function () {});
          var Xi = function () {
            Bt(document.querySelectorAll("[data-tippy]")).forEach(function (t) {
              var i = t.getAttribute("data-tippy");
              i && Bi(t, { content: i });
            });
          };
          return o && setTimeout(Xi), jt(t), Bi;
        })();
      },
      589: (t) => {
        t.exports = {
          Vt() {
            document.querySelector(
              ".main"
            ).innerHTML = `<div class="message_wrap">\n\t\t\t<span class="text">${chrome.i18n.getMessage(
              "here_no_vimeo_video"
            )}</span>\n\t\t\t<button class="go_to_vimeo">${chrome.i18n.getMessage(
              "go_to_vimeo"
            )}</button>\n\t\t\t</div>`;
          },
          Gt() {
            document.querySelector(
              ".main"
            ).innerHTML = `<div class="message_wrap">\n\t\t\t<div class="mt30">\n\t\t\t<span class="text">${chrome.i18n.getMessage(
              "no_video"
            )}</span>\n\t\t\t</div>\n\t\t\t</div>`;
          },
          Wt() {
            document.querySelector(
              ".main"
            ).innerHTML = `<div class="message_wrap">\n\t\t\t<div class="mt30">\n\t\t\t<span class="text">${chrome.i18n.getMessage(
              "something_went_wrong"
            )}</span>\n\t\t\t</div>\n\t\t\t</div>`;
          },
          Kt() {
            document.querySelector(
              ".main"
            ).innerHTML = `<div class="message_wrap">\n\t\t\t<div class="mt30">\n\t\t\t<button class="btn_refresh">\n\t\t\t<span class="refresh_icon"></span>\n\t\t\t<span>${chrome.i18n.getMessage(
              "refresh_page"
            )}</span>\n\t\t\t</button>\n\t\t\t</div>\n\t\t\t</div>`;
          },
          zt() {
            document.querySelector(".main").innerHTML =
              '<div class="page_loader"></div>';
          },
          qt() {
            document.querySelector(
              ".main"
            ).innerHTML = `<div class="message_wrap">\n<div class="empty_favorites mt30">\n<span class="icon"></span>\n<span class="text">${chrome.i18n.getMessage(
              "empty_favorites"
            )}</span>\n</div>'+\n</div>`;
          },
          Jt(t, i = null) {
            t.querySelectorAll(".btn_wrap button").forEach(function (t) {
              (t.innerText = i || chrome.i18n.getMessage("error")),
                (t.dataset.error = "1");
            });
          },
        };
      },
      30: (t, i, n) => {
        const r = n(405);
        t.exports = {
          Qt: null,
          Zt: function (t) {
            (this.Qt[t.video_id] = {
              video_id: t.video_id,
              video_url: t.video_url,
              thumb: t.thumb,
              title: t.title,
              tS: Date.now(),
            }),
              chrome.storage.sync.set(
                { favorite_videos: this.Qt },
                function () {}
              );
          },
          ti: function (t) {
            if (!this.ii(t)) return null;
            delete this.Qt[t],
              chrome.storage.sync.set(
                { favorite_videos: this.Qt },
                function () {}
              );
          },
          ni: function () {
            const t = this;
            return chrome.storage.sync
              .get("favorite_videos")
              .then(function (i) {
                t.Qt = i.favorite_videos || {};
              });
          },
          ii: function (t) {
            return this.Qt.hasOwnProperty(t);
          },
          ri: function (t) {
            return this.ii(t) ? this.Qt[t] : null;
          },
          ei: function () {
            const t = [];
            for (let i in this.Qt)
              this.Qt.hasOwnProperty(i) && t.push(this.Qt[i]);
            return r.si(t, "tS"), t;
          },
        };
      },
      474: (t, i, n) => {
        const r = n(405),
          e = n(589);
        t.exports = {
          ai: null,
          oi(t, i) {
            const n = this;
            r.si(t, "quality", !0);
            const e = i.querySelector(".files_buttons_list_container"),
              s = document.createElement("div");
            (s.className = "files_buttons_kisr_wrap"),
              e.appendChild(s),
              t.forEach(function (t) {
                n.hi(t, s);
              }),
              r.ui(e),
              setTimeout(function () {
                (e.style.width = "260px"), (e.style.height = "131px");
              }, 20),
              setTimeout(function () {
                e.style.bottom = "2px";
              }, 50),
              setTimeout(function () {
                (e.innerHTML += `<div class="close_files_btn">${chrome.i18n.getMessage(
                  "close"
                )}</div>`),
                  e
                    .querySelectorAll(".btn_file_download")
                    .forEach(function (t) {
                      t.classList.add("ready");
                    });
              }, 400);
          },
          hi(t, i) {
            let n = document.createElement("div");
            n.className = "btn_file_download";
            let e = "",
              s = "";
            ("file" !== t.type && "stream" !== t.type) ||
              ((e =
                parseInt(t.quality) >= 1440
                  ? "UHD"
                  : parseInt(t.quality) >= 720
                  ? "HD"
                  : ""),
              (s = t.fileSize || "???")),
              r.fi(n, t),
              (n.innerHTML = `<span><span>${t.title}</span><span class="hd">${e}</span></span>\n<span><span class="size">${s}</span><span class="icon"></span></span>`),
              i.appendChild(n);
          },
          li(t) {
            const i = t.closest(".files_buttons_list_container");
            setTimeout(function () {
              r.ci(i), (i.style.bottom = "10px");
            }, 200),
              setTimeout(function () {
                r.ci(i), (i.innerHTML = "");
              }, 500),
              (i.style.width = "1px"),
              (i.style.height = "1px");
          },
          vi(t) {
            (this.ai = t.closest(".video_item")),
              (this.ai.querySelector(".btn_download .text").innerText = "0%");
          },
          di(t) {
            const i = document.createElement("div");
            (i.className = "wait_download_msg"),
              (i.innerText = chrome.i18n.getMessage(
                "wait_finish_another_downloading_process"
              )),
              t.before(i),
              setTimeout(function () {
                i.remove();
              }, 3e3);
          },
          pi(t) {
            if (!this.ai) return;
            const i = this.ai.querySelector(".btn_download .text");
            if (t.percents)
              100 === t.percents
                ? (i.innerText = `${chrome.i18n.getMessage("finishing")} ...`)
                : (i.innerText = `${t.percents}%`);
            else if (t.done)
              (i.innerText = chrome.i18n.getMessage("done")),
                setTimeout(function () {
                  i.innerText = chrome.i18n.getMessage("download");
                }, 3e3),
                (this.ai = null);
            else if (t.failed) {
              let i = null;
              "network error" === t.e &&
                (i = chrome.i18n.getMessage("network_error")),
                e.Jt(this.ai, i),
                (this.ai = null);
            }
          },
        };
      },
      240: (t, i, n) => {
        const r = n(474);
        t.exports = {
          mi(t) {
            const i = this;
            (i.port = chrome.runtime.connect({ name: "popup" })),
              i.port.onMessage.addListener(function (n) {
                "download_step" === n.action &&
                  t == n.process_id &&
                  (r.pi(n.details),
                  (n.details.done || n.details.failed) && i.port.disconnect());
              });
          },
        };
      },
      135: (t, i, n) => {
        const r = n(617);
        t.exports = {
          yi: !1,
          gi: function () {
            if (this.yi) return;
            this.yi = !0;
            const t = this;
            chrome.storage.sync.get("user_rate", function (i) {
              i.user_rate || t.oi();
            });
          },
          oi: function () {
            const t = document.createElement("div");
            (t.classList = "rate_stars"),
              document.querySelector(".header").appendChild(t),
              (t.innerHTML =
                '\n<span class="star _0" data-val="1"></span>\n<span class="star _0" data-val="2"></span>\n<span class="star _0" data-val="3"></span>\n<span class="star _0" data-val="4"></span>\n<span class="star _0" data-val="5"></span>');
            let i = !1;
            const n = document.querySelector(".rate_stars"),
              e = n.querySelectorAll(".star");
            let s = !1;
            function a(t) {
              s = !0;
              const i = this.dataset.val;
              e.forEach(function (t) {
                t.dataset.val <= i
                  ? (t.classList.remove("_0"), t.classList.add("_1"))
                  : (t.classList.remove("_1"), t.classList.add("_0"));
              });
            }
            function o(t) {
              (s = !1),
                setTimeout(function () {
                  s ||
                    e.forEach(function (t) {
                      t.classList.remove("_1"), t.classList.add("_0");
                    });
                }, 100);
            }
            function h(t) {
              const n = this.dataset.val;
              e.forEach(function (t) {
                t.dataset.val <= n &&
                  (t.classList.remove("_0"), t.classList.add("_1"));
              }),
                e.forEach(function (t) {
                  t.removeEventListener("mouseover", a),
                    t.removeEventListener("mouseout", o),
                    t.removeEventListener("click", h);
                }),
                chrome.storage.sync.set({ user_rate: n }),
                n > 3 && !i
                  ? ((i = !0),
                    chrome.tabs.create({
                      url: `https://chromewebstore.google.com/detail/${chrome.runtime.id}/reviews`,
                    }))
                  : r(".rate_stars .stars", {
                      content: chrome.i18n.getMessage("your_rate"),
                    });
            }
            r(".rate_stars", { content: chrome.i18n.getMessage("rate_us") }),
              e.forEach(function (t) {
                t.addEventListener("mouseover", a),
                  t.addEventListener("mouseout", o),
                  t.addEventListener("click", h);
              }),
              (n.style.display = "flex");
          },
        };
      },
      405: (t) => {
        t.exports = {
          si(t, i, n) {
            t.sort(function (t, r) {
              let e = parseInt(t[i]),
                s = parseInt(r[i]);
              return n
                ? e < s
                  ? 1
                  : e > s
                  ? -1
                  : 0
                : e > s
                ? 1
                : e < s
                ? -1
                : 0;
            });
          },
          wi: (t) =>
            new Promise(function (i) {
              setTimeout(i, t);
            }),
          fi(t, i) {
            t.dataset.meta = JSON.stringify(i);
          },
          bi: (t) => (t.dataset.meta && JSON.parse(t.dataset.meta)) || {},
          ci(t) {
            t.classList.add("hidden");
          },
          ui(t) {
            t.classList.remove("hidden");
          },
          ki(t) {
            let i = null,
              n = null;
            return (
              t.forEach(function (t, r) {
                if (!t.url || "file" !== t.type || !t.quality) return;
                let e = parseInt(t.quality);
                (null === i || e < i) && ((i = e), (n = t.url));
              }),
              n
            );
          },
          Ei: (t) =>
            t.filter(
              (t) =>
                !(
                  "stream" === t.type &&
                  t.fileSizeBytes > 0.45 * performance.memory.jsHeapSizeLimit
                )
            ),
        };
      },
      755: (t, i, n) => {
        const r = n(405);
        t.exports = {
          Ti: {},
          xi(t) {
            return this.Ti[t];
          },
          Si(t) {
            const i = this;
            return chrome.runtime
              .sendMessage({ action: "get_vimeo_links", ...t })
              .then(function (t) {
                return t && t.video_id && t.links
                  ? ((t.links = r.Ei(t.links)), (i.Ti[t.video_id] = t), t)
                  : Promise.reject(t);
              });
          },
        };
      },
      579: (t) => {
        t.exports = {
          Qt: [],
          Ai(t) {
            this.Qt = this.Qt.concat(t);
          },
          ri() {
            return this.Qt;
          },
        };
      },
    },
    i = {};
  function n(r) {
    var e = i[r];
    if (void 0 !== e) return e.exports;
    var s = (i[r] = { exports: {} });
    return t[r].call(s.exports, s, s.exports, n), s.exports;
  }
  (n.n = (t) => {
    var i = t && t.nt ? () => t.default : () => t;
    return n.d(i, { a: i }), i;
  }),
    (n.d = (t, i) => {
      for (var r in i)
        n.o(i, r) &&
          !n.o(t, r) &&
          Object.defineProperty(t, r, { enumerable: !0, get: i[r] });
    }),
    (n.g = (function () {
      if ("object" == typeof globalThis) return globalThis;
      try {
        return this || new Function("return this")();
      } catch (t) {
        if ("object" == typeof window) return window;
      }
    })()),
    (n.o = (t, i) => Object.prototype.hasOwnProperty.call(t, i)),
    (() => {
      var t = n(589),
        i = n.n(t),
        r = n(30),
        e = n.n(r),
        s = n(405),
        a = n.n(s),
        o = n(755),
        h = n.n(o),
        u = n(474),
        f = n.n(u),
        l = n(479),
        c = n.n(l);
      const v = {
        Mi(t, i) {
          this.Di();
          const n = document.createElement("div");
          (n.className = "player_container"),
            (n.innerHTML =
              '<div class="close_video_btn">&times;</div>\n\x3c!--\t\t<div class="expand_video_btn">&times;</div>--\x3e\n\t\t<video autoplay controls>'),
            t.after(n);
          const r = a().ki(i.links),
            e = n.querySelector("video");
          if (r)
            e.setAttribute("src", r),
              e
                .play()
                .then(function (t) {})
                .catch(function (t) {});
          else if (i.master_play_list)
            if (c().isSupported()) {
              const t = new (c())();
              t.loadSource(i.master_play_list),
                t.attachMedia(e),
                e
                  .play()
                  .then(function (t) {})
                  .catch(function (t) {});
            } else
              e.canPlayType("application/vnd.apple.mpegurl") &&
                ((e.src = i.master_play_list),
                e.addEventListener("loadedmetadata", function () {
                  e.play()
                    .then(function (t) {})
                    .catch(function (t) {});
                }));
        },
        Di() {
          document.querySelectorAll("video").forEach(function (t) {
            t.pause();
          }),
            document
              .querySelectorAll(".player_container")
              .forEach(function (t) {
                t.remove();
              });
        },
        _i(t) {
          const i = t.closest(".player_container"),
            n = i.querySelector("video");
          n && n.pause(), i.remove();
        },
      };
      var d = n(240),
        p = n.n(d);
      const m = {
        Oi(t) {
          const i = a().bi(t),
            n = t.closest(".video_item"),
            r = a().bi(n),
            e = !!t.closest(".favoritesContainer");
          f().li(t),
            i.url
              ? this.Ri(i.url, i.filename)
              : this.Li(t, {
                  ...i,
                  thumb: r.thumb,
                  video_id: r.video_id,
                  in_favorites: e,
                });
        },
        Ri(t, i) {
          chrome.runtime.sendMessage(
            { action: "download_file", url: t, filename: i },
            function (res) {
              if (!res || !res.success) {
                // fallback: pokuaj direktno iz popup-a ako background nije uspeo
                chrome.downloads.download(
                  { url: t, filename: i },
                  function (id) {
                    if (chrome.runtime.lastError)
                      console.error(
                        "popup direct download failed:",
                        chrome.runtime.lastError.message
                      );
                    else console.log("popup download started id", id);
                  }
                );
              } else {
                console.log("background download handled");
              }
            }
          );
        },
        Li(t, n) {
          chrome.runtime
            .sendMessage({ action: "download_parts", data: n })
            .then(function (n) {
              if (!chrome.runtime.lastError && n) {
                if (n.start && n.process_id) f().vi(t), p().mi(n.process_id);
                else if (n.downloading_now) {
                  const i = t.closest(".video_item"),
                    n = i.querySelector(".files_buttons_kisr_wrap");
                  n && f().li(n), f().di(i);
                }
              } else {
                const n = t.closest(".video_item");
                i().Jt(n);
              }
            });
        },
      };
      var y = n(579),
        g = n.n(y),
        w = n(135),
        b = n.n(w);
      let k = 1,
        E = [];
      const T = {
          Ii() {
            2 === k ? this.Pi() : this.Ci();
          },
          Ci() {
            const t = g().ri(),
              n = this;
            if (!t.length) return i().Gt();
            document.querySelector(".tileContainer") ||
              (document.querySelector(".main").innerHTML =
                '<div class="tileContainer"></div>'),
              this.Ni(t),
              chrome.runtime.sendMessage(
                { action: "is_downloading_now" },
                function (t) {
                  if (t) {
                    let i = document.querySelector(
                      `.tileContainer [data-video-id="${t.video_id}"]`
                    );
                    i ||
                      t.in_favorites ||
                      (E.push(t.video_id),
                      n.Ui(t, !1, !0),
                      (i = document.querySelector(
                        `[data-video-id="${t.video_id}"]`
                      ))),
                      i && (f().vi(i), p().mi(t.process_id));
                  }
                }
              );
          },
          Pi() {
            if (((E = []), document.querySelector(".favoritesContainer")))
              return;
            const t = e().ei();
            if (!t.length) return i().qt();
            (document.querySelector(".main").innerHTML =
              '<div class="favoritesContainer"></div>'),
              this.Ni(t, !0),
              chrome.runtime.sendMessage(
                { action: "is_downloading_now" },
                function (t) {
                  if (t) {
                    let i = document.querySelector(
                      `.favoritesContainer [data-video-id="${t.video_id}"]`
                    );
                    i && (f().vi(i), p().mi(t.process_id));
                  }
                }
              );
          },
          Ni(t, i) {
            const n = this;
            b().gi(),
              t.forEach(function (t) {
                i
                  ? n.Ui(t, i)
                  : E.includes(t.video_id) || (E.push(t.video_id), n.Ui(t, i));
              });
          },
          Ui(t, i, n = !1) {
            const r = document.querySelector(
                "." + (i ? "favoritesContainer" : "tileContainer")
              ),
              s = t.title || "",
              o = t.thumb
                ? `<div class="video_thumbnail_stub" style="background-image:url(/img/video_stub.svg);">\n\t\t\t<div class="video_thumbnail" style="background-image:url(${t.thumb});background-size:cover;"></div>\n\t\t</div>`
                : '<div class="video_thumbnail_stub" style="background-image:url(/img/video_stub.svg);"></div>',
              h = i
                ? `<button class="del_from_favorites"><span class="icon"></span><span class="text">${chrome.i18n.getMessage(
                    "remove"
                  )}</span></button>`
                : e().ii(t.video_id)
                ? `<button class="add_to_favorites added" data-added="1"><span class="icon"></span><span class="text">${chrome.i18n.getMessage(
                    "in_favorites"
                  )}</span></button>`
                : `<button class="add_to_favorites"><span class="icon"></span><span class="text">${chrome.i18n.getMessage(
                    "add_to_favorites"
                  )}</span></button>`,
              u = document.createElement("div");
            (u.className = "video_item"),
              (u.innerHTML = `\n\t${o}\n<div class="video_data_container">\n<div class="video_title"><div>${s}</div></div>\n<div class="video_actions_container">\n<div class="btn_wrap">\n<button class="btn_play"><span class="icon"></span><span class="text">${chrome.i18n.getMessage(
                "play"
              )}</span></button>\n<button class="btn_download"><span class="icon"></span><span class="text">${chrome.i18n.getMessage(
                "download"
              )}</span></button>\n<div class="files_buttons_list_container">\n</div>\n</div>\n${h}\n</div>\n</div>`),
              a().fi(u, t),
              (u.dataset.videoId = t.video_id),
              n && r.firstElementChild
                ? r.insertBefore(u, r.firstElementChild)
                : r.appendChild(u);
          },
          Fi(t) {
            if (t.classList.contains("favorites_page_tab")) {
              if (2 === k) return;
              (k = 2),
                t.classList.add("active"),
                document
                  .querySelector(".current_page_tab")
                  .classList.remove("active"),
                this.Pi();
            } else if (t.classList.contains("current_page_tab")) {
              if (1 === k) return;
              (k = 1),
                t.classList.add("active"),
                document
                  .querySelector(".favorites_page_tab")
                  .classList.remove("active"),
                this.Ci();
            }
          },
        },
        x = {
          ji: null,
          Bi: !1,
          Xi: function (t) {
            const n = this;
            (n.ji = chrome.tabs.connect(t, { name: "port" })),
              n.Yi(),
              setTimeout(function () {
                n.Bi || (i().Wt(), n.ji.disconnect());
              }, 5e3);
          },
          Yi() {
            const t = this;
            t.ji.onMessage.addListener(function (i) {
              i.video_list && (g().Ai(i.video_list), (t.Bi = !0), T.Ii());
            });
          },
        };
      function S() {
        let t = 0;
        document
          .querySelector(".favorites_page_tab")
          .addEventListener("click", function () {
            T.Fi(this);
          }),
          document
            .querySelector(".current_page_tab")
            .addEventListener("click", function () {
              T.Fi(this);
            }),
          document.body.addEventListener("click", function (n) {
            let r = n.target;
            if (
              !(function (i) {
                i.preventDefault(), i.stopPropagation();
                const n = Date.now();
                return n < t + 500 || ((t = n), !1);
              })(n)
            )
              if (
                r.classList.contains("add_to_favorites") ||
                r.closest(".add_to_favorites")
              ) {
                if (((r = r.closest(".add_to_favorites")), r.dataset.added))
                  return;
                const t = a().bi(r.closest(".video_item"));
                e().Zt(t),
                  (r.querySelector(".text").innerText =
                    chrome.i18n.getMessage("in_favorites")),
                  r.classList.add("added"),
                  (r.dataset.added = "1");
              } else if (
                r.classList.contains("del_from_favorites") ||
                r.closest(".del_from_favorites")
              ) {
                const t = r.closest(".video_item");
                e().ti(a().bi(t).video_id),
                  t.remove(),
                  document.querySelector(".favoritesContainer .video_item") ||
                    i().qt();
              } else if (
                r.classList.contains("btn_play") ||
                r.closest(".btn_play")
              ) {
                if (((r = r.closest(".btn_play")), r.dataset.error)) return;
                const t = r.closest(".video_item"),
                  n = a().bi(t),
                  e = h().xi([n.video_id]);
                if (e) return v.Mi(t, e);
                (r.querySelector(".text").innerText =
                  chrome.i18n.getMessage("play") + "..."),
                  h()
                    .Si(n)
                    .then(function (i) {
                      (r.querySelector(".text").innerText =
                        chrome.i18n.getMessage("play")),
                        v.Mi(t, i);
                    })
                    .catch(function () {
                      i().Jt(t, r);
                    });
              } else if (
                r.classList.contains("btn_download") ||
                r.closest(".btn_download")
              ) {
                if (((r = r.closest(".btn_download")), r.dataset.error)) return;
                const t = r.closest(".video_item");
                chrome.runtime.sendMessage(
                  { action: "is_downloading_now" },
                  function (n) {
                    if (n) return f().di(t);
                    const e = a().bi(t),
                      s = h().xi(e.video_id);
                    if (s) return f().oi(s.links, t);
                    (r.querySelector(".text").innerText =
                      chrome.i18n.getMessage("download") + "..."),
                      h()
                        .Si(e)
                        .then(function (i) {
                          (r.querySelector(".text").innerText =
                            chrome.i18n.getMessage("download")),
                            f().oi(i.links, t);
                        })
                        .catch(function (n) {
                          i().Jt(t, r);
                        });
                  }
                );
              } else if (
                r.classList.contains("btn_file_download") ||
                r.closest(".btn_file_download")
              ) {
                if (
                  ((r = r.closest(".btn_file_download")),
                  !r.classList.contains("ready"))
                )
                  return;
                m.Oi(r);
              } else
                r.classList.contains("close_files_btn") ||
                r.closest(".close_files_btn")
                  ? ((r = r.closest(".close_files_btn")), f().li(r))
                  : r.classList.contains("close_video_btn") ||
                    r.closest(".close_video_btn")
                  ? ((r = r.closest(".close_video_btn")), v._i(r))
                  : r.classList.contains("go_to_vimeo") ||
                    r.closest(".go_to_vimeo")
                  ? ((r = r.closest(".go_to_vimeo")),
                    chrome.tabs.create({ url: "https://vimeo.com/watch" }),
                    window.close())
                  : (r.classList.contains("btn_refresh") ||
                      r.closest(".btn_refresh")) &&
                    ((r = r.closest(".btn_refresh")),
                    chrome.tabs.reload(function () {
                      T.Ii();
                    }));
          });
      }
      function A() {
        let t, n;
        return chrome.tabs
          .query({ active: !0, currentWindow: !0 })
          .then(function (i) {
            return chrome.runtime.lastError || !i.length
              ? Promise.reject("not_vimeo")
              : "complete" !== i[0].status
              ? Promise.reject("tab_not_loaded")
              : ((t = i[0].url),
                (n = i[0].id),
                chrome.runtime.sendMessage({
                  action: "is_page_connected",
                  tab_id: i[0].id,
                }));
          })
          .then(function (i) {
            return i
              ? n
              : t && /https?:\/\/(.*\.)?vimeo\.com/.test(t)
              ? Promise.reject("need_refresh_page")
              : Promise.reject("not_vimeo");
          })
          .catch(function (t) {
            return "tab_not_loaded" === t
              ? a()
                  .wi(500)
                  .then(function () {
                    return i().zt(), A();
                  })
              : ("not_vimeo" === t
                  ? i().Vt()
                  : "need_refresh_page" === t
                  ? i().Kt()
                  : i().Wt(),
                Promise.reject(t));
          });
      }
      document
        .querySelector("html")
        .setAttribute("lang", chrome.i18n.getMessage("lang")),
        (document.querySelector("title").innerText =
          chrome.i18n.getMessage("name")),
        (document.querySelector(".current_page_tab").innerText =
          chrome.i18n.getMessage("current_page_header")),
        (document.querySelector(".favorites_page_tab").innerText =
          chrome.i18n.getMessage("favorites_header")),
        e()
          .ni()
          .then(function () {
            return S(), A();
          })
          .then(function (t) {
            i().zt(), x.Xi(t);
          })
          .catch(function (t) {});
    })();
})();
